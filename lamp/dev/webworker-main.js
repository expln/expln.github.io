(()=>{"use strict";var r,t={2761:(r,t,n)=>{var e=n(7175);function o(r,t,n){var e=r[t];r[t]=r[n],r[n]=e}function i(r){for(var t,n,e=r.length,i=0;i<e;++i)o(r,i,(t=i,n=e,(0|Math.floor(Math.random()*(n-t|0)))+t|0))}function a(r,t){for(var n=r.length,o=new Array(n),i=0,a=0;a<n;++a){var u=t(r[a]);void 0!==u&&(o[i]=e.valFromOption(u),i=i+1|0)}return o.length=i,o}t.make=function(r,t){if(r<=0)return[];var n=new Array(r);return n.fill(t),n},t.fromInitializer=function(r,t){if(r<=0)return[];for(var n=new Array(r),e=0;e<r;++e)n[e]=t(e);return n},t.equal=function(r,t,n){var e=r.length;if(e!==t.length)return!1;for(var o=0;;){var i=o;if(i===e)return!0;if(!n(r[i],t[i]))return!1;o=i+1|0}},t.compare=function(r,t,n){var e=r.length,o=t.length;if(e<o)return-1;if(e>o)return 1;for(var i=0;;){var a=i;if(a===e)return 0;var u=n(r[a],t[a]);if(0!==u)return u;i=a+1|0}},t.indexOfOpt=function(r,t){var n=r.indexOf(t);if(-1!==n)return n},t.lastIndexOfOpt=function(r,t){var n=r.lastIndexOf(t);if(-1!==n)return n},t.reduce=function(r,t,n){return r.reduce(n,t)},t.reduceWithIndex=function(r,t,n){return r.reduce(n,t)},t.reduceRight=function(r,t,n){return r.reduceRight(n,t)},t.reduceRightWithIndex=function(r,t,n){return r.reduceRight(n,t)},t.findIndexOpt=function(r,t){var n=r.findIndex(t);if(-1!==n)return n},t.filterMap=a,t.keepSome=function(r){return a(r,(function(r){return r}))},t.toShuffled=function(r){var t=r.slice();return i(t),t},t.shuffle=i,t.findMap=function(r,t){for(var n=0;;){var e=n;if(e===r.length)return;var o=t(r[e]);if(void 0!==o)return o;n=e+1|0}},t.last=function(r){return r[r.length-1|0]}},5300:(r,t)=>{var n={floor:function(r){return 0|Math.floor(r)},ceil:function(r){return 0|Math.ceil(r)},random:function(r,t){var n=Math.random()*(t-r|0);return(0|Math.floor(n))+r|0}};t.Constants={},t.Int=n},2971:(r,t,n)=>{var e=n(6253),o=n(1386),i=n(4763),a=n(7175);function u(r,t,n){var e=r[t];r[t]=r[n],r[n]=e}function s(r){for(var t=r.length,n=0;n<t;++n)u(r,n,i.random_int(n,t))}function f(r,t){if(r<=0)return[];for(var n=new Array(r),e=0;e<r;++e)n[e]=t(e);return n}function c(r,t){var n=f(r,t);return s(n),n}function v(r,t,n){for(var e=r.length,o=t.length,i=e<o?e:o,a=new Array(i),u=0;u<i;++u)a[u]=n(r[u],t[u]);return a}function d(r){for(var t=r.length,n=0,e=0;e<t;++e)n=n+r[e].length|0;var o=new Array(n);n=0;for(var i=0;i<t;++i)for(var a=r[i],u=0,s=a.length;u<s;++u)o[n]=a[u],n=n+1|0;return o}function l(r,t){for(var n=0,e=r.length;n<e;++n)t(r[n])}function p(r,t){for(var n=r.length,e=new Array(n),o=0;o<n;++o)e[o]=t(r[o]);return e}function m(r,t){for(var n,e=r.length,o=0;void 0===n&&o<e;){var i=r[o];t(i)&&(n=a.some(i)),o=o+1|0}return n}function h(r,t){for(var n,e=r.length,o=0;void 0===n&&o<e;)t(r[o])&&(n=o),o=o+1|0;return n}function g(r,t){for(var n=r.length,e=new Array(n),o=0,i=0;i<n;++i){var a=r[i];t(a)&&(e[o]=a,o=o+1|0)}return e.length=o,e}function E(r,t){for(var n=r.length,e=new Array(n),o=0,i=0;i<n;++i){var a=r[i];t(a,i)&&(e[o]=a,o=o+1|0)}return e.length=o,e}function x(r,t){for(var n=r.length,e=new Array(n),o=0,i=0;i<n;++i){var u=t(r[i]);void 0!==u&&(e[o]=a.valFromOption(u),o=o+1|0)}return e.length=o,e}function y(r,t){for(var n=0,e=r.length;n<e;++n)t(n,r[n])}function _(r,t){for(var n=r.length,e=new Array(n),o=0;o<n;++o)e[o]=t(o,r[o]);return e}function b(r,t,n){for(var e=t,o=0,i=r.length;o<i;++o)e=n(e,r[o]);return e}function A(r,t,n){for(var e=t,o=r.length-1|0;o>=0;--o)e=n(e,r[o]);return e}function T(r,t,n,o){for(var i=n,a=e.int_min(r.length,t.length)-1|0;a>=0;--a)i=o(i,r[a],t[a]);return i}function k(r,t,n){for(var e=t,o=0,i=r.length;o<i;++o)e=n(e,r[o],o);return e}function S(r,t){for(var n=r.length,e=0;;){var o=e;if(o===n)return!0;if(!t(r[o]))return!1;e=o+1|0}}function w(r,t){for(var n=r.length,e=0;;){var o=e;if(o===n)return!1;if(t(r[o]))return!0;e=o+1|0}}function I(r,t,n,e,o){for(;;){var i=n;if(i===o)return!0;if(!e(r[i],t[i]))return!1;n=i+1|0}}function G(r,t,n){return I(r,t,0,n,e.int_min(r.length,t.length))}function C(r,t,n){for(var o=0,i=e.int_min(r.length,t.length);;){var a=o;if(a===i)return!1;if(n(r[a],t[a]))return!0;o=a+1|0}}function M(r,t,n){var e=r.length;return e===t.length&&I(r,t,0,n,e)}function N(r,t,n){var e=r.length,o=t.length;if(e>o)return 1;if(e<o)return-1;for(var i=0;;){var a=i;if(a===e)return 0;var u=n(r[a],t[a]);if(0!==u)return u;i=a+1|0}}function D(r,t){for(var n=r.length,e=0,o=0,i=new Array(n),a=new Array(n),u=0;u<n;++u){var s=r[u];t(s)?(i[e]=s,e=e+1|0):(a[o]=s,o=o+1|0)}return i.length=e,a.length=o,[i,a]}function U(r,t,n){var e=r.length;if(0===e)return"";for(var o=e-1|0,i=0,a="";;){var u=a,s=i;if(s===o)return u+n(r[s]);a=u+(n(r[s])+t),i=s+1|0}}function j(r,t){for(var n=new Array(r),e=0;e<r;++e)n[e]=t(e);return n}t.get=function(r,t){if(t>=0&&t<r.length)return a.some(r[t])},t.getExn=function(r,t){if(!(t>=0&&t<r.length))throw{RE_EXN_ID:"Assert_failure",_1:["belt_Array.res",36,2],Error:new Error};return r[t]},t.set=function(r,t,n){return t>=0&&t<r.length&&(r[t]=n,!0)},t.setExn=function(r,t,n){if(!(t>=0&&t<r.length))throw{RE_EXN_ID:"Assert_failure",_1:["belt_Array.res",49,2],Error:new Error};r[t]=n},t.shuffleInPlace=s,t.shuffle=function(r){var t=r.slice(0);return s(t),t},t.reverseInPlace=function(r){for(var t=r.length,n=0,e=t/2|0;n<e;++n)u(r,0+n|0,((0+t|0)-n|0)-1|0)},t.reverse=function(r){for(var t=r.length,n=new Array(t),e=0;e<t;++e)n[e]=r[(t-1|0)-e|0];return n},t.make=function(r,t){if(r<=0)return[];for(var n=new Array(r),e=0;e<r;++e)n[e]=t;return n},t.range=function(r,t){var n=t-r|0;if(n<0)return[];for(var e=new Array(n+1|0),o=0;o<=n;++o)e[o]=r+o|0;return e},t.rangeBy=function(r,t,n){var e=t-r|0;if(e<0||n<=0)return[];for(var o=1+(e/n|0)|0,i=new Array(o),a=r,u=0;u<o;++u)i[u]=a,a=a+n|0;return i},t.makeByU=f,t.makeBy=function(r,t){return f(r,o.__1(t))},t.makeByAndShuffleU=c,t.makeByAndShuffle=function(r,t){return c(r,o.__1(t))},t.zip=function(r,t){for(var n=r.length,e=t.length,o=n<e?n:e,i=new Array(o),a=0;a<o;++a)i[a]=[r[a],t[a]];return i},t.zipByU=v,t.zipBy=function(r,t,n){return v(r,t,o.__2(n))},t.unzip=function(r){for(var t=r.length,n=new Array(t),e=new Array(t),o=0;o<t;++o){var i=r[o];n[o]=i[0],e[o]=i[1]}return[n,e]},t.concat=function(r,t){for(var n=r.length,e=t.length,o=new Array(n+e|0),i=0;i<n;++i)o[i]=r[i];for(var a=0;a<e;++a)o[n+a|0]=t[a];return o},t.concatMany=d,t.slice=function(r,t,n){if(n<=0)return[];var o=r.length,i=t<0?e.int_max(o+t|0,0):t,a=o-i|0,u=a<n?a:n;if(u<=0)return[];for(var s=new Array(u),f=0;f<u;++f)s[f]=r[i+f|0];return s},t.sliceToEnd=function(r,t){for(var n=r.length,o=t<0?e.int_max(n+t|0,0):t,i=n>o?n-o|0:0,a=new Array(i),u=0;u<i;++u)a[u]=r[o+u|0];return a},t.fill=function(r,t,n,o){if(!(n<=0)){var i=r.length,a=t<0?e.int_max(i+t|0,0):t,u=i-a|0,s=u<n?u:n;if(!(s<=0))for(var f=a,c=a+s|0;f<c;++f)r[f]=o}},t.blit=function(r,t,n,o,i){var a=r.length,u=n.length,s=t<0?e.int_max(a+t|0,0):t,f=o<0?e.int_max(u+o|0,0):o,c=e.int_min(i,e.int_min(a-s|0,u-f|0));if(f<=s)for(var v=0;v<c;++v)n[v+f|0]=r[v+s|0];else for(var d=c-1|0;d>=0;--d)n[d+f|0]=r[d+s|0]},t.blitUnsafe=function(r,t,n,e,o){if(e<=t)for(var i=0;i<o;++i)n[i+e|0]=r[i+t|0];else for(var a=o-1|0;a>=0;--a)n[a+e|0]=r[a+t|0]},t.forEachU=l,t.forEach=function(r,t){l(r,o.__1(t))},t.mapU=p,t.map=function(r,t){return p(r,o.__1(t))},t.flatMapU=function(r,t){return d(p(r,t))},t.flatMap=function(r,t){return d(p(r,o.__1(t)))},t.getByU=m,t.getBy=function(r,t){return m(r,o.__1(t))},t.getIndexByU=h,t.getIndexBy=function(r,t){return h(r,o.__1(t))},t.keepU=g,t.keep=function(r,t){return g(r,o.__1(t))},t.keepWithIndexU=E,t.keepWithIndex=function(r,t){return E(r,o.__2(t))},t.keepMapU=x,t.keepMap=function(r,t){return x(r,o.__1(t))},t.forEachWithIndexU=y,t.forEachWithIndex=function(r,t){y(r,o.__2(t))},t.mapWithIndexU=_,t.mapWithIndex=function(r,t){return _(r,o.__2(t))},t.partitionU=D,t.partition=function(r,t){return D(r,o.__1(t))},t.reduceU=b,t.reduce=function(r,t,n){return b(r,t,o.__2(n))},t.reduceReverseU=A,t.reduceReverse=function(r,t,n){return A(r,t,o.__2(n))},t.reduceReverse2U=T,t.reduceReverse2=function(r,t,n,e){return T(r,t,n,o.__3(e))},t.reduceWithIndexU=k,t.reduceWithIndex=function(r,t,n){return k(r,t,o.__3(n))},t.joinWithU=U,t.joinWith=function(r,t,n){return U(r,t,o.__1(n))},t.someU=w,t.some=function(r,t){return w(r,o.__1(t))},t.everyU=S,t.every=function(r,t){return S(r,o.__1(t))},t.every2U=G,t.every2=function(r,t,n){return G(r,t,o.__2(n))},t.some2U=C,t.some2=function(r,t,n){return C(r,t,o.__2(n))},t.cmpU=N,t.cmp=function(r,t,n){return N(r,t,o.__2(n))},t.eqU=M,t.eq=function(r,t,n){return M(r,t,o.__2(n))},t.initU=j,t.init=function(r,t){return j(r,o.__1(t))}},2815:(r,t,n)=>{var e=n(7175),o=n(5252),i=n(354);function a(r,t,n,e){for(;;){var o=e;if(void 0===o)return;var i=r(o.key)&(t.length-1|0),a=n[i];void 0!==a?a.next=o:t[i]=o,n[i]=o,e=o.next}}function u(r,t,n,e,o){var i=r.buckets,u=i.length,s=o(t)&(u-1|0),f=i[s];if(void 0!==f?function(r,t,n,e){for(;;){var o=e;if(r(o.key,t))return o.value=n,!1;var i=o.next;if(void 0===i)return!0;e=i}}(e,t,n,f)&&(i[s]={key:t,value:n,next:f},r.size=r.size+1|0):(i[s]={key:t,value:n,next:void 0},r.size=r.size+1|0),r.size>u<<1){var c=r.buckets,v=c.length,d=v<<1;if(d<v)return;var l=new Array(d),p=new Array(d);r.buckets=l;for(var m=0;m<v;++m)a(o,l,p,c[m]);for(var h=0;h<d;++h){var g=p[h];void 0!==g&&(g.next=void 0)}}}var s=i.clear,f=i.isEmpty,c=o.copy,v=o.forEachU,d=o.forEach,l=o.reduceU,p=o.reduce,m=o.keepMapInPlaceU,h=o.keepMapInPlace,g=o.toArray,E=o.keysToArray,x=o.valuesToArray,y=o.getBucketHistogram,_=o.logStats;t.Int=void 0,t.$$String=void 0,t.make=function(r,t){return i.make(t.hash,t.eq,r)},t.clear=s,t.isEmpty=f,t.set=function(r,t,n){u(r,t,n,r.eq,r.hash)},t.copy=c,t.get=function(r,t){var n=r.buckets,o=n[r.hash(t)&(n.length-1|0)];if(void 0!==o){var i=r.eq;if(i(t,o.key))return e.some(o.value);var a=o.next;if(void 0!==a){if(i(t,a.key))return e.some(a.value);var u=a.next;if(void 0!==u){if(i(t,u.key))return e.some(u.value);for(var s=u.next;;){var f=s;if(void 0===f)return;if(i(t,f.key))return e.some(f.value);s=f.next}}}}},t.has=function(r,t){var n=r.buckets,e=n[r.hash(t)&(n.length-1|0)];if(void 0===e)return!1;for(var o=e,i=r.eq;;){var a=o;if(i(a.key,t))return!0;var u=a.next;if(void 0===u)return!1;o=u}},t.remove=function(r,t){var n=r.buckets,e=r.hash(t)&(n.length-1|0),o=n[e];if(void 0!==o){var i=r.eq;if(i(o.key,t))return n[e]=o.next,void(r.size=r.size-1|0);for(var a=o,u=o.next;;){var s=u,f=a;if(void 0===s)return;var c=s.next;if(i(s.key,t))return f.next=c,void(r.size=r.size-1|0);u=c,a=s}}},t.forEachU=v,t.forEach=d,t.reduceU=l,t.reduce=p,t.keepMapInPlaceU=m,t.keepMapInPlace=h,t.size=function(r){return r.size},t.toArray=g,t.keysToArray=E,t.valuesToArray=x,t.fromArray=function(r,t){for(var n=t.hash,e=t.eq,o=r.length,a=i.make(n,e,o),s=0;s<o;++s){var f=r[s];u(a,f[0],f[1],e,n)}return a},t.mergeMany=function(r,t){for(var n=r.hash,e=r.eq,o=t.length,i=0;i<o;++i){var a=t[i];u(r,a[0],a[1],e,n)}},t.getBucketHistogram=y,t.logStats=_},7356:(r,t,n)=>{var e=n(7175),o=n(1863),i=n(5252),a=n(354);function u(r,t,n){for(;;){var e=n;if(void 0===e)return;var i=o.hash_final_mix(o.hash_mix_int(0,e.key))&(r.length-1|0),a=t[i];void 0!==a?a.next=e:r[i]=e,t[i]=e,n=e.next}}function s(r,t,n){var e=r.buckets,i=e.length,a=o.hash_final_mix(o.hash_mix_int(0,t))&(i-1|0),s=e[a];if(void 0!==s?function(r,t,n){for(;;){var e=n;if(e.key===r)return e.value=t,!1;var o=e.next;if(void 0===o)return!0;n=o}}(t,n,s)&&(e[a]={key:t,value:n,next:s},r.size=r.size+1|0):(e[a]={key:t,value:n,next:void 0},r.size=r.size+1|0),r.size>i<<1){var f=r.buckets,c=f.length,v=c<<1;if(v<c)return;var d=new Array(v),l=new Array(v);r.buckets=d;for(var p=0;p<c;++p)u(d,l,f[p]);for(var m=0;m<v;++m){var h=l[m];void 0!==h&&(h.next=void 0)}}}var f=a.clear,c=a.isEmpty,v=i.copy,d=i.forEachU,l=i.forEach,p=i.reduceU,m=i.reduce,h=i.keepMapInPlaceU,g=i.keepMapInPlace,E=i.toArray,x=i.keysToArray,y=i.valuesToArray,_=i.getBucketHistogram,b=i.logStats;t.make=function(r){return a.make(void 0,void 0,r)},t.clear=f,t.isEmpty=c,t.set=s,t.copy=v,t.get=function(r,t){var n=r.buckets,i=n[o.hash_final_mix(o.hash_mix_int(0,t))&(n.length-1|0)];if(void 0!==i){if(t===i.key)return e.some(i.value);var a=i.next;if(void 0!==a){if(t===a.key)return e.some(a.value);var u=a.next;if(void 0!==u){if(t===u.key)return e.some(u.value);for(var s=u.next;;){var f=s;if(void 0===f)return;if(t===f.key)return e.some(f.value);s=f.next}}}}},t.has=function(r,t){var n=r.buckets,e=n[o.hash_final_mix(o.hash_mix_int(0,t))&(n.length-1|0)];if(void 0===e)return!1;for(var i=e;;){var a=i;if(a.key===t)return!0;var u=a.next;if(void 0===u)return!1;i=u}},t.remove=function(r,t){var n=r.buckets,e=o.hash_final_mix(o.hash_mix_int(0,t))&(n.length-1|0),i=n[e];if(void 0!==i){if(i.key===t)return n[e]=i.next,void(r.size=r.size-1|0);for(var a=i,u=i.next;;){var s=u,f=a;if(void 0===s)return;var c=s.next;if(s.key===t)return f.next=c,void(r.size=r.size-1|0);u=c,a=s}}},t.forEachU=d,t.forEach=l,t.reduceU=p,t.reduce=m,t.keepMapInPlaceU=h,t.keepMapInPlace=g,t.size=function(r){return r.size},t.toArray=E,t.keysToArray=x,t.valuesToArray=y,t.fromArray=function(r){for(var t=r.length,n=a.make(void 0,void 0,t),e=0;e<t;++e){var o=r[e];s(n,o[0],o[1])}return n},t.mergeMany=function(r,t){for(var n=t.length,e=0;e<n;++e){var o=t[e];s(r,o[0],o[1])}},t.getBucketHistogram=_,t.logStats=b},2275:(r,t,n)=>{var e=n(7175),o=n(1863),i=n(5252),a=n(354);function u(r,t,n){for(;;){var e=n;if(void 0===e)return;var i=o.hash_final_mix(o.hash_mix_string(0,e.key))&(r.length-1|0),a=t[i];void 0!==a?a.next=e:r[i]=e,t[i]=e,n=e.next}}function s(r,t,n){var e=r.buckets,i=e.length,a=o.hash_final_mix(o.hash_mix_string(0,t))&(i-1|0),s=e[a];if(void 0!==s?function(r,t,n){for(;;){var e=n;if(e.key===r)return e.value=t,!1;var o=e.next;if(void 0===o)return!0;n=o}}(t,n,s)&&(e[a]={key:t,value:n,next:s},r.size=r.size+1|0):(e[a]={key:t,value:n,next:void 0},r.size=r.size+1|0),r.size>i<<1){var f=r.buckets,c=f.length,v=c<<1;if(v<c)return;var d=new Array(v),l=new Array(v);r.buckets=d;for(var p=0;p<c;++p)u(d,l,f[p]);for(var m=0;m<v;++m){var h=l[m];void 0!==h&&(h.next=void 0)}}}var f=a.clear,c=a.isEmpty,v=i.copy,d=i.forEachU,l=i.forEach,p=i.reduceU,m=i.reduce,h=i.keepMapInPlaceU,g=i.keepMapInPlace,E=i.toArray,x=i.keysToArray,y=i.valuesToArray,_=i.getBucketHistogram,b=i.logStats;t.make=function(r){return a.make(void 0,void 0,r)},t.clear=f,t.isEmpty=c,t.set=s,t.copy=v,t.get=function(r,t){var n=r.buckets,i=n[o.hash_final_mix(o.hash_mix_string(0,t))&(n.length-1|0)];if(void 0!==i){if(t===i.key)return e.some(i.value);var a=i.next;if(void 0!==a){if(t===a.key)return e.some(a.value);var u=a.next;if(void 0!==u){if(t===u.key)return e.some(u.value);for(var s=u.next;;){var f=s;if(void 0===f)return;if(t===f.key)return e.some(f.value);s=f.next}}}}},t.has=function(r,t){var n=r.buckets,e=n[o.hash_final_mix(o.hash_mix_string(0,t))&(n.length-1|0)];if(void 0===e)return!1;for(var i=e;;){var a=i;if(a.key===t)return!0;var u=a.next;if(void 0===u)return!1;i=u}},t.remove=function(r,t){var n=r.buckets,e=o.hash_final_mix(o.hash_mix_string(0,t))&(n.length-1|0),i=n[e];if(void 0!==i){if(i.key===t)return n[e]=i.next,void(r.size=r.size-1|0);for(var a=i,u=i.next;;){var s=u,f=a;if(void 0===s)return;var c=s.next;if(s.key===t)return f.next=c,void(r.size=r.size-1|0);u=c,a=s}}},t.forEachU=d,t.forEach=l,t.reduceU=p,t.reduce=m,t.keepMapInPlaceU=h,t.keepMapInPlace=g,t.size=function(r){return r.size},t.toArray=E,t.keysToArray=x,t.valuesToArray=y,t.fromArray=function(r){for(var t=r.length,n=a.make(void 0,void 0,t),e=0;e<t;++e){var o=r[e];s(n,o[0],o[1])}return n},t.mergeMany=function(r,t){for(var n=t.length,e=0;e<n;++e){var o=t[e];s(r,o[0],o[1])}},t.getBucketHistogram=_,t.logStats=b},9775:(r,t,n)=>{var e=n(9167),o=n(354);function i(r,t,n,e){for(;;){var o=e;if(void 0===o)return;var i=r(o.key)&(t.length-1|0),a=n[i];void 0!==a?a.next=o:t[i]=o,n[i]=o,e=o.next}}function a(r,t,n,e){var o=r.buckets,a=o.length,u=n(t)&(a-1|0),s=o[u];if(void 0!==s?function(r,t,n,e){for(;;){var o=n;if(e(o.key,t))return;var i=o.next;if(void 0===i)return r.size=r.size+1|0,void(o.next={key:t,next:void 0});n=i}}(r,t,s,e):(r.size=r.size+1|0,o[u]={key:t,next:void 0}),r.size>a<<1){var f=r.buckets,c=f.length,v=c<<1;if(v<c)return;var d=new Array(v),l=new Array(v);r.buckets=d;for(var p=0;p<c;++p)i(n,d,l,f[p]);for(var m=0;m<v;++m){var h=l[m];void 0!==h&&(h.next=void 0)}}}var u=o.clear,s=o.isEmpty,f=e.copy,c=e.forEachU,v=e.forEach,d=e.reduceU,l=e.reduce,p=e.logStats,m=e.toArray,h=e.getBucketHistogram;t.Int=void 0,t.$$String=void 0,t.make=function(r,t){return o.make(t.hash,t.eq,r)},t.clear=u,t.isEmpty=s,t.add=function(r,t){a(r,t,r.hash,r.eq)},t.copy=f,t.has=function(r,t){var n=r.eq,e=r.buckets,o=e[r.hash(t)&(e.length-1|0)];if(void 0===o)return!1;for(var i=o;;){var a=i;if(n(a.key,t))return!0;var u=a.next;if(void 0===u)return!1;i=u}},t.remove=function(r,t){var n=r.eq,e=r.buckets,o=r.hash(t)&(e.length-1|0),i=e[o];if(void 0!==i){var a=i.next;if(n(i.key,t))return r.size=r.size-1|0,void(e[o]=a);if(void 0!==a)for(var u=i,s=a;;){var f=s,c=u,v=f.next;if(n(f.key,t))return c.next=v,void(r.size=r.size-1|0);if(void 0===v)return;s=v,u=f}}},t.forEachU=c,t.forEach=v,t.reduceU=d,t.reduce=l,t.size=function(r){return r.size},t.logStats=p,t.toArray=m,t.fromArray=function(r,t){for(var n=t.eq,e=t.hash,i=r.length,u=o.make(e,n,i),s=0;s<i;++s)a(u,r[s],e,n);return u},t.mergeMany=function(r,t){for(var n=r.eq,e=r.hash,o=t.length,i=0;i<o;++i)a(r,t[i],e,n)},t.getBucketHistogram=h},7659:(r,t,n)=>{var e=n(1863),o=n(9167),i=n(354);function a(r,t,n){for(;;){var o=n;if(void 0===o)return;var i=e.hash_final_mix(e.hash_mix_int(0,o.key))&(r.length-1|0),a=t[i];void 0!==a?a.next=o:r[i]=o,t[i]=o,n=o.next}}function u(r,t){var n=r.buckets,o=n.length,i=e.hash_final_mix(e.hash_mix_int(0,t))&(o-1|0),u=n[i];if(void 0!==u?function(r,t,n){for(;;){var e=n;if(e.key===t)return;var o=e.next;if(void 0===o)return r.size=r.size+1|0,void(e.next={key:t,next:void 0});n=o}}(r,t,u):(n[i]={key:t,next:void 0},r.size=r.size+1|0),r.size>o<<1){var s=r.buckets,f=s.length,c=f<<1;if(c<f)return;var v=new Array(c),d=new Array(c);r.buckets=v;for(var l=0;l<f;++l)a(v,d,s[l]);for(var p=0;p<c;++p){var m=d[p];void 0!==m&&(m.next=void 0)}}}var s=i.clear,f=i.isEmpty,c=o.copy,v=o.forEachU,d=o.forEach,l=o.reduceU,p=o.reduce,m=o.logStats,h=o.toArray,g=o.getBucketHistogram;t.make=function(r){return i.make(void 0,void 0,r)},t.clear=s,t.isEmpty=f,t.add=u,t.copy=c,t.has=function(r,t){var n=r.buckets,o=n[e.hash_final_mix(e.hash_mix_int(0,t))&(n.length-1|0)];if(void 0===o)return!1;for(var i=o;;){var a=i;if(a.key===t)return!0;var u=a.next;if(void 0===u)return!1;i=u}},t.remove=function(r,t){var n=r.buckets,o=e.hash_final_mix(e.hash_mix_int(0,t))&(n.length-1|0),i=n[o];if(void 0!==i){var a=i.next;if(i.key===t)return r.size=r.size-1|0,void(n[o]=a);if(void 0!==a)for(var u=i,s=a;;){var f=s,c=u,v=f.next;if(f.key===t)return c.next=v,void(r.size=r.size-1|0);if(void 0===v)return;s=v,u=f}}},t.forEachU=v,t.forEach=d,t.reduceU=l,t.reduce=p,t.size=function(r){return r.size},t.logStats=m,t.toArray=h,t.fromArray=function(r){for(var t=r.length,n=i.make(void 0,void 0,t),e=0;e<t;++e)u(n,r[e]);return n},t.mergeMany=function(r,t){for(var n=t.length,e=0;e<n;++e)u(r,t[e])},t.getBucketHistogram=g},8615:(r,t,n)=>{var e=n(1863),o=n(9167),i=n(354);function a(r,t,n){for(;;){var o=n;if(void 0===o)return;var i=e.hash_final_mix(e.hash_mix_string(0,o.key))&(r.length-1|0),a=t[i];void 0!==a?a.next=o:r[i]=o,t[i]=o,n=o.next}}function u(r,t){var n=r.buckets,o=n.length,i=e.hash_final_mix(e.hash_mix_string(0,t))&(o-1|0),u=n[i];if(void 0!==u?function(r,t,n){for(;;){var e=n;if(e.key===t)return;var o=e.next;if(void 0===o)return r.size=r.size+1|0,void(e.next={key:t,next:void 0});n=o}}(r,t,u):(n[i]={key:t,next:void 0},r.size=r.size+1|0),r.size>o<<1){var s=r.buckets,f=s.length,c=f<<1;if(c<f)return;var v=new Array(c),d=new Array(c);r.buckets=v;for(var l=0;l<f;++l)a(v,d,s[l]);for(var p=0;p<c;++p){var m=d[p];void 0!==m&&(m.next=void 0)}}}var s=i.clear,f=i.isEmpty,c=o.copy,v=o.forEachU,d=o.forEach,l=o.reduceU,p=o.reduce,m=o.logStats,h=o.toArray,g=o.getBucketHistogram;t.make=function(r){return i.make(void 0,void 0,r)},t.clear=s,t.isEmpty=f,t.add=u,t.copy=c,t.has=function(r,t){var n=r.buckets,o=n[e.hash_final_mix(e.hash_mix_string(0,t))&(n.length-1|0)];if(void 0===o)return!1;for(var i=o;;){var a=i;if(a.key===t)return!0;var u=a.next;if(void 0===u)return!1;i=u}},t.remove=function(r,t){var n=r.buckets,o=e.hash_final_mix(e.hash_mix_string(0,t))&(n.length-1|0),i=n[o];if(void 0!==i){var a=i.next;if(i.key===t)return r.size=r.size-1|0,void(n[o]=a);if(void 0!==a)for(var u=i,s=a;;){var f=s,c=u,v=f.next;if(f.key===t)return c.next=v,void(r.size=r.size-1|0);if(void 0===v)return;s=v,u=f}}},t.forEachU=v,t.forEach=d,t.reduceU=l,t.reduce=p,t.size=function(r){return r.size},t.logStats=m,t.toArray=h,t.fromArray=function(r){for(var t=r.length,n=i.make(void 0,void 0,t),e=0;e<t;++e)u(n,r[e]);return n},t.mergeMany=function(r,t){for(var n=t.length,e=0;e<n;++e)u(r,t[e])},t.getBucketHistogram=g},6638:(r,t,n)=>{var e=n(1386);t.MakeComparableU=function(r){return r},t.MakeComparable=function(r){var t=r.cmp;return{cmp:e.__2(t)}},t.comparableU=function(r){return{cmp:r}},t.comparable=function(r){return{cmp:e.__2(r)}},t.MakeHashableU=function(r){return r},t.MakeHashable=function(r){var t=r.hash,n=e.__1(t),o=r.eq;return{hash:n,eq:e.__2(o)}},t.hashableU=function(r,t){return{hash:r,eq:t}},t.hashable=function(r,t){return{hash:e.__1(r),eq:e.__2(t)}}},1094:(r,t,n)=>{var e=n(1386),o=n(7175),i=n(3163),a=n(6144);function u(r,t,n){if(void 0===r)return a.singleton(t,n);var e=r.k;if(t===e)return a.updateValue(r,n);var o=r.v;return t<e?a.bal(u(r.l,t,n),e,o,r.r):a.bal(r.l,e,o,u(r.r,t,n))}function s(r,t,n){if(void 0!==r){var e=r.k;if(t===e){var i=n(o.some(r.v));if(void 0!==i)return a.updateValue(r,o.valFromOption(i));var u=r.l,f=r.r;if(void 0===u)return f;if(void 0===f)return u;var c={contents:f.k},v={contents:f.v},d=a.removeMinAuxWithRef(f,c,v);return a.bal(u,c.contents,v.contents,d)}var l=r.v,p=r.l,m=r.r;if(t<e){var h=s(p,t,n);return p===h?r:a.bal(h,e,l,m)}var g=s(m,t,n);return m===g?r:a.bal(p,e,l,g)}var E=n(void 0);return void 0!==E?a.singleton(t,o.valFromOption(E)):r}function f(r,t){var n=r.k,e=r.l,o=r.r;if(t===n){if(void 0===e)return o;if(void 0===o)return e;var i={contents:o.k},u={contents:o.v},s=a.removeMinAuxWithRef(o,i,u);return a.bal(e,i.contents,u.contents,s)}if(t<n){if(void 0===e)return r;var c=f(e,t);return c===e?r:a.bal(c,n,r.v,o)}if(void 0===o)return r;var v=f(o,t);return a.bal(e,n,r.v,v)}var c=a.isEmpty,v=i.has,d=i.cmpU,l=i.cmp,p=i.eqU,m=i.eq,h=a.findFirstByU,g=a.findFirstBy,E=a.forEachU,x=a.forEach,y=a.reduceU,_=a.reduce,b=a.everyU,A=a.every,T=a.someU,k=a.some,S=a.size,w=a.toList,I=a.toArray,G=i.fromArray,C=a.keysToArray,M=a.valuesToArray,N=a.minKey,D=a.minKeyUndefined,U=a.maxKey,j=a.maxKeyUndefined,O=a.minimum,P=a.minUndefined,R=a.maximum,F=a.maxUndefined,V=i.get,B=i.getUndefined,L=i.getWithDefault,W=i.getExn,X=a.checkInvariantInternal,z=i.mergeU,H=i.merge,q=a.keepSharedU,$=a.keepShared,K=a.partitionSharedU,J=a.partitionShared,Q=i.split,Z=a.mapU,Y=a.map,rr=a.mapWithKeyU,tr=a.mapWithKey;t.empty=void 0,t.isEmpty=c,t.has=v,t.cmpU=d,t.cmp=l,t.eqU=p,t.eq=m,t.findFirstByU=h,t.findFirstBy=g,t.forEachU=E,t.forEach=x,t.reduceU=y,t.reduce=_,t.everyU=b,t.every=A,t.someU=T,t.some=k,t.size=S,t.toList=w,t.toArray=I,t.fromArray=G,t.keysToArray=C,t.valuesToArray=M,t.minKey=N,t.minKeyUndefined=D,t.maxKey=U,t.maxKeyUndefined=j,t.minimum=O,t.minUndefined=P,t.maximum=R,t.maxUndefined=F,t.get=V,t.getUndefined=B,t.getWithDefault=L,t.getExn=W,t.checkInvariantInternal=X,t.remove=function(r,t){if(void 0!==r)return f(r,t)},t.removeMany=function(r,t){var n=t.length;if(void 0!==r)for(var e=r,o=0;;){var i=o;if(i>=n)return e;var a=f(e,t[i]);if(void 0===a)return a;o=i+1|0,e=a}},t.set=u,t.updateU=s,t.update=function(r,t,n){return s(r,t,e.__1(n))},t.mergeU=z,t.merge=H,t.mergeMany=function(r,t){for(var n=t.length,e=r,o=0;o<n;++o){var i=t[o];e=u(e,i[0],i[1])}return e},t.keepU=q,t.keep=$,t.partitionU=K,t.partition=J,t.split=Q,t.mapU=Z,t.map=Y,t.mapWithKeyU=rr,t.mapWithKey=tr},5082:(r,t,n)=>{var e=n(1386),o=n(7175),i=n(6144),a=n(2459);function u(r,t,n){if(void 0===r)return i.singleton(t,n);var e=r.k;if(t===e)return i.updateValue(r,n);var o=r.v;return t<e?i.bal(u(r.l,t,n),e,o,r.r):i.bal(r.l,e,o,u(r.r,t,n))}function s(r,t,n){if(void 0!==r){var e=r.k;if(t===e){var a=n(o.some(r.v));if(void 0!==a)return i.updateValue(r,o.valFromOption(a));var u=r.l,f=r.r;if(void 0===u)return f;if(void 0===f)return u;var c={contents:f.k},v={contents:f.v},d=i.removeMinAuxWithRef(f,c,v);return i.bal(u,c.contents,v.contents,d)}var l=r.v,p=r.l,m=r.r;if(t<e){var h=s(p,t,n);return p===h?r:i.bal(h,e,l,m)}var g=s(m,t,n);return m===g?r:i.bal(p,e,l,g)}var E=n(void 0);return void 0!==E?i.singleton(t,o.valFromOption(E)):r}function f(r,t){var n=r.k,e=r.l,o=r.r;if(t===n){if(void 0===e)return o;if(void 0===o)return e;var a={contents:o.k},u={contents:o.v},s=i.removeMinAuxWithRef(o,a,u);return i.bal(e,a.contents,u.contents,s)}if(t<n){if(void 0===e)return r;var c=f(e,t);return c===e?r:i.bal(c,n,r.v,o)}if(void 0===o)return r;var v=f(o,t);return i.bal(e,n,r.v,v)}var c=i.isEmpty,v=a.has,d=a.cmpU,l=a.cmp,p=a.eqU,m=a.eq,h=i.findFirstByU,g=i.findFirstBy,E=i.forEachU,x=i.forEach,y=i.reduceU,_=i.reduce,b=i.everyU,A=i.every,T=i.someU,k=i.some,S=i.size,w=i.toList,I=i.toArray,G=a.fromArray,C=i.keysToArray,M=i.valuesToArray,N=i.minKey,D=i.minKeyUndefined,U=i.maxKey,j=i.maxKeyUndefined,O=i.minimum,P=i.minUndefined,R=i.maximum,F=i.maxUndefined,V=a.get,B=a.getUndefined,L=a.getWithDefault,W=a.getExn,X=i.checkInvariantInternal,z=a.mergeU,H=a.merge,q=i.keepSharedU,$=i.keepShared,K=i.partitionSharedU,J=i.partitionShared,Q=a.split,Z=i.mapU,Y=i.map,rr=i.mapWithKeyU,tr=i.mapWithKey;t.empty=void 0,t.isEmpty=c,t.has=v,t.cmpU=d,t.cmp=l,t.eqU=p,t.eq=m,t.findFirstByU=h,t.findFirstBy=g,t.forEachU=E,t.forEach=x,t.reduceU=y,t.reduce=_,t.everyU=b,t.every=A,t.someU=T,t.some=k,t.size=S,t.toList=w,t.toArray=I,t.fromArray=G,t.keysToArray=C,t.valuesToArray=M,t.minKey=N,t.minKeyUndefined=D,t.maxKey=U,t.maxKeyUndefined=j,t.minimum=O,t.minUndefined=P,t.maximum=R,t.maxUndefined=F,t.get=V,t.getUndefined=B,t.getWithDefault=L,t.getExn=W,t.checkInvariantInternal=X,t.remove=function(r,t){if(void 0!==r)return f(r,t)},t.removeMany=function(r,t){var n=t.length;if(void 0!==r)for(var e=r,o=0;;){var i=o;if(i>=n)return e;var a=f(e,t[i]);if(void 0===a)return a;o=i+1|0,e=a}},t.set=u,t.updateU=s,t.update=function(r,t,n){return s(r,t,e.__1(n))},t.mergeU=z,t.merge=H,t.mergeMany=function(r,t){for(var n=t.length,e=r,o=0;o<n;++o){var i=t[o];e=u(e,i[0],i[1])}return e},t.keepU=q,t.keep=$,t.partitionU=K,t.partition=J,t.split=Q,t.mapU=Z,t.map=Y,t.mapWithKeyU=rr,t.mapWithKey=tr},5981:(r,t,n)=>{var e=n(1386),o=n(7175),i=n(3163),a=n(6144);function u(r,t){return{data:a.mapU(r.data,t)}}function s(r,t){return{data:a.mapWithKeyU(r.data,t)}}function f(r,t,n){return a.reduceU(r.data,t,n)}function c(r,t){var n=r.k;if(t===n){var e=r.l,o=r.r;return void 0!==e?void 0!==o?(r.r=a.removeMinAuxWithRootMutate(r,o),a.balMutate(r)):e:o}if(t<n){var i=r.l;return void 0!==i?(r.l=c(i,t),a.balMutate(r)):r}var u=r.r;return void 0!==u?(r.r=c(u,t),a.balMutate(r)):r}function v(r,t,n){if(void 0!==r){var e=r.k;if(e===t){var i=n(o.some(r.v));if(void 0!==i)return r.v=o.valFromOption(i),r;var u=r.l,s=r.r;return void 0!==u?void 0!==s?(r.r=a.removeMinAuxWithRootMutate(r,s),a.balMutate(r)):u:s}var f=r.l,c=r.r;if(t<e){var d=v(f,t,n);r.l=d}else r.r=v(c,t,n);return a.balMutate(r)}var l=n(void 0);return void 0!==l?a.singleton(t,o.valFromOption(l)):r}function d(r,t,n){var e=r.data,o=v(e,t,n);o===e||(r.data=o)}function l(r,t,n){return i.cmpU(r.data,t.data,n)}function p(r,t,n){return i.eqU(r.data,t.data,n)}t.make=function(r){return{data:void 0}},t.clear=function(r){r.data=void 0},t.isEmpty=function(r){return void 0===r.data},t.has=function(r,t){return i.has(r.data,t)},t.cmpU=l,t.cmp=function(r,t,n){return l(r,t,e.__2(n))},t.eqU=p,t.eq=function(r,t,n){return p(r,t,e.__2(n))},t.forEachU=function(r,t){a.forEachU(r.data,t)},t.forEach=function(r,t){a.forEachU(r.data,e.__2(t))},t.reduceU=f,t.reduce=function(r,t,n){return f(r,t,e.__3(n))},t.everyU=function(r,t){return a.everyU(r.data,t)},t.every=function(r,t){return a.everyU(r.data,e.__2(t))},t.someU=function(r,t){return a.someU(r.data,t)},t.some=function(r,t){return a.someU(r.data,e.__2(t))},t.size=function(r){return a.size(r.data)},t.toList=function(r){return a.toList(r.data)},t.toArray=function(r){return a.toArray(r.data)},t.fromArray=function(r){return{data:i.fromArray(r)}},t.keysToArray=function(r){return a.keysToArray(r.data)},t.valuesToArray=function(r){return a.valuesToArray(r.data)},t.minKey=function(r){return a.minKey(r.data)},t.minKeyUndefined=function(r){return a.minKeyUndefined(r.data)},t.maxKey=function(r){return a.maxKey(r.data)},t.maxKeyUndefined=function(r){return a.maxKeyUndefined(r.data)},t.minimum=function(r){return a.minimum(r.data)},t.minUndefined=function(r){return a.minUndefined(r.data)},t.maximum=function(r){return a.maximum(r.data)},t.maxUndefined=function(r){return a.maxUndefined(r.data)},t.get=function(r,t){return i.get(r.data,t)},t.getUndefined=function(r,t){return i.getUndefined(r.data,t)},t.getWithDefault=function(r,t,n){return i.getWithDefault(r.data,t,n)},t.getExn=function(r,t){return i.getExn(r.data,t)},t.checkInvariantInternal=function(r){a.checkInvariantInternal(r.data)},t.remove=function(r,t){var n=r.data;if(void 0!==n){var e=c(n,t);e===n||(r.data=e)}},t.removeMany=function(r,t){var n=r.data;if(void 0!==n){var e=function(r,t,n,e){for(;;){var o=n;if(o>=e)return r;var i=c(r,t[o]);if(void 0===i)return;n=o+1|0,r=i}}(n,t,0,t.length);e===n||(r.data=e)}},t.set=function(r,t,n){var e=r.data,o=i.addMutate(e,t,n);o===e||(r.data=o)},t.updateU=d,t.update=function(r,t,n){d(r,t,e.__1(n))},t.mapU=u,t.map=function(r,t){return u(r,e.__1(t))},t.mapWithKeyU=s,t.mapWithKey=function(r,t){return s(r,e.__2(t))}},2867:(r,t,n)=>{var e=n(1386),o=n(7175),i=n(6144),a=n(2459);function u(r,t){return{data:i.mapU(r.data,t)}}function s(r,t){return{data:i.mapWithKeyU(r.data,t)}}function f(r,t,n){return i.reduceU(r.data,t,n)}function c(r,t){var n=r.k;if(t===n){var e=r.l,o=r.r;return void 0!==e?void 0!==o?(r.r=i.removeMinAuxWithRootMutate(r,o),i.balMutate(r)):e:o}if(t<n){var a=r.l;return void 0!==a?(r.l=c(a,t),i.balMutate(r)):r}var u=r.r;return void 0!==u?(r.r=c(u,t),i.balMutate(r)):r}function v(r,t,n){if(void 0!==r){var e=r.k;if(e===t){var a=n(o.some(r.v));if(void 0!==a)return r.v=o.valFromOption(a),r;var u=r.l,s=r.r;return void 0!==u?void 0!==s?(r.r=i.removeMinAuxWithRootMutate(r,s),i.balMutate(r)):u:s}var f=r.l,c=r.r;if(t<e){var d=v(f,t,n);r.l=d}else r.r=v(c,t,n);return i.balMutate(r)}var l=n(void 0);return void 0!==l?i.singleton(t,o.valFromOption(l)):r}function d(r,t,n){var e=r.data,o=v(e,t,n);o===e||(r.data=o)}function l(r,t,n){return a.cmpU(r.data,t.data,n)}function p(r,t,n){return a.eqU(r.data,t.data,n)}t.make=function(r){return{data:void 0}},t.clear=function(r){r.data=void 0},t.isEmpty=function(r){return void 0===r.data},t.has=function(r,t){return a.has(r.data,t)},t.cmpU=l,t.cmp=function(r,t,n){return l(r,t,e.__2(n))},t.eqU=p,t.eq=function(r,t,n){return p(r,t,e.__2(n))},t.forEachU=function(r,t){i.forEachU(r.data,t)},t.forEach=function(r,t){i.forEachU(r.data,e.__2(t))},t.reduceU=f,t.reduce=function(r,t,n){return f(r,t,e.__3(n))},t.everyU=function(r,t){return i.everyU(r.data,t)},t.every=function(r,t){return i.everyU(r.data,e.__2(t))},t.someU=function(r,t){return i.someU(r.data,t)},t.some=function(r,t){return i.someU(r.data,e.__2(t))},t.size=function(r){return i.size(r.data)},t.toList=function(r){return i.toList(r.data)},t.toArray=function(r){return i.toArray(r.data)},t.fromArray=function(r){return{data:a.fromArray(r)}},t.keysToArray=function(r){return i.keysToArray(r.data)},t.valuesToArray=function(r){return i.valuesToArray(r.data)},t.minKey=function(r){return i.minKey(r.data)},t.minKeyUndefined=function(r){return i.minKeyUndefined(r.data)},t.maxKey=function(r){return i.maxKey(r.data)},t.maxKeyUndefined=function(r){return i.maxKeyUndefined(r.data)},t.minimum=function(r){return i.minimum(r.data)},t.minUndefined=function(r){return i.minUndefined(r.data)},t.maximum=function(r){return i.maximum(r.data)},t.maxUndefined=function(r){return i.maxUndefined(r.data)},t.get=function(r,t){return a.get(r.data,t)},t.getUndefined=function(r,t){return a.getUndefined(r.data,t)},t.getWithDefault=function(r,t,n){return a.getWithDefault(r.data,t,n)},t.getExn=function(r,t){return a.getExn(r.data,t)},t.checkInvariantInternal=function(r){i.checkInvariantInternal(r.data)},t.remove=function(r,t){var n=r.data;if(void 0!==n){var e=c(n,t);e===n||(r.data=e)}},t.removeMany=function(r,t){var n=r.data;if(void 0!==n){var e=function(r,t,n,e){for(;;){var o=n;if(o>=e)return r;var i=c(r,t[o]);if(void 0===i)return;n=o+1|0,r=i}}(n,t,0,t.length);e===n||(r.data=e)}},t.set=function(r,t,n){var e=r.data,o=a.addMutate(e,t,n);o===e||(r.data=o)},t.updateU=d,t.update=function(r,t,n){d(r,t,e.__1(n))},t.mapU=u,t.map=function(r,t){return u(r,e.__1(t))},t.mapWithKeyU=s,t.mapWithKey=function(r,t){return s(r,e.__2(t))}},5650:(r,t,n)=>{var e=n(1386),o=n(7175);function i(r){r.length=0,r.first=void 0,r.last=void 0}function a(r,t){var n={content:t,next:void 0},e=r.last;void 0!==e?(r.length=r.length+1|0,e.next=n,r.last=n):(r.length=1,r.first=n,r.last=n)}function u(r,t){for(var n,e={length:r.length,first:void 0,last:void 0},o=r.first;;){var i=o,a=n;if(void 0===i)return e.last=a,e;var u={content:t(i.content),next:void 0};void 0!==a?a.next=u:e.first=u,o=i.next,n=u}}function s(r,t){for(var n=r.first;;){var e=n;if(void 0===e)return;t(e.content),n=e.next}}function f(r,t,n){for(var e=t,o=r.first;;){var i=o;if(void 0===i)return e;var a=n(e,i.content);o=i.next,e=a}}t.make=function(r){return{length:0,first:void 0,last:void 0}},t.clear=i,t.isEmpty=function(r){return 0===r.length},t.fromArray=function(r){for(var t={length:0,first:void 0,last:void 0},n=0,e=r.length;n<e;++n)a(t,r[n]);return t},t.add=a,t.peek=function(r){var t=r.first;if(void 0!==t)return o.some(t.content)},t.peekUndefined=function(r){var t=r.first;if(void 0!==t)return t.content},t.peekExn=function(r){var t=r.first;if(void 0!==t)return t.content;throw{RE_EXN_ID:"Not_found",Error:new Error}},t.pop=function(r){var t=r.first;if(void 0!==t){var n=t.next;return void 0===n?(i(r),o.some(t.content)):(r.length=r.length-1|0,r.first=n,o.some(t.content))}},t.popUndefined=function(r){var t=r.first;if(void 0!==t){var n=t.next;return void 0===n?(i(r),t.content):(r.length=r.length-1|0,r.first=n,t.content)}},t.popExn=function(r){var t=r.first;if(void 0!==t){var n=t.next;return void 0===n?(i(r),t.content):(r.length=r.length-1|0,r.first=n,t.content)}throw{RE_EXN_ID:"Not_found",Error:new Error}},t.copy=function(r){for(var t,n={length:r.length,first:void 0,last:void 0},e=r.first;;){var o=e,i=t;if(void 0===o)return n.last=i,n;var a={content:o.content,next:void 0};void 0!==i?i.next=a:n.first=a,e=o.next,t=a}},t.size=function(r){return r.length},t.mapU=u,t.map=function(r,t){return u(r,e.__1(t))},t.forEachU=s,t.forEach=function(r,t){s(r,e.__1(t))},t.reduceU=f,t.reduce=function(r,t,n){return f(r,t,e.__2(n))},t.transfer=function(r,t){if(!(r.length<=0)){var n=t.last;return void 0!==n?(t.length=t.length+r.length|0,n.next=r.first,t.last=r.last,i(r)):(t.length=r.length,t.first=r.first,t.last=r.last,i(r))}},t.toArray=function(r){var t=new Array(r.length);return function(r,t,n){for(;;){var e=n,o=r;if(void 0===e)return;t[o]=e.content,n=e.next,r=o+1|0}}(0,t,r.first),t}},6601:(r,t,n)=>{var e=n(1386),o=n(7175);function i(r,t){for(var n=r.root;;){var e=n;if(void 0===e)return;t(e.head),n=e.tail}}function a(r,t){for(;;){var n=r.root;if(void 0===n)return;r.root=n.tail,t(n.head)}}t.make=function(r){return{root:void 0}},t.clear=function(r){r.root=void 0},t.copy=function(r){return{root:r.root}},t.push=function(r,t){r.root={head:t,tail:r.root}},t.popUndefined=function(r){var t=r.root;if(void 0!==t)return r.root=t.tail,t.head},t.pop=function(r){var t=r.root;if(void 0!==t)return r.root=t.tail,o.some(t.head)},t.topUndefined=function(r){var t=r.root;if(void 0!==t)return t.head},t.top=function(r){var t=r.root;if(void 0!==t)return o.some(t.head)},t.isEmpty=function(r){return void 0===r.root},t.size=function(r){var t=r.root;if(void 0===t)return 0;for(var n=t,e=0;;){var o=e,i=n.tail;if(void 0===i)return o+1|0;e=o+1|0,n=i}},t.forEachU=i,t.forEach=function(r,t){i(r,e.__1(t))},t.dynamicPopIterU=a,t.dynamicPopIter=function(r,t){a(r,e.__1(t))}},6517:(r,t,n)=>{var e=n(1386),o=n(7175);function i(r,t){if(void 0!==r&&t(o.valFromOption(r)))return r}function a(r,t){if(void 0!==r)return t(o.valFromOption(r))}function u(r,t,n){return void 0!==r?n(o.valFromOption(r)):t}function s(r,t){if(void 0!==r)return o.some(t(o.valFromOption(r)))}function f(r,t){if(void 0!==r)return t(o.valFromOption(r))}function c(r,t,n){return void 0!==r?void 0!==t&&n(o.valFromOption(r),o.valFromOption(t)):void 0===t}function v(r,t,n){return void 0!==r?void 0!==t?n(o.valFromOption(r),o.valFromOption(t)):1:void 0!==t?-1:0}t.keepU=i,t.keep=function(r,t){return i(r,e.__1(t))},t.forEachU=a,t.forEach=function(r,t){a(r,e.__1(t))},t.getExn=function(r){if(void 0!==r)return o.valFromOption(r);throw{RE_EXN_ID:"Not_found",Error:new Error}},t.mapWithDefaultU=u,t.mapWithDefault=function(r,t,n){return u(r,t,e.__1(n))},t.mapU=s,t.map=function(r,t){return s(r,e.__1(t))},t.flatMapU=f,t.flatMap=function(r,t){return f(r,e.__1(t))},t.getWithDefault=function(r,t){return void 0!==r?o.valFromOption(r):t},t.orElse=function(r,t){return void 0!==r?r:t},t.isSome=function(r){return void 0!==r},t.isNone=function(r){return void 0===r},t.eqU=c,t.eq=function(r,t,n){return c(r,t,e.__2(n))},t.cmpU=v,t.cmp=function(r,t,n){return v(r,t,e.__2(n))}},6369:(r,t,n)=>{var e=n(1386);function o(r,t,n){return"Ok"===r.TAG?n(r._0):t}function i(r,t){return"Ok"===r.TAG?{TAG:"Ok",_0:t(r._0)}:{TAG:"Error",_0:r._0}}function a(r,t){return"Ok"===r.TAG?t(r._0):{TAG:"Error",_0:r._0}}function u(r,t,n){return"Ok"===r.TAG?"Ok"===t.TAG&&n(r._0,t._0):"Ok"!==t.TAG}function s(r,t,n){return"Ok"===r.TAG?"Ok"===t.TAG?n(r._0,t._0):1:"Ok"===t.TAG?-1:0}t.getExn=function(r){if("Ok"===r.TAG)return r._0;throw{RE_EXN_ID:"Not_found",Error:new Error}},t.mapWithDefaultU=o,t.mapWithDefault=function(r,t,n){return o(r,t,e.__1(n))},t.mapU=i,t.map=function(r,t){return i(r,e.__1(t))},t.flatMapU=a,t.flatMap=function(r,t){return a(r,e.__1(t))},t.getWithDefault=function(r,t){return"Ok"===r.TAG?r._0:t},t.isOk=function(r){return"Ok"===r.TAG},t.isError=function(r){return"Ok"!==r.TAG},t.eqU=u,t.eq=function(r,t,n){return u(r,t,e.__2(n))},t.cmpU=s,t.cmp=function(r,t,n){return s(r,t,e.__2(n))}},303:(r,t,n)=>{var e=n(4881),o=n(9113);function i(r,t){if(void 0===r)return e.singleton(t);var n=r.v;if(t===n)return r;var o=r.l,a=r.r;if(t<n){var u=i(o,t);return u===o?r:e.bal(u,n,a)}var s=i(a,t);return s===a?r:e.bal(o,n,s)}function a(r,t){if(void 0===r)return r;var n=r.v,o=r.l,i=r.r;if(t===n){if(void 0===o)return i;if(void 0===i)return o;var u={contents:i.v},s=e.removeMinAuxWithRef(i,u);return e.bal(o,u.contents,s)}if(t<n){var f=a(o,t);return f===o?r:e.bal(f,n,i)}var c=a(i,t);return c===i?r:e.bal(o,n,c)}function u(r,t){var n=r.v,o=r.l,i=r.r;if(t===n)return[o,i];if(t<n){if(void 0===o)return[void 0,r];var a=u(o,t);return[a[0],e.joinShared(a[1],n,i)]}if(void 0===i)return[r,void 0];var s=u(i,t);return[e.joinShared(o,n,s[0]),s[1]]}function s(r,t,n){var o=r.v,i=r.l,a=r.r;if(t===o)return n.contents=!0,[i,a];if(t<o){if(void 0===i)return[void 0,r];var u=s(i,t,n);return[u[0],e.joinShared(u[1],o,a)]}if(void 0===a)return[r,void 0];var f=s(a,t,n);return[e.joinShared(i,o,f[0]),f[1]]}var f=o.fromArray,c=e.fromSortedArrayUnsafe,v=e.isEmpty,d=o.has,l=o.subset,p=o.cmp,m=o.eq,h=e.forEachU,g=e.forEach,E=e.reduceU,x=e.reduce,y=e.everyU,_=e.every,b=e.someU,A=e.some,T=e.keepSharedU,k=e.keepShared,S=e.partitionSharedU,w=e.partitionShared,I=e.size,G=e.toList,C=e.toArray,M=e.minimum,N=e.minUndefined,D=e.maximum,U=e.maxUndefined,j=o.get,O=o.getUndefined,P=o.getExn,R=e.checkInvariantInternal;t.empty=void 0,t.fromArray=f,t.fromSortedArrayUnsafe=c,t.isEmpty=v,t.has=d,t.add=i,t.mergeMany=function(r,t){for(var n=t.length,e=r,o=0;o<n;++o)e=i(e,t[o]);return e},t.remove=a,t.removeMany=function(r,t){for(var n=t.length,e=r,o=0;o<n;++o)e=a(e,t[o]);return e},t.union=function r(t,n){if(void 0===t)return n;if(void 0===n)return t;var o=t.h,a=n.h;if(o>=a){if(1===a)return i(t,n.v);var s=t.v,f=t.l,c=t.r,v=u(n,s);return e.joinShared(r(f,v[0]),s,r(c,v[1]))}if(1===o)return i(n,t.v);var d=n.v,l=n.l,p=n.r,m=u(t,d);return e.joinShared(r(m[0],l),d,r(m[1],p))},t.intersect=function r(t,n){if(void 0!==t&&void 0!==n){var o=t.v,i=t.l,a=t.r,u={contents:!1},f=s(n,o,u),c=r(i,f[0]),v=r(a,f[1]);return u.contents?e.joinShared(c,o,v):e.concatShared(c,v)}},t.diff=function r(t,n){if(void 0===t)return t;if(void 0===n)return t;var o=t.v,i=t.l,a=t.r,u={contents:!1},f=s(n,o,u),c=r(i,f[0]),v=r(a,f[1]);return u.contents?e.concatShared(c,v):e.joinShared(c,o,v)},t.subset=l,t.cmp=p,t.eq=m,t.forEachU=h,t.forEach=g,t.reduceU=E,t.reduce=x,t.everyU=y,t.every=_,t.someU=b,t.some=A,t.keepU=T,t.keep=k,t.partitionU=S,t.partition=w,t.size=I,t.toList=G,t.toArray=C,t.minimum=M,t.minUndefined=N,t.maximum=D,t.maxUndefined=U,t.get=j,t.getUndefined=O,t.getExn=P,t.split=function(r,t){if(void 0===r)return[[void 0,void 0],!1];var n={contents:!1};return[s(r,t,n),n.contents]},t.checkInvariantInternal=R},1367:(r,t,n)=>{var e=n(4881),o=n(1572);function i(r,t){if(void 0===r)return e.singleton(t);var n=r.v;if(t===n)return r;var o=r.l,a=r.r;if(t<n){var u=i(o,t);return u===o?r:e.bal(u,n,a)}var s=i(a,t);return s===a?r:e.bal(o,n,s)}function a(r,t){if(void 0===r)return r;var n=r.v,o=r.l,i=r.r;if(t===n){if(void 0===o)return i;if(void 0===i)return o;var u={contents:i.v},s=e.removeMinAuxWithRef(i,u);return e.bal(o,u.contents,s)}if(t<n){var f=a(o,t);return f===o?r:e.bal(f,n,i)}var c=a(i,t);return c===i?r:e.bal(o,n,c)}function u(r,t){var n=r.v,o=r.l,i=r.r;if(t===n)return[o,i];if(t<n){if(void 0===o)return[void 0,r];var a=u(o,t);return[a[0],e.joinShared(a[1],n,i)]}if(void 0===i)return[r,void 0];var s=u(i,t);return[e.joinShared(o,n,s[0]),s[1]]}function s(r,t,n){var o=r.v,i=r.l,a=r.r;if(t===o)return n.contents=!0,[i,a];if(t<o){if(void 0===i)return[void 0,r];var u=s(i,t,n);return[u[0],e.joinShared(u[1],o,a)]}if(void 0===a)return[r,void 0];var f=s(a,t,n);return[e.joinShared(i,o,f[0]),f[1]]}var f=o.fromArray,c=e.fromSortedArrayUnsafe,v=e.isEmpty,d=o.has,l=o.subset,p=o.cmp,m=o.eq,h=e.forEachU,g=e.forEach,E=e.reduceU,x=e.reduce,y=e.everyU,_=e.every,b=e.someU,A=e.some,T=e.keepSharedU,k=e.keepShared,S=e.partitionSharedU,w=e.partitionShared,I=e.size,G=e.toList,C=e.toArray,M=e.minimum,N=e.minUndefined,D=e.maximum,U=e.maxUndefined,j=o.get,O=o.getUndefined,P=o.getExn,R=e.checkInvariantInternal;t.empty=void 0,t.fromArray=f,t.fromSortedArrayUnsafe=c,t.isEmpty=v,t.has=d,t.add=i,t.mergeMany=function(r,t){for(var n=t.length,e=r,o=0;o<n;++o)e=i(e,t[o]);return e},t.remove=a,t.removeMany=function(r,t){for(var n=t.length,e=r,o=0;o<n;++o)e=a(e,t[o]);return e},t.union=function r(t,n){if(void 0===t)return n;if(void 0===n)return t;var o=t.h,a=n.h;if(o>=a){if(1===a)return i(t,n.v);var s=t.v,f=t.l,c=t.r,v=u(n,s);return e.joinShared(r(f,v[0]),s,r(c,v[1]))}if(1===o)return i(n,t.v);var d=n.v,l=n.l,p=n.r,m=u(t,d);return e.joinShared(r(m[0],l),d,r(m[1],p))},t.intersect=function r(t,n){if(void 0!==t&&void 0!==n){var o=t.v,i=t.l,a=t.r,u={contents:!1},f=s(n,o,u),c=r(i,f[0]),v=r(a,f[1]);return u.contents?e.joinShared(c,o,v):e.concatShared(c,v)}},t.diff=function r(t,n){if(void 0===t)return t;if(void 0===n)return t;var o=t.v,i=t.l,a=t.r,u={contents:!1},f=s(n,o,u),c=r(i,f[0]),v=r(a,f[1]);return u.contents?e.concatShared(c,v):e.joinShared(c,o,v)},t.subset=l,t.cmp=p,t.eq=m,t.forEachU=h,t.forEach=g,t.reduceU=E,t.reduce=x,t.everyU=y,t.every=_,t.someU=b,t.some=A,t.keepU=T,t.keep=k,t.partitionU=S,t.partition=w,t.size=I,t.toList=G,t.toArray=C,t.minimum=M,t.minUndefined=N,t.maximum=D,t.maxUndefined=U,t.get=j,t.getUndefined=O,t.getExn=P,t.split=function(r,t){if(void 0===r)return[[void 0,void 0],!1];var n={contents:!1};return[s(r,t,n),n.contents]},t.checkInvariantInternal=R},2531:(r,t,n)=>{var e=n(1386),o=n(2971);function i(r,t){var n=r.length;if(0===n||1===n)return n;var e=r[0],o=r[1];if(!t(e,o))return t(o,e)?0|-function(r,t,n,e,o){for(;;){var i=n,a=t;if(i>=e)return i;var u=r[i];if(!o(u,a))return i;n=i+1|0,t=u}}(r,o,2,n,t):1;for(var i=o,a=2;;){var u=a,s=i;if(u>=n)return u;var f=r[u];if(!t(s,f))return u;a=u+1|0,i=f}}function a(r,t){var n=r.length;if(0===n)return!0;for(var e=0,o=n-1|0;;){var i=e;if(i===o)return!0;if(t(r[i],r[i+1|0])>0)return!1;e=i+1|0}}function u(r,t,n,e,i,a,u,s,f){for(var c=t+n|0,v=i+a|0,d=t,l=r[t],p=i,m=e[i],h=s;;){var g=h,E=m,x=p,y=l,_=d;if(f(y,E)<=0){u[g]=y;var b=_+1|0;if(b>=c)return o.blitUnsafe(e,x,u,g+1|0,v-x|0);h=g+1|0,l=r[b],d=b}else{u[g]=E;var A=x+1|0;if(A>=v)return o.blitUnsafe(r,_,u,g+1|0,c-_|0);h=g+1|0,m=e[A],p=A}}}function s(r,t,n,e,i,a,u,s,f){for(var c=t+n|0,v=i+a|0,d=t,l=r[t],p=i,m=e[i],h=s;;){var g=h,E=m,x=p,y=l,_=d,b=f(y,E);if(b<0){u[g]=y;var A=_+1|0,T=g+1|0;if(A<c){h=T,l=r[A],d=A;continue}return o.blitUnsafe(e,x,u,T,v-x|0),(T+v|0)-x|0}if(0!==b){u[g]=E;var k=x+1|0,S=g+1|0;if(!(k<v))return o.blitUnsafe(r,_,u,S,c-_|0),(S+c|0)-_|0;h=S,m=e[k],p=k}else{u[g]=y;var w=_+1|0,I=x+1|0,G=g+1|0;if(!(w<c&&I<v))return w===c?(o.blitUnsafe(e,I,u,G,v-I|0),(G+v|0)-I|0):(o.blitUnsafe(r,w,u,G,c-w|0),(G+c|0)-w|0);h=G,m=e[I],p=I,l=r[w],d=w}}}function f(r,t,n,e,o,i,a,u,s){for(var f=t+n|0,c=o+i|0,v=t,d=r[t],l=o,p=e[o],m=u;;){var h=m,g=l,E=d,x=v,y=s(E,p);if(y<0){var _=x+1|0;if(_>=f)return h;d=r[_],v=_}else if(0!==y){var b=g+1|0;if(b>=c)return h;p=e[b],l=b}else{a[h]=E;var A=x+1|0,T=g+1|0,k=h+1|0;if(!(A<f&&T<c))return k;m=k,p=e[T],l=T,d=r[A],v=A}}}function c(r,t,n,e,i,a,u,s,f){for(var c=t+n|0,v=i+a|0,d=t,l=r[t],p=i,m=e[i],h=s;;){var g=h,E=p,x=l,y=d,_=f(x,m);if(_<0){u[g]=x;var b=g+1|0,A=y+1|0;if(A>=c)return b;h=b,l=r[A],d=A}else if(0!==_){var T=E+1|0;if(!(T<v))return o.blitUnsafe(r,y,u,g,c-y|0),(g+c|0)-y|0;m=e[T],p=T}else{var k=y+1|0,S=E+1|0;if(!(k<c&&S<v))return k===c?g:(o.blitUnsafe(r,k,u,g,c-k|0),(g+c|0)-k|0);m=e[S],p=S,l=r[k],d=k}}}function v(r,t,n,e,o,i){for(var a=0;a<o;++a){for(var u=r[t+a|0],s=(e+a|0)-1|0;s>=e&&i(n[s],u)>0;)n[s+1|0]=n[s],s=s-1|0;n[s+1|0]=u}}function d(r,t,n,e,o,i){if(o<=5)return v(r,t,n,e,o,i);var a=o/2|0,s=o-a|0;d(r,t+a|0,n,e+a|0,s,i),d(r,t,r,t+s|0,a,i),u(r,t+s|0,a,n,e+a|0,s,n,e,i)}function l(r,t){var n=r.length;if(n<=5)return v(r,0,r,0,n,t);var e=n/2|0,o=n-e|0,i=new Array(o);d(r,e,i,0,o,t),d(r,0,r,o,e,t),u(r,o,e,i,0,o,r,0,t)}function p(r,t){var n=r.slice(0);return l(n,t),n}function m(r,t,n){var e=r.length;if(0===e)return-1;if(n(t,r[0])<0)return-1;if(n(t,r[e-1|0])>0)return 0|-(e+1|0);for(var o=0,i=e-1|0;;){var a=i,u=o,s=(u+a|0)/2|0,f=n(t,r[s]);if(0===f)return s;if(f<0){if(a===s)return 0===n(r[u],t)?u:0|-(a+1|0);i=s}else{if(u===s)return 0===n(r[a],t)?a:0|-(a+1|0);o=s}}}t.Int=void 0,t.$$String=void 0,t.strictlySortedLengthU=i,t.strictlySortedLength=function(r,t){return i(r,e.__2(t))},t.isSortedU=a,t.isSorted=function(r,t){return a(r,e.__2(t))},t.stableSortInPlaceByU=l,t.stableSortInPlaceBy=function(r,t){l(r,e.__2(t))},t.stableSortByU=p,t.stableSortBy=function(r,t){return p(r,e.__2(t))},t.binarySearchByU=m,t.binarySearchBy=function(r,t,n){return m(r,t,e.__2(n))},t.unionU=s,t.union=function(r,t,n,o,i,a,u,f,c){return s(r,t,n,o,i,a,u,f,e.__2(c))},t.intersectU=f,t.intersect=function(r,t,n,o,i,a,u,s,c){return f(r,t,n,o,i,a,u,s,e.__2(c))},t.diffU=c,t.diff=function(r,t,n,o,i,a,u,s,f){return c(r,t,n,o,i,a,u,s,e.__2(f))}},3282:(r,t,n)=>{var e=n(2971);function o(r,t,n,o,i,a,u,s){for(var f=t+n|0,c=i+a|0,v=t,d=r[t],l=i,p=o[i],m=s;;){var h=m,g=p,E=l,x=d,y=v;if(x<=g){u[h]=x;var _=y+1|0;if(_>=f)return e.blitUnsafe(o,E,u,h+1|0,c-E|0);m=h+1|0,d=r[_],v=_}else{u[h]=g;var b=E+1|0;if(b>=c)return e.blitUnsafe(r,y,u,h+1|0,f-y|0);m=h+1|0,p=o[b],l=b}}}function i(r,t,n,e,o){for(var i=0;i<o;++i){for(var a=r[t+i|0],u=(e+i|0)-1|0;u>=e&&n[u]>a;)n[u+1|0]=n[u],u=u-1|0;n[u+1|0]=a}}function a(r,t,n,e,u){if(u<=5)return i(r,t,n,e,u);var s=u/2|0,f=u-s|0;a(r,t+s|0,n,e+s|0,f),a(r,t,r,t+f|0,s),o(r,t+f|0,s,n,e+s|0,f,n,e)}function u(r){var t=r.length;if(t<=5)return i(r,0,r,0,t);var n=t/2|0,e=t-n|0,u=new Array(e);a(r,n,u,0,e),a(r,0,r,e,n),o(r,e,n,u,0,e,r,0)}t.strictlySortedLength=function(r){var t=r.length;if(0===t||1===t)return t;var n=r[0],e=r[1];if(!(n<e))return n>e?0|-function(r,t,n,e){for(;;){var o=n,i=t;if(o>=e)return o;var a=r[o];if(i<=a)return o;n=o+1|0,t=a}}(r,e,2,t):1;for(var o=e,i=2;;){var a=i,u=o;if(a>=t)return a;var s=r[a];if(u>=s)return a;i=a+1|0,o=s}},t.isSorted=function(r){var t=r.length;if(0===t)return!0;for(var n=0,e=t-1|0;;){var o=n;if(o===e)return!0;if(r[o]>r[o+1|0])return!1;n=o+1|0}},t.stableSortInPlace=u,t.stableSort=function(r){var t=r.slice(0);return u(t),t},t.binarySearch=function(r,t){var n=r.length;if(0===n)return-1;if(t<r[0])return-1;if(t>r[n-1|0])return 0|-(n+1|0);for(var e=0,o=n-1|0;;){var i=o,a=e,u=(a+i|0)/2|0,s=r[u];if(t===s)return u;if(t<s){if(i===u)return r[a]===t?a:0|-(i+1|0);o=u}else{if(a===u)return r[i]===t?i:0|-(i+1|0);e=u}}},t.union=function(r,t,n,o,i,a,u,s){for(var f=t+n|0,c=i+a|0,v=t,d=r[t],l=i,p=o[i],m=s;;){var h=m,g=p,E=l,x=d,y=v;if(x<g){u[h]=x;var _=y+1|0,b=h+1|0;if(_<f){m=b,d=r[_],v=_;continue}return e.blitUnsafe(o,E,u,b,c-E|0),(b+c|0)-E|0}if(x!==g){u[h]=g;var A=E+1|0,T=h+1|0;if(!(A<c))return e.blitUnsafe(r,y,u,T,f-y|0),(T+f|0)-y|0;m=T,p=o[A],l=A}else{u[h]=x;var k=y+1|0,S=E+1|0,w=h+1|0;if(!(k<f&&S<c))return k===f?(e.blitUnsafe(o,S,u,w,c-S|0),(w+c|0)-S|0):(e.blitUnsafe(r,k,u,w,f-k|0),(w+f|0)-k|0);m=w,p=o[S],l=S,d=r[k],v=k}}},t.intersect=function(r,t,n,e,o,i,a,u){for(var s=t+n|0,f=o+i|0,c=t,v=r[t],d=o,l=e[o],p=u;;){var m=p,h=l,g=d,E=v,x=c;if(E<h){var y=x+1|0;if(y>=s)return m;v=r[y],c=y}else if(E!==h){var _=g+1|0;if(_>=f)return m;l=e[_],d=_}else{a[m]=E;var b=x+1|0,A=g+1|0,T=m+1|0;if(!(b<s&&A<f))return T;p=T,l=e[A],d=A,v=r[b],c=b}}},t.diff=function(r,t,n,o,i,a,u,s){for(var f=t+n|0,c=i+a|0,v=t,d=r[t],l=i,p=o[i],m=s;;){var h=m,g=p,E=l,x=d,y=v;if(x<g){u[h]=x;var _=h+1|0,b=y+1|0;if(b>=f)return _;m=_,d=r[b],v=b}else if(x!==g){var A=E+1|0;if(!(A<c))return e.blitUnsafe(r,y,u,h,f-y|0),(h+f|0)-y|0;p=o[A],l=A}else{var T=y+1|0,k=E+1|0;if(!(T<f&&k<c))return T===f?h:(e.blitUnsafe(r,T,u,h,f-T|0),(h+f|0)-T|0);p=o[k],l=k,d=r[T],v=T}}}},8466:(r,t,n)=>{var e=n(2971);function o(r,t,n,o,i,a,u,s){for(var f=t+n|0,c=i+a|0,v=t,d=r[t],l=i,p=o[i],m=s;;){var h=m,g=p,E=l,x=d,y=v;if(x<=g){u[h]=x;var _=y+1|0;if(_>=f)return e.blitUnsafe(o,E,u,h+1|0,c-E|0);m=h+1|0,d=r[_],v=_}else{u[h]=g;var b=E+1|0;if(b>=c)return e.blitUnsafe(r,y,u,h+1|0,f-y|0);m=h+1|0,p=o[b],l=b}}}function i(r,t,n,e,o){for(var i=0;i<o;++i){for(var a=r[t+i|0],u=(e+i|0)-1|0;u>=e&&n[u]>a;)n[u+1|0]=n[u],u=u-1|0;n[u+1|0]=a}}function a(r,t,n,e,u){if(u<=5)return i(r,t,n,e,u);var s=u/2|0,f=u-s|0;a(r,t+s|0,n,e+s|0,f),a(r,t,r,t+f|0,s),o(r,t+f|0,s,n,e+s|0,f,n,e)}function u(r){var t=r.length;if(t<=5)return i(r,0,r,0,t);var n=t/2|0,e=t-n|0,u=new Array(e);a(r,n,u,0,e),a(r,0,r,e,n),o(r,e,n,u,0,e,r,0)}t.strictlySortedLength=function(r){var t=r.length;if(0===t||1===t)return t;var n=r[0],e=r[1];if(!(n<e))return n>e?0|-function(r,t,n,e){for(;;){var o=n,i=t;if(o>=e)return o;var a=r[o];if(i<=a)return o;n=o+1|0,t=a}}(r,e,2,t):1;for(var o=e,i=2;;){var a=i,u=o;if(a>=t)return a;var s=r[a];if(u>=s)return a;i=a+1|0,o=s}},t.isSorted=function(r){var t=r.length;if(0===t)return!0;for(var n=0,e=t-1|0;;){var o=n;if(o===e)return!0;if(r[o]>r[o+1|0])return!1;n=o+1|0}},t.stableSortInPlace=u,t.stableSort=function(r){var t=r.slice(0);return u(t),t},t.binarySearch=function(r,t){var n=r.length;if(0===n)return-1;if(t<r[0])return-1;if(t>r[n-1|0])return 0|-(n+1|0);for(var e=0,o=n-1|0;;){var i=o,a=e,u=(a+i|0)/2|0,s=r[u];if(t===s)return u;if(t<s){if(i===u)return r[a]===t?a:0|-(i+1|0);o=u}else{if(a===u)return r[i]===t?i:0|-(i+1|0);e=u}}},t.union=function(r,t,n,o,i,a,u,s){for(var f=t+n|0,c=i+a|0,v=t,d=r[t],l=i,p=o[i],m=s;;){var h=m,g=p,E=l,x=d,y=v;if(x<g){u[h]=x;var _=y+1|0,b=h+1|0;if(_<f){m=b,d=r[_],v=_;continue}return e.blitUnsafe(o,E,u,b,c-E|0),(b+c|0)-E|0}if(x!==g){u[h]=g;var A=E+1|0,T=h+1|0;if(!(A<c))return e.blitUnsafe(r,y,u,T,f-y|0),(T+f|0)-y|0;m=T,p=o[A],l=A}else{u[h]=x;var k=y+1|0,S=E+1|0,w=h+1|0;if(!(k<f&&S<c))return k===f?(e.blitUnsafe(o,S,u,w,c-S|0),(w+c|0)-S|0):(e.blitUnsafe(r,k,u,w,f-k|0),(w+f|0)-k|0);m=w,p=o[S],l=S,d=r[k],v=k}}},t.intersect=function(r,t,n,e,o,i,a,u){for(var s=t+n|0,f=o+i|0,c=t,v=r[t],d=o,l=e[o],p=u;;){var m=p,h=l,g=d,E=v,x=c;if(E<h){var y=x+1|0;if(y>=s)return m;v=r[y],c=y}else if(E!==h){var _=g+1|0;if(_>=f)return m;l=e[_],d=_}else{a[m]=E;var b=x+1|0,A=g+1|0,T=m+1|0;if(!(b<s&&A<f))return T;p=T,l=e[A],d=A,v=r[b],c=b}}},t.diff=function(r,t,n,o,i,a,u,s){for(var f=t+n|0,c=i+a|0,v=t,d=r[t],l=i,p=o[i],m=s;;){var h=m,g=p,E=l,x=d,y=v;if(x<g){u[h]=x;var _=h+1|0,b=y+1|0;if(b>=f)return _;m=_,d=r[b],v=b}else if(x!==g){var A=E+1|0;if(!(A<c))return e.blitUnsafe(r,y,u,h,f-y|0),(h+f|0)-y|0;p=o[A],l=A}else{var T=y+1|0,k=E+1|0;if(!(T<f&&k<c))return T===f?h:(e.blitUnsafe(r,T,u,h,f-T|0),(h+f|0)-T|0);p=o[k],l=k,d=r[T],v=T}}}},4881:(r,t,n)=>{var e=n(1386),o=n(7175),i=n(2531);function a(r,t,n){var e=void 0!==r?r.h:0,o=void 0!==n?n.h:0;return{v:t,h:(e>=o?e:o)+1|0,l:r,r:n}}function u(r){return{v:r,h:1,l:void 0,r:void 0}}function s(r,t){return void 0===t||void 0!==r&&r.h>=t.h}function f(r,t,n){var e=void 0!==r?r.h:0,o=void 0!==n?n.h:0;if(e>(o+2|0)){var i=r.l,u=r.r;return s(i,u)?a(i,r.v,a(u,t,n)):a(a(i,r.v,u.l),u.v,a(u.r,t,n))}if(o<=(e+2|0))return{v:t,h:(e>=o?e:o)+1|0,l:r,r:n};var f=n.l,c=n.r;return s(c,f)?a(a(r,t,f),n.v,c):a(a(r,t,f.l),f.v,a(f.r,n.v,c))}function c(r){for(;;){var t=r,n=t.l;if(void 0===n)return t.v;r=n}}function v(r){for(;;){var t=r,n=t.r;if(void 0===n)return t.v;r=n}}function d(r,t){var n=r.l;return void 0!==n?f(d(n,t),r.v,r.r):(t.contents=r.v,r.r)}function l(r,t){for(;;){if(void 0===r)return t;t={hd:r,tl:t},r=r.l}}function p(r,t){for(;;){var n=r;if(void 0===n)return;p(n.l,t),t(n.v),r=n.r}}function m(r,t,n){for(;;){var e=t,o=r;if(void 0===o)return e;t=n(m(o.l,e,n),o.v),r=o.r}}function h(r,t){for(;;){var n=r;if(void 0===n)return!0;if(!t(n.v))return!1;if(!h(n.l,t))return!1;r=n.r}}function g(r,t){for(;;){var n=r;if(void 0===n)return!1;if(t(n.v))return!0;if(g(n.l,t))return!0;r=n.r}}function E(r,t){return void 0!==r?f(E(r.l,t),r.v,r.r):u(t)}function x(r,t){return void 0!==r?f(r.l,r.v,x(r.r,t)):u(t)}function y(r,t,n){if(void 0===r)return E(n,t);if(void 0===n)return x(r,t);var e=r.h,o=n.h;return e>(o+2|0)?f(r.l,r.v,y(r.r,t,n)):o>(e+2|0)?f(y(r,t,n.l),n.v,n.r):a(r,t,n)}function _(r,t){if(void 0===r)return t;if(void 0===t)return r;var n={contents:t.v},e=d(t,n);return y(r,n.contents,e)}function b(r,t){if(void 0===r)return[void 0,void 0];var n=r.v,e=b(r.l,t),o=e[1],i=e[0],a=t(n),u=b(r.r,t),s=u[1],f=u[0];return a?[y(i,n,f),_(o,s)]:[_(i,f),y(o,n,s)]}function A(r){var t=r.l,n=r.r;return(1+(void 0!==t?A(t):0)|0)+(void 0!==n?A(n):0)|0}function T(r){return void 0!==r?A(r):0}function k(r,t){for(;;){var n=t,e=r;if(void 0===e)return n;t={hd:e.v,tl:k(e.r,n)},r=e.l}}function S(r,t,n){for(;;){var e=t,o=r,i=o.v,a=o.l,u=o.r,s=void 0!==a?S(a,e,n):e;n[s]=i;var f=s+1|0;if(void 0===u)return f;t=f,r=u}}function w(r,t,n,e){for(;;){var o=r,i=o.v,a=o.l,u=o.r;if(void 0!==a&&w(a,t,n,e),e(i)){var s=t.forward;n[s]=i,t.forward=s+1|0}else{var f=t.backward;n[f]=i,t.backward=f-1|0}if(void 0===u)return;r=u}}function I(r,t,n,e){for(;;){var o=t,i=r,a=i.v,u=i.l,s=i.r,f=void 0!==u?I(u,o,n,e):o,c=e(a)?(n[f]=a,f+1|0):f;if(void 0===s)return c;t=c,r=s}}function G(r,t,n){switch(n){case 0:return;case 1:return u(r[t]);case 2:var e=r[t];return{v:r[t-1|0],h:2,l:u(e),r:void 0};case 3:var o=r[t],i=r[t-1|0],s=r[t-2|0];return{v:i,h:2,l:u(o),r:u(s)};default:var f=n/2|0;return a(G(r,t,f),r[t-f|0],G(r,(t-f|0)-1|0,(n-f|0)-1|0))}}function C(r,t,n){switch(n){case 0:return;case 1:return u(r[t]);case 2:var e=r[t];return{v:r[t+1|0],h:2,l:u(e),r:void 0};case 3:var o=r[t],i=r[t+1|0],s=r[t+2|0];return{v:i,h:2,l:u(o),r:u(s)};default:var f=n/2|0;return a(C(r,t,f),r[t+f|0],C(r,1+(t+f|0)|0,(n-f|0)-1|0))}}function M(r,t){if(void 0!==r){var n=r.v,e=r.l,o=r.r,i=M(e,t),a=t(n),u=M(o,t);return a?e===i&&o===u?r:y(i,n,u):_(i,u)}}function N(r,t){if(void 0!==r){var n=A(r),e=new Array(n);return C(e,0,I(r,0,e,t))}}function D(r,t){if(void 0===r)return[void 0,void 0];var n=A(r),e=new Array(n),o=n-1|0,i={forward:0,backward:o};w(r,i,e,t);var a=i.forward;return[C(e,0,a),G(e,o,n-a|0)]}function U(r,t,n){var e=T(r),o=T(t);if(e!==o)return e<o?-1:1;for(var i=l(r,0),a=l(t,0);;){var u=a,s=i;if(!s)return 0;if(!u)return 0;var f=u.hd,c=s.hd,v=n(c.v,f.v);if(0!==v)return v;a=l(f.r,u.tl),i=l(c.r,s.tl)}}function j(r){var t=r.l;r.l=t.r,t.r=r;var n=r.l,e=void 0!==n?n.h:0,o=r.r,i=void 0!==o?o.h:0;r.h=(e>i?e:i)+1|0;var a=t.l,u=void 0!==a?a.h:0,s=r.h;return t.h=(u>s?u:s)+1|0,t}function O(r){var t=r.r;r.r=t.l,t.l=r;var n=r.l,e=void 0!==n?n.h:0,o=r.r,i=void 0!==o?o.h:0;r.h=(e>i?e:i)+1|0;var a=t.r,u=void 0!==a?a.h:0,s=r.h;return t.h=(u>s?u:s)+1|0,t}function P(r){var t=r.l,n=void 0!==t?t.h:0,e=r.r,o=void 0!==e?e.h:0;return r.h=(n>o?n:o)+1|0,r}function R(r){var t,n,e=r.l,o=r.r,i=void 0!==e?e.h:0,a=void 0!==o?o.h:0;if(i>(2+a|0))return s(e.l,e.r)?P(j(r)):P((n=O((t=r).l),t.l=n,j(t)));if(a>(2+i|0)){var u=o.l;return s(o.r,u)?P(O(r)):P(function(r){var t=j(r.r);return r.r=t,O(r)}(r))}return r.h=(i>a?i:a)+1|0,r}function F(r,t,n){if(void 0===t)return u(n);var e=r(n,t.v);if(0===e)return t;var o=t.l,i=t.r;if(e<0){var a=F(r,o,n);t.l=a}else t.r=F(r,i,n);return R(t)}t.copy=function r(t){return void 0!==t?{v:t.v,h:t.h,l:r(t.l),r:r(t.r)}:t},t.create=a,t.bal=f,t.singleton=u,t.minimum=function(r){if(void 0!==r)return o.some(c(r))},t.minUndefined=function(r){if(void 0!==r)return c(r)},t.maximum=function(r){if(void 0!==r)return o.some(v(r))},t.maxUndefined=function(r){if(void 0!==r)return v(r)},t.removeMinAuxWithRef=d,t.isEmpty=function(r){return void 0===r},t.stackAllLeft=l,t.forEachU=p,t.forEach=function(r,t){p(r,e.__1(t))},t.reduceU=m,t.reduce=function(r,t,n){return m(r,t,e.__2(n))},t.everyU=h,t.every=function(r,t){return h(r,e.__1(t))},t.someU=g,t.some=function(r,t){return g(r,e.__1(t))},t.joinShared=y,t.concatShared=_,t.keepSharedU=M,t.keepShared=function(r,t){return M(r,e.__1(t))},t.keepCopyU=N,t.keepCopy=function(r,t){return N(r,e.__1(t))},t.partitionSharedU=b,t.partitionShared=function(r,t){return b(r,e.__1(t))},t.partitionCopyU=D,t.partitionCopy=function(r,t){return D(r,e.__1(t))},t.lengthNode=A,t.size=T,t.toList=function(r){return k(r,0)},t.checkInvariantInternal=function r(t){for(;;){var n=t;if(void 0===n)return;var e=n.l,o=n.r,i=(void 0!==e?e.h:0)-(void 0!==o?o.h:0)|0;if(!(i<=2&&i>=-2))throw{RE_EXN_ID:"Assert_failure",_1:["belt_internalAVLset.res",319,4],Error:new Error};r(e),t=o}},t.fillArray=S,t.toArray=function(r){if(void 0===r)return[];var t=A(r),n=new Array(t);return S(r,0,n),n},t.fromSortedArrayAux=C,t.fromSortedArrayRevAux=G,t.fromSortedArrayUnsafe=function(r){return C(r,0,r.length)},t.has=function(r,t,n){for(;;){var e=r;if(void 0===e)return!1;var o=n(t,e.v);if(0===o)return!0;r=o<0?e.l:e.r}},t.cmp=U,t.eq=function(r,t,n){return 0===U(r,t,n)},t.subset=function r(t,n,e){for(;;){var o=n,i=t;if(void 0===i)return!0;if(void 0===o)return!1;var u=i.v,s=i.l,f=i.r,c=o.v,v=o.l,d=o.r,l=e(u,c);if(0!==l)if(l<0){if(!r(a(s,u,void 0),v,e))return!1;t=f}else{if(!r(a(void 0,u,f),d,e))return!1;t=s}else{if(!r(s,v,e))return!1;n=d,t=f}}},t.get=function(r,t,n){for(;;){var e=r;if(void 0===e)return;var i=e.v,a=n(t,i);if(0===a)return o.some(i);r=a<0?e.l:e.r}},t.getUndefined=function(r,t,n){for(;;){var e=r;if(void 0===e)return;var o=e.v,i=n(t,o);if(0===i)return o;r=i<0?e.l:e.r}},t.getExn=function(r,t,n){for(;;){var e=r;if(void 0===e)throw{RE_EXN_ID:"Not_found",Error:new Error};var o=e.v,i=n(t,o);if(0===i)return o;r=i<0?e.l:e.r}},t.fromArray=function(r,t){var n=r.length;if(0!==n){var e,o=i.strictlySortedLengthU(r,(function(r,n){return t(r,n)<0}));e=o>=0?C(r,0,o):G(r,(o=0|-o)-1|0,o);for(var a=o;a<n;++a)e=F(t,e,r[a]);return e}},t.addMutate=F,t.balMutate=R,t.removeMinAuxWithRootMutate=function r(t,n){var e=n.l,o=n.r;return void 0!==e?(n.l=r(t,e),R(n)):(t.v=n.v,o)}},6144:(r,t,n)=>{var e=n(1386),o=n(7175),i=n(2531);function a(r){return void 0!==r?r.h:0}function u(r,t,n,e){var o=a(r),i=a(e);return{k:t,v:n,h:o>=i?o+1|0:i+1|0,l:r,r:e}}function s(r,t){return{k:r,v:t,h:1,l:void 0,r:void 0}}function f(r,t){return void 0===t||void 0!==r&&r.h>=t.h}function c(r,t,n,e){var o=void 0!==r?r.h:0,i=void 0!==e?e.h:0;if(o>(i+2|0)){var s=r.l,f=r.r;return a(s)>=a(f)?u(s,r.k,r.v,u(f,t,n,e)):u(u(s,r.k,r.v,f.l),f.k,f.v,u(f.r,t,n,e))}if(i<=(o+2|0))return{k:t,v:n,h:o>=i?o+1|0:i+1|0,l:r,r:e};var c=e.l,v=e.r;return a(v)>=a(c)?u(u(r,t,n,c),e.k,e.v,v):u(u(r,t,n,c.l),c.k,c.v,u(c.r,e.k,e.v,v))}function v(r){for(;;){var t=r,n=t.l;if(void 0===n)return t.k;r=n}}function d(r){for(;;){var t=r,n=t.r;if(void 0===n)return t.k;r=n}}function l(r){for(;;){var t=r,n=t.l;if(void 0===n)return[t.k,t.v];r=n}}function p(r){for(;;){var t=r,n=t.r;if(void 0===n)return[t.k,t.v];r=n}}function m(r,t,n){var e=r.l;return void 0!==e?c(m(e,t,n),r.k,r.v,r.r):(t.contents=r.k,n.contents=r.v,r.r)}function h(r,t){for(;;){if(void 0===r)return t;t={hd:r,tl:t},r=r.l}}function g(r,t){if(void 0!==r){var n=g(r.l,t);if(void 0!==n)return n;var e=r.k,o=r.v;if(t(e,o))return[e,o];var i=g(r.r,t);return void 0!==i?i:void 0}}function E(r,t){for(;;){var n=r;if(void 0===n)return;E(n.l,t),t(n.k,n.v),r=n.r}}function x(r,t){if(void 0!==r){var n=x(r.l,t),e=t(r.v),o=x(r.r,t);return{k:r.k,v:e,h:r.h,l:n,r:o}}}function y(r,t){if(void 0!==r){var n=r.k,e=y(r.l,t),o=t(n,r.v),i=y(r.r,t);return{k:n,v:o,h:r.h,l:e,r:i}}}function _(r,t,n){for(;;){var e=t,o=r;if(void 0===o)return e;var i=o.k,a=o.v,u=o.l,s=o.r;t=n(_(u,e,n),i,a),r=s}}function b(r,t){for(;;){var n=r;if(void 0===n)return!0;if(!t(n.k,n.v))return!1;if(!b(n.l,t))return!1;r=n.r}}function A(r,t){for(;;){var n=r;if(void 0===n)return!1;if(t(n.k,n.v))return!0;if(A(n.l,t))return!0;r=n.r}}function T(r,t,n){return void 0!==r?c(T(r.l,t,n),r.k,r.v,r.r):s(t,n)}function k(r,t,n){return void 0!==r?c(r.l,r.k,r.v,k(r.r,t,n)):s(t,n)}function S(r,t,n,e){if(void 0===r)return T(e,t,n);if(void 0===e)return k(r,t,n);var o=r.k,i=r.v,a=r.h,s=r.l,f=r.r,v=e.k,d=e.v,l=e.h,p=e.l,m=e.r;return a>(l+2|0)?c(s,o,i,S(f,t,n,e)):l>(a+2|0)?c(S(r,t,n,p),v,d,m):u(r,t,n,e)}function w(r,t){if(void 0===r)return t;if(void 0===t)return r;var n={contents:t.k},e={contents:t.v},o=m(t,n,e);return S(r,n.contents,e.contents,o)}function I(r,t){if(void 0!==r){var n=r.k,e=r.v,o=I(r.l,t),i=t(n,e),a=I(r.r,t);return i?S(o,n,e,a):w(o,a)}}function G(r,t){if(void 0!==r){var n=r.k,e=r.v,i=G(r.l,t),a=t(n,e),u=G(r.r,t);return void 0!==a?S(i,n,o.valFromOption(a),u):w(i,u)}}function C(r,t){if(void 0===r)return[void 0,void 0];var n=r.k,e=r.v,o=C(r.l,t),i=o[1],a=o[0],u=t(n,e),s=C(r.r,t),f=s[1],c=s[0];return u?[S(a,n,e,c),w(i,f)]:[w(a,c),S(i,n,e,f)]}function M(r){var t=r.l,n=r.r;return(1+(void 0!==t?M(t):0)|0)+(void 0!==n?M(n):0)|0}function N(r){return void 0!==r?M(r):0}function D(r,t){for(;;){var n=t,e=r;if(void 0===e)return n;var o=e.k,i=e.v,a=e.l;t={hd:[o,i],tl:D(e.r,n)},r=a}}function U(r,t,n){for(;;){var e=t,o=r,i=o.k,a=o.l,u=o.r,s=void 0!==a?U(a,e,n):e;n[s]=i;var f=s+1|0;if(void 0===u)return f;t=f,r=u}}function j(r,t,n){for(;;){var e=t,o=r,i=o.l,a=o.r,u=void 0!==i?j(i,e,n):e;n[u]=o.v;var s=u+1|0;if(void 0===a)return s;t=s,r=a}}function O(r,t,n){for(;;){var e=t,o=r,i=o.l,a=o.k,u=o.r,s=void 0!==i?O(i,e,n):e;n[s]=[a,o.v];var f=s+1|0;if(void 0===u)return f;t=f,r=u}}function P(r,t,n){switch(n){case 0:return;case 1:var e=r[t];return s(e[0],e[1]);case 2:var o=r[t],i=r[t-1|0],a=o;return{k:i[0],v:i[1],h:2,l:s(a[0],a[1]),r:void 0};case 3:var f=r[t],c=r[t-1|0],v=r[t-2|0],d=c,l=f;return{k:d[0],v:d[1],h:2,l:s(l[0],l[1]),r:s(v[0],v[1])};default:var p=n/2|0,m=P(r,t,p),h=r[t-p|0],g=P(r,(t-p|0)-1|0,(n-p|0)-1|0);return u(m,h[0],h[1],g)}}function R(r,t,n){switch(n){case 0:return;case 1:var e=r[t];return s(e[0],e[1]);case 2:var o=r[t],i=r[t+1|0],a=o;return{k:i[0],v:i[1],h:2,l:s(a[0],a[1]),r:void 0};case 3:var f=r[t],c=r[t+1|0],v=r[t+2|0],d=c,l=f;return{k:d[0],v:d[1],h:2,l:s(l[0],l[1]),r:s(v[0],v[1])};default:var p=n/2|0,m=R(r,t,p),h=r[t+p|0],g=R(r,1+(t+p|0)|0,(n-p|0)-1|0);return u(m,h[0],h[1],g)}}function F(r,t,n,e){var o=N(r),i=N(t);if(o!==i)return o<i?-1:1;for(var a=h(r,0),u=h(t,0);;){var s=u,f=a;if(!f)return 0;if(!s)return 0;var c=s.hd,v=f.hd,d=n(v.k,c.k);if(0!==d)return d;var l=e(v.v,c.v);if(0!==l)return l;u=h(c.r,s.tl),a=h(v.r,f.tl)}}function V(r,t,n,e){if(N(r)!==N(t))return!1;for(var o=h(r,0),i=h(t,0);;){var a=i,u=o;if(!u)return!0;if(!a)return!0;var s=a.hd,f=u.hd;if(0!==n(f.k,s.k)||!e(f.v,s.v))return!1;i=h(s.r,a.tl),o=h(f.r,u.tl)}}function B(r){var t=r.l;r.l=t.r,t.r=r;var n=a(r.l),e=a(r.r);r.h=(n>e?n:e)+1|0;var o=a(t.l),i=r.h;return t.h=(o>i?o:i)+1|0,t}function L(r){var t=r.r;r.r=t.l,t.l=r;var n=a(r.l),e=a(r.r);r.h=(n>e?n:e)+1|0;var o=a(t.r),i=r.h;return t.h=(o>i?o:i)+1|0,t}function W(r){var t=a(r.l),n=a(r.r);return r.h=(t>n?t:n)+1|0,r}function X(r){var t,n,e=r.l,o=r.r,i=a(e),u=a(o);if(i>(2+u|0))return f(e.l,e.r)?W(B(r)):W((n=L((t=r).l),t.l=n,B(t)));if(u>(2+i|0)){var s=o.l;return f(o.r,s)?W(L(r)):W(function(r){var t=B(r.r);return r.r=t,L(r)}(r))}return r.h=(i>u?i:u)+1|0,r}function z(r,t,n,e){if(void 0===r)return s(t,n);var o=e(t,r.k);if(0===o)return r.v=n,r;var i=r.l,a=r.r;if(o<0){var u=z(i,t,n,e);r.l=u}else r.r=z(a,t,n,e);return X(r)}t.copy=function r(t){return void 0!==t?{k:t.k,v:t.v,h:t.h,l:r(t.l),r:r(t.r)}:t},t.create=u,t.bal=c,t.singleton=s,t.updateValue=function(r,t){return r.v===t?r:{k:r.k,v:t,h:r.h,l:r.l,r:r.r}},t.minKey=function(r){if(void 0!==r)return o.some(v(r))},t.minKeyUndefined=function(r){if(void 0!==r)return v(r)},t.maxKey=function(r){if(void 0!==r)return o.some(d(r))},t.maxKeyUndefined=function(r){if(void 0!==r)return d(r)},t.minimum=function(r){if(void 0!==r)return l(r)},t.minUndefined=function(r){if(void 0!==r)return l(r)},t.maximum=function(r){if(void 0!==r)return p(r)},t.maxUndefined=function(r){if(void 0!==r)return p(r)},t.removeMinAuxWithRef=m,t.isEmpty=function(r){return void 0===r},t.stackAllLeft=h,t.findFirstByU=g,t.findFirstBy=function(r,t){return g(r,e.__2(t))},t.forEachU=E,t.forEach=function(r,t){E(r,e.__2(t))},t.mapU=x,t.map=function(r,t){return x(r,e.__1(t))},t.mapWithKeyU=y,t.mapWithKey=function(r,t){return y(r,e.__2(t))},t.reduceU=_,t.reduce=function(r,t,n){return _(r,t,e.__3(n))},t.everyU=b,t.every=function(r,t){return b(r,e.__2(t))},t.someU=A,t.some=function(r,t){return A(r,e.__2(t))},t.join=S,t.concat=w,t.concatOrJoin=function(r,t,n,e){return void 0!==n?S(r,t,o.valFromOption(n),e):w(r,e)},t.keepSharedU=I,t.keepShared=function(r,t){return I(r,e.__2(t))},t.keepMapU=G,t.keepMap=function(r,t){return G(r,e.__2(t))},t.partitionSharedU=C,t.partitionShared=function(r,t){return C(r,e.__2(t))},t.lengthNode=M,t.size=N,t.toList=function(r){return D(r,0)},t.checkInvariantInternal=function r(t){for(;;){var n=t;if(void 0===n)return;var e=n.l,o=n.r,i=a(e)-a(o)|0;if(!(i<=2&&i>=-2))throw{RE_EXN_ID:"Assert_failure",_1:["belt_internalAVLtree.res",457,4],Error:new Error};r(e),t=o}},t.fillArray=O,t.toArray=function(r){if(void 0===r)return[];var t=M(r),n=new Array(t);return O(r,0,n),n},t.keysToArray=function(r){if(void 0===r)return[];var t=M(r),n=new Array(t);return U(r,0,n),n},t.valuesToArray=function(r){if(void 0===r)return[];var t=M(r),n=new Array(t);return j(r,0,n),n},t.fromSortedArrayAux=R,t.fromSortedArrayRevAux=P,t.fromSortedArrayUnsafe=function(r){return R(r,0,r.length)},t.cmpU=F,t.cmp=function(r,t,n,o){return F(r,t,n,e.__2(o))},t.eqU=V,t.eq=function(r,t,n,o){return V(r,t,n,e.__2(o))},t.get=function(r,t,n){for(;;){var e=r;if(void 0===e)return;var i=n(t,e.k);if(0===i)return o.some(e.v);r=i<0?e.l:e.r}},t.getUndefined=function(r,t,n){for(;;){var e=r;if(void 0===e)return;var o=n(t,e.k);if(0===o)return e.v;r=o<0?e.l:e.r}},t.getWithDefault=function(r,t,n,e){for(;;){var o=r;if(void 0===o)return n;var i=e(t,o.k);if(0===i)return o.v;r=i<0?o.l:o.r}},t.getExn=function(r,t,n){for(;;){var e=r;if(void 0===e)throw{RE_EXN_ID:"Not_found",Error:new Error};var o=n(t,e.k);if(0===o)return e.v;r=o<0?e.l:e.r}},t.has=function(r,t,n){for(;;){var e=r;if(void 0===e)return!1;var o=n(t,e.k);if(0===o)return!0;r=o<0?e.l:e.r}},t.fromArray=function(r,t){var n=r.length;if(0!==n){var e,o=i.strictlySortedLengthU(r,(function(r,n){return t(r[0],n[0])<0}));e=o>=0?R(r,0,o):P(r,(o=0|-o)-1|0,o);for(var a=o;a<n;++a){var u=r[a];e=z(e,u[0],u[1],t)}return e}},t.updateMutate=z,t.balMutate=X,t.removeMinAuxWithRootMutate=function r(t,n){var e=n.r,o=n.l;return void 0!==o?(n.l=r(t,o),X(n)):(t.k=n.k,t.v=n.v,e)}},5252:(r,t,n)=>{var e=n(1386),o=n(2971),i=n(7175);function a(r){if(void 0===r)return r;var t={key:r.key,value:r.value,next:void 0};return function(r,t){for(;;){var n=t,e=r;if(void 0===e)return;var o={key:e.key,value:e.value,next:void 0};n.next=o,t=o,r=e.next}}(r.next,t),t}function u(r){for(var t=r.length,n=new Array(t),e=0;e<t;++e)n[e]=a(r[e]);return n}function s(r,t){for(;;){var n=r;if(void 0===t)return n;t=t.next,r=n+1|0}}function f(r,t){for(;;){var n=t;if(void 0===n)return;r(n.key,n.value),t=n.next}}function c(r,t){for(var n=r.buckets,e=0,o=n.length;e<o;++e)f(t,n[e])}function v(r,t,n){for(;;){var e=t;if(void 0===e)return n;n=r(n,e.key,e.value),t=e.next}}function d(r,t,n){for(var e=r.buckets,o=t,i=0,a=e.length;i<a;++i)o=v(n,e[i],o);return o}function l(r){var t=function(r){return o.reduceU(r.buckets,0,(function(r,t){var n=s(0,t);return r>n?r:n}))}(r),n=o.makeByU(t+1|0,(function(r){return 0}));return o.forEachU(r.buckets,(function(r){var t=s(0,r);n[t]=n[t]+1|0})),n}function p(r,t,n,e,o){for(;;){var a=o,u=e,s=a.next,f=r(a.key,a.value);if(void 0===f){if(t.size=t.size-1|0,void 0===s)return void(void 0!==u?u.next=s:t.buckets[n]=u);o=s}else{if(void 0!==u?a.next=a:t.buckets[n]=a,a.value=i.valFromOption(f),void 0===s)return void(a.next=s);o=s,e=a}}}function m(r,t){for(var n=r.buckets,e=0,o=n.length;e<o;++e){var i=n[e];void 0!==i&&p(t,r,e,void 0,i)}}function h(r,t,n,e){for(;;){var o=n,i=r;t[i]=e(o);var a=o.next;if(void 0===a)return i+1|0;n=a,r=i+1|0}}function g(r,t){for(var n=r.buckets,e=0,o=new Array(r.size),i=0,a=n.length;i<a;++i){var u=n[i];void 0!==u&&(e=h(e,o,u,t))}return o}t.C=void 0,t.copy=function(r){return{size:r.size,buckets:u(r.buckets),hash:r.hash,eq:r.eq}},t.forEachU=c,t.forEach=function(r,t){c(r,e.__2(t))},t.reduceU=d,t.reduce=function(r,t,n){return d(r,t,e.__3(n))},t.logStats=function(r){var t=l(r);console.log({bindings:r.size,buckets:r.buckets.length,histogram:t})},t.keepMapInPlaceU=m,t.keepMapInPlace=function(r,t){m(r,e.__2(t))},t.fillArray=function(r,t,n){for(;;){var e=n,o=r;t[o]=[e.key,e.value];var i=e.next;if(void 0===i)return o+1|0;n=i,r=o+1|0}},t.keysToArray=function(r){return g(r,(function(r){return r.key}))},t.valuesToArray=function(r){return g(r,(function(r){return r.value}))},t.toArray=function(r){return g(r,(function(r){return[r.key,r.value]}))},t.getBucketHistogram=l},354:(r,t)=>{t.emptyOpt=void 0,t.make=function(r,t,n){var e=function(r,t){for(;;){if(r>=t)return r;if(r<<1<r)return r;r<<=1}}(16,n);return{size:0,buckets:new Array(e),hash:r,eq:t}},t.clear=function(r){r.size=0;for(var t=r.buckets,n=t.length,e=0;e<n;++e)t[e]=void 0},t.isEmpty=function(r){return 0===r.size}},3163:(r,t,n)=>{var e=n(6253),o=n(1386),i=n(7175),a=n(2531),u=n(6144);function s(r,t){var n=t.k,e=t.v,o=t.l,a=t.r;if(r===n)return[o,i.some(e),a];if(r<n){if(void 0===o)return[void 0,void 0,t];var f=s(r,o);return[f[0],f[1],u.join(f[2],n,e,a)]}if(void 0===a)return[t,void 0,void 0];var c=s(r,a);return[u.join(o,n,e,c[0]),c[1],c[2]]}function f(r,t){return void 0!==t?s(r,t):[void 0,void 0,void 0]}function c(r,t,n){if(void 0!==r){if(r.h>=(void 0!==t?t.h:0)){var e=r.k,o=r.v,a=r.l,s=r.r,v=f(e,t);return u.concatOrJoin(c(a,v[0],n),e,n(e,i.some(o),v[1]),c(s,v[2],n))}}else if(void 0===t)return;var d=t.k,l=t.v,p=t.l,m=t.r,h=f(d,r);return u.concatOrJoin(c(h[0],p,n),d,n(d,h[1],i.some(l)),c(h[2],m,n))}function v(r,t,n){for(;;){var o=t,i=r;if(!i)return 0;if(!o)return 0;var a=o.hd,s=i.hd,f=e.int_compare(s.k,a.k);if(0!==f)return f;var c=n(s.v,a.v);if(0!==c)return c;t=u.stackAllLeft(a.r,o.tl),r=u.stackAllLeft(s.r,i.tl)}}function d(r,t,n){var e=u.size(r),o=u.size(t);return e===o?v(u.stackAllLeft(r,0),u.stackAllLeft(t,0),n):e<o?-1:1}function l(r,t,n){for(;;){var e=t,o=r;if(!o)return!0;if(!e)return!0;var i=e.hd,a=o.hd;if(a.k!==i.k||!n(a.v,i.v))return!1;t=u.stackAllLeft(i.r,e.tl),r=u.stackAllLeft(a.r,o.tl)}}function p(r,t,n){return u.size(r)===u.size(t)&&l(u.stackAllLeft(r,0),u.stackAllLeft(t,0),n)}function m(r,t,n){if(void 0===r)return u.singleton(t,n);var e=r.k;if(t===e)return r.k=t,r.v=n,r;var o=r.l,i=r.r;if(t<e){var a=m(o,t,n);r.l=a}else r.r=m(i,t,n);return u.balMutate(r)}t.N=void 0,t.A=void 0,t.S=void 0,t.add=function r(t,n,e){if(void 0===t)return u.singleton(n,e);var o=t.k;if(n===o)return u.updateValue(t,e);var i=t.v;return n<o?u.bal(r(t.l,n,e),o,i,t.r):u.bal(t.l,o,i,r(t.r,n,e))},t.get=function(r,t){for(;;){var n=r;if(void 0===n)return;var e=n.k;if(t===e)return i.some(n.v);r=t<e?n.l:n.r}},t.getUndefined=function(r,t){for(;;){var n=r;if(void 0===n)return;var e=n.k;if(t===e)return n.v;r=t<e?n.l:n.r}},t.getExn=function(r,t){for(;;){var n=r;if(void 0===n)throw{RE_EXN_ID:"Not_found",Error:new Error};var e=n.k;if(t===e)return n.v;r=t<e?n.l:n.r}},t.getWithDefault=function(r,t,n){for(;;){var e=r;if(void 0===e)return n;var o=e.k;if(t===o)return e.v;r=t<o?e.l:e.r}},t.has=function(r,t){for(;;){var n=r;if(void 0===n)return!1;var e=n.k;if(t===e)return!0;r=t<e?n.l:n.r}},t.remove=function r(t,n){if(void 0===t)return t;var e=t.k,o=t.l,i=t.r;if(n!==e)return n<e?u.bal(r(o,n),e,t.v,i):u.bal(o,e,t.v,r(i,n));if(void 0===o)return i;if(void 0===i)return o;var a={contents:i.k},s={contents:i.v},f=u.removeMinAuxWithRef(i,a,s);return u.bal(o,a.contents,s.contents,f)},t.splitAux=s,t.split=f,t.mergeU=c,t.merge=function(r,t,n){return c(r,t,o.__3(n))},t.compareAux=v,t.cmpU=d,t.cmp=function(r,t,n){return d(r,t,o.__2(n))},t.eqAux=l,t.eqU=p,t.eq=function(r,t,n){return p(r,t,o.__2(n))},t.addMutate=m,t.fromArray=function(r){var t=r.length;if(0!==t){var n,e=a.strictlySortedLengthU(r,(function(r,t){return r[0]<t[0]}));e>=0?n=u.fromSortedArrayAux(r,0,e):(e=0|-e,n=u.fromSortedArrayRevAux(r,e-1|0,e));for(var o=e;o<t;++o){var i=r[o];n=m(n,i[0],i[1])}return n}}},2459:(r,t,n)=>{var e=n(6253),o=n(1386),i=n(7175),a=n(2531),u=n(6144);function s(r,t){var n=t.k,e=t.v,o=t.l,a=t.r;if(r===n)return[o,i.some(e),a];if(r<n){if(void 0===o)return[void 0,void 0,t];var f=s(r,o);return[f[0],f[1],u.join(f[2],n,e,a)]}if(void 0===a)return[t,void 0,void 0];var c=s(r,a);return[u.join(o,n,e,c[0]),c[1],c[2]]}function f(r,t){return void 0!==t?s(r,t):[void 0,void 0,void 0]}function c(r,t,n){if(void 0!==r){if(r.h>=(void 0!==t?t.h:0)){var e=r.k,o=r.v,a=r.l,s=r.r,v=f(e,t);return u.concatOrJoin(c(a,v[0],n),e,n(e,i.some(o),v[1]),c(s,v[2],n))}}else if(void 0===t)return;var d=t.k,l=t.v,p=t.l,m=t.r,h=f(d,r);return u.concatOrJoin(c(h[0],p,n),d,n(d,h[1],i.some(l)),c(h[2],m,n))}function v(r,t,n){for(;;){var o=t,i=r;if(!i)return 0;if(!o)return 0;var a=o.hd,s=i.hd,f=e.string_compare(s.k,a.k);if(0!==f)return f;var c=n(s.v,a.v);if(0!==c)return c;t=u.stackAllLeft(a.r,o.tl),r=u.stackAllLeft(s.r,i.tl)}}function d(r,t,n){var e=u.size(r),o=u.size(t);return e===o?v(u.stackAllLeft(r,0),u.stackAllLeft(t,0),n):e<o?-1:1}function l(r,t,n){for(;;){var e=t,o=r;if(!o)return!0;if(!e)return!0;var i=e.hd,a=o.hd;if(a.k!==i.k||!n(a.v,i.v))return!1;t=u.stackAllLeft(i.r,e.tl),r=u.stackAllLeft(a.r,o.tl)}}function p(r,t,n){return u.size(r)===u.size(t)&&l(u.stackAllLeft(r,0),u.stackAllLeft(t,0),n)}function m(r,t,n){if(void 0===r)return u.singleton(t,n);var e=r.k;if(t===e)return r.k=t,r.v=n,r;var o=r.l,i=r.r;if(t<e){var a=m(o,t,n);r.l=a}else r.r=m(i,t,n);return u.balMutate(r)}t.N=void 0,t.A=void 0,t.S=void 0,t.add=function r(t,n,e){if(void 0===t)return u.singleton(n,e);var o=t.k;if(n===o)return u.updateValue(t,e);var i=t.v;return n<o?u.bal(r(t.l,n,e),o,i,t.r):u.bal(t.l,o,i,r(t.r,n,e))},t.get=function(r,t){for(;;){var n=r;if(void 0===n)return;var e=n.k;if(t===e)return i.some(n.v);r=t<e?n.l:n.r}},t.getUndefined=function(r,t){for(;;){var n=r;if(void 0===n)return;var e=n.k;if(t===e)return n.v;r=t<e?n.l:n.r}},t.getExn=function(r,t){for(;;){var n=r;if(void 0===n)throw{RE_EXN_ID:"Not_found",Error:new Error};var e=n.k;if(t===e)return n.v;r=t<e?n.l:n.r}},t.getWithDefault=function(r,t,n){for(;;){var e=r;if(void 0===e)return n;var o=e.k;if(t===o)return e.v;r=t<o?e.l:e.r}},t.has=function(r,t){for(;;){var n=r;if(void 0===n)return!1;var e=n.k;if(t===e)return!0;r=t<e?n.l:n.r}},t.remove=function r(t,n){if(void 0===t)return t;var e=t.k,o=t.l,i=t.r;if(n!==e)return n<e?u.bal(r(o,n),e,t.v,i):u.bal(o,e,t.v,r(i,n));if(void 0===o)return i;if(void 0===i)return o;var a={contents:i.k},s={contents:i.v},f=u.removeMinAuxWithRef(i,a,s);return u.bal(o,a.contents,s.contents,f)},t.splitAux=s,t.split=f,t.mergeU=c,t.merge=function(r,t,n){return c(r,t,o.__3(n))},t.compareAux=v,t.cmpU=d,t.cmp=function(r,t,n){return d(r,t,o.__2(n))},t.eqAux=l,t.eqU=p,t.eq=function(r,t,n){return p(r,t,o.__2(n))},t.addMutate=m,t.fromArray=function(r){var t=r.length;if(0!==t){var n,e=a.strictlySortedLengthU(r,(function(r,t){return r[0]<t[0]}));e>=0?n=u.fromSortedArrayAux(r,0,e):(e=0|-e,n=u.fromSortedArrayRevAux(r,e-1|0,e));for(var o=e;o<t;++o){var i=r[o];n=m(n,i[0],i[1])}return n}}},9167:(r,t,n)=>{var e=n(1386),o=n(2971);function i(r){if(void 0===r)return r;var t={key:r.key,next:void 0};return function(r,t){for(;;){var n=t,e=r;if(void 0===e)return;var o={key:e.key,next:void 0};n.next=o,t=o,r=e.next}}(r.next,t),t}function a(r){for(var t=r.length,n=new Array(t),e=0;e<t;++e)n[e]=i(r[e]);return n}function u(r,t){for(;;){var n=r;if(void 0===t)return n;t=t.next,r=n+1|0}}function s(r,t){for(;;){var n=t;if(void 0===n)return;r(n.key),t=n.next}}function f(r,t){for(var n=r.buckets,e=0,o=n.length;e<o;++e)s(t,n[e])}function c(r,t,n){for(;;){var e=n,o=r;t[o]=e.key;var i=e.next;if(void 0===i)return o+1|0;n=i,r=o+1|0}}function v(r,t,n){for(;;){var e=t;if(void 0===e)return n;n=r(n,e.key),t=e.next}}function d(r,t,n){for(var e=r.buckets,o=t,i=0,a=e.length;i<a;++i)o=v(n,e[i],o);return o}function l(r){var t=function(r){return o.reduceU(r.buckets,0,(function(r,t){var n=u(0,t);return r>n?r:n}))}(r),n=o.makeByU(t+1|0,(function(r){return 0}));return o.forEachU(r.buckets,(function(r){var t=u(0,r);n[t]=n[t]+1|0})),n}t.C=void 0,t.copy=function(r){return{size:r.size,buckets:a(r.buckets),hash:r.hash,eq:r.eq}},t.forEachU=f,t.forEach=function(r,t){f(r,e.__1(t))},t.fillArray=c,t.toArray=function(r){for(var t=r.buckets,n=0,e=new Array(r.size),o=0,i=t.length;o<i;++o){var a=t[o];void 0!==a&&(n=c(n,e,a))}return e},t.reduceU=d,t.reduce=function(r,t,n){return d(r,t,e.__2(n))},t.logStats=function(r){var t=l(r);console.log({bindings:r.size,buckets:r.buckets.length,histogram:t})},t.getBucketHistogram=l},9113:(r,t,n)=>{var e=n(3282),o=n(4881);function i(r,t){for(;;){var n=t,e=r;if(!e)return 0;if(!n)return 0;var i=n.hd,a=e.hd,u=a.v,s=i.v;if(u!==s)return u<s?-1:1;t=o.stackAllLeft(i.r,n.tl),r=o.stackAllLeft(a.r,e.tl)}}function a(r,t){var n=o.size(r),e=o.size(t);return n===e?i(o.stackAllLeft(r,0),o.stackAllLeft(t,0)):n<e?-1:1}function u(r,t){if(void 0===r)return o.singleton(t);var n=r.v;if(t===n)return r;var e=r.l,i=r.r;return t<n?r.l=u(e,t):r.r=u(i,t),o.balMutate(r)}t.S=void 0,t.N=void 0,t.A=void 0,t.has=function(r,t){for(;;){var n=r;if(void 0===n)return!1;var e=n.v;if(t===e)return!0;r=t<e?n.l:n.r}},t.compareAux=i,t.cmp=a,t.eq=function(r,t){return 0===a(r,t)},t.subset=function r(t,n){for(;;){var e=n,i=t;if(void 0===i)return!0;if(void 0===e)return!1;var a=i.v,u=i.l,s=i.r,f=e.v,c=e.l,v=e.r;if(a!==f)if(a<f){if(!r(o.create(u,a,void 0),c))return!1;t=s}else{if(!r(o.create(void 0,a,s),v))return!1;t=u}else{if(!r(u,c))return!1;n=v,t=s}}},t.get=function(r,t){for(;;){var n=r;if(void 0===n)return;var e=n.v;if(t===e)return e;r=t<e?n.l:n.r}},t.getUndefined=function(r,t){for(;;){var n=r;if(void 0===n)return;var e=n.v;if(t===e)return e;r=t<e?n.l:n.r}},t.getExn=function(r,t){for(;;){var n=r;if(void 0===n)throw{RE_EXN_ID:"Not_found",Error:new Error};var e=n.v;if(t===e)return e;r=t<e?n.l:n.r}},t.addMutate=u,t.fromArray=function(r){var t=r.length;if(0!==t){var n,i=e.strictlySortedLength(r);i>=0?n=o.fromSortedArrayAux(r,0,i):(i=0|-i,n=o.fromSortedArrayRevAux(r,i-1|0,i));for(var a=i;a<t;++a)n=u(n,r[a]);return n}}},1572:(r,t,n)=>{var e=n(4881),o=n(8466);function i(r,t){for(;;){var n=t,o=r;if(!o)return 0;if(!n)return 0;var i=n.hd,a=o.hd,u=a.v,s=i.v;if(u!==s)return u<s?-1:1;t=e.stackAllLeft(i.r,n.tl),r=e.stackAllLeft(a.r,o.tl)}}function a(r,t){var n=e.size(r),o=e.size(t);return n===o?i(e.stackAllLeft(r,0),e.stackAllLeft(t,0)):n<o?-1:1}function u(r,t){if(void 0===r)return e.singleton(t);var n=r.v;if(t===n)return r;var o=r.l,i=r.r;return t<n?r.l=u(o,t):r.r=u(i,t),e.balMutate(r)}t.S=void 0,t.N=void 0,t.A=void 0,t.has=function(r,t){for(;;){var n=r;if(void 0===n)return!1;var e=n.v;if(t===e)return!0;r=t<e?n.l:n.r}},t.compareAux=i,t.cmp=a,t.eq=function(r,t){return 0===a(r,t)},t.subset=function r(t,n){for(;;){var o=n,i=t;if(void 0===i)return!0;if(void 0===o)return!1;var a=i.v,u=i.l,s=i.r,f=o.v,c=o.l,v=o.r;if(a!==f)if(a<f){if(!r(e.create(u,a,void 0),c))return!1;t=s}else{if(!r(e.create(void 0,a,s),v))return!1;t=u}else{if(!r(u,c))return!1;n=v,t=s}}},t.get=function(r,t){for(;;){var n=r;if(void 0===n)return;var e=n.v;if(t===e)return e;r=t<e?n.l:n.r}},t.getUndefined=function(r,t){for(;;){var n=r;if(void 0===n)return;var e=n.v;if(t===e)return e;r=t<e?n.l:n.r}},t.getExn=function(r,t){for(;;){var n=r;if(void 0===n)throw{RE_EXN_ID:"Not_found",Error:new Error};var e=n.v;if(t===e)return e;r=t<e?n.l:n.r}},t.addMutate=u,t.fromArray=function(r){var t=r.length;if(0!==t){var n,i=o.strictlySortedLength(r);i>=0?n=e.fromSortedArrayAux(r,0,i):(i=0|-i,n=e.fromSortedArrayRevAux(r,i-1|0,i));for(var a=i;a<t;++a)n=u(n,r[a]);return n}}},6253:(r,t)=>{function n(r,t){return r[1]===t[1]&&r[0]===t[0]}function e(r,t){var n=t[0],e=r[0];return e>n||!(e<n)&&r[1]>=t[1]}function o(r,t){return r[0]>t[0]||!(r[0]<t[0])&&r[1]>t[1]}t.int_compare=function(r,t){return r<t?-1:r===t?0:1},t.bool_compare=function(r,t){return r?t?0:1:t?-1:0},t.float_compare=function(r,t){return r===t?0:r<t?-1:r>t||r==r?1:t==t?-1:0},t.bigint_compare=function(r,t){return r<t?-1:r===t?0:1},t.string_compare=function(r,t){return r===t?0:r<t?-1:1},t.bool_min=function(r,t){return r?t:r},t.int_min=function(r,t){return r<t?r:t},t.float_min=function(r,t){return r<t?r:t},t.string_min=function(r,t){return r<t?r:t},t.bool_max=function(r,t){return r||t},t.int_max=function(r,t){return r>t?r:t},t.float_max=function(r,t){return r>t?r:t},t.string_max=function(r,t){return r>t?r:t},t.i64_eq=n,t.i64_neq=function(r,t){return!n(r,t)},t.i64_lt=function(r,t){return!e(r,t)},t.i64_gt=o,t.i64_le=function(r,t){return!o(r,t)},t.i64_ge=e,t.i64_min=function(r,t){return e(r,t)?t:r},t.i64_max=function(r,t){return o(r,t)?r:t}},1748:(r,t)=>{t.dup=function(r){return r.slice(0)},t.sub=function(r,t,n){for(var e=new Array(n),o=0,i=t;o<n;)e[o]=r[i],o=o+1|0,i=i+1|0;return e},t.concat=function(r){var t=function(r,t){for(;;){var n=t,e=r;if(!n)return e;t=n.tl,r=n.hd.length+e|0}}(0,r),n=new Array(t);return function(r,t,n){for(;;){var e=n,o=t;if(!e)return;for(var i=e.hd,a=i.length,u=o,s=0;s<a;)r[u]=i[s],u=u+1|0,s=s+1|0;n=e.tl,t=u}}(n,0,r),n},t.make=function(r,t){for(var n=new Array(r),e=0;e<r;++e)n[e]=t;return n},t.make_float=function(r){for(var t=new Array(r),n=0;n<r;++n)t[n]=0;return t},t.blit=function(r,t,n,e,o){if(e<=t)for(var i=0;i<o;++i)n[i+e|0]=r[i+t|0];else for(var a=o-1|0;a>=0;--a)n[a+e|0]=r[a+t|0]},t.get=function(r,t){if(t<0||t>=r.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};return r[t]},t.set=function(r,t,n){if(t<0||t>=r.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};r[t]=n}},6181:(r,t)=>{var n=new Map;t.create=function(r){var t,e=n.get(r);if(void 0!==e){var o=e+1|0;n.set(r,o),t=o}else n.set(r,1),t=1;return r+"/"+t},t.is_extension=function(r){return null!=r&&"string"==typeof r.RE_EXN_ID},t.exn_slot_name=function(r){return r.RE_EXN_ID}},1863:(r,t)=>{function n(r,t){return r<<t|r>>>(32-t|0)|0}function e(r,t){var e=t;e=n(e=Math.imul(e,-862048943),15);var o=r^(e=Math.imul(e,461845907));return((o=n(o,13))+(o<<2)|0)-430675100|0}t.hash_mix_int=e,t.hash_mix_string=function(r,t){for(var n=t.length,o=(n/4|0)-1|0,i=r,a=0;a<=o;++a){var u=a<<2;i=e(i,t.charCodeAt(u)|t.charCodeAt(u+1|0)<<8|t.charCodeAt(u+2|0)<<16|t.charCodeAt(u+3|0)<<24)}var s=3&n;return 0!==s&&(i=e(i,3===s?t.charCodeAt(n-1|0)<<16|t.charCodeAt(n-2|0)<<8|t.charCodeAt(n-3|0):2===s?t.charCodeAt(n-1|0)<<8|t.charCodeAt(n-2|0):t.charCodeAt(n-1|0))),i^n},t.hash_final_mix=function(r){var t=r^r>>>16;return t=Math.imul(t,-2048144789),t^=t>>>13,(t=Math.imul(t,-1028477387))^t>>>16}},8723:(r,t)=>{t.div=function(r,t){if(0===t)throw{RE_EXN_ID:"Division_by_zero",Error:new Error};return r/t|0},t.mod_=function(r,t){if(0===t)throw{RE_EXN_ID:"Division_by_zero",Error:new Error};return r%t}},4518:(r,t,n)=>{var e=n(7175),o=n(6181),i="JsError";t.$$Error=i,t.internalToOCamlException=function(r){return o.is_extension(r)?r:{RE_EXN_ID:"JsError",_1:r}},t.as_js_exn=function(r){if(r.RE_EXN_ID===i)return e.some(r._1)}},4923:(r,t,n)=>{var e=n(6253),o=function(r,t){for(var n in r)t(n)};function i(r,t){if(r===t)return 0;var n=typeof r,o=typeof t;switch(n){case"bigint":if("bigint"===o)return e.float_compare(r,t);break;case"boolean":if("boolean"===o)return e.bool_compare(r,t);break;case"function":if("function"===o)throw{RE_EXN_ID:"Invalid_argument",_1:"compare: functional value",Error:new Error};break;case"number":if("number"===o)return e.float_compare(r,t);break;case"string":return"string"===o?e.string_compare(r,t):1;case"undefined":return-1}switch(o){case"string":return-1;case"undefined":return 1;default:if("boolean"===n)return 1;if("boolean"===o)return-1;if("function"===n)return 1;if("function"===o)return-1;if("number"===n)return null===t||void 0!==t.BS_PRIVATE_NESTED_SOME_NONE?1:-1;if("number"===o)return null===r||void 0!==r.BS_PRIVATE_NESTED_SOME_NONE?-1:1;if(null===r)return void 0!==t.BS_PRIVATE_NESTED_SOME_NONE?1:-1;if(null===t)return void 0!==r.BS_PRIVATE_NESTED_SOME_NONE?-1:1;if(void 0!==r.BS_PRIVATE_NESTED_SOME_NONE)return void 0!==t.BS_PRIVATE_NESTED_SOME_NONE?a(r,t):-1;var u=r.TAG,s=t.TAG;if(248===u)return e.int_compare(r[1],t[1]);if(251===u)throw{RE_EXN_ID:"Invalid_argument",_1:"equal: abstract value",Error:new Error};if(u!==s)return u<s?-1:1;var f=0|r.length,c=0|t.length;if(f===c){if(!Array.isArray(r))return r instanceof Date&&t instanceof Date?r-t:a(r,t);for(var v=0;;){var d=v;if(d===f)return 0;var l=i(r[d],t[d]);if(0!==l)return l;v=d+1|0}}else if(f<c)for(var p=0;;){var m=p;if(m===f)return-1;var h=i(r[m],t[m]);if(0!==h)return h;p=m+1|0}else for(var g=0;;){var E=g;if(E===c)return 1;var x=i(r[E],t[E]);if(0!==x)return x;g=E+1|0}}}function a(r,t){var n={contents:void 0},a={contents:void 0},u=function(r,t){var n=r[2],e=r[1];if(!Object.prototype.hasOwnProperty.call(e,t)||i(r[0][t],e[t])>0){var o=n.contents;return void 0!==o&&t>=o?void 0:void(n.contents=t)}},s=[r,t,a],f=[t,r,n];o(r,(function(r){return u(s,r)})),o(t,(function(r){return u(f,r)}));var c=n.contents,v=a.contents;return void 0!==c?void 0!==v?e.string_compare(c,v):-1:void 0!==v?1:0}function u(r,t){if(r===t)return!0;var n=typeof r;if("string"===n||"number"===n||"bigint"===n||"boolean"===n||"undefined"===n||null===r)return!1;var e=typeof t;if("function"===n||"function"===e)throw{RE_EXN_ID:"Invalid_argument",_1:"equal: functional value",Error:new Error};if("number"===e||"bigint"===e||"undefined"===e||null===t)return!1;var i=r.TAG,a=t.TAG;if(248===i)return r[1]===t[1];if(251===i)throw{RE_EXN_ID:"Invalid_argument",_1:"equal: abstract value",Error:new Error};if(i!==a)return!1;var s=0|r.length;if(s!==(0|t.length))return!1;if(!Array.isArray(r)){if(r instanceof Date&&t instanceof Date)return!(r>t||r<t);var f={contents:!0};return o(r,(function(r){Object.prototype.hasOwnProperty.call(t,r)||(f.contents=!1)})),f.contents&&o(t,(function(n){Object.prototype.hasOwnProperty.call(r,n)&&u(t[n],r[n])||(f.contents=!1)})),f.contents}for(var c=0;;){var v=c;if(v===s)return!0;if(!u(r[v],t[v]))return!1;c=v+1|0}}t.obj_dup=function(r){if(Array.isArray(r)){for(var t=r.length,n=new Array(t),e=0;e<t;++e)n[e]=r[e];return void 0!==r.TAG&&(n.TAG=r.TAG),n}return Object.assign({},r)},t.update_dummy=function(r,t){if(Array.isArray(t)){for(n=0;n<t.length;++n)r[n]=t[n];void 0!==t.TAG&&(r.TAG=t.TAG)}else for(var n in t)r[n]=t[n]},t.compare=i,t.equal=u,t.equal_null=function(r,t){return null!==t?u(r,t):r===t},t.equal_undefined=function(r,t){return void 0!==t?u(r,t):r===t},t.equal_nullable=function(r,t){return null==t?r===t:u(r,t)},t.notequal=function(r,t){return"number"!=typeof r&&"bigint"!=typeof r||"number"!=typeof t&&"bigint"!=typeof t?!u(r,t):r!==t},t.greaterequal=function(r,t){return"number"!=typeof r&&"bigint"!=typeof r||"number"!=typeof t&&"bigint"!=typeof t?i(r,t)>=0:r>=t},t.greaterthan=function(r,t){return"number"!=typeof r&&"bigint"!=typeof r||"number"!=typeof t&&"bigint"!=typeof t?i(r,t)>0:r>t},t.lessthan=function(r,t){return"number"!=typeof r&&"bigint"!=typeof r||"number"!=typeof t&&"bigint"!=typeof t?i(r,t)<0:r<t},t.lessequal=function(r,t){return"number"!=typeof r&&"bigint"!=typeof r||"number"!=typeof t&&"bigint"!=typeof t?i(r,t)<=0:r<=t},t.min=function(r,t){return i(r,t)<=0?r:t},t.max=function(r,t){return i(r,t)>=0?r:t}},7175:(r,t)=>{function n(r){return void 0===r?{BS_PRIVATE_NESTED_SOME_NONE:0}:null!==r&&void 0!==r.BS_PRIVATE_NESTED_SOME_NONE?{BS_PRIVATE_NESTED_SOME_NONE:r.BS_PRIVATE_NESTED_SOME_NONE+1|0}:r}function e(r){if(null===r||void 0===r.BS_PRIVATE_NESTED_SOME_NONE)return r;var t=r.BS_PRIVATE_NESTED_SOME_NONE;return 0===t?void 0:{BS_PRIVATE_NESTED_SOME_NONE:t-1|0}}t.nullable_to_opt=function(r){return null==r?void 0:n(r)},t.undefined_to_opt=function(r){return void 0===r?void 0:n(r)},t.null_to_opt=function(r){return null===r?void 0:n(r)},t.valFromOption=e,t.some=n,t.isNested=function(r){return void 0!==r.BS_PRIVATE_NESTED_SOME_NONE},t.option_get=function(r){return void 0===r?void 0:e(r)},t.option_unwrap=function(r){return void 0!==r?r.VAL:r}},3533:(r,t)=>{t.spliceApply=function(r,t){var n,e;e=t.length;var o=[];for(n=0;n<e-1;++n)o.push(t[n]);var i=t[e-1];for(n=0;n<i.length;++n)o.push(i[n]);return r.apply(null,o)},t.spliceNewApply=function(r,t){var n,e;e=t.length;var o=[null];for(n=0;n<e-1;++n)o.push(t[n]);var i=t[e-1];for(n=0;n<i.length;++n)o.push(i[n]);return new(Function.prototype.bind.apply(r,o))},t.spliceObjApply=function(r,t,n){var e,o;o=n.length;var i=[];for(e=0;e<o-1;++e)i.push(n[e]);var a=n[o-1];for(e=0;e<a.length;++e)i.push(a[e]);return r[t].apply(r,i)}},1386:(r,t,n)=>{var e=n(1748);function o(r,t){for(;;){var n=t,i=r,a=i.length,u=0===a?1:a,s=u-n.length|0;if(0===s)return i.apply(null,n);if(s>=0)return function(r,t){return function(n){return o(r,t.concat([n]))}}(i,n);t=e.sub(n,u,0|-s),r=i.apply(null,e.sub(n,0,u))}}function i(r,t){var n=r.length;if(1===n)return r(t);switch(n){case 1:return r(t);case 2:return function(n){return r(t,n)};case 3:return function(n,e){return r(t,n,e)};case 4:return function(n,e,o){return r(t,n,e,o)};case 5:return function(n,e,o,i){return r(t,n,e,o,i)};case 6:return function(n,e,o,i,a){return r(t,n,e,o,i,a)};case 7:return function(n,e,o,i,a,u){return r(t,n,e,o,i,a,u)};default:return o(r,[t])}}function a(r,t,n){var e=r.length;if(2===e)return r(t,n);switch(e){case 1:return o(r(t),[n]);case 2:return r(t,n);case 3:return function(e){return r(t,n,e)};case 4:return function(e,o){return r(t,n,e,o)};case 5:return function(e,o,i){return r(t,n,e,o,i)};case 6:return function(e,o,i,a){return r(t,n,e,o,i,a)};case 7:return function(e,o,i,a,u){return r(t,n,e,o,i,a,u)};default:return o(r,[t,n])}}function u(r,t,n,e){var i=r.length;if(3===i)return r(t,n,e);switch(i){case 1:return o(r(t),[n,e]);case 2:return o(r(t,n),[e]);case 3:return r(t,n,e);case 4:return function(o){return r(t,n,e,o)};case 5:return function(o,i){return r(t,n,e,o,i)};case 6:return function(o,i,a){return r(t,n,e,o,i,a)};case 7:return function(o,i,a,u){return r(t,n,e,o,i,a,u)};default:return o(r,[t,n,e])}}function s(r,t,n,e,i){var a=r.length;if(4===a)return r(t,n,e,i);switch(a){case 1:return o(r(t),[n,e,i]);case 2:return o(r(t,n),[e,i]);case 3:return o(r(t,n,e),[i]);case 4:return r(t,n,e,i);case 5:return function(o){return r(t,n,e,i,o)};case 6:return function(o,a){return r(t,n,e,i,o,a)};case 7:return function(o,a,u){return r(t,n,e,i,o,a,u)};default:return o(r,[t,n,e,i])}}function f(r,t,n,e,i,a){var u=r.length;if(5===u)return r(t,n,e,i,a);switch(u){case 1:return o(r(t),[n,e,i,a]);case 2:return o(r(t,n),[e,i,a]);case 3:return o(r(t,n,e),[i,a]);case 4:return o(r(t,n,e,i),[a]);case 5:return r(t,n,e,i,a);case 6:return function(o){return r(t,n,e,i,a,o)};case 7:return function(o,u){return r(t,n,e,i,a,o,u)};default:return o(r,[t,n,e,i,a])}}function c(r,t,n,e,i,a,u){var s=r.length;if(6===s)return r(t,n,e,i,a,u);switch(s){case 1:return o(r(t),[n,e,i,a,u]);case 2:return o(r(t,n),[e,i,a,u]);case 3:return o(r(t,n,e),[i,a,u]);case 4:return o(r(t,n,e,i),[a,u]);case 5:return o(r(t,n,e,i,a),[u]);case 6:return r(t,n,e,i,a,u);case 7:return function(o){return r(t,n,e,i,a,u,o)};default:return o(r,[t,n,e,i,a,u])}}function v(r,t,n,e,i,a,u,s){var f=r.length;if(7===f)return r(t,n,e,i,a,u,s);switch(f){case 1:return o(r(t),[n,e,i,a,u,s]);case 2:return o(r(t,n),[e,i,a,u,s]);case 3:return o(r(t,n,e),[i,a,u,s]);case 4:return o(r(t,n,e,i),[a,u,s]);case 5:return o(r(t,n,e,i,a),[u,s]);case 6:return o(r(t,n,e,i,a,u),[s]);case 7:return r(t,n,e,i,a,u,s);default:return o(r,[t,n,e,i,a,u,s])}}function d(r,t,n,e,i,a,u,s,f){var c=r.length;if(8===c)return r(t,n,e,i,a,u,s,f);switch(c){case 1:return o(r(t),[n,e,i,a,u,s,f]);case 2:return o(r(t,n),[e,i,a,u,s,f]);case 3:return o(r(t,n,e),[i,a,u,s,f]);case 4:return o(r(t,n,e,i),[a,u,s,f]);case 5:return o(r(t,n,e,i,a),[u,s,f]);case 6:return o(r(t,n,e,i,a,u),[s,f]);case 7:return o(r(t,n,e,i,a,u,s),[f]);default:return o(r,[t,n,e,i,a,u,s,f])}}t.app=o,t._1=i,t.__1=function(r){return 1===r.length?r:function(t){return i(r,t)}},t._2=a,t.__2=function(r){return 2===r.length?r:function(t,n){return a(r,t,n)}},t._3=u,t.__3=function(r){return 3===r.length?r:function(t,n,e){return u(r,t,n,e)}},t._4=s,t.__4=function(r){return 4===r.length?r:function(t,n,e,o){return s(r,t,n,e,o)}},t._5=f,t.__5=function(r){return 5===r.length?r:function(t,n,e,o,i){return f(r,t,n,e,o,i)}},t._6=c,t.__6=function(r){return 6===r.length?r:function(t,n,e,o,i,a){return c(r,t,n,e,o,i,a)}},t._7=v,t.__7=function(r){return 7===r.length?r:function(t,n,e,o,i,a,u){return v(r,t,n,e,o,i,a,u)}},t._8=d,t.__8=function(r){return 8===r.length?r:function(t,n,e,o,i,a,u,s){return d(r,t,n,e,o,i,a,u,s)}}},2900:(r,t)=>{t.$$Error="JsError",t.raiseError=function(r){throw new Error(r)},t.raiseEvalError=function(r){throw new EvalError(r)},t.raiseRangeError=function(r){throw new RangeError(r)},t.raiseReferenceError=function(r){throw new ReferenceError(r)},t.raiseSyntaxError=function(r){throw new SyntaxError(r)},t.raiseTypeError=function(r){throw new TypeError(r)},t.raiseUriError=function(r){throw new URIError(r)}},1589:(r,t)=>{t.equal=function(r,t){return r===t},t.max=2147483647,t.min=-2147483648},4763:(r,t,n)=>{var e=n(1589);function o(r){return r>e.max?e.max:r<e.min?e.min:Math.ceil(r)}function i(r){return r>e.max?e.max:r<e.min?e.min:Math.floor(r)}var a=o,u=i;t.unsafe_ceil=function(r){return Math.ceil(r)},t.ceil_int=o,t.ceil=a,t.unsafe_floor=function(r){return Math.floor(r)},t.floor_int=i,t.floor=u,t.random_int=function(r,t){return i(Math.random()*(t-r|0))+r|0}},3053:(r,t,n)=>{var e=n(6517),o=n(2423),i=n(1874);function a(r,t,n,i){for(var a,u=0,s={contents:0},f=r.hyps.length-1|0;u<=f&&e.isNone(a);){var c=r.hyps[u];"E"===c.typ&&(e.getWithDefault(e.map(n,function(r){return function(t){return t===r.label}}(c)),!1)||e.getWithDefault(e.map(i,(function(r){return r===s.contents})),!1)?a=o.pnGetExpr(t[u]):s.contents=s.contents+1|0),u=u+1|0}return a}function u(r,t,n,e,o){if(e===n.frm.numOfHypsE)return!0;if(-1===e){var s={contents:!1},f=n.frm;return i.iterateSubstitutions(f.frame.asrt,r,f.frmConstParts[f.numOfHypsE],f.constParts[f.numOfHypsE],f.varGroups[f.numOfHypsE],f.subs,o,(function(i){return u(r,t,n,e+1|0,o)?(s.contents=!0,"Stop"):"Continue"})),s.contents}var c=function(r,t,n){if("object"==typeof n&&"Assertion"===n.TAG){var e=n.frame,o=n.args,i=r.hypMatchers[t];return"Label"===i.TAG?a(e,o,i._0,void 0):a(e,o,void 0,i._0)}}(n,e,t);if(void 0===c)return!1;var v={contents:!1},d=n.frm;return i.iterateSubstitutions(d.hypsE[e].expr,c,d.frmConstParts[e],d.constParts[e],d.varGroups[e],d.subs,o,(function(i){return u(r,t,n,e+1|0,o)?(v.contents=!0,"Stop"):"Continue"})),v.contents}t.exprSrcMatches=function(r,t,n,e){return n.matchAsrt?u(r,t,n,-1,e):u(r,t,n,0,e)}},6705:(r,t,n)=>{var e=n(6638),o=n(55),i=n(2971),a=n(6517),u=n(9775),s=n(1874),f=n(5047),c=n(7653);function v(r,t){return!(!a.isNone(r.err)||!a.isNone(t.err)||r.frame.label!==t.frame.label)&&s.subsEq(r.subs,t.subs)}function d(r){return f.hash2(f.hashStr(r.frame.label),s.subsHash(r.subs))}var l=e.MakeHashableU({hash:d,eq:v});function p(r,t,n,e,o,i,a,u,s){if(n===t.length)return i.contents=i.contents+1|0,i.contents>a?u():t.some((function(r){return-1===r}))?e?"Continue":s(t):o?"Continue":s(t);for(var f="Continue",c=0,v=r[n].length-1|0;"Continue"===f&&c<=v&&i.contents<=a;)t[n]=r[n][c],-1===t[n]&&e||(f=p(r,t,n+1|0,e,o,i,a,u,s)),c=c+1|0;return f}function m(r,t,n,e,o,a,u){for(var s=i.makeBy(t,(function(r){return[]})),f=t-1|0,c=r-1|0,v=0;v<=f;++v)for(var d=-1;d<=c;++d)n(d,v)&&s[v].push(d);var l=s.findIndex((function(r){return 0===r.length}));if(-1!==l)return o>=2?u({TAG:"NoUnifForArg",args:[],errArgIdx:l}):"Continue";var m=i.make(t,0),h={contents:!1},g=p(s,m,0,!0,!1,{contents:0},e,(function(){return h.contents=!0,u({TAG:"TooManyCombinations",frmLabels:void 0})}),a);return"Continue"===g?p(s,m,0,!1,!0,{contents:0},e,(function(){return h.contents?"Continue":u({TAG:"TooManyCombinations",frmLabels:void 0})}),a):g}function h(r,t,n,e,o){var i=r.newVars.length,a=t.subs.isDefined.slice(),u={contents:(r.maxVar+1|0)+r.newVars.length|0},f=[],c=[],v=[];s.applySubs(e<t.hypsE.length?t.hypsE[e].expr:t.frame.asrt,t.subs,(function(r){var n=f.indexOf(r);if(-1!==n)return c[n];var e=u.contents;return u.contents=u.contents+1|0,f.push(r),c.push(e),v.push(t.frame.varTypes[r]),e}));for(var d=f.length-1|0,l=0;l<=d;++l){var p=f[l],m=c[l],h=v[l];t.subs.exprs[p]=[m],t.subs.begins[p]=0,t.subs.ends[p]=0,t.subs.isDefined[p]=!0,r.newVars.push(m),r.newVarTypes.push(h)}var g=n||0===r.newVars.length?o():"Continue";return a.forEach((function(r,n){t.subs.isDefined[n]=r})),r.newVars.splice(i),r.newVarTypes.splice(i),g}function g(r,t){for(var n=r+1|0;n<t.length&&t[n]>=0;)n=n+1|0;if(n<t.length&&t[n]<0)return n}function E(r,t){if(r>=t.length)throw{RE_EXN_ID:o.MmException,_1:{msg:"getNextHypIdxToMatch: hypIdx >= comb->Array.length"},Error:new Error};if(r<0||t[r]>=0){var n=function(r,t){for(var n=r+1|0;n<t.length&&t[n]<0;)n=n+1|0;if(n<t.length&&t[n]>=0)return n}(r,t);if(void 0!==n)return n;var e=g(-1,t);return void 0!==e?e:t.length}var i=g(r,t);return void 0!==i?i:t.length}function x(r,t,n,e,o,i,a,u,f,c){var v=function(){return i.map((function(r){return r>=0?e[r]:[]}))};if(a===i.length){var d={contents:!1},l=h(r,t,o,a,(function(){return d.contents=!0,f()}));return u>=2&&!d.contents?c({TAG:"NewVarsAreDisabled",args:v(),errArgIdx:a}):l}if(i[a]>=0){var p={contents:!1},m=s.iterateSubstitutions(t.hypsE[a].expr,e[i[a]],t.frmConstParts[a],t.constParts[a],t.varGroups[a],t.subs,n,(function(s){return p.contents=!0,x(r,t,n,e,o,i,E(a,i),u,f,c)}));return u>=2&&!p.contents?c({TAG:"NoUnifForArg",args:v(),errArgIdx:a}):m}var g={contents:!1},y=h(r,t,o,a,(function(){return g.contents=!0,x(r,t,n,e,o,i,E(a,i),u,f,c)}));return u>=2&&!g.contents?c({TAG:"NewVarsAreDisabled",args:v(),errArgIdx:a}):y}t.applyAssertionResultEq=v,t.applyAssertionResultHash=d,t.ApplyAssertionResultHash=l,t.applyAssertions=function(r,t,n,e,o,i,f,v,d,p,h,g,y,_,b,A){var T=void 0!==f&&f,k=void 0===v||v,S=void 0===d||d,w=void 0!==g&&g,I=void 0!==y?y:1e4,G=void 0!==b?b:0,C=function(r){return void 0!==p?_({newVars:[],newVarTypes:[],frame:r.frame,subs:s.subsClone(r.subs),err:{TAG:"NoUnifForAsrt",asrtExpr:r.frame.asrt,expr:p}}):"Continue"},M=i.length,N=function(r,t,n){if(void 0!==t)return t.length;if(void 0===n)return s.frmsGetAll(r).length;var e=s.frmsGetByType(r,n[0]);return void 0!==e?e.length:0}(t,n,p),D=c.progressTrackerMake(.01,void 0,A,void 0),U={contents:0},j={contents:"Continue"},O=u.make(16,l),P=function(t){if("Continue"===j.contents)if(a.getWithDefault(a.map(p,(function(r){return r[0]!==t.frame.asrt[0]})),!1))G>=2&&(j.contents=C(t));else{var n={contents:!1};j.contents=function(r,t,n,e){return void 0!==t?s.iterateSubstitutions(r.frame.asrt,t,r.frmConstParts[r.numOfHypsE],r.constParts[r.numOfHypsE],r.varGroups[r.numOfHypsE],r.subs,n,e):e(r.subs)}(t,p,h,(function(e){n.contents=!0;var a=t.numOfHypsE,f=[],c=[],v={maxVar:r,newVars:f,newVarTypes:c};return m(M,a,(function(r,n){return-1===r?!T&&k:(!T||r===n)&&function(r,t,n,e,o){if(e[0]!==n[0])return!1;var i={contents:!1};return s.iterateSubstitutions(e,n,r.frmConstParts[t],r.constParts[t],r.varGroups[t],r.subs,o,(function(r){return i.contents=!0,"Stop"})),i.contents}(t,n,i[r],t.hypsE[n].expr,h)}),I,G,(function(n){return x(v,t,h,i,S,n,E(-1,n),G,(function(){var n=function(r,t,n,e,o,i){return s.verifyDisjoints(r,t,(function(r,t){return!(r<=n&&t<=n&&!o(r,t))||e}),i)}(t.frame.disj,t.subs,r,w,o,G);if(void 0!==n){if(0===G)return"Continue";var e=f.slice(),i=c.slice(),a=t.frame,v=s.subsClone(t.subs);return _({newVars:e,newVarTypes:i,frame:a,subs:v,err:n})}var d={newVars:f.slice(),newVarTypes:c.slice(),frame:t.frame,subs:s.subsClone(t.subs),err:void 0};return u.has(O,d)?"Continue":(u.add(O,d),_(d))}),(function(r){return _({newVars:[],newVarTypes:[],frame:t.frame,subs:s.subsClone(t.subs),err:r})}))}),(function(r){return _({newVars:[],newVarTypes:[],frame:t.frame,subs:s.subsClone(t.subs),err:r})}))})),G>=2&&!n.contents&&(j.contents=C(t))}U.contents=U.contents+1,c.progressTrackerSetCurrPct(D,U.contents/N)};return void 0!==n?void n.forEach((function(r){a.forEach(s.frmsGetByLabel(t,r),(function(r){if(e(r.frame))return P(r)}))})):s.frmsForEach(t,a.map(p,(function(r){return r[0]})),(function(r){if(e(r.frame))return P(r)}))},t.iterateCombinations=m,t.getNextHypIdxToMatch=E},3333:(r,t,n)=>{var e=n(5291),o=n(6638),i=n(55),a=n(2971),u=n(1094),s=n(6517),f=n(303),c=n(7175),v=n(5082),d=n(7356),l=n(7659),p=n(3533),m=n(2275),h=n(8615),g=n(5047),E=n(7653),x=n(9217);function y(r,t){var n=r.length;if(n!==t.length)return!1;for(var e=!0,o=0;e&&o<n;)e=r[o]===t[o],o=o+1|0;return e}function _(r,t){var n=r.length,e=t.length,o=g.intCmp(n,e);if(0!==o)return o;for(var i=0,a=0;a<n&&0===i;)i=g.intCmp(r[a],t[a]),a=a+1|0;return i}var b=g.toIntCmp(_),A=o.MakeComparableU({cmp:b}),T=o.MakeHashableU({hash:g.hashArrInt,eq:y});function k(r,t,n){if(t!==n){var e=t<=n?t:n,o=t<=n?n:t,i=d.get(r,e);return void 0!==i?l.add(c.valFromOption(i),o):d.set(r,e,l.fromArray([o]))}}function S(r,t){var n=r.parent;if(void 0===n)return t(r);var e=S(n,t);return void 0!==e?c.some(c.valFromOption(e)):t(r)}function w(r,t){for(;;){var n=r,e=t(n);if(void 0!==e)return c.some(c.valFromOption(e));var o=n.parent;if(void 0===o)return;r=o}}function I(r,t){return w(r.contents,(function(r){var n=m.get(r.frames,t);if(void 0!==n)return s.isNone(n.proof)?"A":"P";var e=m.get(r.labelToHyp,t);if(void 0!==e)return"F"===e.typ?"F":"E";var o=m.get(r.symToInt,t);return void 0!==o?o<0?"C":"V":void 0}))}function G(r,t){return s.getWithDefault(s.map(m.get(s.getExn(r.contents.root).symToInt,t),(function(r){return r<0})),!1)}function C(r,t){return s.getWithDefault(s.map(w(r.contents,(function(r){return m.get(r.symToInt,t)})),(function(r){return 0<=r})),!1)}function M(r,t){return s.isSome(w(r.contents,(function(r){return m.get(r.labelToHyp,t)})))}function N(r,t,n){var e=t<=n?t:n,o=t<=n?n:t,i=d.get(r,e);return void 0!==i&&l.has(c.valFromOption(i),o)}function D(r,t){d.forEach(r,(function(r,n){l.forEach(n,(function(n){t(r,n)}))}))}function U(r){var t=l.make(100);return d.forEach(r,(function(r,n){l.add(t,r),l.forEach(n,(function(r){l.add(t,r)}))})),t}function j(r,t,n,o,i){var a=void 0!==t&&t,u=[];D(r,(function(r,t){u.push([r,t])}));for(var f,v=function(t,n){var e={contents:!0};return t.forEach((function(t){e.contents&&n.forEach((function(n){e.contents&&t!==n&&(e.contents=N(r,t,n))}))})),e.contents},p=function(r,t){u.splice(u.findIndex((function(r){return y(r,t)})),1),t.forEach((function(t){r.includes(t)||r.push(t)}))},m=function(){for(var r,t=0,n=u.length-2|0;t<=n;++t)if(s.isNone(r))for(var e=t+1|0,o=u.length;e<o;++e)if(s.isNone(r)){var i=u[t],a=u[e];v(i,a)&&(r=[i,a])}return r},h=!0;h;){var E=m();void 0!==E?p(E[0],E[1]):h=!1}if(a&&void 0!==o&&void 0!==i&&void 0!==n){var x=U(r),b=d.make(l.size(x)),A=d.make(l.size(x));l.forEach(x,(function(r){var t=o(r);void 0!==t&&d.set(b,r,t);var e=n(r);if(void 0!==e)return d.set(A,r,e)}));var T=e.createVarTypeComparator(b,c.valFromOption(i)),k=e.createVarNameComparator(A);f=g.comparatorAndThen(T,k)}else f=g.intCmp;return u.forEach((function(r){g.sortInPlaceWith(r,f)})),g.sortInPlaceWith(u,_)}function O(r,t){var n=t.expr,e=n.length,o=e>0?n[0]:0,i=e>1?n[1]:0,a=d.get(r.exprToHyp,e);if(void 0===a)return d.set(r.exprToHyp,e,d.fromArray([[o,d.fromArray([[i,[t]]])]]));var u=c.valFromOption(a),s=d.get(u,o);if(void 0===s)return d.set(u,o,d.fromArray([[i,[t]]]));var f=c.valFromOption(s),v=d.get(f,i);return void 0===v?d.set(f,i,[t]):void 0!==v.find((function(r){return y(r.expr,t.expr)}))?void 0:void v.push(t)}function P(r,t){return w(r.contents,(function(r){return m.get(r.frames,t)}))}function R(r,t){return S(r.contents,(function(r){return g.arrForEach(r.hyps,t)}))}function F(r,t){return w(r.contents,(function(r){return m.get(r.symToInt,t)}))}function V(r,t){var n=F(r,t);if(void 0!==n)return n;throw{RE_EXN_ID:i.MmException,_1:{msg:"The symbol '"+t+"' is not declared."},Error:new Error}}function B(r,t){return t.map((function(t){return V(r,t)}))}function L(r,t){return t<0?a.get(s.getExn(r.contents.root).consts,0|-t):w(r.contents,(function(r){return t<r.varsBaseIdx?void 0:r.vars[t-r.varsBaseIdx|0]}))}function W(r,t){var n=L(r,t);if(void 0!==n)return n;throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot convert "+String(t)+" to a symbol."},Error:new Error}}function X(r,t){return t.map((function(t){return W(r,t)}))}function z(r,t){return t.map((function(t){return W(r,t)})).join(" ")}function H(r,t,n){return n<0?L(r,n):a.get(t.frameVarToSymb,n)}function q(r,t,n){var e=H(r,t,n);if(void 0!==e)return e;throw{RE_EXN_ID:i.MmException,_1:{msg:"Could not convert from int "+String(n)+" to a symbol."},Error:new Error}}function $(r,t,n){return n.map((function(n){return q(r,t,n)}))}function K(r,t){return w(r.contents,(function(r){return d.get(r.varTypes,t)}))}function J(r,t){var n=K(r,t);if(void 0!==n)return n;var e=L(r,t),o=void 0!==e?"'"+e+"'":String(t);throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot determine type of the variable "+o},Error:new Error}}function Q(r,t,n,e){var o=void 0!==n&&n,i=l.make(16);return o||(void 0!==e?e.forEach((function(r){r.forEach((function(r){if(r>=0)return l.add(i,r)}))})):R(r,(function(r){"E"===r.typ&&r.expr.forEach((function(r){if(r>=0)return l.add(i,r)}))}))),t.forEach((function(r){if(r>=0)return l.add(i,r)})),i}function Z(r,t,n,e){var o=void 0!==n&&n,i=[];return R(r,(function(r){("E"===r.typ&&!o&&s.isNone(e)||"F"===r.typ&&l.has(t,r.expr[1]))&&i.push(r)})),void 0!==e&&e.forEach((function(r,t){i.push({typ:"E",label:String(t),expr:r})})),i}function Y(r){return s.getExn(r.contents.root).consts.slice(1)}function rr(r,t){return S(r.contents,(function(r){var n={contents:void 0};return m.forEach(r.frames,(function(r,e){s.isNone(n.contents)&&(n.contents=t(e))})),n.contents}))}function tr(r){var t=r.parent;return void 0!==t?1+tr(t)|0:0}function nr(r,t){var n=void 0!==t&&t,e=void 0!==r?r.contents:void 0,o={contents:{root:void 0,parent:e,consts:void 0!==e?[]:[""],varsBaseIdx:void 0!==e?e.varsBaseIdx+e.vars.length|0:0,vars:[],symToInt:m.make(0),disj:d.make(16),hyps:[],labelToHyp:m.make(4),exprToHyp:d.make(4),varTypes:d.make(4),lastComment:void 0,frames:m.make(1),totalNumOfFrames:void 0!==e?e.totalNumOfFrames:0,deprOrTranDeprFrms:h.make(1),debug:s.getWithDefault(s.map(e,(function(r){return r.debug})),n)}};return o.contents.root=void 0!==e?e.root:o.contents,o}function er(r){r.contents=nr(r,void 0).contents}function or(r){var t,n=r.contents,e=n.parent;if(void 0===e)throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot close the root context."},Error:new Error};e.totalNumOfFrames=e.totalNumOfFrames+m.size(n.frames)|0,m.forEach(n.frames,(function(r,t){m.set(e.frames,r,t)}));var o=e.deprOrTranDeprFrms;h.forEach(n.deprOrTranDeprFrms,(function(r){return h.add(o,r)})),t=e,r.contents=t}function ir(r,t,n){if(""===t.trim())throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot use an empty string as a name of "+n+"."},Error:new Error};var e=I(r,t);if(void 0!==e)switch(e){case"C":throw{RE_EXN_ID:i.MmException,_1:{msg:"An attempt to re-declare the constant '"+t+"' as "+n+"."},Error:new Error};case"V":throw{RE_EXN_ID:i.MmException,_1:{msg:"An attempt to re-declare the variable '"+t+"' as "+n+"."},Error:new Error};case"F":throw{RE_EXN_ID:i.MmException,_1:{msg:"An attempt to re-declare a floating label '"+t+"' as "+n+"."},Error:new Error};case"E":throw{RE_EXN_ID:i.MmException,_1:{msg:"An attempt to re-declare an essential label '"+t+"' as "+n+"."},Error:new Error};case"A":throw{RE_EXN_ID:i.MmException,_1:{msg:"An attempt to re-declare an axiom label '"+t+"' as "+n+"."},Error:new Error};case"P":throw{RE_EXN_ID:i.MmException,_1:{msg:"An attempt to re-declare a provable label '"+t+"' as "+n+"."},Error:new Error}}}function ar(r,t){if(t<0)return t;var n=d.get(r,t);if(void 0!==n)return n;throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot determine frame variable for the context variable "+String(t)+"."},Error:new Error}}function ur(r,t){return t.map((function(t){return ar(r,t)}))}function sr(r,t){var n=d.make(16);return D(t,(function(t,e){k(n,ar(r,t),ar(r,e))})),u.fromArray(d.toArray(n).map((function(r){return[r[0],f.fromArray(l.toArray(r[1]))]})))}function fr(r,t){return s.getWithDefault(s.map(t,(function(t){return t.test(r)})),!1)}function cr(r,t,n,e){return!!s.getWithDefault(s.map(r,(function(r){return fr(r,n)})),!1)||fr(t,e)}function vr(r,t){if(void 0===t)return!1;var n=t.labels;return s.getWithDefault(S(r.contents,(function(r){if(n.some((function(t){return h.has(r.deprOrTranDeprFrms,t)})))return!0})),!1)}function dr(r,t){var n=a.make(r,-1);if(t.forEach((function(t,e){if("F"===t.typ){var o=t.expr[1];if(o>=r)throw{RE_EXN_ID:i.MmException,_1:{msg:"Internal error: hyp.expr[1] >= numOfVars"},Error:new Error};n[o]=e}})),n.some((function(r){return r<0})))throw{RE_EXN_ID:i.MmException,_1:{msg:"Internal error: varHyps->Array.some(idx => idx < 0)"},Error:new Error};return n}function lr(r,t,n,e,o,a,u,f,c,v,p,m,h,g,E){var x=void 0!==f&&f,y=void 0!==c&&c,_=void 0!==v&&v;if(ir(r,e,void 0!==u?u:"a frame"),o.length<1)throw{RE_EXN_ID:i.MmException,_1:{msg:"Length of an assertion expression must be at least 1."},Error:new Error};if(!y&&!G(r,o[0]))throw{RE_EXN_ID:i.MmException,_1:{msg:"The first symbol in an assertion expression must be a constant."},Error:new Error};var b=o.find((function(t){return s.isNone(F(r,t))}));if(void 0!==b)throw{RE_EXN_ID:i.MmException,_1:{msg:"The symbol '"+b+"' must be either a constant or a variable."},Error:new Error};var A=o.map((function(t){return V(r,t)})),T=Q(r,A,x,p),S=l.toArray(T),I=_?d.make(16):function(r,t){var n=d.make(16);return w(r.contents,(function(r){d.forEach(r.disj,(function(r,e){if(l.has(t,r))return l.forEach(e,(function(e){if(l.has(t,e))return k(n,r,e)}))}))})),n}(r,T),C=Z(r,T,x,p),M=d.fromArray(S.map((function(r,t){return[r,t]}))),N=r.contents.lastComment,D=C.map((function(r){return{typ:r.typ,label:r.label,expr:ur(M,r.expr)}})),U=S.length;return{ord:t,isAxiom:n,disj:sr(M,I),hyps:D,asrt:ur(M,A),label:e,frameVarToSymb:S.map((function(t){return W(r,t)})),varTypes:S.map((function(t){return J(r,t)})),varHyps:dr(U,D),numOfVars:U,numOfArgs:C.length,descr:N,proof:a,isDisc:cr(N,e,m,h),isDepr:cr(N,e,g,E),isTranDepr:vr(r,a),dbg:r.contents.debug?{disj:j(I,void 0,void 0,void 0,void 0).map((function(t){return z(r,t)})),hyps:C.map((function(t){return z(r,t.expr)})),asrt:z(r,A)}:void 0}}function pr(r,t,n,e,o,i,a,u,f){var c=r.contents,v=lr(r,c.totalNumOfFrames,t,n,e,o,s.isNone(o)?"an axiom":"a theorem",void 0,void 0,void 0,void 0,i,a,u,f);if(m.set(c.frames,n,v),c.totalNumOfFrames=c.totalNumOfFrames+1|0,v.isDepr||v.isTranDepr)return h.add(c.deprOrTranDeprFrms,n)}function mr(r,t,n,e,o,a){switch(t.TAG){case"Comment":var u=t.text;return void(r.contents.lastComment=u);case"Const":return void t.symbols.forEach((function(t){if(s.isSome(r.contents.parent))throw{RE_EXN_ID:i.MmException,_1:{msg:"An attempt to declare a constant '"+t+"' in an inner block."},Error:new Error};ir(r,t,"a constant");var n=r.contents;m.set(n.symToInt,t,0|-n.consts.length),n.consts.push(t)}));case"Block":throw{RE_EXN_ID:i.MmException,_1:{msg:"Block statements are not accepted by applySingleStmt()."},Error:new Error};case"Var":return void t.symbols.forEach((function(t){ir(r,t,"a variable");var n=r.contents;m.set(n.symToInt,t,n.varsBaseIdx+n.vars.length|0),n.vars.push(t)}));case"Disj":var f=t.vars,c=f.find((function(t){return!C(r,t)}));if(void 0!==c)throw{RE_EXN_ID:i.MmException,_1:{msg:"The symbol '"+c+"' is not a variable but it is used in a disjoint statement."},Error:new Error};for(var v=f.map((function(t){return V(r,t)})),l=v.length-1|0,p=0;p<=l;++p)for(var h=p+1|0;h<=l;++h)k(r.contents.disj,v[p],v[h]);return;case"Floating":var g=t.label,E=t.expr;if(2!==E.length)throw{RE_EXN_ID:i.MmException,_1:{msg:"Length of a floating expression must be 2."},Error:new Error};ir(r,g,"a floating label");var x=E[0],y=E[1];if(!G(r,x))throw{RE_EXN_ID:i.MmException,_1:{msg:"The first symbol in the floating '"+x+"' must be a constant."},Error:new Error};if(!C(r,y))throw{RE_EXN_ID:i.MmException,_1:{msg:"The second symbol in the floating '"+y+"' must be a variable."},Error:new Error};var _=V(r,y);if(s.isSome(K(r,_)))throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot redefine typecode for the variable '"+y+"'"},Error:new Error};var b=V(r,x),A={typ:"F",label:g,expr:[b,_]},T=r.contents;return T.hyps.push(A),m.set(T.labelToHyp,g,A),O(T,A),d.set(T.varTypes,_,b);case"Essential":var S=t.label,w=t.expr;if(w.length<1)throw{RE_EXN_ID:i.MmException,_1:{msg:"Length of an essential expression must be at least 1."},Error:new Error};if(!G(r,w[0]))throw{RE_EXN_ID:i.MmException,_1:{msg:"The first symbol in an essential expression must be a constant."},Error:new Error};var I={typ:"E",label:S,expr:B(r,w)},M=r.contents;return M.hyps.push(I),m.set(M.labelToHyp,S,I),O(M,I);case"Axiom":return pr(r,!0,t.label,t.expr,void 0,n,e,o,a);case"Provable":return pr(r,!1,t.label,t.expr,t.proof,n,e,o,a)}}function hr(r,t){return s.getWithDefault(d.get(r,t),t)}function gr(r,t){for(var n=t.length-1|0,e=0;e<=n;++e){var o=t[e];o<0&&(t[e]=hr(r,o))}}function Er(r,t,n){return{ord:r.ord,isAxiom:r.isAxiom,disj:r.disj,hyps:r.hyps,asrt:r.asrt,label:r.label,frameVarToSymb:r.frameVarToSymb,varTypes:r.varTypes,varHyps:r.varHyps,numOfVars:r.numOfVars,numOfArgs:r.numOfArgs,descr:t?void 0:r.descr,proof:n?void 0:r.proof,isDisc:r.isDisc,isDepr:r.isDepr,isTranDepr:r.isTranDepr,dbg:r.dbg}}function xr(r,t,n){var e=function(r){var e=r.parent;return{root:r.root,parent:r.parent,consts:r.consts,varsBaseIdx:r.varsBaseIdx,vars:r.vars,symToInt:r.symToInt,disj:r.disj,hyps:r.hyps,labelToHyp:r.labelToHyp,exprToHyp:r.exprToHyp,varTypes:r.varTypes,lastComment:t?void 0:r.lastComment,frames:m.fromArray(m.toArray(r.frames).map((function(r){return[r[0],Er(r[1],t,n)]}))),totalNumOfFrames:void 0!==e?e.totalNumOfFrames+m.size(r.frames)|0:m.size(r.frames),deprOrTranDeprFrms:h.make(0),debug:r.debug}},o=r.parent;if(void 0!==o){var i=xr(o,t,n),a=i[0],u=e(r);return[a,{root:a,parent:i[1],consts:u.consts,varsBaseIdx:u.varsBaseIdx,vars:u.vars,symToInt:u.symToInt,disj:u.disj,hyps:u.hyps,labelToHyp:u.labelToHyp,exprToHyp:u.exprToHyp,varTypes:u.varTypes,lastComment:u.lastComment,frames:u.frames,totalNumOfFrames:u.totalNumOfFrames,deprOrTranDeprFrms:u.deprOrTranDeprFrms,debug:u.debug}]}var s=e(r);return s.root=s,[s,s]}function yr(r,t){return B(r,X(r,t).sort())}function _r(r,t){var n=l.fromArray(B(r,Y(r))),o=l.size(n),i=l.make(o),u=l.make(o);rr(r,(function(r){var t=r.asrt[1];t<0&&l.add(i,t);var n=r.asrt[r.asrt.length-1|0];n<0&&l.add(u,n)}));var f=l.fromArray(l.toArray(i).filter((function(r){return l.has(u,r)})));l.forEach(f,(function(r){return l.remove(i,r)})),l.forEach(f,(function(r){return l.remove(u,r)}));var c=e.getSpaceSeparatedValuesAsArray(t).map((function(t){return F(r,t)})).filter((function(r){return s.mapWithDefault(r,!1,(function(r){return r<0}))})).map(s.getExn);c.forEach((function(r){l.remove(i,r),l.remove(f,r),l.remove(u,r)}));var v,d=l.fromArray(l.toArray(n).filter((function(r){return!(c.includes(r)||l.has(i,r)||l.has(f,r)||l.has(u,r))}))),p=a.concatMany([c,(v=l.toArray(i),yr(r,v)),function(t){return yr(r,t)}(l.toArray(f)),function(t){return yr(r,t)}(l.toArray(u)),function(t){return yr(r,t)}(l.toArray(d))]),m=0|-c.length,h=m-1|0,g=(1+(h-l.size(i)|0)|0)-1|0,E=1+(g-l.size(f)|0)|0,x=1+((E-1|0)-l.size(u)|0)|0;return{allConsts:X(r,p),parenMin:m,canBeFirstMin:E,canBeFirstMax:h,canBeLastMin:x,canBeLastMax:g}}t.createContext=nr,t.applySingleStmt=mr,t.openChildContext=er,t.closeChildContext=or,t.resetToParentContext=function(r){var t,n=r.contents.parent;if(void 0===n)throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot reset the root context."},Error:new Error};t=n,r.contents=t},t.loadContext=function(r,t,n,e,o,a,u,s,f,v,d,l){var p=void 0!==n?n:"",m=void 0!==e?e:"",h=void 0!==a?a:-1,g=void 0!==d?d:function(r){},x=void 0!==l&&l,y={contents:0},_=E.progressTrackerMake(.1,void 0,g,void 0);return i.traverseAst(void 0!==t?t:nr(void 0,x),r,(function(r,t){void 0!==o&&o(r,t.stmt);var n=t.stmt;switch(n.TAG){case"Block":return n.level>0&&er(r),void(r.contents.lastComment=void 0);case"Axiom":case"Provable":break;default:return}if(h>0&&(y.contents=y.contents+1,E.progressTrackerSetCurrPct(_,y.contents/h)),p===n.label)return c.some(void 0)}),(function(r,t){var n=t.stmt;"Block"!==n.TAG&&mr(r,n,u,s,f,v)}),(function(r,t){var n=t.stmt;switch(n.TAG){case"Block":return void(n.level>0&&or(r));case"Axiom":case"Provable":break;default:return}if(m===n.label)return c.some(void 0)}))[0]},t.ctxOptimizeForProver=function(r,t,n,e){var o=void 0===n||n,i=void 0===e||e,a={contents:xr(r.contents,o,i)[1]};return function(r,t){for(var n=s.getExn(r.contents.root),e=t.slice(),o=-1,i=0|-(n.consts.length-1|0);o>=i;--o)e.includes(o)||e.push(o);var a=n.consts.slice(),u=d.make(n.consts.length);e.forEach((function(r,t){var e=a[0|-r],o=0|-(t+1|0);d.set(u,r,o),n.consts[0|-o]=e,m.set(n.symToInt,e,o)})),R(r,(function(r){gr(u,r.expr)})),rr(r,(function(r){r.hyps.forEach((function(r){gr(u,r.expr)})),gr(u,r.asrt),gr(u,r.varTypes)})),S(r.contents,(function(r){for(var t=r.vars.length-1|0,n=0;n<=t;++n){var e=r.varsBaseIdx+n|0,o=d.get(r.varTypes,e);void 0!==o&&d.set(r.varTypes,e,hr(u,o))}d.clear(r.exprToHyp),r.hyps.forEach((function(t){O(r,t)}))}))}(a,B(a,_r(a,t).allConsts)),a},t.ctxGetOptimizedConstsOrder=_r,t.isDebug=function(r){return r.contents.debug},t.isConst=G,t.isVar=C,t.isHyp=M,t.isAsrt=function(r,t){return s.isSome(w(r.contents,(function(r){return m.get(r.frames,t)})))},t.isDisj=function(r,t,n){return s.getWithDefault(w(r.contents,(function(r){if(N(r.disj,t,n))return!0})),!1)},t.getAllConsts=Y,t.getHypothesis=function(r,t){return w(r.contents,(function(r){return m.get(r.labelToHyp,t)}))},t.getHypByExpr=function(r,t){return w(r.contents,(function(r){var n=t.length,e=d.get(r.exprToHyp,n);if(void 0!==e){var o=n>0?t[0]:0,i=d.get(c.valFromOption(e),o);if(void 0!==i){var a=n>1?t[1]:0,u=d.get(c.valFromOption(i),a);return void 0!==u?u.find((function(r){return y(r.expr,t)})):void 0}}}))},t.getMandHyps=function(r,t,n,e){var o=void 0!==n&&n;return Z(r,Q(r,t,o,e),o,e)},t.getAllHyps=function(r){var t=[];return R(r,(function(r){t.push(r)})),v.fromArray(t.map((function(r){return[r.label,r]})))},t.getAllFrames=function(r){var t=[];return w(r.contents,(function(r){m.forEach(r.frames,(function(r,n){t.push([r,n])}))})),v.fromArray(t)},t.getAllFramesArr=function(r){var t=[];return w(r.contents,(function(r){p.spliceObjApply(t,"push",[m.valuesToArray(r.frames)])})),t},t.getAllDisj=function(r){var t=d.make(16);return w(r.contents,(function(r){d.forEach(r.disj,(function(r,n){l.forEach(n,(function(n){k(t,r,n)}))}))})),t},t.getLocalDisj=function(r){var t=d.make(16);return d.forEach(r.contents.disj,(function(r,n){l.forEach(n,(function(n){k(t,r,n)}))})),t},t.getFrame=P,t.getFrameExn=function(r,t){var n=P(r,t);if(void 0!==n)return n;throw{RE_EXN_ID:i.MmException,_1:{msg:"Could not find a frame by the label '"+t+"'"},Error:new Error}},t.frameIsAllowed=function(r,t){return!(r.isDisc&&!t.useDisc||r.isDepr&&!t.useDepr)&&(!r.isTranDepr||t.useTranDepr)},t.getLocalVars=function(r){return r.contents.vars.slice()},t.getLocalHyps=function(r){return r.contents.hyps.slice()},t.getNumOfVars=function(r){return r.contents.varsBaseIdx+r.contents.vars.length|0},t.forEachFrame=rr,t.forEachHypothesisInDeclarationOrder=R,t.getNestingLevel=function(r){return tr(r.contents)},t.findParentheses=function(r,t){for(var n,o=function(r,t,n){for(var e=!0,o=!1,i=!1,a=x.parenCntMake([t,n],!1),u="Balanced",s=r.length,f=0;f<s&&e;){for(var c=r[f],v=c.length,d=0;d<v&&e;){var l=c[d];o||l!==t||(o=!0),i||l!==n||(i=!0),e="Failed"!==(u=x.parenCntPut(a,l)),d=d+1|0}e="Balanced"===u,f=f+1|0}return!(!e||!o)&&i},i=function(r){var t=[];return rr(r,(function(r){r.hyps.forEach((function(r){"E"!==r.typ||t.push(r.expr)})),t.push(r.asrt)})),t}(r),u=(n=e.getSpaceSeparatedValuesAsArray('( ) [ ] { } [. ]. [_ ]_ <. >. <" "> << >> [s ]s (. ). (( ))').filter((function(t){return G(r,t)})),B(r,n)).concat(a.range(1,s.getExn(r.contents.root).consts.length-1|0).map((function(r){return 0|-r}))),f=u.length-2|0,c=E.progressTrackerMake(.01,void 0,t,void 0),v=[],d=0;d<=f;++d){var l=u[d],p=u[d+1|0];v.includes(l)||v.includes(p)||!o(i,l,p)||(v.push(l),v.push(p)),E.progressTrackerSetCurrPct(c,d/f)}return v},t.getTypeOfVar=K,t.getTypeOfVarExn=J,t.getTokenType=I,t.ctxSymToInt=F,t.ctxIntToSym=L,t.ctxSymToIntExn=V,t.ctxSymsToIntsExn=B,t.ctxStrToIntsExn=function(r,t){return B(r,e.getSpaceSeparatedValuesAsArray(t))},t.ctxIntToSymExn=W,t.ctxIntsToSymsExn=X,t.ctxIntsToStrExn=z,t.frmIntToSym=H,t.frmIntToSymExn=q,t.frmIntsToStrExn=function(r,t,n){return $(r,t,n).join(" ")},t.frmIntsToSymsExn=$,t.createFrame=lr,t.generateNewVarNames=function(r,t,n,e){for(var o=void 0!==n?c.valFromOption(n):void 0,i=m.make(v.size(o)),a=function(r){return s.getWithDefault(m.get(i,r),0)},u=function(r){m.set(i,r,a(r)+1|0)},f=t.length-1|0,d=[],l=0;l<=f;++l){var p=W(r,t[l]),g=v.getWithDefault(o,p,p);u(g);for(var E={contents:g+String(a(g))};s.isSome(I(r,E.contents))||s.getWithDefault(s.map(e,function(r){return function(t){return h.has(t,r.contents)}}(E)),!1);)u(g),E.contents=g+String(a(g));d.push(E.contents)}return d},t.generateNewLabels=function(r,t,n,e,o){for(var i=void 0!==o&&o,a=function(t){return!!(s.getWithDefault(s.map(e,(function(r){return h.has(r,t)})),!1)||!i&&s.isSome(I(r,t)))||!!i&&M(r,t)},u=n-1|0,f=0,c=[],v=0;v<=u;++v){f=f+1|0;for(var d=t+String(f);a(d);)f=f+1|0,d=t+String(f);c.push(d)}return c},t.disjMake=function(){return d.make(16)},t.disjAddPair=k,t.disjContains=N,t.disjImmContains=function(r,t,n){var e=t<=n?t:n,o=t<=n?n:t,i=u.get(r,e);return void 0!==i&&f.has(c.valFromOption(i),o)},t.disjToArr=j,t.disjForEachArr=function(r,t,n,e,o,i){j(r,void 0!==t&&t,n,e,o).forEach(i)},t.disjForEach=D,t.disjIsEmpty=function(r){return 0===d.size(r)},t.disjMutToDisjImm=function(r){return u.fromArray(d.toArray(r).map((function(r){return[r[0],f.fromArray(l.toArray(r[1]))]})))},t.disjGetAllVars=U,t.exprEq=y,t.ExprCmp=A,t.ExprHash=T},4792:(r,t,n)=>{var e=n(55);t.parenCntMake=function(r,t,n,o,i){if(r%2!=0)throw{RE_EXN_ID:e.MmException,_1:{msg:"mod(parenMin, 2)  != 0 in parenCntMake"},Error:new Error};return{stack:new Array(1e3),len:0,failed:!1,parenMin:r,canBeFirstMin:t,canBeFirstMax:n,canBeLastMin:o,canBeLastMax:i}},t.parenCntReset=function(r){r.len=0,r.failed=!1},t.parenCntPut=function(r,t){return r.failed?"Failed":r.parenMin<=t&&t<0?t%2==-1?(function(r,t){if(r.stack.length===r.len)for(var n=1;n<=1e3;++n)r.stack.push(0);r.stack[r.len]=t,r.len=r.len+1|0}(r,t),"Opened"):0===r.len||r.stack[r.len-1|0]!==(t+1|0)?(r.failed=!0,"Failed"):(r.len=r.len-1|0,0===r.len?"Balanced":"Opened"):0===r.len?"Balanced":"Opened"},t.parenCntCanBeFirst=function(r,t){return 0<=t||r.parenMin<t&&t%2==-1||r.canBeFirstMin<=t&&t<=r.canBeFirstMax},t.parenCntCanBeLast=function(r,t){return 0<=t||r.parenMin<=t&&t%2==0||r.canBeLastMin<=t&&t<=r.canBeLastMax}},9217:(r,t,n)=>{var e=n(55),o=n(2761),i=n(5047);t.parenCntMake=function(r,t){var n=void 0===t||t,i=r.length;if(i%2!=0)throw{RE_EXN_ID:e.MmException,_1:{msg:"mod(parenLen, 2)  != 0 in parenCntMake"},Error:new Error};if(0===i)return{min:0,parens:[],parentStack:[],failed:!1};for(var a=[],u=(i/2|0)-1|0,s=0;s<=u;++s){var f=r[s<<1],c=r[1+(s<<1)|0];a.push({code:f,isOpen:!0,opposite:c}),a.push({code:c,isOpen:!1,opposite:f})}var v=o.reduce(r,r[0],(function(r,t){return r<=t?r:t}));return n&&Math.abs(v)!==i&&console.log("Warning: parentheses are not optimized (this may slow down the unification process)."),{min:v,parens:a,parentStack:[],failed:!1}},t.parenCntReset=function(r){i.clearArray(r.parentStack),r.failed=!1},t.parenCntPut=function(r,t){if(!r.failed&&r.min<=t&&t<0){var n=r.parens.find((function(r){return r.code===t}));if(void 0!==n)if(n.isOpen)r.parentStack.push(n);else{var e=r.parentStack.pop();void 0!==e&&e.opposite===n.code||(r.failed=!0)}}return r.failed?"Failed":0===r.parentStack.length?"Balanced":"Opened"}},55:(r,t,n)=>{var e=n(6517),o=n(7175),i=n(6181),a=n(3533),u=n(368),s=n(7653),f=i.create("MM_parser.MmException");function c(r){return" "===r||"\t"===r||"\n"===r||"\r"===r}function v(r,t){var n=(t+20|0)<r.length?"...":"";return"'"+r.substr(t,20)+n+"'"}function d(r,t,n,e,o){return u.traverseTree(r,t,(function(r,t){var n=t.stmt;if("Block"===n.TAG)return n.statements}),n,e,o)}function l(r){return void 0!==r?"Uncompressed"===r.TAG?r.labels.join(" "):"( "+r.labels.join(" ")+" ) "+r.compressedProofBlock:"?"}function p(r){var t=r.stmt;switch(t.TAG){case"Comment":return"$( "+t.text+" $)";case"Const":return"$c "+t.symbols.join(" ")+" $.";case"Block":return"block(level="+String(t.level)+")";case"Var":return"$v "+t.symbols.join(" ")+" $.";case"Disj":return"$d "+t.vars.join(" ")+" $.";case"Floating":return t.label+" $f "+t.expr.join(" ")+" $.";case"Essential":return t.label+" $e "+t.expr.join(" ")+" $.";case"Axiom":return t.label+" $a "+t.expr.join(" ")+" $.";case"Provable":return t.label+" $p "+t.expr.join(" ")+" $= "+l(t.proof)+" $."}}t.MmException=f,t.parseMmFile=function(r,t,n,i){var u=void 0!==t&&t,d=void 0!==n&&n,l=void 0!==i?i:function(r){},p=r.length,m={contents:0},h={contents:!1},g={contents:""},E=s.progressTrackerMake(.1,void 0,l,!0),x=[],y=function(t){m.contents=t,m.contents>=p?(h.contents=!0,g.contents=""):(h.contents=!1,g.contents=r.charAt(m.contents))};y(0);var _=function(){if(!h.contents)return m.contents=m.contents+1|0,void(m.contents>=p?(h.contents=!0,g.contents=""):g.contents=r.charAt(m.contents))},b=function(t){for(var n,i=m.contents;e.isNone(n);){var a=r.indexOf(t,m.contents);if(a<0)n=o.some(void 0);else{var u=a+t.length|0;y(u),h.contents||c(g.contents)?n=o.some(r.substring(i,a)):y(a+1|0)}}return e.getExn(n)},A=function(t){var n=b("$)");if(void 0!==n)return{begin:t,end:m.contents-1|0,stmt:{TAG:"Comment",text:n}};throw{RE_EXN_ID:f,_1:{msg:"A comment is not closed at "+v(r,t)},Error:new Error}},T=function(t){if(void 0===t||t){for(var n=T(!1);"$("===n;)A(m.contents),n=T(!1);return n}!function(){for(;!h.contents&&c(g.contents);)_()}();for(var e=m.contents;!h.contents&&!c(g.contents);)_();return r.substring(e,m.contents)},k=function(r){for(var t,n=[];e.isNone(t);){var i=T(void 0);""===i?t=o.some(void 0):"$("===i?A(m.contents):i===r?t=o.some(n):n.push(i)}return e.getExn(t)},S=function(t){var n=k("$.");if(void 0!==n)return{begin:t,end:m.contents-1|0,stmt:{TAG:"Const",symbols:n}};throw{RE_EXN_ID:f,_1:{msg:"A constant statement is not closed at "+v(r,t)},Error:new Error}},w=function(t){var n=k("$.");if(void 0!==n)return{begin:t,end:m.contents-1|0,stmt:{TAG:"Var",symbols:n}};throw{RE_EXN_ID:f,_1:{msg:"A variable statement is not closed at "+v(r,t)},Error:new Error}},I=function(t){var n=k("$.");if(void 0!==n)return{begin:t,end:m.contents-1|0,stmt:{TAG:"Disj",vars:n}};throw{RE_EXN_ID:f,_1:{msg:"A disjoint statement is not closed at "+v(r,t)},Error:new Error}},G=function(t,n){var e=k("$.");if(void 0!==e)return{begin:t,end:m.contents-1|0,stmt:{TAG:"Floating",label:n,expr:e}};throw{RE_EXN_ID:f,_1:{msg:"A floating statement is not closed at "+v(r,t)},Error:new Error}},C=function(t,n){var e=k("$.");if(void 0!==e)return{begin:t,end:m.contents-1|0,stmt:{TAG:"Essential",label:n,expr:e}};throw{RE_EXN_ID:f,_1:{msg:"An essential statement is not closed at "+v(r,t)},Error:new Error}},M=function(t,n){var e=k("$.");if(void 0!==e)return{begin:t,end:m.contents-1|0,stmt:{TAG:"Axiom",label:n,expr:e}};throw{RE_EXN_ID:f,_1:{msg:"An axiom statement is not closed at "+v(r,t)},Error:new Error}},N=function(t,n){var e=k("$=");if(void 0!==e){var o=T(void 0);if("("===o){var i=k(")");if(void 0!==i){var u=k("$.");if(void 0!==u)return{begin:t,end:m.contents-1|0,stmt:{TAG:"Provable",label:n,expr:e,proof:d?void 0:{TAG:"Compressed",labels:i,compressedProofBlock:a.spliceObjApply("","concat",[u])}}};throw{RE_EXN_ID:f,_1:{msg:"A probale statement is not closed[3] at "+v(r,t)},Error:new Error}}throw{RE_EXN_ID:f,_1:{msg:"A provable statement is not closed[2] at "+v(r,t)},Error:new Error}}var s=k("$.");if(void 0!==s)return{begin:t,end:m.contents-1|0,stmt:{TAG:"Provable",label:n,expr:e,proof:d?void 0:{TAG:"Uncompressed",labels:[o].concat(s)}}};throw{RE_EXN_ID:f,_1:{msg:"A provable statement is not closed[4] at "+v(r,t)},Error:new Error}}throw{RE_EXN_ID:f,_1:{msg:"A provable statement is not closed[1] at "+v(r,t)},Error:new Error}},D=function(t,n){for(var o,i=[];e.isNone(o);){var a=T(!1),c=m.contents-a.length|0;if(""===a){if(0!==n)throw{RE_EXN_ID:f,_1:{msg:"Unexpected end of a block. The block begins at "+v(r,t)+" and is not closed."},Error:new Error};o={begin:t,end:m.contents-1|0,stmt:{TAG:"Block",level:n,statements:i}}}else if("$}"===a)o={begin:t,end:m.contents-1|0,stmt:{TAG:"Block",level:n,statements:i}};else if("${"===a){var d=D(c,n+1|0);i.push(d)}else if("$("===a){var l=A(c);u||i.push(l)}else if("$["===a)b("$]");else if("$c"===a){var h=S(c);i.push(h)}else if("$v"===a){var g=w(c);i.push(g)}else if("$d"===a){var y=I(c);i.push(y)}else{var _=T(void 0),k=m.contents-_.length|0;if(""===_)throw{RE_EXN_ID:f,_1:{msg:"Unexpected end of file at "+v(r,c)},Error:new Error};if("$f"===_){var U=G(c,a);i.push(U)}else if("$e"===_){var j=C(c,a);i.push(j)}else if("$a"===_){x.push(a);var O=M(c,a);i.push(O)}else{if("$p"!==_)throw{RE_EXN_ID:f,_1:{msg:"Unexpected token '"+_+"' at "+v(r,k)},Error:new Error};x.push(a);var P=N(c,a);i.push(P)}}s.progressTrackerSetCurrPct(E,c/p)}return e.getExn(o)};return[D(m.contents,0),x]},t.textAt=v,t.traverseAst=d,t.stmtToStr=p,t.stmtToStrRec=function(r){return d([{contents:0},[]],r,(function(r,t){var n=r[0],e=t.stmt;if("Block"===e.TAG){var o=e.level;0!==o&&r[1].push("    ".repeat(n.contents)+"${"),n.contents=o}}),(function(r,t){var n;""!==(n="Block"===t.stmt.TAG?"":p(t))&&r[1].push("    ".repeat(r[0].contents)+n)}),(function(r,t){var n=r[0],e=t.stmt;if("Block"===e.TAG){var o=e.level;n.contents=o-1|0,0!==o&&r[1].push("    ".repeat(n.contents)+"$}")}}))[0][1]},t.astToStr=function(r){var t=[];return d(void 0,r,(function(r,n){var e=n.stmt;"Block"===e.TAG&&e.level>0&&t.push("${")}),(function(r,n){var e=n.stmt;switch(e.TAG){case"Comment":t.push("$( "+e.text+" $)");break;case"Const":var o="$c "+e.symbols.join(" ")+" $.";t.push(o);break;case"Block":break;case"Var":var i="$v "+e.symbols.join(" ")+" $.";t.push(i);break;case"Disj":var a="$d "+e.vars.join(" ")+" $.";t.push(a);break;case"Floating":var u=e.label+" $f "+e.expr.join(" ")+" $.";t.push(u);break;case"Essential":var s=e.label+" $e "+e.expr.join(" ")+" $.";t.push(s);break;case"Axiom":var f=e.label+" $a "+e.expr.join(" ")+" $.";t.push(f);break;case"Provable":var c=e.label+" $p "+e.expr.join(" ")+" $= "+l(e.proof)+" $.";t.push(c)}}),(function(r,n){var e=n.stmt;"Block"===e.TAG&&e.level>0&&t.push("$}")})),t.join("\n")}},6134:(r,t,n)=>{var e=n(4923),o=n(55),i=n(5300),a=n(3333),u=n(6517),s=n(2761),f=n(7356),c=n(7659),v=n(368),d=n(9702),l=n(2275);function p(r,t,n){var e=r.length;return n<=e?r:r+t.repeat(n-e|0)}function m(r){return s.reduce(r.map((function(r){return r.length})),0,(function(r,t){return Math.max(r,t)}))}function h(r,t){var n=t.map((function(r){var t=r.proof;return"Hypothesis"===t.TAG?"":t.args.map((function(r){return r+1|0})).join(",")})),e=t.map((function(r){var t=r.proof;return t.TAG,t.label})),o=t.map((function(t){return a.ctxIntsToStrExn(r,t.expr)})),u=1+(i.Int.floor(Math.log10(t.length))+1|0)|0,s=m(n)+1|0,f=m(e)+1|0;return t.map((function(r,t){return i=String(t+1|0)," ",((a=u)<=(c=i.length)?i:" ".repeat(a-c|0)+i)+"| "+p(n[t]," ",s)+"| "+p(e[t]," ",f)+"| "+o[t];var i,a,c}))}function g(r,t,n){var e=h(r,t);return p("--- "+n+" ","-",m(e))+"\n"+e.join("\n")+"\n"+p("","-",m(e))}function E(r,t,n,e){var o=c.make(64);v.traverseTree(void 0,t,(function(t,n){var e=r[n].proof;return"Hypothesis"===e.TAG||c.has(o,n)?void 0:e.args}),void 0,void 0,(function(t,i){"Hypothesis"===r[i].proof.TAG?n(i):c.has(o,i)?e(i):(c.add(o,i),n(i))}))}t.createProof=function(r,t,n){if(t.length<=n)throw{RE_EXN_ID:o.MmException,_1:{msg:"tblLen <= rootIdx"},Error:new Error};var e=r.length,i=l.fromArray(r.map((function(r,t){return[r.label,t+1|0]}))),a=[],s=l.make(64),v=function(r,t){var n=c.make(64);return E(r,t,(function(r){}),(function(r){c.add(n,r)})),n}(t,n),p=f.make(64),m=[];E(t,n,(function(r){var n,o=t[r].proof;if(o.TAG,n=function(r){var t=l.get(i,r);if(void 0!==t)return t;var n=l.get(s,r);if(void 0!==n)return n;a.push(r);var o=e+a.length|0;return l.set(s,r,o),o}(o.label),m.push(n),c.has(v,r))return m.push(0),f.set(p,r,f.size(p)+1|0)}),(function(r){m.push(0|-u.getExn(f.get(p,r)))}));var h=e+a.length|0;return{TAG:"Compressed",labels:a,compressedProofBlock:m.map((function(r){return 0===r?"Z":r<0?d.intToCompressedProofStr(h-r|0):d.intToCompressedProofStr(r)})).join("")}},t.createProofTableFromProof=function(r,t){var n=void 0===t||t,i=f.make(d.proofNodeGetId(r)),s=[],c=function(r,t,n){s.push({expr:t,proof:n});var e=s.length-1|0;f.set(i,r,e)},l=function(r,t,v){if(u.isSome(f.get(i,r)))throw{RE_EXN_ID:o.MmException,_1:{msg:"getIdxByNodeId(nodeId)->Belt_Option.isSome in createProofTableFromProof()"},Error:new Error};if(!n)return c(r,t,v);var d=s.findIndex((function(r){return!!a.exprEq(r.expr,t)&&e.equal(r.proof,v)}));return-1!==d?f.set(i,r,d):c(r,t,v)};return v.traverseTree(void 0,r,(function(r,t){return"Hypothesis"===t.TAG?void 0:t.args}),void 0,void 0,(function(r,t){if("Hypothesis"===t.TAG){var n=t.id;u.isNone(f.get(i,n))&&l(n,t.expr,{TAG:"Hypothesis",label:t.hypLabel})}else{var e=t.id;u.isNone(f.get(i,e))&&l(e,t.expr,{TAG:"Assertion",args:t.args.map((function(r){var t=d.proofNodeGetId(r),n=f.get(i,t);if(void 0!==n)return n;throw{RE_EXN_ID:o.MmException,_1:{msg:"Could not determine idx by nodeId in createProofTableFromProof()."},Error:new Error}})),label:t.asrtLabel})}})),s},t.proofTableToArrStr=h,t.proofTableToStr=g,t.proofTablePrint=function(r,t,n){console.log(g(r,t,n))}},2423:(r,t,n)=>{var e=n(5291),o=n(55),i=n(3333),a=n(6517),u=n(2815),s=n(9775),f=n(5082),c=n(5650),v=n(2275),d=n(5047);function l(r){if("object"!=typeof r)return!0;switch(r.TAG){case"Hypothesis":return!0;case"Assertion":return r.args.every((function(r){return a.isSome(r.proof)}));case"AssertionWithErr":return!1}}function p(r){var t=r.pnDbg;return void 0!==t?t.exprStr:r.expr.map((function(r){return String(r)})).join(" ")}function m(r){var t=r.fParents,n=void 0!==t?t.find(l):void 0;return a.isSome(n)?n:r.eParents.find(l)}t.ptMake=function(r,t,n,e,o,c){var d=f.toArray(t);return{frms:r,hypsByExpr:u.fromArray(d.map((function(r){var t=r[1];return[t.expr,t]})),i.ExprHash),hypsByLabel:v.fromArray(d),ctxMaxVar:n,ctxDisj:e,maxVar:n,newVars:s.make(16,i.ExprHash),parenCnt:o,nextNodeId:0,nodes:u.make(128,i.ExprHash),rootStmts:[],syntaxProofs:u.make(128,i.ExprHash),ptDbg:a.map(c,(function(r){return{newVars:[],exprToStr:r}}))}},t.ptGetFrms=function(r){return r.frms},t.ptGetHypByExpr=function(r,t){return u.get(r.hypsByExpr,t)},t.ptGetHypByLabel=function(r,t){return v.get(r.hypsByLabel,t)},t.ptGetMaxVar=function(r){return r.maxVar},t.ptGetCtxMaxVar=function(r){return r.ctxMaxVar},t.ptGetParenCnt=function(r){return r.parenCnt},t.ptIsDisjInCtx=function(r,t,n){return i.disjContains(r.ctxDisj,t,n)},t.ptIsNewVarDef=function(r,t){return s.has(r.newVars,t)},t.ptGetRootStmts=function(r){return r.rootStmts},t.ptGetNode=function(r,t){var n=u.get(r.nodes,t);if(void 0!==n)return n;var e={id:r.nextNodeId,expr:t,fParents:void 0,eParents:[],children:[],proof:void 0,isInvalidFloating:!1,dist:void 0,pnDbg:a.map(r.ptDbg,(function(r){return{exprStr:r.exprToStr(t)}}))};return u.set(r.nodes,t,e),r.nextNodeId=r.nextNodeId+1|0,e},t.ptAddNewVar=function(r,t){r.maxVar=r.maxVar+1|0;var n=r.maxVar;s.add(r.newVars,[t,n]);var e=r.ptDbg;return void 0!==e&&e.newVars.push(e.exprToStr([t,n])),n},t.ptAddRootStmt=function(r,t){return void 0!==r.rootStmts.find((function(r){return i.exprEq(r.expr,t.expr)}))?void 0:void r.rootStmts.push(t)},t.ptAddSyntaxProof=function(r,t,n){u.set(r.syntaxProofs,t,n)},t.ptGetSyntaxProof=function(r,t){return u.get(r.syntaxProofs,t)},t.ptGetAllSyntaxProofs=function(r){return u.toArray(r.syntaxProofs)},t.ptClearDists=function(r){u.forEach(r.nodes,(function(r,t){t.dist=void 0}))},t.ptGetDbg=function(r){return r.ptDbg},t.ptGetCopyOfNewVars=function(r){return s.toArray(r.newVars)},t.ptGetCtxDisj=function(r){return r.ctxDisj},t.pnGetId=function(r){return r.id},t.pnGetExpr=function(r){return r.expr},t.pnGetProof=function(r){return r.proof},t.pnGetFParents=function(r){return r.fParents},t.pnGetEParents=function(r){return r.eParents},t.pnAddParent=function(r,t,n,e){if(a.isNone(r.proof)||e){var i,u=!1;if(n)i=r.eParents;else{var s=r.fParents;if(void 0!==s)i=s;else{var f=[t];r.fParents=f,u=!0,i=f}}if(!u){var v=i.find((function(r){if("object"!=typeof r)return"object"!=typeof t;switch(r.TAG){case"Hypothesis":return"object"==typeof t&&"Hypothesis"===t.TAG&&r.label===t.label;case"Assertion":var n=r.args;if("object"!=typeof t)return!1;if("Assertion"!==t.TAG)return!1;var e=t.args;return r.frame.label===t.frame.label&&n.length===e.length&&n.every((function(r,t){return r.id===e[t].id}));case"AssertionWithErr":return!1}}));if(void 0!==v){if(l(v))throw{RE_EXN_ID:o.MmException,_1:{msg:"Unexpected: an unproved node '"+p(r)+"' has a proved parent."},Error:new Error}}else i.push(t),u=!0}if(u)return"object"==typeof t&&"Assertion"===t.TAG&&t.args.forEach((function(t){if(t.id!==r.id)return void 0!==t.children.find((function(t){return t.id===r.id}))?void 0:void t.children.push(r)})),l(t)?(function(r){if(a.isNone(r.proof)){var t=m(r);if(void 0!==t){r.proof=t;for(var n=c.fromArray(r.children);!c.isEmpty(n);){var e=a.getExn(c.pop(n));if(a.isNone(e.proof)){var o=m(e);void 0!==o&&(e.proof=o,e.children.forEach((function(r){c.add(n,r)})))}}}}}(r),e?void(r.proof=t):void 0):void 0}},t.pnIsInvalidFloating=function(r){return r.isInvalidFloating},t.pnSetInvalidFloating=function(r){r.isInvalidFloating=!0},t.pnGetDist=function(r){return r.dist},t.pnSetDist=function(r,t){r.dist=t},t.pnGetDbg=function(r){return r.pnDbg},t.jstfEqSrc=function(r,t,n){if("object"!=typeof n)return!1;if("Assertion"!==n.TAG)return!1;var e=n.frame;if(t!==e.label)return!1;var o=n.args,a=r.length,u=e.hyps.length;if(a>u)return!1;for(var s=0,f=0,c=!0;c&&s<a&&f<u;)"F"===e.hyps[f].typ||(c=i.exprEq(r[s],o[f].expr),s=s+1|0),f=f+1|0;for(;c&&f<u;)"F"===e.hyps[f].typ?f=f+1|0:c=!1;return!(!c||s!==a)&&f===u},t.ptPrintStats=function(r){var t=u.toArray(r.nodes).map((function(r){return r[1]})),n=t.length;console.log("nodeCnt",n);var o=t.filter((function(r){return a.isSome(r.proof)})).length;console.log("provedNodeCnt",o,e.floatToPctStr(o/n));var i=t.filter((function(r){return r.isInvalidFloating})).length;console.log("invalidFloatingCnt",i,e.floatToPctStr(i/n));var s=r.ptDbg;if(void 0===s)return"Debug is off";var f=t.filter((function(r){return!!a.isNone(r.proof)&&!r.isInvalidFloating}));return d.sortInPlaceWith(f,(function(r,t){return r.expr.length-t.expr.length|0})),f.map((function(r){return r.expr})).map(s.exprToStr).join("\n")}},1717:(r,t,n)=>{var e=n(55),o=n(3333),i=n(6517),a=n(2815),u=n(9775),s=n(2423),f=n(368),c=n(6601);function v(r,t){var n=function(r){var n=a.get(t,s.pnGetExpr(r));if(void 0!==n)return n;throw{RE_EXN_ID:e.MmException,_1:{msg:"exprSrcToDto: cannot get idx by expr."},Error:new Error}};if("object"!=typeof r)return"VarType";switch(r.TAG){case"Hypothesis":return{TAG:"Hypothesis",label:r.label};case"Assertion":return{TAG:"Assertion",args:r.args.map(n),label:r.frame.label};case"AssertionWithErr":return{TAG:"AssertionWithErr",args:r.args.map(n),label:r.frame.label,err:r.err}}}function d(r,t,n){return s.ptGetAllSyntaxProofs(r).map((function(r){var o,i=a.get(t,s.pnGetExpr(r[1]));if(void 0===i)throw{RE_EXN_ID:e.MmException,_1:{msg:"Could not convert proofNode to proofNodeDto for a syntax proof."},Error:new Error};return o=n[i],[r[0],o]}))}t.proofTreeToDto=function(r,t){var n=function(r,t){var n=c.make();s.ptGetAllSyntaxProofs(r).forEach((function(r){c.push(n,r[1])})),t.forEach((function(t){c.push(n,s.ptGetNode(r,t))}));for(var e=u.make(100,o.ExprHash),f=a.make(100,o.ExprHash),v=function(r){"object"==typeof r&&"Hypothesis"!==r.TAG&&r.args.forEach((function(r){c.push(n,r)}))};!c.isEmpty(n);){var d=i.getExn(c.pop(n)),l=s.pnGetExpr(d);u.has(e,l)||(u.add(e,l),a.set(f,l,a.size(f)),s.pnGetEParents(d).forEach(v),i.forEach(s.pnGetProof(d),v))}return f}(r,t),e=new Array(a.size(n));return a.forEach(n,(function(t,o){e[o]=function(r,t){return{expr:s.pnGetExpr(r),parents:s.pnGetEParents(r).map((function(r){return v(r,t)})),proof:i.map(s.pnGetProof(r),(function(r){return v(r,t)})),dbg:i.map(s.pnGetDbg(r),(function(r){return{exprStr:r.exprStr}}))}}(s.ptGetNode(r,t),n)})),{newVars:s.ptGetCopyOfNewVars(r),nodes:e,syntaxProofs:d(r,n,e),dbg:i.map(s.ptGetDbg(r),(function(r){return{newVars:r.newVars}}))}},t.createProofTable=function(r,t,n,u){var s=void 0!==n&&n;if(s&&i.isNone(u))throw{RE_EXN_ID:e.MmException,_1:{msg:"Error in createProofTable: ctx must be set when essentialsOnly == true."},Error:new Error};var c=function(r,t){if(!(s&&r.length>0))return r;var n=[];return o.getFrameExn(i.getExn(u),t).hyps.forEach((function(t,e){"E"!==t.typ||n.push(r[e])})),n},v=a.make(64,o.ExprHash),d=[],l=function(r,t){if(i.isSome(a.get(v,r)))throw{RE_EXN_ID:e.MmException,_1:{msg:"getIdxByExpr(expr)->Belt_Option.isSome in createProofTable()."},Error:new Error};d.push({expr:r,proof:t});var n=d.length-1|0;a.set(v,r,n)};return f.traverseTree(void 0,t,(function(t,n){var o=n.proof;if(void 0===o)throw{RE_EXN_ID:e.MmException,_1:{msg:"Cannot create proofTable from an unproved proofNodeDto [1]."},Error:new Error};if("object"!=typeof o)throw{RE_EXN_ID:e.MmException,_1:{msg:"VarType is not supported in createProofTable [1]."},Error:new Error};switch(o.TAG){case"Hypothesis":return;case"Assertion":return c(o.args,o.label).map((function(t){return r.nodes[t]}));case"AssertionWithErr":throw{RE_EXN_ID:e.MmException,_1:{msg:"AssertionWithErr is not supported in createProofTable [1]."},Error:new Error}}}),void 0,void 0,(function(t,n){var o=n.proof;if(void 0===o)throw{RE_EXN_ID:e.MmException,_1:{msg:"Cannot create proofTable from an unproved proofNodeDto [2]."},Error:new Error};if("object"!=typeof o)throw{RE_EXN_ID:e.MmException,_1:{msg:"VarType is not supported in createProofTable [2]."},Error:new Error};switch(o.TAG){case"Hypothesis":i.isNone(a.get(v,n.expr))&&l(n.expr,{TAG:"Hypothesis",label:o.label});break;case"Assertion":var u=o.label;i.isNone(a.get(v,n.expr))&&l(n.expr,{TAG:"Assertion",args:c(o.args,u).map((function(t){var n=r.nodes[t].expr,o=a.get(v,n);if(void 0!==o)return o;throw{RE_EXN_ID:e.MmException,_1:{msg:"Could not determine idx by expr in createProofTable()."},Error:new Error}})),label:u});break;case"AssertionWithErr":throw{RE_EXN_ID:e.MmException,_1:{msg:"AssertionWithErr is not supported in createProofTable [2]."},Error:new Error}}})),d}},9702:(r,t,n)=>{var e=n(4923),o=n(55),i=n(2971),a=n(3333),u=n(1094),s=n(6517),f=n(303),c=n(5047),v=n(1725);function d(r){return r.TAG,r.expr}function l(r,t){return d(r.nodes[t])}function p(r,t,n,o,i){var a=t,u=o,s=r.length,f=n.length;if(s<(t+i|0)||f<(o+i|0))return!1;for(var c=(t+i|0)-1|0;a<=c&&e.equal(r[a],n[u]);)u=u+1|0,a=a+1|0;return a>c}var m=s.getExn("Z".codePointAt(0)),h=s.getExn("A".codePointAt(0)),g=h-1|0,E=s.getExn("T".codePointAt(0)),x=s.getExn("U".codePointAt(0)),y=x-1|0;function _(r){for(var t=r.length,n=[],e=0,o=0;o<t;){var i=s.getExn(r.codePointAt(o));i===m?(n.push("Z"),e=o=o+1|0):h<=i&&i<=E?(n.push(r.substring(e,o+1|0)),e=o=o+1|0):o=o+1|0}return n}function b(r){return r<=E?r-g|0:r-y|0}function A(r){for(var t=0,n=1,e=r.length,o=e-2|0;o>=0;--o)t=t+Math.imul(n,b(s.getExn(r.codePointAt(o))))|0,n=Math.imul(n,5);return Math.imul(t,20)+b(s.getExn(r.codePointAt(e-1|0)))|0}function T(r,t,n){var e={contents:void 0};return u.forEach(t,(function(t,o){if(s.isNone(e.contents))return f.forEach(o,(function(o){if(s.isNone(e.contents))for(var i=r[t],a=i.length-1|0,u=r[o],f=u.length-1|0,c=1;c<=a;++c)if(s.isNone(e.contents)){var v=i[c];if(v>=0)for(var d=1;d<=f;++d)if(s.isNone(e.contents)){var l=u[d];l>=0&&(v===l?e.contents={TAG:"DisjCommonVar",frmVar1:t,expr1:i.slice(1,a+1|0),frmVar2:o,expr2:u.slice(1,f+1|0),commonVar:v}:n(v,l)||(e.contents={TAG:"Disj",frmVar1:t,expr1:i.slice(1,a+1|0),var1:v,frmVar2:o,expr2:u.slice(1,f+1|0),var2:l}))}}}))})),e.contents}function k(r,t,n,e){var u=r.nodes.length;if(u<t.numOfArgs)throw{RE_EXN_ID:o.MmException,_1:{msg:"stackLength < numOfArgs"},Error:new Error};var s=function(r,t){var n=new Array(t.numOfVars),e=i.make(t.numOfVars,!1),a=r.nodes.length-t.numOfArgs|0;if(t.hyps.forEach((function(t,i){if("F"===t.typ){var u=t.expr[0],s=t.expr[1];if(e[s])throw{RE_EXN_ID:o.MmException,_1:{msg:"subsLock[v]"},Error:new Error};var f=l(r,a+i|0);if(f.length<2)throw{RE_EXN_ID:o.MmException,_1:{msg:"subsExpr->Array.length < 2"},Error:new Error};if(f[0]!==u)throw{RE_EXN_ID:o.MmException,_1:{msg:"subsExpr[0] != t"},Error:new Error};e[s]=!0,n[s]=f}})),e.some((function(r){return!r})))throw{RE_EXN_ID:o.MmException,_1:{msg:"subsLock->Array.some(lock => !lock)"},Error:new Error};return n}(r,t),f=T(s,t.disj,e);if(void 0!==f){var d=v.unifErrToStr(f,(function(r){return a.ctxIntsToStrExn(n,r)}),(function(r){return a.frmIntsToStrExn(n,t,r)}));throw{RE_EXN_ID:o.MmException,_1:{msg:"Disjoint verification failed: "+d},Error:new Error}}!function(r,t,n){var e=r.nodes.length-t.numOfArgs|0;t.hyps.forEach((function(t,i){if("E"===t.typ&&!function(r,t,n){for(var e=0,o=0,i=!0,a=r.length,u=n.length;i&&e<a&&o<u;){var s=r[e];if(s<0)i=s===n[o],o=o+1|0;else{var f=t[s],c=f.length-1|0;i=p(f,1,n,o,c),o=o+c|0}e=e+1|0}return!(!i||e!==a)&&o===u}(t.expr,n,l(r,e+i|0)))throw{RE_EXN_ID:o.MmException,_1:{msg:"!compareExprAfterSubstitution(ess, subs, stack->stGetExpr(baseIdx+i))"},Error:new Error}}))}(r,t,s);var m=function(r,t){var n={contents:0};r.forEach((function(r){n.contents=r<0?n.contents+1|0:(n.contents+t[r].length|0)-1|0}));for(var e=new Array(n.contents),o=0,i=0;i<n.contents;){var a=r[o];if(a<0)e[i]=a,i=i+1|0;else{var u=t[a],s=u.length-1|0;c.copySubArray(u,1,e,i,s),i=i+s|0}o=o+1|0}return e}(t.asrt,s),h={TAG:"Calculated",id:r.nextId,args:r.nodes.slice(u-t.numOfArgs|0),asrtLabel:t.label,expr:m,dbg:a.isDebug(n)?{exprStr:a.ctxIntsToStrExn(n,m)}:void 0};r.nextId=r.nextId+1|0;for(var g=1,E=t.numOfArgs;g<=E;++g)r.nodes.pop();r.nodes.push(h)}t.proofNodeGetId=function(r){return r.id},t.proofNodeGetExpr=d,t.verifyProof=function(r,t,n,e){var u,s={nextId:0,nodes:[]};if("Uncompressed"===n.TAG?function(r,t,n,e){n.forEach((function(n){var i=a.getHypothesis(r,n);if(void 0!==i)return t.nodes.push({TAG:"Hypothesis",id:t.nextId,hypLabel:i.label,expr:i.expr,dbg:a.isDebug(r)?{exprStr:a.ctxIntsToStrExn(r,i.expr)}:void 0}),void(t.nextId=t.nextId+1|0);var u=a.getFrame(r,n);if(void 0!==u)return k(t,u,r,e);throw{RE_EXN_ID:o.MmException,_1:{msg:"The proof step '"+n+"' doesn't refer to a hypothesis or assertion (in uncompressed proof)."},Error:new Error}}))}(r,s,n.labels,e):function(r,t,n,e,u,s){var f=function(r){e.nodes.push({TAG:"Hypothesis",id:e.nextId,hypLabel:r.label,expr:r.expr,dbg:a.isDebug(n)?{exprStr:a.ctxIntsToStrExn(n,r.expr)}:void 0}),e.nextId=e.nextId+1|0},c=_(t),v=a.getMandHyps(n,r,void 0,void 0),d=v.length,l=d+s.length|0,p=[];i.forEach(c,(function(r){if("Z"!==r){var t=A(r);if(t<1)throw{RE_EXN_ID:o.MmException,_1:{msg:"Unexpected condition when applying compressed proof: i < 1."},Error:new Error};if(t<=d)return f(v[t-1|0]);if(t<=l){var c=s[(t-d|0)-1|0],m=a.getHypothesis(n,c);if(void 0!==m)return f(m);var h=a.getFrame(n,c);if(void 0!==h)return k(e,h,n,u);throw{RE_EXN_ID:o.MmException,_1:{msg:"The proof step '"+c+"' doesn't refer to a hypothesis or assertion (in compressed proof)."},Error:new Error}}var g=i.get(p,(t-l|0)-1|0);if(void 0===g)throw{RE_EXN_ID:o.MmException,_1:{msg:"Compressed proof refers to a saved step by the index which is out of bounds."},Error:new Error};e.nodes.push(g)}else{var E=e.nodes.length;if(0===E)throw{RE_EXN_ID:o.MmException,_1:{msg:"Cannot execute 'Z' command because the stack is empty."},Error:new Error};p.push(e.nodes[E-1|0])}}))}(t,n.compressedProofBlock,r,s,e,n.labels),1!==s.nodes.length)throw{RE_EXN_ID:o.MmException,_1:{msg:"stack->Array.length is "+String(s.nodes.length)+" but must be 1."},Error:new Error};if(!a.exprEq(l(s,0),t))throw{RE_EXN_ID:o.MmException,_1:{msg:"stack[0] != expr\nstack[0] is '"+(u=l(s,0),a.ctxIntsToStrExn(r,u)+"'\nexpr is     '"+function(t){return a.ctxIntsToStrExn(r,t)}(t)+"'")},Error:new Error};return s.nodes[0]},t.compressedProofBlockToArray=_,t.compressedProofStrToInt=A,t.intToCompressedProofStr=function(r){if(r<1)throw{RE_EXN_ID:o.MmException,_1:{msg:"intToCompressedProofStr: i < 1"},Error:new Error};for(var t=[String.fromCharCode(h+(r-1|0)%20|0)],n=(r-1|0)/20|0;n>0;)t.push(String.fromCharCode(x+(n-1|0)%5|0)),n=(n-1|0)/5|0;return t.reverse(),t.join("")},t.verifyDisjoints=T},9592:(r,t,n)=>{var e=n(5291),o=n(4923),i=n(55),a=n(2971),u=n(3333),s=n(6517),f=n(7175),c=n(6705),v=n(2423),d=n(5082),l=n(7659),p=n(4792),m=n(1874),h=n(5650),g=n(5981),E=n(5047),x=n(7653),y=n(3053);function _(r){switch(r){case"Less":return"Less";case"LessEq":return"LessEq";case"No":return"No";default:return}}function b(r,t){if(v.ptIsNewVarDef(r,t))return"VarType";var n=v.ptGetHypByExpr(r,t);return void 0!==n?{TAG:"Hypothesis",label:n.label}:void 0}function A(r,t,n,e,o){var a=t.length;m.frmsForEach(v.ptGetFrms(r),t[0],(function(f){if(u.frameIsAllowed(f.frame,e)){var c=f.frame.asrt;m.iterateSubstitutions(c,t,f.frmConstParts[f.numOfHypsE],f.constParts[f.numOfHypsE],f.varGroups[f.numOfHypsE],f.subs,v.ptGetParenCnt(r),(function(t){if(t.isDefined.every((function(r){return r}))&&s.isNone(m.verifyDisjoints(f.frame.disj,t,(function(t,n){return v.ptIsDisjInCtx(r,t,n)}),0))){for(var e=f.frame.hyps,u=e.length,c=new Array(u),d=!0,l=0,p=u-1|0;l<=p&&d;){var h,g=m.applySubs(e[l].expr,t,(function(r){throw{RE_EXN_ID:i.MmException,_1:{msg:"Work variables are not supported in findAsrtParentsWithoutNewVars()."},Error:new Error}}));switch(n){case"No":h=!0;break;case"LessEq":h=g.length<=a;break;case"Less":h=g.length<a}if(d=h){var E=v.ptGetNode(r,g);c[l]=E,d=!v.pnIsInvalidFloating(E)}l=l+1|0}d&&o({TAG:"Assertion",args:c,frame:f.frame})}return"Continue"}))}}))}function T(r,t,n,o){if(s.isNone(v.pnGetProof(t))&&!v.pnIsInvalidFloating(t)){e.arrayQueueReset(o);var i=l.make(128),a=function(r){if(void 0===v.pnGetProof(r)){var t=v.pnGetId(r);return l.has(i,t)?void 0:(l.add(i,t),e.arrayQueueAdd(o,r))}},u=function(r){"object"==typeof r&&"Assertion"===r.TAG&&r.args.forEach(a)},f=function(){for(var r=e.arrayQueuePop(o);s.mapWithDefault(r,!1,(function(r){return!!s.isSome(v.pnGetProof(r))||v.pnIsInvalidFloating(r)}));)r=e.arrayQueuePop(o);return r};a(t);for(var c={contents:!1},d=f();s.isNone(v.pnGetProof(t))&&s.isSome(d);){var p=s.getExn(d),m=v.pnGetFParents(p);if(void 0!==m)m.forEach(u);else{var h=v.pnGetExpr(p),g=b(r,h);void 0!==g?v.pnAddParent(p,g,!1,!1):(c.contents=!1,A(r,h,"LessEq",n,function(r){return function(t){v.pnAddParent(r,t,!1,!1),u(t),c.contents=!0}}(p)),c.contents||v.pnSetInvalidFloating(p))}d=f()}return s.isNone(v.pnGetProof(t))?v.pnSetInvalidFloating(t):void 0}}function k(r,t,n,o,a,f,d,l,p,h,E,x,y){var _=void 0!==E?E:0,b=e.arrayQueueMake(1e3),A=[],k=s.isSome(x),S=s.getWithDefault(x,0),w=v.ptGetMaxVar(r);c.applyAssertions(w,v.ptGetFrms(r),l,(function(r){return u.frameIsAllowed(r,p.inEssen)}),(function(t,n){return v.ptIsDisjInCtx(r,t,n)}),n,o,a,f,t,v.ptGetParenCnt(r),d,h,(function(r){A.push(r);var t=A.length;return void 0!==y&&t%100==0&&y(t),k&&t>=S?"Stop":"Continue"}),_,void 0);var I=[];return A.forEach((function(t){var n=t.frame,e=t.err,o=0;if(void 0!==e&&"object"==typeof e)switch(e.TAG){case"NoUnifForAsrt":case"NoUnifForArg":case"NewVarsAreDisabled":o=1;break;case"TooManyCombinations":return void I.push({TAG:"AssertionWithErr",args:[],frame:n,err:s.getExn(t.err)});default:o=2}else o=2;switch(o){case 1:return 0!==_?void I.push({TAG:"AssertionWithErr",args:[],frame:n,err:s.getExn(t.err)}):void 0;case 2:var a=g.make();t.newVars.forEach((function(n,e){var o=t.newVarTypes[e],i=v.ptAddNewVar(r,o);g.set(a,n,i)}));for(var u,f=n.hyps.length,c=new Array(f),d=0,l=f-1|0;d<=l&&(s.isNone(u)||0!==_);){for(var h=m.applySubs(n.hyps[d].expr,t.subs,(function(r){throw{RE_EXN_ID:i.MmException,_1:{msg:"New work variables are not expected here [findAsrtParentsWithNewVars]."},Error:new Error}})),E=h.length-1|0,x=0;x<=E;++x){var y=h[x];if(y>w){var A,k=g.get(a,y);if(void 0===k)throw{RE_EXN_ID:i.MmException,_1:{msg:"Could not replace an applVar with a treeVar."},Error:new Error};A=k,h[x]=A}}var S=v.ptGetNode(r,h);c[d]=S,"F"===n.hyps[d].typ&&s.isNone(t.err)&&s.isNone(u)&&(T(r,S,p.inSyntax,b),s.isNone(v.pnGetProof(S))&&(u=v.pnGetExpr(S))),d=d+1|0}var G=void 0!==t.err?t.err:s.map(u,(function(r){return{TAG:"UnprovedFloating",expr:r}}));return void 0!==G?0!==_?void I.push({TAG:"AssertionWithErr",args:c,frame:n,err:G}):void 0:void I.push({TAG:"Assertion",args:c,frame:n})}})),I}function S(r,t){return"object"==typeof t&&"Assertion"===t.TAG&&t.args.some((function(t){return u.exprEq(r,v.pnGetExpr(t))}))}function w(r,t,n){return void 0!==r?r<=t&&(void 0===n||t<=n):void 0===n||t<=n}function I(r,t,n){return void 0===t||t.some((function(t){if(!t.matchAsrt)return!0;var e=t.frm;if(r[0]!==e.frame.asrt[0])return!1;var o={contents:!1};return m.iterateSubstitutions(e.frame.asrt,r,e.frmConstParts[e.numOfHypsE],e.constParts[e.numOfHypsE],e.varGroups[e.numOfHypsE],e.subs,n,(function(r){return o.contents=!0,"Stop"})),o.contents}))}function G(r,t,n,e,o,u,c,d){void 0!==e?function(r,t,n,e,o,u,f){(function(r,t,n,e,o){var a=h.make(),u=String(e),f=x.progressTrackerMake(.01,void 0,(function(r){}),void 0);v.ptClearDists(r);var c=v.ptGetNode(r,t);v.pnSetDist(c,0),h.add(a,c);for(var d=0,l=1,p=0,m=s.map(o,(function(r){return function(t){r("Proving bottom-up: 0/"+u+" "+String(t))}}));s.isNone(v.pnGetProof(c))&&!h.isEmpty(a);){var g=s.getExn(h.pop(a));if(s.isNone(v.pnGetProof(g))){var E,y=v.pnGetDist(g);if(void 0===y)throw{RE_EXN_ID:i.MmException,_1:{msg:"Encountered a node without dist."},Error:new Error};if(E=y,void 0!==o){if(d!==E){m=void 0,d=E;var _=String(E);f=x.progressTrackerMake(.01,void 0,function(r){return function(t){var n=String(0|Math.round(100*t));o("Proving bottom-up: "+r+"/"+u+" "+n+"%")}}(_),void 0),l=h.size(a)+1|0,p=0}x.progressTrackerSetCurrPct(f,p/l),p=p+1|0}var A=v.pnGetExpr(g),T=b(r,A);if(void 0!==T)v.pnAddParent(g,T,!0,!1);else{var k=E+1|0;k<=e&&n(A,E,m).forEach(function(r,t,n){return function(e){S(t,e)||(v.pnAddParent(r,e,!0,!1),"object"==typeof e&&"Assertion"===e.TAG&&e.args.forEach((function(r){if(s.isNone(v.pnGetProof(r))&&s.isNone(v.pnGetDist(r)))return v.pnSetDist(r,n),h.add(a,r)})))}}(g,A,k))}}}})(r,t,(function(t,i,s){for(var f=[],c=0,d=n.frameParams.length;c<d;++c){var l=n.frameParams[c];if(w(l.minDist,i,l.maxDist)&&I(t,l.matches,v.ptGetParenCnt(r))){var p,m=k(r,t,l.args,!1,l.allowNewStmts,l.allowNewVars,l.allowNewDisjForExistingVars,l.frmsToUse,e,o,u,l.maxNumberOfBranches,s),h=0;switch(l.lengthRestrict){case"No":p=m;break;case"LessEq":case"Less":h=1}if(1===h){var g=t.length;p=m.filter(function(r,t){return function(n){if("object"!=typeof n)return!0;if("Assertion"!==n.TAG)return!0;for(var e=n.frame,o=n.args,i=!0,a=e.hyps.length-1|0,u=0;u<=a&&i;){var s=o[u];if("E"===e.hyps[u].typ){var f;switch(r.lengthRestrict){case"No":f=!0;break;case"LessEq":f=v.pnGetExpr(s).length<=t;break;case"Less":f=v.pnGetExpr(s).length<t}i=f}u=u+1|0}return i}}(l,g))}var E=l.matches,x=void 0!==E?p.filter(function(n){return function(e){return n.some((function(n){return y.exprSrcMatches(t,e,n,v.ptGetParenCnt(r))}))}}(E)):p;f.push(x)}}return a.concatMany(f)}),n.maxSearchDepth,f),v.ptGetNode(r,t)}(r,t,e,o,u,c,d):void 0!==n?function(r,t,n,e,o){var i=function(i,a){return k(r,t,i,!0,!1,!1,!1,[n.label],e,o,a,void 0,void 0)},a=v.ptGetNode(r,t),u=function(r,t){var n=t.args.map((function(t){var n=v.ptGetRootStmts(r).find((function(r){return r.label===t}));if(void 0!==n)return n.expr;var e=v.ptGetHypByLabel(r,t);return void 0!==e?e.expr:void 0})).filter(s.isSome).map(s.getExn);if(n.length===t.args.length)return n}(r,n);void 0!==u&&s.getWithDefault(s.map(v.pnGetProof(a),(function(r){return!v.jstfEqSrc(u,n.label,r)})),!0)&&(E.arrForEach(i(u,0),(function(r){var t=v.jstfEqSrc(u,n.label,r);if(v.pnAddParent(a,r,!0,t),t)return f.some(void 0)})),s.isNone(v.pnGetProof(a))&&E.arrForEach(i(u,2),(function(r){var t=v.jstfEqSrc(u,n.label,r);if(v.pnAddParent(a,r,!0,t),t)return f.some(void 0)})))}(r,t,n,o,u):function(r,t,n,e){var o=v.ptGetNode(r,t);if(s.isNone(v.pnGetProof(o))){var i=k(r,t,v.ptGetRootStmts(r).map((function(r){return r.expr})),!1,!1,!1,!1,void 0,n,e,void 0,void 0,void 0);E.arrForEach(i,(function(r){return v.pnAddParent(o,r,!0,!1),v.pnGetProof(o)}))}}(r,t,o,u)}function C(r,t,n){var e=u.getNumOfVars(r)-1|0,o=u.getAllHyps(r),i=v.ptMake(t,o,e,u.getAllDisj(r),n,function(r,t){if(u.isDebug(r)){var n=function(n){return n<=t?u.ctxIntToSymExn(r,n):"&"+String(n)};return function(r){return r.map(n).join(" ")}}}(r,e));return d.forEach(o,(function(r,t){if("E"===t.typ){var n=v.ptGetNode(i,t.expr);v.pnAddParent(n,{TAG:"Hypothesis",label:r},!0,!1),v.ptAddRootStmt(i,{isHyp:!0,label:r,expr:t.expr,jstf:void 0})}})),i}function M(r,t,n,o,a,u,c,d){if(s.isNone(r)&&(s.isNone(t)||s.isNone(n)||s.isNone(a)))throw{RE_EXN_ID:i.MmException,_1:{msg:"Either proofTree or (wrkCtx and frms and parenCnt) should be passed."},Error:new Error};var l=x.progressTrackerMake(.01,void 0,d,void 0),p=void 0!==r?f.valFromOption(r):C(s.getExn(t),s.getExn(n),s.getExn(a));if(0===c.length)return p;for(var m=e.arrayQueueMake(1e3),h=c[0],g=0,E=u.length;g<E;++g){var y=u[g],_=v.ptGetNode(p,[h].concat(y));T(p,_,o,m);for(var b=0;s.isNone(v.pnGetProof(_))&&b<c.length;){var A=c[b];b=b+1|0,A!==h&&T(p,_=v.ptGetNode(p,[A].concat(y)),o,m)}void 0!==v.pnGetProof(_)&&(v.ptAddSyntaxProof(p,y,_),h=v.pnGetExpr(_)[0]),x.progressTrackerSetCurrPct(l,(g+1|0)/u.length)}return p}function N(r,t){var n=u.createContext(f.some(r),void 0);return t.forEach((function(t){if(t.isHyp)return u.applySingleStmt(n,{TAG:"Essential",label:t.label,expr:u.ctxIntsToSymsExn(r,t.expr)},void 0,void 0,void 0,void 0)})),n}function D(r,t,n){return r.slice(t,n).sort()}function U(r,t,n,e){return o.equal(D(r,n,e),D(t,n,e))}t.bottomUpProverParamsMakeDefault=function(r,t,n,e,o,i,a,u,f){var c=void 0!==n?n:"Less",v=void 0===e||e,d=void 0===o||o,l=void 0!==i&&i,p=void 0!==a?a:[],m=void 0!==u?u:[];return{maxSearchDepth:void 0!==t?t:4,frameParams:[{minDist:0,maxDist:0,frmsToUse:s.map(r,(function(r){return[r]})),matches:void 0,args:p,allowNewDisjForExistingVars:v,allowNewStmts:d,allowNewVars:l,lengthRestrict:"No",maxNumberOfBranches:f},{minDist:1,maxDist:void 0,frmsToUse:void 0,matches:void 0,args:m,allowNewDisjForExistingVars:v,allowNewStmts:d,allowNewVars:!1,lengthRestrict:c,maxNumberOfBranches:f}]}},t.lengthRestrictToStr=function(r){switch(r){case"No":return"No";case"LessEq":return"LessEq";case"Less":return"Less"}},t.lengthRestrictFromStr=_,t.lengthRestrictFromStrExn=function(r){var t=_(r);if(void 0!==t)return t;throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot convert '"+r+"' to lengthRestrict."},Error:new Error}},t.createProofCtx=N,t.proveFloatings=function(r,t,n,o,i){var a=C(r,t,i),u=e.arrayQueueMake(1e3);return o.forEach((function(r){T(a,v.ptGetNode(a,r),n,u)})),a},t.proveSyntaxTypes=M,t.unifyAll=function(r,t,n,o,i,a,u,c,d,l,p){var m=void 0!==l?l:0,h=x.progressTrackerMake(.01,void 0,s.map(p,(function(r){return function(t){r("Unifying all: "+e.floatToPctStr(t))}})),void 0),g=C(N(r,n),t,o);void 0!==c&&c.length>0&&void 0!==d&&M(f.some(g),void 0,void 0,a.inSyntax,void 0,d,c,s.map(p,(function(r){return function(t){r("Checking syntax: "+e.floatToPctStr(t))}})));var E=n.filter((function(r){return!r.isHyp})),y=E.length,_=y-1|0;return E.forEach((function(r,t){G(g,r.expr,r.jstf,t===_?i:void 0,a,u,m,t!==_||s.isNone(i)?void 0:p),v.ptAddRootStmt(g,r),x.progressTrackerSetCurrPct(h,(t+1|0)/y)})),g},t.makeParenCnt=function(r,t){var n=u.ctxGetOptimizedConstsOrder(r,t),e=n.canBeLastMax,a=n.canBeLastMin,s=n.canBeFirstMax,f=n.canBeFirstMin,c=n.parenMin,v=n.allConsts,d=u.getAllConsts(r);if(v.length!==d.length)throw{RE_EXN_ID:i.MmException,_1:{msg:"allConsts.length != allConstsActual.length"},Error:new Error};if(c<0&&o.notequal(v.slice(0,0|-c),d.slice(0,0|-c)))throw{RE_EXN_ID:i.MmException,_1:{msg:"allConsts.parens != allConstsActual.parens"},Error:new Error};if(f<=s&&!U(v,d,(0|-s)-1|0,0|-f))throw{RE_EXN_ID:i.MmException,_1:{msg:"allConsts.canBeFirst != allConstsActual.canBeFirst"},Error:new Error};if(a<=e&&!U(v,d,(0|-e)-1|0,0|-a))throw{RE_EXN_ID:i.MmException,_1:{msg:"allConsts.canBeLast != allConstsActual.canBeLast"},Error:new Error};if(!U(v,d,0,v.length))throw{RE_EXN_ID:i.MmException,_1:{msg:"allConsts.remaining != allConstsActual.remaining"},Error:new Error};return p.parenCntMake(c,f,s,a,e)}},5090:(r,t,n)=>{var e=n(4923);t.jstfEq=function(r,t){return r.label===t.label&&e.equal(r.args,t.args)},t.jstfToStr=function(r){return(r.args.join(" ")+" : "+r.label).trim()}},1874:(r,t,n)=>{var e=n(2971),o=n(3333),i=n(1094),a=n(6517),u=n(303),s=n(7356),f=n(4792),c=n(2275),v=n(8615),d=n(5047);function l(r,t,n){return r<0?t[0][0]:r<(t.length-1|0)?(t[r+1|0][0]-t[r][1]|0)-1|0:(n-t[r][1]|0)-1|0}function p(r,t,n){return r<0?t.begins[0]:r<(t.length-1|0)?(t.begins[r+1|0]-t.ends[r]|0)-1|0:(n-t.ends[r]|0)-1|0}function m(r){for(var t=[],n=0,e=r.length;n<e;++n){var o=t.length;r[n]<0?(0===o||t[o-1|0][1]>=0)&&t.push([n,-1]):o>0&&t[o-1|0][1]<0&&(t[o-1|0][1]=n-1|0)}var i=t.length,a=r.length;i>0&&t[i-1|0][1]<0&&(t[i-1|0][1]=a-1|0);for(var u=new Array(i),s=new Array(i),f=new Array(i),c={length:i,begins:u,ends:s,remainingMinLength:f},v=0,d=i-1|0;d>=0;--d)u[d]=t[d][0],s[d]=t[d][1],v=(v+(1+(s[d]-u[d]|0)|0)|0)+l(d,t,a)|0,f[d]=v;return c}function h(r){return{length:r.length,begins:new Array(r.length),ends:new Array(r.length),remainingMinLength:[]}}function g(r,t,n,e,o,i,u){var s=function(){return g(r,t,n,e,o+1|0,i,u)},c=t.length,v=r.length;if(c<v)return"Continue";if(o===n.length){if(n.length<=0)return f.parenCntCanBeFirst(i,t[0])&&f.parenCntCanBeLast(i,t[c-1|0])?u(e):"Continue";if(e.ends[o-1|0]===(c-1|0))return u(e);if(n.ends[o-1|0]===(v-1|0))return"Continue";var d=p(o-1|0,n,v);if(p(o-1|0,e,c)<d)return"Continue";if(!f.parenCntCanBeFirst(i,t[e.ends[o-1|0]+1|0])||!f.parenCntCanBeLast(i,t[c-1|0]))return"Continue";f.parenCntReset(i);for(var l="Balanced",m=e.ends[o-1|0]+1|0;m<c&&"Failed"!==l;)l=f.parenCntPut(i,t[m]),m=m+1|0;return"Balanced"===l?u(e):"Continue"}if(0===o&&0===n.begins[0]){if((c-1|0)<n.ends[0])return"Continue";for(var h,E=n.ends[0],x=0;a.isNone(h)&&x<=E;)r[x]!==t[x]&&(h="Continue"),x=x+1|0;return void 0!==h?h:E===(c-1|0)||f.parenCntCanBeFirst(i,t[E+1|0])?(e.begins[0]=0,e.ends[0]=E,s()):"Continue"}var y=0===o?0:e.ends[o-1|0]+1|0,_=c-n.remainingMinLength[o]|0;f.parenCntReset(i);for(var b="Balanced",A=p(o-1|0,n,v),T=1;T<=A;++T)b=f.parenCntPut(i,t[y]),y=y+1|0;for(var k=1+(n.ends[o]-n.begins[o]|0)|0,S="Continue";y<=_&&"Failed"!==b&&"Continue"===S;){if("Balanced"===b){for(var w=0,I=!0;w<k&&I;)I=r[n.begins[o]+w|0]===t[y+w|0],w=w+1|0;var G=(y+k|0)-1|0;w===k&&I&&f.parenCntCanBeLast(i,t[y-1|0])&&(G===(c-1|0)||f.parenCntCanBeFirst(i,t[G+1|0]))&&(e.begins[o]=y,e.ends[o]=G,S=s(),f.parenCntReset(i))}b=f.parenCntPut(i,t[y]),y=y+1|0}return S}function E(r,t){var n=r.length;if(0===t.length)return[{leftConstPartIdx:-1,frmExpr:r,varsBeginIdx:0,numOfVars:n,exprBeginIdx:0,exprEndIdx:0}];var e=[];0!==t.begins[0]&&e.push({leftConstPartIdx:-1,frmExpr:r,varsBeginIdx:0,numOfVars:t.begins[0],exprBeginIdx:0,exprEndIdx:0});for(var o=0,i=t.length-2|0;o<=i;++o)e.push({leftConstPartIdx:o,frmExpr:r,varsBeginIdx:t.ends[o]+1|0,numOfVars:p(o,t,n),exprBeginIdx:0,exprEndIdx:0});var a=t.length-1|0;return t.ends[a]!==(n-1|0)&&e.push({leftConstPartIdx:a,frmExpr:r,varsBeginIdx:t.ends[a]+1|0,numOfVars:p(a,t,n),exprBeginIdx:0,exprEndIdx:0}),e}function x(r,t,n,e,o,i,a,u){var s=n[e],c=s.frmExpr[s.varsBeginIdx+o|0],v=(1+(s.exprEndIdx-i|0)|0)-((s.numOfVars-o|0)-1|0)|0,d=function(f){return o<(s.numOfVars-1|0)?x(r,t,n,e,o+1|0,i+f|0,a,u):e<(n.length-1|0)?x(r,t,n,e+1|0,0,n[e+1|0].exprBeginIdx,a,u):u(t)},l="Continue";if(t.isDefined[c]){var p=t.exprs[c],m=t.begins[c],h=1+(t.ends[c]-m|0)|0;if(h<=v&&(o<(s.numOfVars-1|0)||h===v)){for(var g=0;g<h&&p[m+g|0]===r[i+g|0];)g=g+1|0;g===h&&(l=d(h))}}else{if(t.isDefined[c]=!0,t.exprs[c]=r,t.begins[c]=i,o===(s.numOfVars-1|0))t.ends[c]=s.exprEndIdx,l=d(v);else if(f.parenCntCanBeFirst(a,r[i])){var E=1,y=i;f.parenCntReset(a);for(var _="Balanced";E<=v&&"Continue"===l&&"Failed"!==_;)t.ends[c]=y,"Balanced"===(_=f.parenCntPut(a,r[y]))&&f.parenCntCanBeLast(a,r[y])&&(l=d(E),f.parenCntReset(a)),E=E+1|0,y=y+1|0}t.isDefined[c]=!1}return l}function y(r,t,n,e,i,a,u,s){if(0===a.size)return o.exprEq(r,t)?s(a):"Continue";var f=t.length,c=r.length;if(f<c||0===f||0===c)return"Continue";var v=r[c-1|0];if(v<0&&v!==t[f-1|0])return"Continue";var l=r[0];return l<0&&l!==t[0]?"Continue":g(r,t,n,e,0,u,(function(r){return i.length>0?(function(r,t,n){var e=n.length;0===t.length?(r[0].exprBeginIdx=0,r[0].exprEndIdx=e-1|0):(r.forEach((function(r){-1===r.leftConstPartIdx?(r.exprBeginIdx=0,r.exprEndIdx=t.begins[0]-1|0):r.leftConstPartIdx===(t.length-1|0)?(r.exprBeginIdx=t.ends[r.leftConstPartIdx]+1|0,r.exprEndIdx=e-1|0):(r.exprBeginIdx=t.ends[r.leftConstPartIdx]+1|0,r.exprEndIdx=t.begins[r.leftConstPartIdx+1|0]-1|0)})),d.sortInPlaceWith(r,(function(r,t){return r.numOfVars-t.numOfVars|0})))}(i,r,t),x(t,a,i,0,0,i[0].exprBeginIdx,u,s)):s(a)}))}function _(r){return{size:r,begins:e.make(r,0),ends:e.make(r,0),exprs:e.make(r,[]),isDefined:e.make(r,!1)}}function b(r){var t=r.hyps.filter((function(r){return"E"===r.typ})),n=[],e=[],o=[];t.forEach((function(r){var t=m(r.expr),i=h(t),a=E(r.expr,t);n.push(t),e.push(i),o.push(a)}));var i=m(r.asrt),a=h(i),u=E(r.asrt,i);n.push(i),e.push(a),o.push(u);var s=_(r.numOfVars);return{frame:r,hypsE:t,numOfHypsE:t.length,frmConstParts:n,constParts:e,varGroups:o,subs:s}}t.subsClone=function(r){return{size:r.size,begins:r.begins.slice(),ends:r.ends.slice(),exprs:r.exprs.slice(),isDefined:r.isDefined.slice()}},t.subsEq=function(r,t){if(r.size!==t.size||!r.isDefined.every((function(r){return r}))||!t.isDefined.every((function(r){return r})))return!1;for(var n=!0,e=0;n&&e<r.size;){var o=r.exprs[e],i=r.begins[e],a=r.ends[e],u=1+(a-i|0)|0,s=t.exprs[e],f=t.begins[e];if(u===(1+(t.ends[e]-f|0)|0))for(var c=i,v=f;n&&c<=a;)n=o[c]===s[v],c=c+1|0,v=v+1|0;else n=!1;e=e+1|0}return n},t.subsHash=function(r){if(!r.isDefined.every((function(r){return r})))return 0;for(var t=0,n=0;n<r.size;)t=d.hash2(t,d.hashArrIntFromTo(r.exprs[n],r.begins[n],r.ends[n])),n=n+1|0;return t},t.createConstParts=m,t.createMatchingConstParts=h,t.createSubs=_,t.prepareFrmSubsDataForFrame=b,t.prepareFrmSubsData=function(r){var t=d.comparatorAndThen(d.comparatorBy((function(r){return r.hypsE.length})),d.comparatorBy((function(r){return r.frame.ord}))),n=d.sortInPlaceWith(o.getAllFramesArr(r).map(b),t),e=c.make(1e3),i=s.make(16);return n.forEach((function(r){c.set(e,r.frame.label,r);var t=r.frame.asrt[0],n=s.get(i,t);return void 0!==n?void n.push(r):s.set(i,t,[r])})),{all:n,byType:i,byLabel:e}},t.sortFrames=function(r,t){var n=v.fromArray(t);return r.all.filter((function(r){return v.has(n,r.frame.label)})).map((function(r){return r.frame.label}))},t.iterateSubstitutions=y,t.applySubs=function(r,t,n){var e={contents:0};r.forEach((function(r){r<0||!t.isDefined[r]?e.contents=e.contents+1|0:e.contents=e.contents+(1+(t.ends[r]-t.begins[r]|0)|0)|0}));for(var o=new Array(e.contents),i=0,a=0;a<e.contents;){var u=r[i];if(u<0)o[a]=u,a=a+1|0;else if(t.isDefined[u]){var s=t.exprs[u],f=1+(t.ends[u]-t.begins[u]|0)|0;d.copySubArray(s,t.begins[u],o,a,f),a=a+f|0}else o[a]=n(u),a=a+1|0;i=i+1|0}return o},t.verifyDisjoints=function(r,t,n,e){var o={contents:void 0};return i.forEach(r,(function(r,i){if(a.isNone(o.contents))return u.forEach(i,(function(i){if(a.isNone(o.contents))for(var u=t.exprs[r],s=t.begins[r],f=t.ends[r],c=t.exprs[i],v=t.begins[i],d=t.ends[i],l=s;l<=f;++l)if(a.isNone(o.contents)){var p=u[l];if(p>=0)for(var m=v;m<=d;++m)if(a.isNone(o.contents)){var h=c[m];h>=0&&(p===h?o.contents=0===e?"UnifErr":{TAG:"DisjCommonVar",frmVar1:r,expr1:u.slice(s,f+1|0),frmVar2:i,expr2:c.slice(v,d+1|0),commonVar:p}:n(p,h)||(o.contents=0===e?"UnifErr":{TAG:"Disj",frmVar1:r,expr1:u.slice(s,f+1|0),var1:p,frmVar2:i,expr2:c.slice(v,d+1|0),var2:h}))}}}))})),o.contents},t.frmsEmpty=function(){return{all:[],byType:s.make(0),byLabel:c.make(0)}},t.frmsSize=function(r){return r.all.length},t.frmsForEach=function(r,t,n){return void 0!==t?a.forEach(s.get(r.byType,t),(function(r){r.forEach(n)})):void r.all.forEach(n)},t.frmsGetAll=function(r){return r.all},t.frmsGetByLabel=function(r,t){return c.get(r.byLabel,t)},t.frmsGetByType=function(r,t){return s.get(r.byType,t)},t.frmsSelect=function(r,t,n){if(void 0!==t){if(void 0!==n){var e=a.keep(c.get(r.byLabel,n),(function(r){return r.frame.asrt[0]===t}));return void 0!==e?[e]:[]}var o=s.get(r.byType,t);return void 0!==o?o.slice():[]}if(void 0===n)return r.all.slice();var i=c.get(r.byLabel,n);return void 0!==i?[i]:[]},t.frmsGetAllTypes=function(r){return s.keysToArray(r.byType)},t.frmsGetAllGroupedByLabel=function(r){return r.byLabel},t.test_iterateConstParts=function(r,t,n){var e=function(r){return r.begins.map((function(t,n){return[t,r.ends[n]]}))},o=m(r),i=h(o),a=[];return g(r,t,o,i,0,n,(function(r){return a.push(e(r)),"Continue"})),[e(o),a]},t.test_iterateSubstitutions=function(r,t,n){var e=m(r),o=h(e),i=E(r,e),a=u.size(u.fromArray(r.filter((function(r){return r>=0})))),s=_(a),f=[];return y(r,t,e,o,i,s,n,(function(r){for(var t=[],n=0;n<a;++n)t.push(r.exprs[n].slice(r.begins[n],r.ends[n]+1|0));return f.push(t),"Continue"})),f}},3591:(r,t,n)=>{var e=n(4923),o=n(2971),i=n(3333),a=n(6517),u=n(303),s=n(2761),f=n(3533),c=n(368),v=n(1717),d=n(2275),l=n(5047);function p(r){return s.reduce(r,0,(function(r,t){return Math.max(r,function(r){return"Subtree"===r.TAG?r._0.height:0}(t))}))}function m(r,t,n,e,u){var s=u.proof;if("Hypothesis"===s.TAG){for(var f=s.label,c=u.expr.length-1|0,v=r(),d=u.expr[0],l=new Array(c),h={id:v,parent:e,typ:d,label:f,children:l,height:0},g=1;g<=c;++g)l[g-1|0]={TAG:"Symbol",id:r(),parent:h,symInt:u.expr[g],sym:i.ctxIntToSymExn(t,u.expr[g]),color:void 0,isVar:u.expr[g]>=0};return{TAG:"Ok",_0:{id:v,parent:e,typ:d,label:f,children:l,height:p(l)+1|0}}}var E=s.label,x=i.getFrame(t,E);if(void 0===x)return{TAG:"Error",_0:"Cannot find a frame by label '"+E+"' in buildSyntaxTreeInner."};var y=function(r,t){var n=new Array(t.numOfVars),e=o.make(t.numOfVars,!1);if(r.length!==t.numOfArgs)return{TAG:"Error",_0:"extractVarToRecIdxMapping: args.Array.length != frame.numOfArgs"};var i={contents:void 0};t.hyps.forEach((function(t,o){if(a.isNone(i.contents)&&"F"===t.typ){var u=t.expr[1];e[u]?i.contents={TAG:"Error",_0:"extractVarToRecIdxMapping: locks[v]"}:(e[u]=!0,n[u]=r[o])}}));var u=i.contents;return void 0!==u?u:e.some((function(r){return!r}))?{TAG:"Error",_0:"extractVarToRecIdxMapping: locks->Array.some(lock => !lock)"}:{TAG:"Ok",_0:n}}(s.args,x);if("Ok"!==y.TAG)return{TAG:"Error",_0:y._0};var _=y._0,b=r(),A=x.asrt[0],T=new Array(x.asrt.length-1|0),k={id:b,parent:e,typ:A,label:E,children:T,height:0},S={contents:void 0};x.asrt.forEach((function(e,o){if(o>0&&a.isNone(S.contents))if(e<0)T[o-1|0]={TAG:"Symbol",id:r(),parent:k,symInt:e,sym:i.ctxIntToSymExn(t,e),color:void 0,isVar:!1};else{var u=m(r,t,n,k,n[_[e]]);"Ok"===u.TAG?T[o-1|0]={TAG:"Subtree",_0:u._0}:S.contents={TAG:"Error",_0:u._0}}}));var w=S.contents;return void 0!==w?w:{TAG:"Ok",_0:{id:b,parent:e,typ:A,label:E,children:T,height:p(T)+1|0}}}function h(r,t,n){var e={contents:0};return m((function(){return e.contents=e.contents+1|0,e.contents-1|0}),r,t,void 0,t[n])}function g(r,t,n){var e=t.nodes.find((function(r){return i.exprEq(r.expr,n)}));return void 0!==e?{TAG:"Ok",_0:v.createProofTable(t,e,void 0,void 0)}:{TAG:"Error",_0:"buildSyntaxProofTableFromProofTreeDto: could not find a proof for: "+i.ctxIntsToStrExn(r,n)}}function E(r,t){if(1===r.children.length){var n=r.children[0];if("Subtree"!==n.TAG){var e=n.sym;return n.isVar&&t(e)?[n.symInt,e]:void 0}}}function x(r,t){d.forEachU(t,(function(t,n){for(var e=0;e<r.length;)r[e]===t?(f.spliceObjApply(r,"splice",[e,1,n]),e=e+n.length|0):e=e+1|0}))}function y(r,t,n){if(n.includes(t))return!1;x(n,r);var o=d.get(r,t);return void 0!==o?e.equal(n,o):(d.set(r,t,n),d.forEachU(r,(function(t,n){x(n,r)})),!0)}function _(r){return l.arrFlatMap(r.children,(function(r){return"Subtree"===r.TAG?_(r._0):[r.sym]}))}function b(r,t){return c.traverseTree(void 0,r,(function(r,t){if("Subtree"===t.TAG)return t._0.children}),void 0,(function(r,n){return t(n)}),void 0)[1]}t.buildSyntaxTree=h,t.buildSyntaxProofTableFromProofTreeDto=g,t.buildSyntaxTreeFromProofTreeDto=function(r,t,n){var e=g(r,t,n);if("Ok"!==e.TAG)return{TAG:"Error",_0:e._0};var o=e._0;return h(r,o,o.length-1|0)},t.syntaxTreeToSymbols=function r(t){return o.concatMany(t.children.map((function(t){return"Subtree"===t.TAG?r(t._0):[t.sym]})))},t.syntaxTreeIsEmpty=function(r){return 0===r.children.length},t.getNodeById=function(r,t){return c.traverseTree(void 0,{TAG:"Subtree",_0:r},(function(r,t){if("Subtree"===t.TAG)return t._0.children}),void 0,(function(r,n){if(("Subtree"===n.TAG?n._0.id:n.id)===t)return n}),void 0)[1]},t.syntaxTreeForEachNode=b,t.syntaxTreeGetIdsOfAllChildSymbols=function(r){var t=[];return b(r,(function(r){"Subtree"!==r.TAG&&t.push(r.id)})),u.fromArray(t)},t.syntaxTreeToText=function(r){var t=[];return b(r,(function(r){"Subtree"!==r.TAG&&t.push(r.sym)})),t.join(" ")},t.syntaxTreeGetNumberOfSymbols=function(r){var t={contents:0};return b(r,(function(r){"Subtree"!==r.TAG&&(t.contents=t.contents+1|0)})),t.contents},t.isVar=E,t.unify=function r(t,n,e,o,i){if(t.typ===n.typ){var a=E(t,e);if(void 0!==a){var u=a[1],s=E(n,e);return void 0!==s&&u===s[1]?void 0:void(i.contents=y(o,u,_(n)))}var f=E(n,e);if(void 0===f)if(t.children.length===n.children.length)for(var c=t.children.length-1|0,v=0;i.contents&&v<=c;){var d=t.children[v];if("Subtree"===d.TAG){var l=n.children[v];"Subtree"===l.TAG?r(d._0,l._0,e,o,i):i.contents=!1}else{var p=n.children[v];("Subtree"===p.TAG||d.isVar||p.isVar||d.sym!==p.sym)&&(i.contents=!1)}v=v+1|0}else i.contents=!1;else i.contents=y(o,f[1],_(t))}else i.contents=!1}},1725:(r,t)=>{function n(r,t){return r.map((function(r,n){return String(n+1|0)+": "+(0===r.length?"?":t(r))})).join("\n")}t.unifErrToStr=function(r,t,e){if("object"!=typeof r)return"Details of the error were not stored.";switch(r.TAG){case"DisjCommonVar":var o=String.fromCharCode(8594);return"Unsatisfied disjoint, common variable "+t([r.commonVar])+":\n"+e([r.frmVar1])+" "+o+" "+t(r.expr1)+"\n"+e([r.frmVar2])+" "+o+" "+t(r.expr2);case"Disj":var i=String.fromCharCode(8594);return"Missing disjoint "+t([r.var1])+","+t([r.var2])+":\n"+e([r.frmVar1])+" "+i+" "+t(r.expr1)+"\n"+e([r.frmVar2])+" "+i+" "+t(r.expr2);case"UnprovedFloating":return"Could not prove this floating statement:\n"+t(r.expr);case"NoUnifForAsrt":var a=String.fromCharCode(8594);return"Could not find a match for assertion:\n"+e(r.asrtExpr)+"\n"+a+"\n"+t(r.expr);case"NoUnifForArg":var u=r.args,s=0===u.length?"":":";return"Could not match essential hypothesis #"+String(r.errArgIdx+1|0)+s+"\n"+n(u,t);case"NewVarsAreDisabled":var f=r.errArgIdx,c=r.args;return"New variables are not allowed, but one had to be created when unifying "+(c.length===f?"assertion":"essential hypothesis #"+String(f+1|0))+(0===c.length?"":":")+"\n"+n(c,t);case"TooManyCombinations":var v=r.frmLabels;return void 0!==v?"Some assertions produce too big search space. Only part of that search space was examined. Those assertions are: "+v.join(", ")+" .":"This assertion produces too big search space. Only part of that search space was examined."}}},5291:(r,t,n)=>{var e=n(2971),o=n(6517),i=n(7175),a=n(7356),u=n(4518),s=n(5047),f=String.fromCharCode(160),c=String.fromCharCode(9679);function v(r,t){var n=r.depVer;if(void 0!==n&&r.depVerEq(i.valFromOption(n),t))return r.data}function d(r,t){return r.split(t).map((function(r){return o.getWithDefault(r,"").trim()})).filter((function(r){return r.length>0}))}var l=/[\n\r]/,p=/[\s\n\r]/;function m(r){return d(r,p)}var h=/\+/g,g=/-/g,E=/\//g,x=/_/g;t.nbsp=f,t.circleChar=c,t.currTimeStr=function(){return new Date(Date.now()).toISOString()},t.compareDates=function(r,t){var n=r.getTime(),e=t.getTime();return n<e?-1:e<n?1:0},t.floatToPctStr=function(r){return String(0|Math.round(100*r))+"%"},t.cacheMake=function(r,t){return{recalc:r,depVerEq:t,depVer:void 0,data:void 0}},t.cacheGetByDepVer=v,t.cacheGet=function(r,t,n){var e=v(r,t);if(void 0!==e)return i.valFromOption(e);r.depVer=i.some(t);var o=r.recalc(n);return r.data=i.some(o),o},t.multilineTextToNonEmptyLines=function(r){return d(r,l)},t.getSpaceSeparatedValuesAsArray=m,t.strToBase64=function(r){return btoa(r)},t.base64ToStr=function(r){return atob(r)},t.strToSafeBase64=function(r){return btoa(r).replace(h,"-").replace(E,"_")},t.safeBase64ToStr=function(r){return atob(r.replace(x,"/").replace(g,"+"))},t.strToRegex=function(r){try{return{TAG:"Ok",_0:new RegExp(r)}}catch(n){var t=u.internalToOCamlException(n);return{TAG:"Error",_0:o.getWithDefault(o.flatMap(u.as_js_exn(t),(function(r){return r.message})),"could not create a regular expression from string '"+r+"'")}}},t.versionMake=function(r){return{ver:0,val:r}},t.versionSet=function(r,t){return{ver:r.ver+1|0,val:t}},t.arrayQueueMake=function(r){var t=new Array(r);return{begin:0,end:-1,maxEnd:t.length-1|0,data:t}},t.arrayQueueAdd=function(r,t){r.end===r.maxEnd&&(console.log("q.end == q.maxEnd"),r.data=e.concat(r.data,new Array(r.data.length)),r.maxEnd=r.data.length-1|0),r.end=r.end+1|0,r.data[r.end]=t},t.arrayQueuePop=function(r){if(!(r.begin>r.end)){var t=r.data[r.begin];return r.begin=r.begin+1|0,i.some(t)}},t.arrayQueueReset=function(r){r.begin=0,r.end=-1},t.createVarTypeComparator=function(r,t){var n=a.make(a.size(r));return a.forEach(r,(function(r,e){var o=a.get(t,e);if(void 0!==o)return a.set(n,r,o)})),function(r,t){var e=a.get(n,r);if(void 0!==e){var o=a.get(n,t);return void 0!==o?s.intCmp(e,o):-1}return void 0!==a.get(n,t)?1:0}},t.createVarNameComparator=function(r){return function(t,n){var e=a.get(r,t);if(void 0!==e){var o=a.get(r,n);return void 0!==o?e.localeCompare(o):-1}return void 0!==a.get(r,n)?1:0}},t.createTypeOrderFromStr=function(r,t){var n=a.make(4);return m(r).forEach((function(r){var e=t(r);if(void 0!==e)return a.set(n,e,a.size(n))})),n}},7653:(r,t,n)=>{var e=n(8723);function o(r,t){return e.div(1e5*r|0,t)}function i(r,t,n,e){var i=void 0!==e&&e,a=1e5*r|0,u=o(void 0!==t?t:0,a);return{step:a,numOfSteps:u,lastSentNumOfSteps:u,onProgress:n,dontDecrease:i}}function a(r,t){var n=r.onProgress;if(void 0!==n){var e,i,a=o(t,r.step);return r.dontDecrease&&a>r.lastSentNumOfSteps||!r.dontDecrease&&a!==r.lastSentNumOfSteps?(n((e=a,i=r.step,Math.imul(e,i)/1e5)),void(r.lastSentNumOfSteps=a)):void 0}}t.progressTrackerMake=i,t.progressTrackerSetCurrPct=a,t.progressTrackerIntMake=function(r,t,n,e,o){var a=void 0!==t?t:0;return{progressState:i(r,a/n,e,void 0!==o&&o),cnt:a,maxCnt:n,stepInt:Math.max(n*r/2|0,1)}},t.progressTrackerIntIncCnt=function(r){if(r.cnt=r.cnt+1|0,0===e.mod_(r.cnt,r.stepInt))return a(r.progressState,r.cnt/r.maxCnt)}},5376:(r,t,n)=>{var e=n(3333),o=n(2605),i="MM_wrk_FindParens";t.procName=i,t.beginFindParens=function(r,t,n){o.beginWorkerInteraction(i,{TAG:"FindParens",ctx:r},(function(r,e,o){if("FindParensProgress"===r.TAG)return t(r.pct);o(),n(r.parens)}),void 0,void 0,void 0)},t.processOnWorkerSide=function(r,t){var n,o=r.ctx;t({TAG:"FindParensDone",parens:(n=e.findParentheses(o,(function(r){t({TAG:"FindParensProgress",pct:r})})),e.ctxIntsToStrExn(o,n))})},t.reqToStr=function(r){return"FindParens"},t.respToStr=function(r){return"FindParensProgress"===r.TAG?"FindParensProgress(pct="+String(r.pct)+")":'FindParensDone(parens="'+r.parens+'")'}},5171:(r,t,n)=>{var e=n(5291),o=n(2900),i=n(55),a=n(3333),u=n(6517),s=n(7175),f=n(2761),c=n(2605),v=n(7709),d=n(4518),l="MM_wrk_LoadCtx";function p(r){var t=r.trim();if(0!==t.length){var n=e.strToRegex(t);if("Ok"===n.TAG)return s.some(n._0);throw{RE_EXN_ID:i.MmException,_1:{msg:"Could not parse a regex: "+n._0},Error:new Error}}}t.procName=l,t.beginLoadingMmContext=function(r,t,n,e,o,i,a){c.beginWorkerInteraction(l,{TAG:"LoadMmContext",scopes:r,descrRegexToDisc:t,labelRegexToDisc:n,descrRegexToDepr:e,labelRegexToDepr:o},(function(r,t,n){if("MmContextLoadProgress"===r.TAG)return i(r.pct);n(),a(r.ctx)}),void 0,void 0,void 0)},t.processOnWorkerSide=function(r,t){var n=r.labelRegexToDepr,e=r.descrRegexToDepr,c=r.labelRegexToDisc,v=r.descrRegexToDisc,l=r.scopes,m=f.reduce(l,0,(function(r,t){return r+t.expectedNumOfAssertions|0})),h=l.map((function(r){return r.expectedNumOfAssertions/m}));try{for(var g=a.createContext(void 0,void 0),E=0,x=l.length;E<x;++E){var y=l[E],_=f.reduceWithIndex(h,0,function(r){return function(t,n,e){return e<r?t+n:t}}(E)),b=h[E];if(a.loadContext(l[E].ast,s.some(g),y.stopBefore,y.stopAfter,void 0,y.expectedNumOfAssertions,p(v),p(c),p(e),p(n),function(r,n){return function(e){t({TAG:"MmContextLoadProgress",pct:r+e*n})}}(_,b),void 0),y.resetNestingLevel)for(;0!==a.getNestingLevel(g);)a.closeChildContext(g)}return t({TAG:"MmContextLoadProgress",pct:1}),t({TAG:"MmContextLoaded",ctx:{TAG:"Ok",_0:g}})}catch(r){var A=d.internalToOCamlException(r);if(A.RE_EXN_ID===i.MmException)return t({TAG:"MmContextLoaded",ctx:{TAG:"Error",_0:A._1.msg}});if(A.RE_EXN_ID===o.$$Error)return t({TAG:"MmContextLoaded",ctx:{TAG:"Error",_0:u.getWithDefault(A._1.message,"Internal error.")}});throw A}},t.reqToStr=function(r){return"LoadMmContext"},t.respToStr=function(r){return"MmContextLoadProgress"===r.TAG?"MmContextLoadProgress(pct="+String(r.pct)+")":"MmContextLoaded"},t.createMmScopesForFrame=function(r,t){var n=[];return f.reduce(r,!1,(function(r,e){if(r)return r;var o=function(r){switch(v.readInstrFromStr(r.readInstr)){case"ReadAll":return[void 0,void 0,r.allLabels];case"StopBefore":var t=r.allLabels.findIndex((function(t){return t===r.label}));return-1!==t?[r.label,void 0,r.allLabels.slice(0,t)]:[void 0,void 0,r.allLabels];case"StopAfter":var n=r.allLabels.findIndex((function(t){return t===r.label}));return-1!==n?[void 0,r.label,r.allLabels.slice(0,n+1|0)]:[void 0,void 0,r.allLabels]}}(e),a=o[2],u=a.includes(t)?[t,void 0,a.indexOf(t),!1]:[o[0],o[1],a.length,!0],s=u[2],f=e.ast;if(void 0===f)throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot create MM context for a frame without ast."},Error:new Error};var c={ast:f,expectedNumOfAssertions:s,stopBefore:u[0],stopAfter:u[1],resetNestingLevel:u[3]};return n.push(c),a.length!==s})),n}},8152:(r,t,n)=>{var e=n(55),o=n(2605),i=n(4518),a="MM_wrk_ParseMmFile";t.procName=a,t.beginParsingMmFile=function(r,t,n){o.beginWorkerInteraction(a,{TAG:"ParseMmFile",mmFileText:r},(function(r,e,o){if("MmFileParseProgress"===r.TAG)return t(r.pct);o(),n(r.parseResult)}),void 0,void 0,void 0)},t.processOnWorkerSide=function(r,t){try{var n=e.parseMmFile(r.mmFileText,void 0,void 0,(function(r){t({TAG:"MmFileParseProgress",pct:r})}));return t({TAG:"MmFileParseProgress",pct:1}),t({TAG:"MmFileParsed",parseResult:{TAG:"Ok",_0:n}})}catch(r){var o=i.internalToOCamlException(r);if(o.RE_EXN_ID===e.MmException)return t({TAG:"MmFileParsed",parseResult:{TAG:"Error",_0:o._1.msg}});throw o}},t.reqToStr=function(r){return"ParseMmFile"},t.respToStr=function(r){return"MmFileParseProgress"===r.TAG?"MmFileParseProgress(pct="+String(r.pct)+")":"MmFileParsed"}},6862:(r,t,n)=>{var e=n(5291),o=n(6517);t.serialize=function(r){return r},t.deserialize=function(r){return r},t.logClientIsSendingRequest=function(r,t,n,i){var a=o.getWithDefault(o.map(i,(function(r){return r(n)})),"");console.log(e.currTimeStr()+" ["+String(r)+","+t+"] C~> "+a)},t.logClientReceivedResponse=function(r,t,n,i){var a=o.getWithDefault(o.map(i,(function(r){return r(n)})),"");console.log(e.currTimeStr()+" ["+String(r)+","+t+"] ->C "+a)},t.logWorkerIsSendingResponse=function(r,t,n,o){console.log(e.currTimeStr()+" ["+String(r)+","+t+"] W~> "+o(n))},t.logWorkerReceivedRequest=function(r,t,n,o){console.log(e.currTimeStr()+" ["+String(r)+","+t+"] ->W "+o(n))}},2605:(r,t,n)=>{var e=n(6862),o=n(6517),i=n(7175),a=n(6181),u=n(5047),s=a.create("MM_wrk_client.WorkerException"),f={contents:void 0},c=[],v={contents:0};t.beginWorkerInteraction=function(r,t,n,a,d,l){var p=void 0!==a&&a,m={contents:-1},h={contents:function(r){}};m.contents=function(r,t){var n=(v.contents=v.contents+1|0,v.contents-1|0);return c.push({id:n,callback:r,traceEnabled:t}),n}((function(t){var o=e.deserialize(t);p&&e.logClientReceivedResponse(m.contents,r,o,l),n(o,h.contents,(function(){for(var r=m.contents,t=0;t<c.length;)c[t].id===r?c.splice(t,1):t=t+1|0}))}),p),h.contents=function(t){p&&e.logClientIsSendingRequest(m.contents,r,t,d);var n={clientId:m.contents,procName:r,body:e.serialize(t),traceEnabled:p};if(o.isNone(f.contents)){var a=new Worker("./webworker-main.js");a.onmessage=function(r){var t=r.data;u.arrForEach(c,(function(r){if(r.id===t.clientId)return r.callback(t.body),i.some(void 0)}))},f.contents=i.some(a)}var v=f.contents;if(void 0!==v)return i.valFromOption(v).postMessage(n);throw{RE_EXN_ID:s,_1:"Could not instantiate a webworker.",Error:new Error}},h.contents(t)},t.terminateWorker=function(){var r=f.contents;if(void 0!==r)return i.valFromOption(r).terminate(),f.contents=void 0,void c.splice(0,c.length)}},9010:(r,t,n)=>{var e=n(5291),o=n(55),i=n(3333),a=n(7175),u=n(2761),s=n(4518);function f(r){var t=e.multilineTextToNonEmptyLines(r);return 0===t.length?{TAG:"Ok",_0:[]}:u.reduce(t,{TAG:"Ok",_0:[]},(function(r,t){if("Ok"!==r.TAG)return r;var n=r._0,o=function(r){var t=e.getSpaceSeparatedValuesAsArray(r);return 3!==t.length?{TAG:"Error",_0:"A line representing a variable definition should consist of exactly three parts separated with a whitespace."}:{TAG:"Ok",_0:t}}(t);return"Ok"!==o.TAG?{TAG:"Error",_0:o._0}:(n.push(o._0),{TAG:"Ok",_0:n})}))}t.prepareParenInts=function(r,t){for(var n=e.getSpaceSeparatedValuesAsArray(t),o=[],a=(n.length/2|0)-1|0,u=0;u<=a;++u){var s=n[u<<1],f=n[1+(u<<1)|0],c=i.ctxSymToInt(r,s);if(void 0!==c&&i.isConst(r,s)){var v=i.ctxSymToInt(r,f);void 0!==v&&i.isConst(r,f)&&(o.push(c),o.push(v))}}return o},t.textToVarDefs=f,t.createWrkCtx=function(r,t,n){var c=i.createContext(a.some(r),void 0),v=u.reduce([function(){var r=f(t);if("Ok"!==r.TAG){return{varsErr:r._0,disjErr:void 0}}try{return void r._0.forEach((function(r){i.applySingleStmt(c,{TAG:"Var",symbols:[r[2]]},void 0,void 0,void 0,void 0),i.applySingleStmt(c,{TAG:"Floating",label:r[0],expr:[r[1],r[2]]},void 0,void 0,void 0,void 0)}))}catch(r){var n=s.internalToOCamlException(r);if(n.RE_EXN_ID===o.MmException){return{varsErr:n._1.msg,disjErr:void 0}}throw n}},function(){try{return void e.multilineTextToNonEmptyLines(n).forEach((function(r){i.applySingleStmt(c,{TAG:"Disj",vars:r.split(" ").map((function(r){return r.trim()})).filter((function(r){return""!==r}))},void 0,void 0,void 0,void 0)}))}catch(t){var r=s.internalToOCamlException(t);if(r.RE_EXN_ID===o.MmException)return{varsErr:void 0,disjErr:r._1.msg};throw r}}],void 0,(function(r,t){return void 0!==r?r:t()}));return void 0!==v?{TAG:"Error",_0:v}:{TAG:"Ok",_0:c}}},9662:(r,t,n)=>{var e=n(5291),o=n(55),i=n(9592),a=n(7175),u=n(2605),s=n(1874),f=n(9010),c="MM_wrk_ctx",v={contents:void 0},d=e.cacheMake((function(r){return r}),(function(r,t){return r===t})),l=e.cacheMake((function(r){return r}),(function(r,t){return r===t})),p=e.cacheMake((function(r){return s.prepareFrmSubsData(r[1])}),(function(r,t){return r[0]===t[0]&&r[1]===t[1]})),m=e.cacheMake((function(r){return i.makeParenCnt(r[1],r[0].parens)}),(function(r,t){return r[0]===t[0]&&r[1]===t[1]}));t.procName=c,t.beginWorkerInteractionUsingCtx=function(r,t,n,e,o,i,a,s,f,v){var d=void 0!==v&&v,l={TAG:"PrepareWrkPrecalcData",settingsVer:r,preCtxVer:n,varsText:o,disjText:i};u.beginWorkerInteraction(c,l,(function(o,i,c){if("object"==typeof o)return"GetSettings"===o.TAG?o.settingsVer===r?(i({TAG:"SetSettings",settingsVer:r,settings:t}),i(l)):void 0:o.preCtxVer===n?(i({TAG:"SetPreCtx",preCtxVer:n,preCtx:e}),i(l)):void 0;c(),u.beginWorkerInteraction(a,s,f,d,void 0,void 0)}),d,void 0,void 0)},t.getWrkCtxExn=function(){var r=v.contents;if(void 0!==r)return r.wrkCtx;throw{RE_EXN_ID:o.MmException,_1:{msg:"wrkCtx is not created in the worker thread."},Error:new Error}},t.getWrkParenCntExn=function(){var r=v.contents;if(void 0!==r)return r.wrkParenCnt;throw{RE_EXN_ID:o.MmException,_1:{msg:"wrkParenCnt is not created in the worker thread."},Error:new Error}},t.getWrkFrmsExn=function(){var r=v.contents;if(void 0!==r)return r.wrkFrms;throw{RE_EXN_ID:o.MmException,_1:{msg:"wrkFrms is not created in the worker thread."},Error:new Error}},t.processOnWorkerSide=function(r,t){switch(r.TAG){case"PrepareWrkPrecalcData":v.contents=void 0;var n=function(r,t,n,i){var u=e.cacheGetByDepVer(d,r);if(void 0===u)return{TAG:"Error",_0:{TAG:"GetSettings",settingsVer:r}};var s=e.cacheGetByDepVer(l,t);if(void 0===s)return{TAG:"Error",_0:{TAG:"GetPreCtx",preCtxVer:t}};var c=a.valFromOption(s),v=f.createWrkCtx(c,n,i);if("Ok"===v.TAG)return{TAG:"Ok",_0:{wrkFrms:e.cacheGet(p,[r,t],[u,c]),wrkParenCnt:e.cacheGet(m,[r,t],[u,c]),wrkCtx:v._0}};throw{RE_EXN_ID:o.MmException,_1:{msg:"There was an error creating wrkCtx in the worker thread."},Error:new Error}}(r.settingsVer,r.preCtxVer,r.varsText,r.disjText);return"Ok"!==n.TAG?t(n._0):(v.contents=n._0,t("Ok"));case"SetSettings":return void e.cacheGet(d,r.settingsVer,r.settings);case"SetPreCtx":return void e.cacheGet(l,r.preCtxVer,r.preCtx)}},t.reqToStr=function(r){switch(r.TAG){case"PrepareWrkPrecalcData":return"PrepareWrkPrecalcData";case"SetSettings":return"SetSettings(settingsVer="+String(r.settingsVer)+")";case"SetPreCtx":return"SetPreCtx(preCtxVer="+String(r.preCtxVer)+")"}},t.respToStr=function(r){return"object"!=typeof r?"Ok":"GetSettings"===r.TAG?"GetSettings(settingsVer="+String(r.settingsVer)+")":"GetPreCtx(preCtxVer="+String(r.preCtxVer)+")"}},7709:(r,t,n)=>{var e=n(5291),o=n(4923),i=n(55),a=n(2971),u=n(5300),s=n(3333),f=n(9592),c=n(6517),v=n(6369),d=n(7175),l=n(2761),p=n(2815),m=n(9775),h=n(2423),g=n(5082),E=n(6134),x=n(3591),y=n(7659),_=n(4792),b=n(1874),A=n(9010),T=n(7470),k=n(5650),S=n(1717),w=n(9702),I=n(5090),G=n(2275),C=n(8615),M=n(5981),N=n(4518),D=n(5047),U=n(1725),j=n(2867);function O(r){return"Text"===r.TAG?e.getSpaceSeparatedValuesAsArray(r.text):e.getSpaceSeparatedValuesAsArray(r._0.text)}function P(r){return"Text"===r.TAG?r.text:r._0.text}function R(r,t,n){var o=e.getSpaceSeparatedValuesAsArray(r);return{TAG:"Text",text:o.join(" "),syms:o.map((function(r){var e,o=c.flatMap(t,(function(t){return G.get(t,r)}));if(void 0!==o)e=o;else{var i=c.flatMap(n,(function(t){return G.get(t,r)}));e=void 0!==i?i:void 0}return{sym:r,color:e}}))}}function F(r){switch(r){case"H":return["E",!1];case"P":return["P",!1];case"G":return["P",!0]}}function V(r,t,n,e){return{id:r,label:n,labelEditMode:!1,typ:t,typEditMode:!1,isGoal:e,isBkm:!1,cont:{TAG:"Text",text:"",syms:[]},contEditMode:!0,isDuplicated:!1,jstfText:"",jstfEditMode:!1,stmtErr:void 0,expr:void 0,jstf:void 0,proofTreeDto:void 0,src:void 0,proof:void 0,proofStatus:void 0,unifErr:void 0,syntaxErr:void 0}}function B(r){var t,n=r.expr;if(void 0===n)throw{RE_EXN_ID:i.MmException,_1:{msg:"Expr must be set for a userStmt before converting to rootStmt."},Error:new Error};return t=n,{isHyp:"E"===r.typ,label:r.label,expr:t,jstf:r.jstf}}function L(r){var t=r.cont;if("Text"===t.TAG)return r;var n=t._0;if(void 0===n.clickedNodeId)return r;var e=o.obj_dup(r);return e.cont={TAG:"Tree",_0:{text:n.text,exprTyp:n.exprTyp,root:n.root,clickedNodeId:void 0,expLvl:n.expLvl}},e}function W(r,t){return r.stmts.find((function(r){return r.id===t}))}function X(r,t){return r.stmts.find((function(r){return r.label===t}))}function z(r,t){var n=W(r,t);if(void 0!==n)return n;throw{RE_EXN_ID:i.MmException,_1:{msg:"editorGetStmtByIdExn: Cannot find a step by id."},Error:new Error}}function H(r,t,n){var e=o.obj_dup(r);return e.stmts=r.stmts.map((function(r){return r.id===t?n(r):r})),e}function q(r,t){return r.checkedStmtIds.some((function(r){return r[0]===t}))}function $(r,t){if(q(r,t)){var n=o.obj_dup(r);return n.checkedStmtIds=r.checkedStmtIds.filter((function(r){return r[0]!==t})),n}var e=o.obj_dup(r);return e.checkedStmtIds=r.checkedStmtIds.concat([[t,new Date]]),e}function K(r){var t=o.obj_dup(r);return t.checkedStmtIds=[],t.stmts=r.stmts.map(L),t}function J(r,t){var n=o.obj_dup(r);return n.checkedStmtIds=r.checkedStmtIds.filter((function(r){return r[0]!==t})),n.stmts=r.stmts.filter((function(r){return r.id!==t})),n}function Q(r,t){var n=o.obj_dup(r);return n.checkedStmtIds=r.checkedStmtIds.filter((function(r){return!t.includes(r[0])})),n.stmts=r.stmts.filter((function(r){return!t.includes(r.id)})),n}function Z(r,t){var n=r.stmts.length;return 0!==n&&0!==r.checkedStmtIds.length&&(!(!t||q(r,r.stmts[0].id))||!t&&!q(r,r.stmts[n-1|0].id))}function Y(r,t){if(!Z(r,t))return r;var n=r.stmts.length,e=r.stmts.slice();if(t){for(var i=n-2|0,a=0;a<=i;++a)if(!q(r,e[a].id)&&q(r,e[a+1|0].id)){var u=e[a];e[a]=e[a+1|0],e[a+1|0]=u}}else for(var s=n-1|0;s>=1;--s)if(q(r,e[s-1|0].id)&&!q(r,e[s].id)){var f=e[s];e[s]=e[s-1|0],e[s-1|0]=f}var c=o.obj_dup(r);return c.stmts=e,c}function rr(r,t,n){var e,o=void 0!==n&&n,i=C.fromArray(r.stmts.map((function(r){return r.label}))),a=A.textToVarDefs(r.varsText);if("Ok"===a.TAG&&a._0.forEach((function(r){C.add(i,r[0])})),void 0!==t)e=t;else if(o){var u=r.stmts.find((function(r){return r.isGoal}));e=void 0!==u?u.label+".":""}else e="";for(var f,v=1,d=e+String(v);f=d,C.has(i,f)||s.isHyp(r.preCtx,f)||o&&c.isSome(s.getTokenType(r.preCtx,f));)v=v+1|0,d=e+String(v);return d}function tr(r){return 0===r.checkedStmtIds.length?void 0:r.stmts.find((function(t){return q(r,t.id)}))}function nr(r,t,n){var e,i=void 0!==t&&t,u=String(r.nextStmtId),s=l.reduce(r.stmts,0,(function(r,t){return"P"===t.typ?r+1|0:r})),f=r.settings.defaultStmtLabel.trim(),v=0===s&&f.length>0?r.stmts.some((function(r){return r.label===f}))?rr(r,f,i):f:rr(r,"",i),d=0===s&&r.settings.initStmtIsGoal,p=c.map(tr(r),(function(r){return r.id})),m=o.obj_dup(r);if(void 0!==p)e=a.concatMany(r.stmts.map((function(r){if(r.id!==p)return[r];var t=o.obj_dup(V(u,"P",v,d));return[(t.isBkm=c.getWithDefault(n,r.isBkm),t),r]})));else{var h=o.obj_dup(V(u,"P",v,d));e=r.stmts.concat([(h.isBkm=c.getWithDefault(n,!1),h)])}return m.stmts=e,[(m.nextStmtId=r.nextStmtId+1|0,m),u]}function er(r,t,n){var e=void 0!==n&&n,i=r.checkedStmtIds,a=K(r),u=nr(0<=t&&t<a.stmts.length?$(a,a.stmts[t].id):a,e,void 0),s=o.obj_dup(u[0]);return s.checkedStmtIds=i,[s,u[1]]}function or(r){return 1===r.checkedStmtIds.length}function ir(r,t){return!r.stmts.some((function(r){return r.id===t&&(!!(r.labelEditMode||r.typEditMode||r.contEditMode)||r.jstfEditMode)}))}function ar(r,t){var n=o.obj_dup(r);return n.disjEditMode=!1,n.disjText=t,n}function ur(r,t,n){return H(r,t,(function(r){if(""===n.trim())return r;var t=o.obj_dup(r);return t.labelEditMode=!1,t.label=n,t}))}function sr(r,t,n){return H(r,t,(function(t){if(""===n.trim())return t;var e=o.obj_dup(t);return e.isDuplicated=!1,e.contEditMode=!1,e.cont=R(n,d.some(r.preCtxColors),d.some(r.wrkCtxColors)),e}))}function fr(r,t){var n=G.make(100);return s.forEachHypothesisInDeclarationOrder(r,(function(e){if("F"===e.typ){var o=s.ctxIntToSym(r,e.expr[0]);if(void 0!==o){var i=G.get(t,o);void 0!==i&&G.set(n,s.ctxIntToSymExn(r,e.expr[1]),i)}}})),n}function cr(r){var t,n,e,i,a=o.obj_dup(r);return a.wrkCtxColors=(t=r.varsText,n=r.typeColors,e=G.make(16),"Ok"===(i=A.textToVarDefs(t)).TAG&&i._0.forEach((function(r){var t=r[2],o=r[1],i=G.get(n,o);if(void 0!==i)return G.set(e,t,i)})),e),a}function vr(r){var t=o.obj_dup(r);return t.stmts=r.stmts.map((function(t){var n=o.obj_dup(t);return n.cont=R(P(t.cont),d.some(r.preCtxColors),d.some(r.wrkCtxColors)),n})),t}function dr(r){return vr(cr(r))}function lr(r,t){var n=o.obj_dup(r);return n.varsEditMode=!1,n.varsText=t,dr(n)}function pr(r){var t=function(t){return"E"===t.typ?1:r.settings.stickGoalToBottom&&t.isGoal?3:2},n=r.stmts.length;if(n<2)return r;for(var e,i,a=r.stmts.slice(),u=!0,s=n-2|0;s>=0&&u;){u=!1;for(var f=0;f<=s;++f)if(e=a[f],i=a[f+1|0],(t(e)-t(i)|0)>0){var c=a[f];a[f]=a[f+1|0],a[f+1|0]=c,u=!0}s=s-1|0}var v=o.obj_dup(r);return v.stmts=a,v}function mr(r){var t=o.obj_dup(r);return t.stmts=r.stmts.map((function(r){var t=o.obj_dup(r);return t.syntaxErr=void 0,t.unifErr=void 0,t.proofStatus=void 0,t.proof=void 0,t.src=void 0,t.proofTreeDto=void 0,t.jstf=void 0,t.expr=void 0,t.stmtErr=void 0,t})),t.disjErr=void 0,t.varsErr=void 0,t}function hr(r){return c.isSome(r.stmtErr)}function gr(r){return!(!c.isSome(r.stmtErr)&&!c.isSome(r.syntaxErr))||c.isSome(r.unifErr)}function Er(r){return!(!c.isSome(r.varsErr)&&!c.isSome(r.disjErr))||r.stmts.some(hr)}function xr(r){var t=A.createWrkCtx(r.preCtx,r.varsText,r.disjText);if("Ok"!==t.TAG){var n,e=t._0,i=e.varsErr;if(void 0!==i){var a=o.obj_dup(r);a.varsErr=i,n=a}else n=r;var u=e.disjErr;if(void 0===u)return n;var s=o.obj_dup(n);return s.disjErr=u,s}var f=o.obj_dup(r);return f.wrkCtx=d.some(t._0),f}function yr(r){var t=r.trim();if(0===t.length)return{TAG:"Ok",_0:void 0};var n=t.split(":");return 2!==n.length?{TAG:"Error",_0:"Cannot parse justification: '"+t+"'. A justification must contain exactly one colon symbol."}:""===n[1].trim()?{TAG:"Error",_0:"Cannot parse justification: '"+t+"'. Reference must not be empty."}:{TAG:"Ok",_0:{args:e.getSpaceSeparatedValuesAsArray(n[0]),label:n[1].trim()}}}function _r(r){if(c.isSome(r.stmtErr)||"E"===r.typ)return r;var t=yr(r.jstfText);if("Ok"===t.TAG){var n=o.obj_dup(r);return n.jstf=t._0,n}var e=o.obj_dup(r);return e.stmtErr={code:-1,msg:t._0},e}function br(r,t,n){return!!C.has(n,r)||s.isHyp(t,r)}function Ar(r){var t=r.wrkCtx;if(void 0!==t){var n=d.valFromOption(t),e=r.stmts.length,a=C.make(e),u=p.make(e,s.ExprHash),f={contents:void 0},v=[function(r){if(c.isSome(r.stmtErr))return r;if(!("E"===r.typ||"P"===r.typ&&r.isGoal)){if(!br(r.label,n,a))return r;var t=o.obj_dup(r);return t.stmtErr={code:-1,msg:"[4] Cannot reuse label '"+r.label+"'."},t}var e=s.getTokenType(n,r.label);if(void 0===e){if(!br(r.label,n,a))return r;var i=o.obj_dup(r);return i.stmtErr={code:-1,msg:"[3] Cannot reuse label '"+r.label+"'."},i}if("E"===r.typ){var u=o.obj_dup(r);return u.stmtErr={code:-1,msg:"[1] Cannot reuse label '"+r.label+"'."},u}switch(e){case"A":case"P":return r;default:var f=o.obj_dup(r);return f.stmtErr={code:-1,msg:"[2] Cannot reuse label '"+r.label+"'."},f}},function(r){if(c.isSome(r.stmtErr))return r;try{var t=o.obj_dup(r);return t.expr=s.ctxSymsToIntsExn(n,O(r.cont)),t}catch(t){var e=N.internalToOCamlException(t);if(e.RE_EXN_ID===i.MmException){var a=o.obj_dup(r);return a.stmtErr={code:-1,msg:e._1.msg},a}throw e}},function(r){if(c.isSome(r.stmtErr))return r;var t=f.contents;if(void 0===t)return r;if(!r.isGoal)return r;var n=o.obj_dup(r);return n.stmtErr={code:-1,msg:"Cannot re-define the goal. Previously defined goal is the step labeled '"+t+"'"},n},_r,function(t){var e=r.frms;if(c.isSome(t.stmtErr))return t;var u=t.jstf;if(void 0===u)return t;var f=u.label,v=u.args,d=v.find((function(r){return!br(r,n,a)}));if(void 0!==d){var l=o.obj_dup(t);return l.stmtErr={code:-1,msg:"The label '"+d+"' is not defined."},l}if(s.isAsrt(n,f)){var p=b.frmsGetByLabel(e,f);if(void 0!==p){var m=p.numOfHypsE,h=v.length;if(h===m)return t;var g=1===m?"essential hypothesis":"essential hypotheses",E=1===h?"is":"are",x=o.obj_dup(t);return x.stmtErr={code:-1,msg:"'"+f+"' assertion expects "+String(m)+" "+g+" but "+String(h)+" "+E+" provided."},x}throw{RE_EXN_ID:i.MmException,_1:{msg:"Could not get frame by label '"+f+"'"},Error:new Error}}var y=o.obj_dup(t);return y.stmtErr={code:-1,msg:"The label '"+f+"' doesn't refer to any assertion."},y},function(r){if(c.isSome(r.stmtErr))return r;var t=r.expr;if(void 0!==t){var e=s.getHypByExpr(n,t);if(void 0!==e){var a=o.obj_dup(r);return a.stmtErr={code:1,msg:"This statement is the same as the previously defined hypothesis - '"+e.label+"'"},a}var f=p.get(u,t);if(void 0!==f){var v=o.obj_dup(r);return v.stmtErr={code:1,msg:"This statement is the same as the previous one - '"+f+"'"},v}if(r.contEditMode||!(0===t.length||t[0]>=0))return r;var d=o.obj_dup(r);return d.stmtErr={code:-1,msg:"Any statement must begin with a constant."},d}throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot validateStmtExpr without expr."},Error:new Error}}];return l.reduce(r.stmts,r,(function(r,t){if(Er(r))return r;var n=l.reduce(v,t,(function(r,t){return c.isSome(r.stmtErr)?r:t(r)}));if(C.add(a,n.label),!c.isSome(n.stmtErr)){var e=n.expr;if(void 0===e)throw{RE_EXN_ID:i.MmException,_1:{msg:"Expr must be set in prepareUserStmtsForUnification."},Error:new Error};p.set(u,e,n.label),n.isGoal&&(f.contents=n.label)}return H(r,n.id,(function(r){return n}))}))}throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot prepareUserStmtsForUnification without wrkCtx."},Error:new Error}}function Tr(r){var t=mr(r);return l.reduce([pr,xr,Ar],t,(function(r,t){return Er(r)?r:t(r)}))}function kr(r,t,n,e){var a=void 0!==e&&e,u=r.wrkCtx;if(void 0!==u){var f,c=d.valFromOption(u),v=t.length;if(0===v)return[r,[]];if(void 0!==n){if(t.length!==n.length)throw{RE_EXN_ID:i.MmException,_1:{msg:"varTypes->Array.length != varNames->Array.length"},Error:new Error};f=n}else{var l=g.fromArray(r.settings.typeSettings.map((function(r){return[r.typ,r.prefix]})));f=s.generateNewVarNames(c,t,d.some(l),void 0)}var p=s.generateNewLabels(c,"var",v,void 0,void 0),m=s.ctxIntsToSymsExn(c,t);a||(s.applySingleStmt(c,{TAG:"Var",symbols:f},void 0,void 0,void 0,void 0),p.forEach((function(r,t){s.applySingleStmt(c,{TAG:"Floating",label:r,expr:[m[t],f[t]]},void 0,void 0,void 0,void 0)})));var h=s.ctxSymsToIntsExn(c,f),E=p.map((function(r,t){return r+" "+m[t]+" "+f[t]})).join("\n"),x=o.obj_dup(r);return x.varsText=[r.varsText,E].join("\n").trim(),[cr(x),h]}throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot create new variables without wrkCtx."},Error:new Error}}function Sr(r,t){var n=r.wrkCtx;if(void 0!==n){var e=d.valFromOption(n),a=[];if(s.disjForEachArr(t,void 0,void 0,void 0,void 0,(function(r){var t=s.ctxIntsToSymsExn(e,r);s.applySingleStmt(e,{TAG:"Disj",vars:t},void 0,void 0,void 0,void 0),a.push(t.join(" "))})),0===a.length)return r;var u=a.join("\n"),f=o.obj_dup(r);return f.disjText=[r.disjText,u].join("\n").trim(),f}throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot create new disjoints without wrkCtx."},Error:new Error}}function wr(r,t){var n=r.expr;if(void 0!==n)return s.exprEq(n,t.expr);throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot compare steps without expr."},Error:new Error}}function Ir(r){var t=r.wrkCtx;if(void 0!==t){var n=d.valFromOption(t),e=C.fromArray(D.arrFlatMap(r.stmts,(function(r){return O(r.cont)})));s.getLocalHyps(n).forEach((function(r){if("F"===r.typ&&r.label.startsWith("."))return C.add(e,s.ctxIntToSymExn(n,r.expr[1]))}));var o,a=s.getLocalVars(n).filter((function(r){return!C.has(e,r)}));if(0===a.length)o=r;else{var u=y.fromArray(s.ctxSymsToIntsExn(n,a));o=lr(r,s.getLocalHyps(n).filter((function(r){return"F"===r.typ&&!y.has(u,r.expr[1])})).map((function(r){return r.label+" "+s.ctxIntToSymExn(n,r.expr[0])+" "+s.ctxIntToSymExn(n,r.expr[1])})).join("\n"))}var f=s.disjMake();s.disjForEach(s.getLocalDisj(n),(function(r,t){if(C.has(e,s.ctxIntToSymExn(n,r))&&C.has(e,s.ctxIntToSymExn(n,t)))return s.disjAddPair(f,r,t)}));var c=s.disjToArr(f,!0,(function(r){return s.ctxIntToSym(n,r)}),(function(r){return s.getTypeOfVar(n,r)}),d.some(o.typeOrderInDisj)).map((function(r){return s.ctxIntsToSymsExn(n,r).join(" ")})).join("\n");return o.disjText!==c?ar(o,c):o}throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot remove unused variables without wrkCtx."},Error:new Error}}function Gr(r,t,n,e){if("object"==typeof n&&"Assertion"===n.TAG){var o=n.label,u=n.args,f=s.getFrame(r,o);if(void 0!==f){var c=[],v={contents:!0};return f.hyps.forEach((function(r,n){if("E"===r.typ&&v.contents){var s=a.get(u,n);if(void 0===s)throw{RE_EXN_ID:i.MmException,_1:{msg:"Too few arguments for '"+o+"' in srcToJstf."},Error:new Error};var f=p.get(e,t.nodes[s].expr);void 0!==f?c.push(f.label):v.contents=!1}})),v.contents?{args:c,label:o}:void 0}throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot find an assertion '"+o+"' in srcToJstf."},Error:new Error}}}function Cr(r,t,n){if(void 0===t)return c.flatMap(n,(function(t){return G.get(t,r)}));var e=G.get(d.valFromOption(t),r);return void 0!==e?e:c.flatMap(n,(function(t){return G.get(t,r)}))}function Mr(r,t,n){return{id:r.id,parent:r.parent,typ:r.typ,label:r.label,children:r.children.map((function(r){return"Subtree"===r.TAG?{TAG:"Subtree",_0:Mr(r._0,t,n)}:{TAG:"Symbol",id:r.id,parent:r.parent,symInt:r.symInt,sym:r.sym,color:Cr(r.sym,t,n),isVar:r.isVar}})),height:r.height}}function Nr(r,t,n,e,o,i,a){if("Uncompressed"===a.TAG)return"Error: only compressed proofs are supported.";var f=function(r,t){var n=r.length;if(n<=50)return[r];for(var e=[],o=u.Int.ceil(n/50),i=1;i<=o;++i){var a=Math.imul(i-1|0,50);e.push(r.substr(a,50))}return e}(a.compressedProofBlock).join(" "),c=i.label+" $p "+P(i.cont)+" $= ( "+a.labels.join(" ")+" ) "+f+" $.",v=0===o.trim().length,l=n.length>0||!s.disjIsEmpty(e)||!v,p=[];l&&p.push("${");var m=n.filter((function(r){return"F"===r.typ})).map((function(t){return s.ctxIntToSymExn(r,t.expr[1])}));return m.length>0&&p.push("$v "+m.join(" ")+" $."),n.forEach((function(t){"F"!==t.typ||p.push(t.label+" $f "+s.ctxIntsToStrExn(r,t.expr)+" $.")})),s.disjForEachArr(e,!0,(function(t){return s.ctxIntToSym(r,t)}),(function(t){return s.getTypeOfVar(r,t)}),d.some(t),(function(t){p.push("$d "+s.ctxIntsToStrExn(r,t)+" $.")})),n.forEach((function(t){"E"!==t.typ||p.push(t.label+" $e "+s.ctxIntsToStrExn(r,t.expr)+" $.")})),v||p.push("$( "+o+" $)"),p.push(c),l&&p.push("$}"),p.join("\r\n")}function Dr(r,t,n){return l.reduce(r.stmts,{TAG:"Ok",_0:r},(function(r,e){if("Ok"!==r.TAG)return r;var i=r._0;if("E"===e.typ)return{TAG:"Ok",_0:i};var a=yr(e.jstfText);if("Ok"!==a.TAG)return{TAG:"Error",_0:"Cannot parse justification '"+e.jstfText+"' for the step '"+e.label+"'"};var u=a._0;if(void 0===u)return{TAG:"Ok",_0:i};if(!u.args.includes(t))return{TAG:"Ok",_0:i};var s={args:u.args.map((function(r){return r===t?n:r})),label:u.label};return{TAG:"Ok",_0:H(i,e.id,(function(r){var t=o.obj_dup(r);return t.jstfText=I.jstfToStr(s),t}))}}))}var Ur=/[\s:]+/g;function jr(r,t,n){var e=n.replace(Ur,"");if(""===e)return{TAG:"Error",_0:"label must not be empty."};var i=r.stmts.find((function(r){return r.id!==t&&r.label===e}));if(void 0!==i)return{TAG:"Error",_0:"label '"+e+"' is used by another step."};var a=W(r,t);if(void 0===a)return{TAG:"Ok",_0:r};if(a.label===e)return{TAG:"Ok",_0:r};var u=Dr(r,a.label,e);return"Ok"===u.TAG?{TAG:"Ok",_0:H(u._0,t,(function(r){var t=o.obj_dup(r);return t.label=e,t}))}:{TAG:"Error",_0:u._0}}function Or(r,t,n){var e=W(r,t);if(void 0===e)return{TAG:"Error",_0:"Cannot find a step with id = '"+t+"'"};var i=W(r,n);if(void 0===i)return{TAG:"Error",_0:"Cannot find a step with id = '"+n+"'"};if(P(e.cont)!==P(i.cont))return{TAG:"Error",_0:"Steps to merge must have identical expressions."};var a=Dr(r,i.label,e.label);if("Ok"!==a.TAG)return{TAG:"Error",_0:a._0};var u=J(a._0,n);return"P"===i.typ&&i.isGoal&&"E"!==e.typ?jr(H(u,t,(function(r){var t=o.obj_dup(r);return t.isGoal=!0,t.typ="P",t})),t,i.label):{TAG:"Ok",_0:u}}var Pr=/^\d+$/;function Rr(r){return c.isSome(d.null_to_opt(r.match(Pr)))}function Fr(r,t,n){if(t.id!==n.id)throw{RE_EXN_ID:i.MmException,_1:{msg:"renameHypToMatchGoal: oldStmt.id != newStmt.id"},Error:new Error};var e=t.id;if("P"!==t.typ||"E"!==n.typ||!Rr(n.label))return r;var o=c.isSome(r.stmts.find((function(r){return r.isGoal})))||c.isSome(s.getTokenType(r.preCtx,n.label))?rr(r,void 0,!0):n.label;if(o===n.label)return r;var a=jr(r,e,o);return"Ok"===a.TAG?a._0:r}function Vr(r,t,n,e){var i=z(r,t),a=H(r,t,(function(r){var t,i=o.obj_dup(r);return t="E"!==n&&e,i.isGoal=t,i.typEditMode=!1,i.typ=n,i}));return Fr(a,i,z(a,t))}var Br="HYP";function Lr(r,t,n){var e=z(r,t),i=H(r,t,(function(e){var i=n.trim().toLocaleUpperCase(),a=i===Br?"E":"P",u=i===Br?"":n.trim(),s=l.reduce(r.stmts,0,(function(r,n){return n.id!==t&&"P"===n.typ?r+1|0:r})),f="E"!==a&&(e.isGoal||r.settings.initStmtIsGoal&&0===s),c=f&&!e.isGoal&&r.settings.defaultStmtLabel.length>0?r.settings.defaultStmtLabel:e.label,v=o.obj_dup(e);return v.jstfEditMode=!1,v.jstfText=u,v.isGoal=f,v.typ=a,v.label=c,v}));return Fr(i,e,z(i,t))}function Wr(r){if(void 0===r)return!1;switch(r){case"H":return!0;case"P":case"G":return!1}}function Xr(r,t,n){var e=[function(r,t,n){var e=n.cont;return void 0!==e&&""!==e.trim()?{TAG:"Ok",_0:sr(r,t,e)}:{TAG:"Error",_0:"Steps must not have empty statements."}},function(r,t,n){var e=n.label;return void 0!==e?""===e.trim()?{TAG:"Error",_0:"Steps must not have empty labels."}:{TAG:"Ok",_0:ur(r,t,e)}:{TAG:"Ok",_0:r}},function(r,t,n){var e=n.typ;if(void 0===e)return{TAG:"Ok",_0:r};var o=F(e);return{TAG:"Ok",_0:Vr(r,t,o[0],o[1])}},function(r,t,n){var e=n.jstf;return void 0!==e?{TAG:"Ok",_0:Lr(r,t,e)}:{TAG:"Ok",_0:r}},function(r,t,n){var e=n.isBkm;return void 0!==e?{TAG:"Ok",_0:H(r,t,(function(r){var t=o.obj_dup(r);return t.isBkm=e,t}))}:{TAG:"Ok",_0:r}}],i=[],a=l.reduceWithIndex(n,{TAG:"Ok",_0:r},(function(r,n,o){if("Ok"!==r.TAG)return r;var a=r._0,u=void 0!==t?er(a,t+o|0,Wr(n.typ)):nr(a,Wr(n.typ),void 0),s=u[1];return i.push(s),l.reduce(e,{TAG:"Ok",_0:u[0]},(function(r,t){return v.flatMap(r,(function(r){return t(r,s,n)}))}))}));return"Ok"===a.TAG?{TAG:"Ok",_0:[a._0,i]}:{TAG:"Error",_0:a._0}}function zr(r){return r.stmts.find((function(r){return!r.isDuplicated&&c.getWithDefault(c.map(r.stmtErr,(function(r){return 1===r.code})),!1)}))}function Hr(r,t){var n=P(t.cont);return r.stmts.find((function(r){return!r.isDuplicated&&r.id!==t.id&&P(r.cont)===n}))}function qr(r,t){for(var n=[],e=r,o=!0;o;){var i=zr(e);if(void 0!==i){var a=Hr(e,i);if(void 0!==a){var u=i.jstfText.trim(),s=a.jstfText.trim();if(t)if(""===u)o=!1;else{var f=Or(e,a.id,i.id);"Ok"===f.TAG?(n.push([i.label,a.label]),e=Tr(f._0)):o=!1}else if(""!==u&&""===s){var c=Or(e,i.id,a.id);"Ok"===c.TAG?(n.push([a.label,i.label]),e=Tr(c._0)):o=!1}else if(""===s||""!==u&&u!==s)o=!1;else{var v=Or(e,a.id,i.id);"Ok"===v.TAG?(n.push([i.label,a.label]),e=Tr(v._0)):o=!1}}else o=!1}else o=!1}return[e,n]}function $r(r){var t=r.clickedNodeId;if(void 0!==t){var n=x.getNodeById(r.root,t[0]);if(void 0!==n&&"Subtree"!==n.TAG){var e=n.parent;if(0===r.expLvl)return{TAG:"Symbol",id:n.id,parent:e,symInt:n.symInt,sym:n.sym,color:n.color,isVar:n.isVar};for(var o=e,i=r.expLvl;i>1&&c.isSome(o);)i=i-1|0,o=c.getExn(o).parent;return void 0!==o?{TAG:"Subtree",_0:o}:{TAG:"Subtree",_0:r.root}}}}function Kr(r){return c.getWithDefault(c.map($r(r),x.syntaxTreeGetNumberOfSymbols),0)}function Jr(r){return{text:r.text,exprTyp:r.exprTyp,root:r.root,clickedNodeId:r.clickedNodeId,expLvl:Math.min(r.expLvl+1|0,r.root.height)}}function Qr(r){return{text:r.text,exprTyp:r.exprTyp,root:r.root,clickedNodeId:r.clickedNodeId,expLvl:Math.max(r.expLvl-1|0,0)}}function Zr(r,t){for(var n=t?Jr:Qr,e=r,o=Kr(e),i=n(e),a=Kr(i);o===a&&(t&&i.expLvl<i.root.height||!t&&i.expLvl>0);)o=Kr(e=i),a=Kr(i=n(e));return i}function Yr(r,t,n,e){var o=Tr(r);if(Er(o))return{TAG:"Error",_0:"Cannot perform renumbering because there is an error in the editor content. Please resolve the error before renumbering."};var i=o.stmts.filter(t).map((function(r){return r.id})),a=C.fromArray(i),u=l.reduce(o.stmts,{TAG:"Ok",_0:o},(function(r,t){if("Ok"!==r.TAG)return r;var n=r._0;return C.has(a,t.id)?jr(n,t.id,"###tmp###"+t.label):{TAG:"Ok",_0:n}})),s=l.reduce(i,u,(function(r,t){if("Ok"!==r.TAG)return r;var o=r._0;return jr(o,t,rr(o,n,e))}));if("Ok"!==s.TAG)return s;var f=Tr(s._0);return Er(f)?{TAG:"Error",_0:"Cannot renumber steps: there was an internal error during renumbering."}:{TAG:"Ok",_0:f}}function rt(r,t,n,e,o,i,u,v){if(0===n.length)return{TAG:"Error",_0:"Could not determine syntax types."};var l=function(t){return t.find((function(t){return c.isNone(s.ctxSymToInt(r,t))}))}(a.concatMany(t));if(void 0!==l)return{TAG:"Error",_0:"Unrecognized symbol: '"+l+"'"};var p=c.getWithDefault(c.flatMap(u,(function(t){return s.ctxSymToInt(r,t)})),0),m=D.sortInPlaceWith(n.slice(),(function(r,t){return r===p?-1:t===p?1:r-t|0})),g=t.map((function(t){return s.ctxSymsToIntsExn(r,t)})),E=f.proveSyntaxTypes(void 0,d.some(r),d.some(e),o,d.some(i),g,m,void 0),y=g.map((function(r){var t=h.ptGetSyntaxProof(E,r);if(void 0!==t)return h.pnGetExpr(d.valFromOption(t))})),_=S.proofTreeToDto(E,y.filter(c.isSome).map(c.getExn)),b=y.find(c.isSome);if(void 0!==b){var A=d.valFromOption(b);void 0!==A&&(void 0!==u?c.forEach(s.ctxIntToSym(r,A[0]),(function(r){if(u!==r)return v(r)})):c.forEach(s.ctxIntToSym(r,A[0]),v))}return{TAG:"Ok",_0:y.map((function(t){return void 0!==t?x.buildSyntaxProofTableFromProofTreeDto(r,_,t):{TAG:"Error",_0:"Could not prove this statement is of any of the types: "+s.ctxIntsToSymsExn(r,m).join(", ")}}))}}t.defaultJstfForHyp=Br,t.contIsEmpty=function(r){return"Text"===r.TAG?0===r.text.length:0===r._0.text.length},t.contToArrStr=O,t.contToStr=P,t.strToCont=R,t.userStmtTypeFromStr=function(r){switch(r){case"e":return"E";case"p":return"P";default:throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot convert '"+r+"' to userStmtType"},Error:new Error}}},t.userStmtTypeToStr=function(r){return"E"===r?"e":"p"},t.userStmtTypeExtendedFromStrExn=function(r){switch(r){case"g":return"G";case"h":return"H";case"p":return"P";default:throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot convert '"+r+"' to userStmtTypeExtended. Possible values are h, p, g."},Error:new Error}}},t.readInstrToStr=function(r){switch(r){case"ReadAll":return"ReadAll";case"StopBefore":return"StopBefore";case"StopAfter":return"StopAfter"}},t.readInstrFromStr=function(r){switch(r){case"ReadAll":return"ReadAll";case"StopAfter":return"StopAfter";case"StopBefore":return"StopBefore";default:throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot convert string '"+r+"' to a readInstr."},Error:new Error}}},t.mmFileSourceTypeToStr=function(r){return"Local"===r?"Local":"Web"},t.mmFileSourceTypeFromStr=function(r){switch(r){case"Local":return"Local";case"Web":return"Web";default:throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot convert string '"+r+"' to an mmFileSourceType."},Error:new Error}}},t.mmFileSourceTypeFromStrOpt=function(r){switch(r){case"Local":return"Local";case"Web":return"Web";default:return}},t.someStmtErrCode=-1,t.duplicatedStmtErrCode=1,t.createEmptyUserStmt=V,t.userStmtToRootStmt=B,t.updateStmt=H,t.isStmtChecked=q,t.toggleStmtChecked=$,t.checkAllStmts=function(r){var t=o.obj_dup(r);return t.checkedStmtIds=r.stmts.map((function(r){return[r.id,new Date]})),t},t.uncheckAllStmts=K,t.deleteCheckedStmts=function(r){var t=o.obj_dup(r);return t.checkedStmtIds=[],t.stmts=r.stmts.filter((function(t){return!q(r,t.id)})),t},t.deleteStmt=J,t.deleteStmts=Q,t.canMoveCheckedStmts=Z,t.moveCheckedStmts=Y,t.moveCheckedStmtsToTop=function(r){var t=r.stmts.filter((function(t){return q(r,t.id)})),n=r.stmts.filter((function(t){return!q(r,t.id)})),e=o.obj_dup(r);return e.stmts=a.concatMany([t,n]),e},t.moveCheckedStmtsToBottom=function(r){var t=r.stmts.filter((function(t){return q(r,t.id)})),n=r.stmts.filter((function(t){return!q(r,t.id)})),e=o.obj_dup(r);return e.stmts=a.concatMany([n,t]),e},t.getRootStmtsForUnification=function(r){var t,n=C.fromArray(r.checkedStmtIds.map((function(r){return r[0]})));if(0===C.size(n))return r.stmts;for(var e=r.stmts.length-1|0;e>=0&&c.isNone(t);){var o=r.stmts[e];C.has(n,o.id)&&(t=e),e=e-1|0}var i=t;return void 0!==i?r.stmts.slice(0,i+1|0):r.stmts},t.addNewStmt=nr,t.addNewStatements=function(r,t,n){var e=void 0!==n&&n,a=kr(r,t.newVarTypes,void 0,void 0),u=a[1],f=M.make();t.newVars.forEach((function(r,t){M.set(f,r,u[t])}));var v=function(r,t){return{newVars:r.newVars,newVarTypes:r.newVarTypes,newDisj:r.newDisj,newDisjStr:r.newDisjStr,stmts:r.stmts.map((function(r){return{label:r.label,expr:r.expr.map((function(r){return M.getWithDefault(t,r,r)})),exprStr:r.exprStr,jstf:r.jstf,isProved:r.isProved}}))}}(t,f),p=s.disjMake();s.disjForEach(v.newDisj,(function(r,t){s.disjAddPair(p,M.getWithDefault(f,r,r),M.getWithDefault(f,t,t))}));var m=Sr(a[0],p),h=function(r){return 0===r.checkedStmtIds.length?void 0:r.stmts.toReversed().find((function(t){return q(r,t.id)}))}(m),g=j.make(),E=function(r){return{args:r.args.map((function(r){return j.getWithDefault(g,r,r)})),label:r.label}},x=v.stmts.some((function(r){return m.stmts.some((function(t){return wr(t,r)}))})),y=c.isSome(h)&&!x,_={contents:m};return v.stmts.forEach((function(r){if(c.isSome(h)&&wr(c.getExn(h),r)){var t=c.getExn(h);return _.contents=H(_.contents,t.id,(function(t){var n=o.obj_dup(t),e=r.jstf;return n.jstfText=void 0!==e?I.jstfToStr(E(e)):t.jstfText,n})),j.set(g,r.label,t.label)}var n=function(r,t,n,e,a,u){var f=r.wrkCtx;if(void 0!==f){var v,p,m=d.valFromOption(f),h=s.getHypByExpr(m,t);if(void 0!==h)return[r,h.label];if(void 0!==e){var g=r.stmts.findIndex((function(r){return r.id===e}));v=-1!==g?g:r.stmts.length}else v=r.stmts.length;if(void 0!==n){var E=C.fromArray(n.args),x=l.reduceWithIndex(r.stmts,0,(function(r,t,n){return C.isEmpty(E)?r:(C.remove(E,t.label),n+1|0)}));p=v<x?v:x}else p=0;var y=function(r,e){var i;if(void 0!==e){var f=function(r,t){return r.stmts.findIndex((function(r){return r.id===t}))}(r,e.id)+1|0;i=p<=f&&f<=v?f:p}else i=a?v:p;var l=er(r,i,void 0),h=l[1],g=l[0],E=H(g,h,(function(r){var e=o.obj_dup(r);return e.expr=t,e.jstfText=c.mapWithDefault(n,"",I.jstfToStr),e.contEditMode=!1,e.cont=R(s.ctxIntsToStrExn(m,t),d.some(g.preCtxColors),d.some(g.wrkCtxColors)),e.isBkm=u,e.typ="P",e}));return[E,z(E,h).label]},_=function(r,t){return r.stmts.find((function(r){var n=r.expr;if(void 0!==n)return s.exprEq(n,t);throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot getUserStmtByExpr without stmt.expr."},Error:new Error}}))}(r,t);if(void 0===_)return y(r,void 0);if("E"===_.typ||c.isNone(n))return[r,_.label];var b=yr(_.jstfText);if("Ok"!==b.TAG)return y(r,_);var A=b._0;return void 0!==A?function(r){return void 0!==n&&I.jstfEq(r,n)}(A)?[r,_.label]:y(r,_):[void 0!==n?H(r,_.id,(function(r){var t=o.obj_dup(r);return t.jstfText=I.jstfToStr(n),t})):r,_.label]}throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot insertStmt without wrkCtx."},Error:new Error}}(_.contents,r.expr,c.map(r.jstf,E),c.map(h,(function(r){return r.id})),y,e);_.contents=n[0],j.set(g,r.label,n[1])})),_.contents},t.isSingleStmtChecked=or,t.duplicateCheckedStmt=function(r,t){if(!or(r))return r;var n=String(r.nextStmtId),e=r.checkedStmtIds[0][0],i=o.obj_dup(r);return i.checkedStmtIds=[[n,new Date]],i.stmts=a.concatMany(r.stmts.map((function(t){if(t.id!==e)return[t];var i=o.obj_dup(t);return[t,(i.jstfText="",i.isDuplicated=!0,i.isGoal=!1,i.label=rr(r,void 0,"E"===t.typ),i.id=n,i)]}))),i.nextStmtId=r.nextStmtId+1|0,t?Y(i,!0):i},t.bookmarkCheckedStmts=function(r,t){var n=r.checkedStmtIds.map((function(r){return r[0]})),e=o.obj_dup(r);return e.stmts=r.stmts.map((function(r){if(!n.includes(r.id))return r;var e=o.obj_dup(r);return e.isBkm=t,e})),e},t.canGoEditModeForStmt=ir,t.setDescrEditMode=function(r){var t=o.obj_dup(r);return t.descrEditMode=!0,t},t.completeDescrEditMode=function(r,t){var n=o.obj_dup(r);return n.descrEditMode=!1,n.descr=t,n},t.setVarsEditMode=function(r){var t=o.obj_dup(r);return t.varsEditMode=!0,t},t.completeVarsEditMode=lr,t.setDisjEditMode=function(r){var t=o.obj_dup(r);return t.disjEditMode=!0,t},t.completeDisjEditMode=ar,t.setLabelEditMode=function(r,t){return ir(r,t)?H(r,t,(function(r){var t=o.obj_dup(r);return t.labelEditMode=!0,t})):r},t.completeLabelEditMode=ur,t.setContEditMode=function(r,t){return ir(r,t)?H(r,t,(function(r){var t=o.obj_dup(r);return t.contEditMode=!0,t})):r},t.completeContEditMode=sr,t.setStmtCont=function(r,t,n){var e=P(n),i=r.settings.autoMergeStmts&&r.stmts.some((function(r){return P(r.cont)===e}));return H(r,t,(function(r){var t=o.obj_dup(r);return t.isDuplicated=i,t.cont=n,t}))},t.setTypEditMode=function(r,t){return ir(r,t)?H(r,t,(function(r){var t=o.obj_dup(r);return t.typEditMode=!0,t})):r},t.completeTypEditMode=Vr,t.setJstfEditMode=function(r,t){return ir(r,t)?H(r,t,(function(r){var t=o.obj_dup(r);return t.jstfEditMode=!0,t})):r},t.completeJstfEditMode=Lr,t.setNextAction=function(r,t){var n=o.obj_dup(r);return n.nextAction=t,n},t.setPreCtxData=function(r,t){for(var n=t.settingsV.val,i=s.ctxOptimizeForProver(t.ctxV.val,n.parens,!0,!0),a=A.prepareParenInts(i,n.parens),u=a.length/2|0,f=G.make(u),c=0;c<u;++c)G.set(f,s.ctxIntToSymExn(i,a[c<<1]),s.ctxIntToSymExn(i,a[1+(c<<1)|0]));var v=e.createTypeOrderFromStr(n.sortDisjByType,(function(r){return s.ctxSymToInt(i,r)})),d=o.obj_dup(r);return d.typeOrderInDisj=v,d.parensMap=f,d.syntaxTypes=t.syntaxTypes,d.allTypes=t.allTypes,d.parenCnt=t.parenCnt,d.frms=t.frms,d.preCtx=i,d.preCtxV=t.ctxV.ver,d.srcs=t.srcs,d.settings=n,d.settingsV=t.settingsV.ver,vr(cr(function(r){var t=o.obj_dup(r);return t.preCtxColors=fr(r.preCtx,r.typeColors),t}(function(r){var t=o.obj_dup(r);return t.typeColors=T.settingsGetTypeColors(r.settings),t}(d))))},t.editorStateHasCriticalErrors=Er,t.editorStateHasAnyErrors=function(r){return!!Er(r)||r.stmts.some(gr)},t.editorStateHasDuplicatedStmts=function(r){return r.stmts.some((function(r){return c.getWithDefault(c.map(r.stmtErr,(function(r){return 1===r.code})),!1)}))},t.createNewDisj=Sr,t.removeUnusedVars=Ir,t.applyUnifyAllResults=function(r,t){var n=r.wrkCtx;if(void 0!==n){var e=d.valFromOption(n),a=p.fromArray(t.nodes.map((function(r){return[r.expr,r]})),s.ExprHash),u=p.fromArray(r.stmts.map((function(r){var t=r.expr;if(void 0!==t)return[t,r];throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot applyUnifyAllResults without stmt.expr [1]."},Error:new Error}})),s.ExprHash),f=p.fromArray(t.syntaxProofs,s.ExprHash);return l.reduce(r.stmts,r,(function(r,n){var v=o.obj_dup(n);return v.proofStatus=void 0,v.proof=void 0,H(r,v.id,(function(n){var v=n.expr;if(void 0!==v){var l=function(r,t,n,e,i,a){var u=t.cont;if("Text"!==u.TAG)return t;var s=p.get(i,n.slice(1)),f=void 0!==s?x.buildSyntaxTreeFromProofTreeDto(e,a,s.expr):void 0;if(void 0!==f){if("Ok"===f.TAG){var c=o.obj_dup(t);return c.cont={TAG:"Tree",_0:{text:u.text,exprTyp:u.syms[0].sym,root:Mr(f._0,d.some(r.preCtxColors),d.some(r.wrkCtxColors)),clickedNodeId:void 0,expLvl:0}},c}var v=o.obj_dup(t);return v.syntaxErr=f._0,v}if(!r.settings.checkSyntax)return t;var l=o.obj_dup(t);return l.syntaxErr=function(r,t){var n="Balanced";_.parenCntReset(t);for(var e=0;e<r.length&&"Failed"!==n;)n=_.parenCntPut(t,r[e]),e=e+1|0;return"Balanced"===n}(n,r.parenCnt)?"":"parentheses mismatch",l}(r,n,v,e,f,t);if("P"!==l.typ)return l;var m=p.get(a,v);if(void 0!==m){var h=function(r,t,n,e,i){var a,u=e.proof;if(void 0!==u){var s=Gr(t,n,u,i);if(void 0!==s){var f=r.jstf;if(void 0!==f)if(I.jstfEq(s,f)){var c=o.obj_dup(r);c.proof=e,c.proofTreeDto=n,a=c}else a=r;else{var v=o.obj_dup(r);v.proof=e,v.proofTreeDto=n,v.jstfText=I.jstfToStr(s),a=v}}else a=r}else a=r;var d=o.obj_dup(a);return d.proofTreeDto=n,d}(l,e,t,m,u),g=h.proof;if(void 0!==g){var E=o.obj_dup(h);return E.proofStatus="Ready",E.src=g.proof,E}var y=h.jstf;if(void 0!==y){var b=m.parents.find((function(r){var n=Gr(e,t,r,u);return void 0!==n&&I.jstfEq(y,n)}));if(void 0!==b){var A=o.obj_dup(h);return A.proofStatus="Waiting",A.src=b,A}var T=m.parents.map((function(r){return"object"!=typeof r||"AssertionWithErr"!==r.TAG?void 0:[r.label,r.err]})).filter(c.isSome).map(c.getExn),k=T.length>0?T.map((function(r){var t=r[0];return U.unifErrToStr(r[1],(function(r){return s.ctxIntsToStrExn(e,r)}),(function(r){return s.frmIntsToStrExn(e,s.getFrameExn(e,t),r)}))})).join("\n\n"):void 0,S=o.obj_dup(h);return S.unifErr=c.orElse(h.unifErr,k),S.proofStatus="JstfIsIncorrect",S}var w=m.parents.map((function(r){if("object"==typeof r&&"AssertionWithErr"===r.TAG){var t=r.err;return"object"!=typeof t||"TooManyCombinations"!==t.TAG?void 0:r.label}})).filter(c.isSome).map(c.getExn),G=w.length>0?U.unifErrToStr({TAG:"TooManyCombinations",frmLabels:w},(function(r){return s.ctxIntsToStrExn(e,r)}),(function(r){return"<frmExprToStr is not defined>"})):void 0,C=o.obj_dup(h);return C.unifErr=c.orElse(h.unifErr,G),C.proofStatus="NoJstf",C}throw{RE_EXN_ID:i.MmException,_1:{msg:"exprToNode->Belt_HashMap.get(expr) is None"},Error:new Error}}throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot applyUnifyAllResults without stmt.expr [2]."},Error:new Error}}))}))}throw{RE_EXN_ID:i.MmException,_1:{msg:"Cannot applyUnifyAllResults without wrkCtx."},Error:new Error}},t.verifyEditorState=function(r){var t=Tr(r);if(!c.isSome(t.wrkCtx))return t;var n=Ir(t);return Tr(n.settings.autoMergeStmts?qr(n,!1)[0]:n)},t.generateCompressedProof=function(r,t){var n=r.wrkCtx;if(void 0!==n){var e=d.valFromOption(n),o=W(r,t);if(void 0!==o){var a=o.proofTreeDto;if(void 0!==a){var u=o.proof;if(void 0!==u){var v=r.preCtx,l=B(o).expr,p=S.createProofTable(a,u,void 0,void 0),h=S.createProofTable(a,u,!0,d.some(e)),g=m.fromArray(p.map((function(r){return r.expr})),s.ExprHash),x=r.stmts.map(B),_=f.createProofCtx(e,x.filter((function(r){return!!r.isHyp&&m.has(g,r.expr)}))),b=s.getMandHyps(_,l,void 0,void 0),A=E.createProof(b,p,p.length-1|0),T=[];b.forEach((function(r){c.isNone(s.getHypByExpr(v,r.expr))&&T.push(r)}));var k=y.make(16);m.forEach(g,(function(r){r.forEach((function(r){if(r>=0)return y.add(k,r)}))}));var I=y.fromArray(b.map((function(r){return r.expr[1]})));s.getLocalHyps(e).forEach((function(r){if("F"===r.typ){var t=r.expr[1];!y.has(k,t)||y.has(I,t)||T.push(r)}}));var G=s.disjMake();return w.verifyProof(_,l,A,(function(r,t){if(!s.isDisj(e,r,t))throw{RE_EXN_ID:i.MmException,_1:{msg:"!(wrkCtx->isDisj(n,m))"},Error:new Error};return s.isDisj(v,r,t)||s.disjAddPair(G,r,t),!0})),[Nr(e,r.typeOrderInDisj,T,G,r.descr,o,A),E.proofTableToStr(e,p,o.label),E.proofTableToStr(e,h,o.label)]}}}}},t.updateColorsInAllStmts=vr,t.getTheOnlyCheckedStmt=function(r){return 1!==r.checkedStmtIds.length?void 0:tr(r)},t.editorGetStmtById=W,t.editorGetStmtByIdExn=z,t.editorGetStmtByLabel=X,t.getAllExprsToSyntaxCheck=function(r,t){var n=[];return r.stmts.forEach((function(r,e){"Text"===r.cont.TAG&&n.push(t[e].expr.slice(1))})),n},t.mergeStmts=Or,t.renameStmt=jr,t.findStmtsToMerge=function(r){var t;if(0===r.checkedStmtIds.length)t=r.stmts.find((function(r){return c.getWithDefault(c.map(r.stmtErr,(function(r){return 1===r.code})),!1)}));else{var n=r.checkedStmtIds[0];t=W(r,n[0])}if(void 0===t)return{TAG:"Error",_0:"[1] Cannot determine a duplicated step."};var e=P(t.cont),o=r.stmts.find((function(r){return r.id!==t.id&&P(r.cont)===e}));return void 0===o?{TAG:"Error",_0:"[2] Cannot find another step to merge with."}:r.stmts.findIndex((function(r){return r.id===t.id}))<r.stmts.findIndex((function(r){return r.id===o.id}))?{TAG:"Ok",_0:[t,o]}:{TAG:"Ok",_0:[o,t]}},t.parseJstf=yr,t.removeAllTempData=mr,t.isEditMode=function(r){return!!(r.descrEditMode||r.varsEditMode||r.disjEditMode)||r.stmts.some((function(r){return!!(r.labelEditMode||r.typEditMode||r.contEditMode)||r.jstfEditMode}))},t.resetEditorContent=function(r){var t=o.obj_dup(r);return t.checkedStmtIds=[],t.stmts=[],t.disjEditMode=!1,t.disjText="",t.varsEditMode=!1,t.varsText="",t.descrEditMode=!1,t.descr="",t},t.deleteUnrelatedSteps=function(r,t,n){var e=Tr(r);if(Er(e))return{TAG:"Error",_0:"Cannot perform deletion because there is an error in the editor content. Please resolve the error before deleting steps."};var o=k.fromArray(t);e.stmts.forEach((function(r){if(!n&&"E"===r.typ||r.isGoal||r.isBkm)return k.add(o,r.id)}));for(var i=C.make(Math.imul(t.length,5));!k.isEmpty(o);){var a=c.getExn(k.pop(o));if(!C.has(i,a)){C.add(i,a);var u=W(e,a);if(void 0!==u){var s=u.jstf;void 0!==s&&s.args.forEach((function(r){var t=X(e,r);if(void 0!==t)return k.add(o,t.id)}))}}}var f=e.stmts.map((function(r){return r.id})).filter((function(r){return!C.has(i,r)}));return{TAG:"Ok",_0:Q(e,f)}},t.autoMergeDuplicatedStatements=qr,t.userStmtHasCriticalErrors=hr,t.userStmtHasAnyErrors=gr,t.createNewVars=kr,t.addSteps=function(r,t,n,e,o){var i=void 0!==e?e:[];if(0===i.length)return Xr(r,t,n);var a=r.wrkCtx;if(void 0===a)return{TAG:"Error",_0:"Cannot add new variables because of errors in the editor."};var u=d.valFromOption(a),f=i.map((function(r){return r[0]})),v=f.map((function(r){return s.ctxSymToInt(u,r)})),l=v.findIndex(c.isNone);if(l>=0)return{TAG:"Error",_0:"Unknown type - "+f[l]};var p=v.map(c.getExn);return function(r){return!!r.every((function(r){return c.isNone(r[1])}))||r.every((function(r){return c.isSome(r[1])}))}(i)?Xr(i.some((function(r){return c.isNone(r[1])}))?kr(r,p,void 0,o)[0]:kr(r,p,i.map((function(r){return c.getExn(r[1])})),o)[0],t,n):{TAG:"Error",_0:"All variable names must be either defined or undefined."}},t.updateSteps=function(r,t){var n=[function(t,n){var e=n.cont;if(void 0===e)return{TAG:"Ok",_0:t};if(""===e.trim())return{TAG:"Error",_0:"Steps must not have empty statements."};var i=o.obj_dup(t);return{TAG:"Ok",_0:(i.isDuplicated=!1,i.contEditMode=!1,i.cont=R(e,d.some(r.preCtxColors),d.some(r.wrkCtxColors)),i)}},function(r,t){var n=t.typ;if(void 0===n)return{TAG:"Ok",_0:r};var e=F(n),i=o.obj_dup(r);return{TAG:"Ok",_0:(i.isGoal=e[1],i.typEditMode=!1,i.typ=e[0],i)}},function(r,t){var n=t.jstf;if(void 0===n)return{TAG:"Ok",_0:r};var e=o.obj_dup(r);return{TAG:"Ok",_0:(e.jstfEditMode=!1,e.jstfText=n,e)}},function(r,t){var n=t.isBkm;if(void 0===n)return{TAG:"Ok",_0:r};var e=o.obj_dup(r);return{TAG:"Ok",_0:(e.isBkm=n,e)}}],e=G.fromArray(t.filter((function(r){return c.isSome(r.id)})).map((function(r){return[c.getExn(r.id),r]}))),i=l.reduce(r.stmts,{TAG:"Ok",_0:[]},(function(r,t){if("Ok"!==r.TAG)return r;var o=r._0,i=G.get(e,t.id),a=void 0!==i?l.reduce(n,{TAG:"Ok",_0:t},(function(r,t){return v.flatMap(r,(function(r){return t(r,i)}))})):{TAG:"Ok",_0:t};return"Ok"!==a.TAG?{TAG:"Error",_0:a._0}:(o.push(a._0),{TAG:"Ok",_0:o})}));if("Ok"!==i.TAG)return{TAG:"Error",_0:i._0};var a=o.obj_dup(r);return{TAG:"Ok",_0:(a.stmts=i._0,a)}},t.getSelectedSubtree=$r,t.getSelectedSubtreeFromStmtCont=function(r){return c.flatMap(function(r){return"Text"===r.TAG?void 0:r._0}(r),$r)},t.getIdsOfSelectedNodes=function(r){if("Text"===r.TAG)return[-1,void 0];var t=r._0,n=t.clickedNodeId;if(void 0===n)return[-1,void 0];var e=$r(t);return void 0!==e?[n[0],x.syntaxTreeGetIdsOfAllChildSymbols(e)]:[-1,void 0]},t.hasSelectedText=function(r){return"Text"!==r.TAG&&void 0!==r._0.clickedNodeId},t.getSelectedText=function(r){return"Text"===r.TAG?void 0:c.map($r(r._0),x.syntaxTreeToText)},t.getNodeIdBySymIdx=function(r,t){var n={contents:0};return x.syntaxTreeForEachNode({TAG:"Subtree",_0:t},(function(t){if("Subtree"!==t.TAG)return n.contents=n.contents+1|0,n.contents===r?t.id:void 0}))},t.incExpLvl=Jr,t.decExpLvl=Qr,t.incExpLvlIfConstClicked=function(r){if(0!==r.expLvl)return r;var t=r.clickedNodeId;if(void 0===t)return r;var n=x.getNodeById(r.root,t[0]);return void 0!==n&&"Subtree"!==n.TAG&&1!==x.syntaxTreeGetNumberOfSymbols({TAG:"Subtree",_0:n.parent})?Zr(r,!0):r},t.getNumberOfSelectedSymbols=Kr,t.updateExpLevel=Zr,t.addColorsToSyntaxTree=Mr,t.getColorForSymbol=Cr,t.createSymbolColors=fr,t.renumberProvableSteps=function(r){return Yr(r,(function(r){return"P"===r.typ&&Rr(r.label)}),"",!1)},t.renumberHypothesisSteps=function(r,t){return Yr(r,(function(r){return"E"===r.typ}),t+".",!0)},t.textToSyntaxProofTable=rt,t.textToSyntaxTree=function(r,t,n,e,o,i,a,u){var s=rt(r,t,n,e,o,i,a,u);return"Ok"===s.TAG?{TAG:"Ok",_0:s._0.map((function(t){if("Ok"!==t.TAG)return{TAG:"Error",_0:t._0};var n=t._0;return x.buildSyntaxTree(r,n,n.length-1|0)}))}:{TAG:"Error",_0:s._0}},t.recalcWrkColors=dr},7115:(r,t,n)=>{var e=n(2971),o=n(3333),i=n(1094),a=n(303),u=n(7356),s=n(1874),f=n(9662),c=n(5047),v=n(8492),d=n(7653),l="MM_wrk_search_asrt";function p(r,t,n,e,o,i){if(o===t.length)return!0;for(var a={contents:i},s=function(){return p(r,t,n,e,o+1|0,a.contents+1|0)},f=!1,c=r.asrt.length-(t.length-o|0)|0;!f&&a.contents<=c;){var v=r.asrt[a.contents],d=t[o];if(v<0&&v===d)f=s();else if(v>=0&&r.varTypes[v]===n[o])if(d<0)f=s();else{var l=u.get(e,d);void 0!==l?l===v&&(f=s()):(u.set(e,d,v),f=s(),u.remove(e,d))}a.contents=a.contents+1|0}return f}function m(r,t,n,e){return!!function(r,t){for(var n=t.length,e=r.asrt.length,o=0,i=0;o<n&&i<e;){var a=r.asrt[i];(a<0&&a===t[o]||a>=0&&r.varTypes[a]===t[o])&&(o=o+1|0),i=i+1|0}return o===n}(r,n)&&p(r,t,n,e,0,0)}function h(r,t,n,f,v,l){var p=d.progressTrackerMake(.01,void 0,l,void 0),h={contents:0},g=s.frmsSize(t),E=v.map((function(t){return t<0?t:o.getTypeOfVarExn(r,t)})),x=[];return c.sortInPlaceWith(s.frmsSelect(t,void 0,void 0),(function(r,t){return r.frame.ord-t.frame.ord|0})).forEach((function(t){var s=t.frame;if(s.label.toLowerCase().includes(n)&&s.asrt[0]===f&&m(s,v,E,u.make(v.length))){var c=o.disjMake();i.forEach(s.disj,(function(r,t){a.forEach(t,(function(t){o.disjAddPair(c,r,t)}))}));var l=[];o.disjForEachArr(c,void 0,void 0,void 0,void 0,(function(t){l.push(o.frmIntsToStrExn(r,s,t))}));var y=[],_=[];s.hyps.forEach((function(t){if("E"===t.typ){var n=t.label;_.push(n),y.push({label:n,expr:t.expr,exprStr:o.frmIntsToStrExn(r,s,t.expr),jstf:void 0,isProved:!1})}})),y.push({label:s.label,expr:s.asrt,exprStr:o.frmIntsToStrExn(r,s,s.asrt),jstf:{args:_,label:s.label},isProved:!1}),x.push({newVars:e.range(0,s.numOfVars-1|0),newVarTypes:s.varTypes,newDisj:c,newDisjStr:l,stmts:y})}h.contents=h.contents+1,d.progressTrackerSetCurrPct(p,h.contents/g)})),x}t.procName=l,t.doSearchAssertions=h,t.searchAssertions=function(r,t,n,e,o,i,a,u,s,c){return v.promise((function(v){f.beginWorkerInteractionUsingCtx(r,t,n,e,o,i,l,{TAG:"FindAssertions",label:a.toLowerCase(),typ:u,pattern:s},(function(r,t,n){if("OnProgress"===r.TAG)return c(r._0);n(),v(r.found)}),!1)}))},t.processOnWorkerSide=function(r,t){var n=h(f.getWrkCtxExn(),f.getWrkFrmsExn(),r.label,r.typ,r.pattern,(function(r){t({TAG:"OnProgress",_0:r})}));t({TAG:"SearchResult",found:n})},t.frameMatchesVarPattern=m,t.reqToStr=function(r){return'FindAssertions(label="'+r.label+'", typ='+String(r.typ)+", pattern=["+r.pattern.map((function(r){return String(r)})).join(", ")+"])"},t.respToStr=function(r){return"OnProgress"===r.TAG?"OnProgress(pct="+String(r._0)+")":"SearchResult"}},7470:(r,t,n)=>{var e=n(4923),o=n(6517),i=n(2275);t.markUrlAsTrusted=function(r,t){if(o.isSome(r.webSrcSettings.find((function(r){return r.url===t})))){var n=e.obj_dup(r);return n.webSrcSettings=r.webSrcSettings.map((function(r){return r.url===t?{alias:r.alias,url:r.url,trusted:!0}:r})),n}var i=e.obj_dup(r);return i.webSrcSettings=r.webSrcSettings.concat([{alias:"",url:t,trusted:!0}]),i},t.settingsGetTypeColors=function(r){return i.fromArray(r.typeSettings.map((function(r){return[r.typ,r.color]})))}},4186:(r,t,n)=>{var e=n(55),o=n(3333),i=n(9592),a=n(6517),u=n(7175),s=n(2815),f=n(9775),c=n(7356),v=n(9662),d=n(368),l=n(1717),p=n(9702),m=n(8615),h=n(8492),g="MM_wrk_unify";function E(r,t,n){var e=new Array(r.numOfVars);return r.hyps.forEach((function(r,o){"F"!==r.typ||(e[r.expr[1]]=n.nodes[t[o]].expr)})),e}t.procName=g,t.unify=function(r,t,n,e,o,i,a,u,s,f,c,d,l){return h.promise((function(p){v.beginWorkerInteractionUsingCtx(r,t,n,e,o,i,g,{TAG:"Unify",rootStmts:a,bottomUpProverParams:u,allowedFrms:s,combCntMax:t.combCntMax,syntaxTypes:f,exprsToSyntaxCheck:c,debugLevel:d},(function(r,t,n){if("OnProgress"===r.TAG)return l(r._0);n(),p(r._0)}),!1)}))},t.processOnWorkerSide=function(r,t){var n=r.rootStmts,e=i.unifyAll(v.getWrkCtxExn(),v.getWrkFrmsExn(),n,v.getWrkParenCntExn(),r.bottomUpProverParams,r.allowedFrms,r.combCntMax,r.syntaxTypes,r.exprsToSyntaxCheck,r.debugLevel,(function(r){t({TAG:"OnProgress",_0:r})}));t({TAG:"Result",_0:l.proofTreeToDto(e,n.map((function(r){return r.expr})))})},t.proofTreeDtoToNewStmtsDto=function(r,t,n,i,v,l){var h=c.fromArray(r.newVars.map((function(r){if(2!==r.length)throw{RE_EXN_ID:"Match_failure",_1:["MM_wrk_unify.res",391,64],Error:new Error};var t=r[0];return[r[1],t]}))),g=r.nodes.find((function(r){return o.exprEq(r.expr,t)}));if(void 0===g)throw{RE_EXN_ID:e.MmException,_1:{msg:"the proof tree DTO doesn't contain the node to prove."},Error:new Error};return g.parents.map((function(g){if("object"==typeof g&&"Assertion"===g.TAG){var x=g.args,y={contents:!1},_={contents:!1},b=[],A=[],T=o.disjMake(),k=[],S=[],w={newVars:b,newVarTypes:A,newDisj:T,newDisjStr:k,stmts:S},I=s.toArray(v),G=s.fromArray(I,o.ExprHash),C=m.fromArray(l),M=function(r,t,i){var a=s.get(G,r);if(void 0!==a)return a;var f=o.getHypByExpr(n,r);if(void 0!==f)return f.label;if(i){var c=o.generateNewLabels(n,t,1,u.some(C),!0)[0];return s.set(G,r,c),m.add(C,c),c}throw{RE_EXN_ID:e.MmException,_1:{msg:"Could not find a label for an expr."},Error:new Error}},N=function(r,t){return M(r,t,!0)},D=function(r){return M(r,"",!1)},U=c.make(8),j=m.make(8),O=o.getNumOfVars(n)-1|0,P=function(r){if(r<=O){var t=o.ctxIntToSym(n,r);if(void 0!==t)return t;throw{RE_EXN_ID:e.MmException,_1:{msg:"Cannot determine sym for an existing int in srcToNewStmts."},Error:new Error}}var i=c.get(U,r);if(void 0!==i)return i;throw{RE_EXN_ID:e.MmException,_1:{msg:"Cannot determine name of a new var in srcToNewStmts."},Error:new Error}},R=function(r){var t=o.getFrame(n,r);if(void 0!==t)return t;throw{RE_EXN_ID:e.MmException,_1:{msg:"Cannot get a frame by label '"+r+" in srcToNewStmts.'"},Error:new Error}},F=function(t,a,s,f){a.forEach((function(r){if(r>O&&!b.includes(r)){var t=c.get(h,r);if(void 0!==t){b.push(r),A.push(t);var a=o.generateNewVarNames(n,[t],u.some(i),u.some(j))[0];return c.set(U,r,a),m.add(j,a),void N([t,r],"v")}throw{RE_EXN_ID:e.MmException,_1:{msg:"Cannot determine type of a new var in srcToNewStmts."},Error:new Error}}}));var v,d=a.map(P).join(" ");if(void 0!==s&&"object"==typeof s)switch(s.TAG){case"Hypothesis":v=void 0;break;case"Assertion":var l=s.label,p=s.args,g=[];R(l).hyps.forEach((function(t,n){"E"!==t.typ||g.push(D(r.nodes[p[n]].expr))})),v={args:g,label:l};break;case"AssertionWithErr":y.contents=!0,v=void 0}else v=void 0;S.push({label:t,expr:a,exprStr:d,jstf:v,isProved:f})},V=R(g.label),B=[];V.hyps.forEach((function(t,n){"E"!==t.typ||B.push(r.nodes[x[n]])}));var L=f.make(16,o.ExprHash),W=f.make(16,o.ExprHash);return B.forEach((function(e){d.traverseTree(f.fromArray([t],o.ExprHash),e,(function(t,n){if(!f.has(L,n.expr)){f.add(L,n.expr);var e=n.proof;if(void 0!==e&&"object"==typeof e)switch(e.TAG){case"Hypothesis":return;case"Assertion":var o=e.args,i=[];return R(e.label).hyps.forEach((function(t,n){"E"!==t.typ||i.push(r.nodes[o[n]])})),i;case"AssertionWithErr":return void(y.contents=!0)}}}),(function(r,t){return y.contents||_.contents?u.some(void 0):f.has(r,t.expr)?(_.contents=!0,u.some(void 0)):void f.add(r,t.expr)}),void 0,(function(t,e){if(f.remove(t,e.expr),y.contents||_.contents)return u.some(void 0);if(!f.has(W,e.expr)){f.add(W,e.expr);var i=e.proof;if(void 0!==i){if("object"==typeof i)switch(i.TAG){case"Hypothesis":return;case"Assertion":var a=R(i.label);return p.verifyDisjoints(E(a,i.args,r),a.disj,(function(r,t){return o.isDisj(n,r,t)||o.disjAddPair(T,r,t),!0})),void F(N(e.expr,""),e.expr,e.proof,!0);case"AssertionWithErr":return y.contents=!0,u.some(void 0)}}else F(N(e.expr,""),e.expr,void 0,!1)}}))})),y.contents||_.contents?void 0:(F(D(t),t,g,x.every((function(t){return a.isSome(r.nodes[t].proof)}))),p.verifyDisjoints(E(V,x,r),V.disj,(function(r,t){return o.isDisj(n,r,t)||o.disjAddPair(T,r,t),!0})),o.disjForEachArr(T,void 0,void 0,void 0,void 0,(function(r){k.push("$d "+r.map(P).join(" ")+" $.")})),w)}})).filter(a.isSome).map(a.getExn)},t.reqToStr=function(r){return"Unify(debugLevel="+String(r.debugLevel)+", bottomUpProverParams="+(void 0!==(t=r.bottomUpProverParams)?t.frameParams.map((function(r){return"{allowNewDisjForExistingVars="+(r.allowNewDisjForExistingVars?"true":"false")+"}"})).join("; "):"None")+")";var t},t.respToStr=function(r){return"OnProgress"===r.TAG?'OnProgress("'+r._0+'")':"Result"}},2855:(r,t,n)=>{var e=n(6862),o=n(6517),i=n(4186),a=n(5082),u=n(5171),s=n(9662),f=n(5376),c=n(8152),v=n(7115);function d(r,t,n){return function(o,i){var a=e.deserialize(o.body);o.traceEnabled&&e.logWorkerReceivedRequest(o.clientId,o.procName,a,t),r(a,(function(r){o.traceEnabled&&e.logWorkerIsSendingResponse(o.clientId,o.procName,r,n),i({clientId:o.clientId,body:e.serialize(r)})}))}}var l=a.fromArray([[c.procName,d(c.processOnWorkerSide,c.reqToStr,c.respToStr)],[u.procName,d(u.processOnWorkerSide,u.reqToStr,u.respToStr)],[f.procName,d(f.processOnWorkerSide,f.reqToStr,f.respToStr)],[s.procName,d(s.processOnWorkerSide,s.reqToStr,s.respToStr)],[v.procName,d(v.processOnWorkerSide,v.reqToStr,v.respToStr)],[i.procName,d(i.processOnWorkerSide,i.reqToStr,i.respToStr)]]);t.U=function(r){o.forEach(a.get(l,r.procName),(function(t){t(r,(function(r){postMessage(r)}))}))}},5047:(r,t,n)=>{var e=n(2900),o=n(2971),i=n(5300),a=n(6517),u=n(303),s=n(1367),f=n(6181),c=e.raiseError,v=f.create("Expln_utils_common.ExplnUtilsException");t.exn=c,t.clearArray=r=>r.length=0,t.arrFlatMap=function(r,t){return o.concatMany(o.map(r,t))},t.arrStrDistinct=function(r){return s.toArray(s.fromArray(r))},t.arrIntDistinct=function(r){return u.toArray(u.fromArray(r))},t.arrForEach=function(r,t){for(var n,e=r.length,o=0;o<e&&a.isNone(n);)n=t(r[o]),o=o+1|0;return n},t.arrJoin=function(r,t){var n=r.length;if(n<2)return r;for(var e=new Array((n<<1)-1|0),o=n-1|0,i=0;i<=o;++i)e[i<<1]=r[i],i!==o&&(e[1+(i<<1)|0]=t);return e},t.copySubArray=function(r,t,n,e,o){for(var i=t,a=e,u=r.length,s=n.length,f=Math.min(u-1|0,(t+o|0)-1|0);i<=f&&a<s;)n[a]=r[i],a=a+1|0,i=i+1|0},t.toIntCmp=function(r){return function(t,n){return i.Int.floor(Math.sign(r(t,n)))}},t.intCmp=function(r,t){return r<t?-1:r===t?0:1},t.floatCmp=function(r,t){return r<t?-1:r===t?0:1},t.strCmp=function(r,t){return r.localeCompare(t)},t.strCmpI=function(r,t){return r.toLocaleUpperCase().localeCompare(t.toLocaleUpperCase())},t.cmpRev=function(r){return function(t,n){return-r(t,n)}},t.stringify=function(r){var t=JSON.stringify(r);return void 0!==t?t:"undefined"},t.ExplnUtilsException=v,t.comparatorBy=function(r){return function(t,n){var e=r(t),o=r(n);return e<o?-1:e===o?0:1}},t.comparatorAndThen=function(r,t){return function(n,e){var o=r(n,e);return 0!==o?o:t(n,e)}},t.comparatorInverse=function(r){return function(t,n){return-r(t,n)}},t.hashStr=r=>{let t=0;for(let n=0;n<r.length;n++)t=(t<<5)-t+r.charCodeAt(n),t|=0;return t},t.hashArrInt=r=>{let t=0;for(let n=0;n<r.length;n++)t=(t<<5)-t+r[n],t|=0;return t},t.hashArrIntFromTo=(r,t,n)=>{let e=0;for(let o=t;o<=n;o++)e=(e<<5)-e+r[o],e|=0;return e},t.hash2=(r,t)=>(r<<5)-r+t|0,t.sortInPlaceWith=function(r,t){return r.sort(t),r}},368:(r,t,n)=>{var e=n(6517),o=n(6601),i=n(5047);t.log=function(r){console.log(r)},t.log2=function(r,t){console.log(r,t)},t.traverseTree=function(r,t,n,a,u,s){var f,c=e.isSome(a),v=e.isSome(u),d=e.isSome(s),l=o.make();for(o.push(l,{node:t,nodesToPostProcess:d?[t]:void 0});!o.isEmpty(l)&&e.isNone(f);){var p=o.pop(l);if(void 0!==p&&(c&&(f=e.flatMap(a,function(t){return function(n){return n(r,t.node)}}(p))),v&&e.isNone(f)&&(f=e.flatMap(u,function(t){return function(n){return n(r,t.node)}}(p))),e.isNone(f))){var m=n(r,p.node),h=0;if(void 0!==m&&0!==m.length)for(var g=m.length-1|0,E=g;E>=0;--E){var x;if(d)if(E===g){var y=p.nodesToPostProcess;if(void 0===y)throw{RE_EXN_ID:i.ExplnUtilsException,_1:{msg:"this case is not possible, because each node has itself in its nodesToPostProcess (2)"},Error:new Error};y.push(m[E]),x=y}else x=[m[E]];else x=void 0;o.push(l,{node:m[E],nodesToPostProcess:x})}else h=1;if(1===h&&d){var _=p.nodesToPostProcess;if(void 0===_)throw{RE_EXN_ID:i.ExplnUtilsException,_1:{msg:"this case is not possible, because each node has itself in its nodesToPostProcess (1)"},Error:new Error};for(var b={contents:_.length-1|0};b.contents>=0&&e.isNone(f);)f=e.flatMap(s,function(t,n){return function(e){return e(r,n[t.contents])}}(b,_)),b.contents=b.contents-1|0}}}return[r,f]}},8492:(r,t,n)=>{var e=n(4518);function o(r){return new Promise((function(t,n){try{return r((function(r){t(r)}))}catch(r){return n(e.internalToOCamlException(r))}}))}t.promise=o,t.promiseFlatMap=function(r,t){return r.then(t)},t.promiseMap=function(r,t){return r.then((function(r){return Promise.resolve(t(r))}))},t.promiseResolved=function(r){return o((function(t){t(r)}))}}},n={};r=function r(e){var o=n[e];if(void 0!==o)return o.exports;var i=n[e]={exports:{}};return t[e](i,i.exports,r),i.exports}(2855),onmessage=t=>{(0,r.U)(t.data)}})();