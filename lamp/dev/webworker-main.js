(()=>{"use strict";var r,t={2761:(r,t,e)=>{var n=e(7175);function o(r,t,e){var n=r[t];r[t]=r[e],r[e]=n}function i(r){for(var t,e,n=r.length,i=0;i<n;++i)o(r,i,(t=i,e=n,(0|Math.floor(Math.random()*(e-t|0)))+t|0))}function a(r,t){for(var e=r.length,o=new Array(e),i=0,a=0;a<e;++a){var s=t(r[a]);void 0!==s&&(o[i]=n.valFromOption(s),i=i+1|0)}return o.length=i,o}t.make=function(r,t){if(r<=0)return[];var e=new Array(r);return e.fill(t),e},t.fromInitializer=function(r,t){if(r<=0)return[];for(var e=new Array(r),n=0;n<r;++n)e[n]=t(n);return e},t.equal=function(r,t,e){var n=r.length;if(n!==t.length)return!1;for(var o=0;;){var i=o;if(i===n)return!0;if(!e(r[i],t[i]))return!1;o=i+1|0}},t.compare=function(r,t,e){var n=r.length,o=t.length;if(n<o)return-1;if(n>o)return 1;for(var i=0;;){var a=i;if(a===n)return 0;var s=e(r[a],t[a]);if(0!==s)return s;i=a+1|0}},t.indexOfOpt=function(r,t){var e=r.indexOf(t);if(-1!==e)return e},t.lastIndexOfOpt=function(r,t){var e=r.lastIndexOf(t);if(-1!==e)return e},t.reduce=function(r,t,e){return r.reduce(e,t)},t.reduceWithIndex=function(r,t,e){return r.reduce(e,t)},t.reduceRight=function(r,t,e){return r.reduceRight(e,t)},t.reduceRightWithIndex=function(r,t,e){return r.reduceRight(e,t)},t.findIndexOpt=function(r,t){var e=r.findIndex(t);if(-1!==e)return e},t.filterMap=a,t.keepSome=function(r){return a(r,(function(r){return r}))},t.toShuffled=function(r){var t=r.slice();return i(t),t},t.shuffle=i,t.findMap=function(r,t){for(var e=0;;){var n=e;if(n===r.length)return;var o=t(r[n]);if(void 0!==o)return o;e=n+1|0}},t.last=function(r){return r[r.length-1|0]}},5015:(r,t)=>{t.$$EvalError={},t.$$RangeError={},t.$$ReferenceError={},t.$$SyntaxError={},t.$$TypeError={},t.$$URIError={},t.panic=function(r){throw new Error("Panic! "+r)}},5300:(r,t)=>{var e={floor:function(r){return 0|Math.floor(r)},ceil:function(r){return 0|Math.ceil(r)},random:function(r,t){var e=Math.random()*(t-r|0);return(0|Math.floor(e))+r|0}};t.Constants={},t.Int=e},2448:(r,t,e)=>{var n=e(7175),o=e(5015);function i(r,t,e){return void 0!==r?e(n.valFromOption(r)):t}function a(r,t){return void 0!==r?n.valFromOption(r):t}var s=i,u=a;t.filter=function(r,t){if(void 0!==r&&t(n.valFromOption(r)))return r},t.forEach=function(r,t){if(void 0!==r)return t(n.valFromOption(r))},t.getExn=function(r,t){return void 0!==r?n.valFromOption(r):o.panic(void 0!==t?t:"Option.getExn called for None value")},t.mapOr=i,t.mapWithDefault=s,t.map=function(r,t){if(void 0!==r)return n.some(t(n.valFromOption(r)))},t.flatMap=function(r,t){if(void 0!==r)return t(n.valFromOption(r))},t.getOr=a,t.getWithDefault=u,t.orElse=function(r,t){return void 0!==r?r:t},t.isSome=function(r){return void 0!==r},t.isNone=function(r){return void 0===r},t.equal=function(r,t,e){return void 0!==r?void 0!==t&&e(n.valFromOption(r),n.valFromOption(t)):void 0===t},t.compare=function(r,t,e){return void 0!==r?void 0!==t?e(n.valFromOption(r),n.valFromOption(t)):1:void 0!==t?-1:0}},2971:(r,t,e)=>{var n=e(6253),o=e(1386),i=e(4763),a=e(7175);function s(r,t,e){var n=r[t];r[t]=r[e],r[e]=n}function u(r){for(var t=r.length,e=0;e<t;++e)s(r,e,i.random_int(e,t))}function f(r,t){if(r<=0)return[];for(var e=new Array(r),n=0;n<r;++n)e[n]=t(n);return e}function c(r,t){var e=f(r,t);return u(e),e}function d(r,t,e){for(var n=r.length,o=t.length,i=n<o?n:o,a=new Array(i),s=0;s<i;++s)a[s]=e(r[s],t[s]);return a}function v(r){for(var t=r.length,e=0,n=0;n<t;++n)e=e+r[n].length|0;var o=new Array(e);e=0;for(var i=0;i<t;++i)for(var a=r[i],s=0,u=a.length;s<u;++s)o[e]=a[s],e=e+1|0;return o}function l(r,t){for(var e=0,n=r.length;e<n;++e)t(r[e])}function m(r,t){for(var e=r.length,n=new Array(e),o=0;o<e;++o)n[o]=t(r[o]);return n}function p(r,t){for(var e,n=r.length,o=0;void 0===e&&o<n;){var i=r[o];t(i)&&(e=a.some(i)),o=o+1|0}return e}function h(r,t){for(var e,n=r.length,o=0;void 0===e&&o<n;)t(r[o])&&(e=o),o=o+1|0;return e}function E(r,t){for(var e=r.length,n=new Array(e),o=0,i=0;i<e;++i){var a=r[i];t(a)&&(n[o]=a,o=o+1|0)}return n.length=o,n}function x(r,t){for(var e=r.length,n=new Array(e),o=0,i=0;i<e;++i){var a=r[i];t(a,i)&&(n[o]=a,o=o+1|0)}return n.length=o,n}function g(r,t){for(var e=r.length,n=new Array(e),o=0,i=0;i<e;++i){var s=t(r[i]);void 0!==s&&(n[o]=a.valFromOption(s),o=o+1|0)}return n.length=o,n}function y(r,t){for(var e=0,n=r.length;e<n;++e)t(e,r[e])}function _(r,t){for(var e=r.length,n=new Array(e),o=0;o<e;++o)n[o]=t(o,r[o]);return n}function T(r,t,e){for(var n=t,o=0,i=r.length;o<i;++o)n=e(n,r[o]);return n}function b(r,t,e){for(var n=t,o=r.length-1|0;o>=0;--o)n=e(n,r[o]);return n}function A(r,t,e,o){for(var i=e,a=n.int_min(r.length,t.length)-1|0;a>=0;--a)i=o(i,r[a],t[a]);return i}function k(r,t,e){for(var n=t,o=0,i=r.length;o<i;++o)n=e(n,r[o],o);return n}function S(r,t){for(var e=r.length,n=0;;){var o=n;if(o===e)return!0;if(!t(r[o]))return!1;n=o+1|0}}function w(r,t){for(var e=r.length,n=0;;){var o=n;if(o===e)return!1;if(t(r[o]))return!0;n=o+1|0}}function C(r,t,e,n,o){for(;;){var i=e;if(i===o)return!0;if(!n(r[i],t[i]))return!1;e=i+1|0}}function I(r,t,e){return C(r,t,0,e,n.int_min(r.length,t.length))}function M(r,t,e){for(var o=0,i=n.int_min(r.length,t.length);;){var a=o;if(a===i)return!1;if(e(r[a],t[a]))return!0;o=a+1|0}}function j(r,t,e){var n=r.length;return n===t.length&&C(r,t,0,e,n)}function D(r,t,e){var n=r.length,o=t.length;if(n>o)return 1;if(n<o)return-1;for(var i=0;;){var a=i;if(a===n)return 0;var s=e(r[a],t[a]);if(0!==s)return s;i=a+1|0}}function G(r,t){for(var e=r.length,n=0,o=0,i=new Array(e),a=new Array(e),s=0;s<e;++s){var u=r[s];t(u)?(i[n]=u,n=n+1|0):(a[o]=u,o=o+1|0)}return i.length=n,a.length=o,[i,a]}function N(r,t,e){var n=r.length;if(0===n)return"";for(var o=n-1|0,i=0,a="";;){var s=a,u=i;if(u===o)return s+e(r[u]);a=s+(e(r[u])+t),i=u+1|0}}function U(r,t){for(var e=new Array(r),n=0;n<r;++n)e[n]=t(n);return e}t.get=function(r,t){if(t>=0&&t<r.length)return a.some(r[t])},t.getExn=function(r,t){if(!(t>=0&&t<r.length))throw{RE_EXN_ID:"Assert_failure",_1:["belt_Array.res",36,2],Error:new Error};return r[t]},t.set=function(r,t,e){return t>=0&&t<r.length&&(r[t]=e,!0)},t.setExn=function(r,t,e){if(!(t>=0&&t<r.length))throw{RE_EXN_ID:"Assert_failure",_1:["belt_Array.res",49,2],Error:new Error};r[t]=e},t.shuffleInPlace=u,t.shuffle=function(r){var t=r.slice(0);return u(t),t},t.reverseInPlace=function(r){for(var t=r.length,e=0,n=t/2|0;e<n;++e)s(r,0+e|0,((0+t|0)-e|0)-1|0)},t.reverse=function(r){for(var t=r.length,e=new Array(t),n=0;n<t;++n)e[n]=r[(t-1|0)-n|0];return e},t.make=function(r,t){if(r<=0)return[];for(var e=new Array(r),n=0;n<r;++n)e[n]=t;return e},t.range=function(r,t){var e=t-r|0;if(e<0)return[];for(var n=new Array(e+1|0),o=0;o<=e;++o)n[o]=r+o|0;return n},t.rangeBy=function(r,t,e){var n=t-r|0;if(n<0||e<=0)return[];for(var o=1+(n/e|0)|0,i=new Array(o),a=r,s=0;s<o;++s)i[s]=a,a=a+e|0;return i},t.makeByU=f,t.makeBy=function(r,t){return f(r,o.__1(t))},t.makeByAndShuffleU=c,t.makeByAndShuffle=function(r,t){return c(r,o.__1(t))},t.zip=function(r,t){for(var e=r.length,n=t.length,o=e<n?e:n,i=new Array(o),a=0;a<o;++a)i[a]=[r[a],t[a]];return i},t.zipByU=d,t.zipBy=function(r,t,e){return d(r,t,o.__2(e))},t.unzip=function(r){for(var t=r.length,e=new Array(t),n=new Array(t),o=0;o<t;++o){var i=r[o];e[o]=i[0],n[o]=i[1]}return[e,n]},t.concat=function(r,t){for(var e=r.length,n=t.length,o=new Array(e+n|0),i=0;i<e;++i)o[i]=r[i];for(var a=0;a<n;++a)o[e+a|0]=t[a];return o},t.concatMany=v,t.slice=function(r,t,e){if(e<=0)return[];var o=r.length,i=t<0?n.int_max(o+t|0,0):t,a=o-i|0,s=a<e?a:e;if(s<=0)return[];for(var u=new Array(s),f=0;f<s;++f)u[f]=r[i+f|0];return u},t.sliceToEnd=function(r,t){for(var e=r.length,o=t<0?n.int_max(e+t|0,0):t,i=e>o?e-o|0:0,a=new Array(i),s=0;s<i;++s)a[s]=r[o+s|0];return a},t.fill=function(r,t,e,o){if(!(e<=0)){var i=r.length,a=t<0?n.int_max(i+t|0,0):t,s=i-a|0,u=s<e?s:e;if(!(u<=0))for(var f=a,c=a+u|0;f<c;++f)r[f]=o}},t.blit=function(r,t,e,o,i){var a=r.length,s=e.length,u=t<0?n.int_max(a+t|0,0):t,f=o<0?n.int_max(s+o|0,0):o,c=n.int_min(i,n.int_min(a-u|0,s-f|0));if(f<=u)for(var d=0;d<c;++d)e[d+f|0]=r[d+u|0];else for(var v=c-1|0;v>=0;--v)e[v+f|0]=r[v+u|0]},t.blitUnsafe=function(r,t,e,n,o){if(n<=t)for(var i=0;i<o;++i)e[i+n|0]=r[i+t|0];else for(var a=o-1|0;a>=0;--a)e[a+n|0]=r[a+t|0]},t.forEachU=l,t.forEach=function(r,t){l(r,o.__1(t))},t.mapU=m,t.map=function(r,t){return m(r,o.__1(t))},t.flatMapU=function(r,t){return v(m(r,t))},t.flatMap=function(r,t){return v(m(r,o.__1(t)))},t.getByU=p,t.getBy=function(r,t){return p(r,o.__1(t))},t.getIndexByU=h,t.getIndexBy=function(r,t){return h(r,o.__1(t))},t.keepU=E,t.keep=function(r,t){return E(r,o.__1(t))},t.keepWithIndexU=x,t.keepWithIndex=function(r,t){return x(r,o.__2(t))},t.keepMapU=g,t.keepMap=function(r,t){return g(r,o.__1(t))},t.forEachWithIndexU=y,t.forEachWithIndex=function(r,t){y(r,o.__2(t))},t.mapWithIndexU=_,t.mapWithIndex=function(r,t){return _(r,o.__2(t))},t.partitionU=G,t.partition=function(r,t){return G(r,o.__1(t))},t.reduceU=T,t.reduce=function(r,t,e){return T(r,t,o.__2(e))},t.reduceReverseU=b,t.reduceReverse=function(r,t,e){return b(r,t,o.__2(e))},t.reduceReverse2U=A,t.reduceReverse2=function(r,t,e,n){return A(r,t,e,o.__3(n))},t.reduceWithIndexU=k,t.reduceWithIndex=function(r,t,e){return k(r,t,o.__3(e))},t.joinWithU=N,t.joinWith=function(r,t,e){return N(r,t,o.__1(e))},t.someU=w,t.some=function(r,t){return w(r,o.__1(t))},t.everyU=S,t.every=function(r,t){return S(r,o.__1(t))},t.every2U=I,t.every2=function(r,t,e){return I(r,t,o.__2(e))},t.some2U=M,t.some2=function(r,t,e){return M(r,t,o.__2(e))},t.cmpU=D,t.cmp=function(r,t,e){return D(r,t,o.__2(e))},t.eqU=j,t.eq=function(r,t,e){return j(r,t,o.__2(e))},t.initU=U,t.init=function(r,t){return U(r,o.__1(t))}},2815:(r,t,e)=>{var n=e(7175),o=e(5252),i=e(354);function a(r,t,e,n){for(;;){var o=n;if(void 0===o)return;var i=r(o.key)&(t.length-1|0),a=e[i];void 0!==a?a.next=o:t[i]=o,e[i]=o,n=o.next}}function s(r,t,e,n,o){var i=r.buckets,s=i.length,u=o(t)&(s-1|0),f=i[u];if(void 0!==f?function(r,t,e,n){for(;;){var o=n;if(r(o.key,t))return o.value=e,!1;var i=o.next;if(void 0===i)return!0;n=i}}(n,t,e,f)&&(i[u]={key:t,value:e,next:f},r.size=r.size+1|0):(i[u]={key:t,value:e,next:void 0},r.size=r.size+1|0),r.size>s<<1){var c=r.buckets,d=c.length,v=d<<1;if(v<d)return;var l=new Array(v),m=new Array(v);r.buckets=l;for(var p=0;p<d;++p)a(o,l,m,c[p]);for(var h=0;h<v;++h){var E=m[h];void 0!==E&&(E.next=void 0)}}}var u=i.clear,f=i.isEmpty,c=o.copy,d=o.forEachU,v=o.forEach,l=o.reduceU,m=o.reduce,p=o.keepMapInPlaceU,h=o.keepMapInPlace,E=o.toArray,x=o.keysToArray,g=o.valuesToArray,y=o.getBucketHistogram,_=o.logStats;t.Int=void 0,t.$$String=void 0,t.make=function(r,t){return i.make(t.hash,t.eq,r)},t.clear=u,t.isEmpty=f,t.set=function(r,t,e){s(r,t,e,r.eq,r.hash)},t.copy=c,t.get=function(r,t){var e=r.buckets,o=e[r.hash(t)&(e.length-1|0)];if(void 0!==o){var i=r.eq;if(i(t,o.key))return n.some(o.value);var a=o.next;if(void 0!==a){if(i(t,a.key))return n.some(a.value);var s=a.next;if(void 0!==s){if(i(t,s.key))return n.some(s.value);for(var u=s.next;;){var f=u;if(void 0===f)return;if(i(t,f.key))return n.some(f.value);u=f.next}}}}},t.has=function(r,t){var e=r.buckets,n=e[r.hash(t)&(e.length-1|0)];if(void 0===n)return!1;for(var o=n,i=r.eq;;){var a=o;if(i(a.key,t))return!0;var s=a.next;if(void 0===s)return!1;o=s}},t.remove=function(r,t){var e=r.buckets,n=r.hash(t)&(e.length-1|0),o=e[n];if(void 0!==o){var i=r.eq;if(i(o.key,t))return e[n]=o.next,void(r.size=r.size-1|0);for(var a=o,s=o.next;;){var u=s,f=a;if(void 0===u)return;var c=u.next;if(i(u.key,t))return f.next=c,void(r.size=r.size-1|0);s=c,a=u}}},t.forEachU=d,t.forEach=v,t.reduceU=l,t.reduce=m,t.keepMapInPlaceU=p,t.keepMapInPlace=h,t.size=function(r){return r.size},t.toArray=E,t.keysToArray=x,t.valuesToArray=g,t.fromArray=function(r,t){for(var e=t.hash,n=t.eq,o=r.length,a=i.make(e,n,o),u=0;u<o;++u){var f=r[u];s(a,f[0],f[1],n,e)}return a},t.mergeMany=function(r,t){for(var e=r.hash,n=r.eq,o=t.length,i=0;i<o;++i){var a=t[i];s(r,a[0],a[1],n,e)}},t.getBucketHistogram=y,t.logStats=_},7356:(r,t,e)=>{var n=e(7175),o=e(1863),i=e(5252),a=e(354);function s(r,t,e){for(;;){var n=e;if(void 0===n)return;var i=o.hash_final_mix(o.hash_mix_int(0,n.key))&(r.length-1|0),a=t[i];void 0!==a?a.next=n:r[i]=n,t[i]=n,e=n.next}}function u(r,t,e){var n=r.buckets,i=n.length,a=o.hash_final_mix(o.hash_mix_int(0,t))&(i-1|0),u=n[a];if(void 0!==u?function(r,t,e){for(;;){var n=e;if(n.key===r)return n.value=t,!1;var o=n.next;if(void 0===o)return!0;e=o}}(t,e,u)&&(n[a]={key:t,value:e,next:u},r.size=r.size+1|0):(n[a]={key:t,value:e,next:void 0},r.size=r.size+1|0),r.size>i<<1){var f=r.buckets,c=f.length,d=c<<1;if(d<c)return;var v=new Array(d),l=new Array(d);r.buckets=v;for(var m=0;m<c;++m)s(v,l,f[m]);for(var p=0;p<d;++p){var h=l[p];void 0!==h&&(h.next=void 0)}}}var f=a.clear,c=a.isEmpty,d=i.copy,v=i.forEachU,l=i.forEach,m=i.reduceU,p=i.reduce,h=i.keepMapInPlaceU,E=i.keepMapInPlace,x=i.toArray,g=i.keysToArray,y=i.valuesToArray,_=i.getBucketHistogram,T=i.logStats;t.make=function(r){return a.make(void 0,void 0,r)},t.clear=f,t.isEmpty=c,t.set=u,t.copy=d,t.get=function(r,t){var e=r.buckets,i=e[o.hash_final_mix(o.hash_mix_int(0,t))&(e.length-1|0)];if(void 0!==i){if(t===i.key)return n.some(i.value);var a=i.next;if(void 0!==a){if(t===a.key)return n.some(a.value);var s=a.next;if(void 0!==s){if(t===s.key)return n.some(s.value);for(var u=s.next;;){var f=u;if(void 0===f)return;if(t===f.key)return n.some(f.value);u=f.next}}}}},t.has=function(r,t){var e=r.buckets,n=e[o.hash_final_mix(o.hash_mix_int(0,t))&(e.length-1|0)];if(void 0===n)return!1;for(var i=n;;){var a=i;if(a.key===t)return!0;var s=a.next;if(void 0===s)return!1;i=s}},t.remove=function(r,t){var e=r.buckets,n=o.hash_final_mix(o.hash_mix_int(0,t))&(e.length-1|0),i=e[n];if(void 0!==i){if(i.key===t)return e[n]=i.next,void(r.size=r.size-1|0);for(var a=i,s=i.next;;){var u=s,f=a;if(void 0===u)return;var c=u.next;if(u.key===t)return f.next=c,void(r.size=r.size-1|0);s=c,a=u}}},t.forEachU=v,t.forEach=l,t.reduceU=m,t.reduce=p,t.keepMapInPlaceU=h,t.keepMapInPlace=E,t.size=function(r){return r.size},t.toArray=x,t.keysToArray=g,t.valuesToArray=y,t.fromArray=function(r){for(var t=r.length,e=a.make(void 0,void 0,t),n=0;n<t;++n){var o=r[n];u(e,o[0],o[1])}return e},t.mergeMany=function(r,t){for(var e=t.length,n=0;n<e;++n){var o=t[n];u(r,o[0],o[1])}},t.getBucketHistogram=_,t.logStats=T},2275:(r,t,e)=>{var n=e(7175),o=e(1863),i=e(5252),a=e(354);function s(r,t,e){for(;;){var n=e;if(void 0===n)return;var i=o.hash_final_mix(o.hash_mix_string(0,n.key))&(r.length-1|0),a=t[i];void 0!==a?a.next=n:r[i]=n,t[i]=n,e=n.next}}function u(r,t,e){var n=r.buckets,i=n.length,a=o.hash_final_mix(o.hash_mix_string(0,t))&(i-1|0),u=n[a];if(void 0!==u?function(r,t,e){for(;;){var n=e;if(n.key===r)return n.value=t,!1;var o=n.next;if(void 0===o)return!0;e=o}}(t,e,u)&&(n[a]={key:t,value:e,next:u},r.size=r.size+1|0):(n[a]={key:t,value:e,next:void 0},r.size=r.size+1|0),r.size>i<<1){var f=r.buckets,c=f.length,d=c<<1;if(d<c)return;var v=new Array(d),l=new Array(d);r.buckets=v;for(var m=0;m<c;++m)s(v,l,f[m]);for(var p=0;p<d;++p){var h=l[p];void 0!==h&&(h.next=void 0)}}}var f=a.clear,c=a.isEmpty,d=i.copy,v=i.forEachU,l=i.forEach,m=i.reduceU,p=i.reduce,h=i.keepMapInPlaceU,E=i.keepMapInPlace,x=i.toArray,g=i.keysToArray,y=i.valuesToArray,_=i.getBucketHistogram,T=i.logStats;t.make=function(r){return a.make(void 0,void 0,r)},t.clear=f,t.isEmpty=c,t.set=u,t.copy=d,t.get=function(r,t){var e=r.buckets,i=e[o.hash_final_mix(o.hash_mix_string(0,t))&(e.length-1|0)];if(void 0!==i){if(t===i.key)return n.some(i.value);var a=i.next;if(void 0!==a){if(t===a.key)return n.some(a.value);var s=a.next;if(void 0!==s){if(t===s.key)return n.some(s.value);for(var u=s.next;;){var f=u;if(void 0===f)return;if(t===f.key)return n.some(f.value);u=f.next}}}}},t.has=function(r,t){var e=r.buckets,n=e[o.hash_final_mix(o.hash_mix_string(0,t))&(e.length-1|0)];if(void 0===n)return!1;for(var i=n;;){var a=i;if(a.key===t)return!0;var s=a.next;if(void 0===s)return!1;i=s}},t.remove=function(r,t){var e=r.buckets,n=o.hash_final_mix(o.hash_mix_string(0,t))&(e.length-1|0),i=e[n];if(void 0!==i){if(i.key===t)return e[n]=i.next,void(r.size=r.size-1|0);for(var a=i,s=i.next;;){var u=s,f=a;if(void 0===u)return;var c=u.next;if(u.key===t)return f.next=c,void(r.size=r.size-1|0);s=c,a=u}}},t.forEachU=v,t.forEach=l,t.reduceU=m,t.reduce=p,t.keepMapInPlaceU=h,t.keepMapInPlace=E,t.size=function(r){return r.size},t.toArray=x,t.keysToArray=g,t.valuesToArray=y,t.fromArray=function(r){for(var t=r.length,e=a.make(void 0,void 0,t),n=0;n<t;++n){var o=r[n];u(e,o[0],o[1])}return e},t.mergeMany=function(r,t){for(var e=t.length,n=0;n<e;++n){var o=t[n];u(r,o[0],o[1])}},t.getBucketHistogram=_,t.logStats=T},9775:(r,t,e)=>{var n=e(9167),o=e(354);function i(r,t,e,n){for(;;){var o=n;if(void 0===o)return;var i=r(o.key)&(t.length-1|0),a=e[i];void 0!==a?a.next=o:t[i]=o,e[i]=o,n=o.next}}function a(r,t,e,n){var o=r.buckets,a=o.length,s=e(t)&(a-1|0),u=o[s];if(void 0!==u?function(r,t,e,n){for(;;){var o=e;if(n(o.key,t))return;var i=o.next;if(void 0===i)return r.size=r.size+1|0,void(o.next={key:t,next:void 0});e=i}}(r,t,u,n):(r.size=r.size+1|0,o[s]={key:t,next:void 0}),r.size>a<<1){var f=r.buckets,c=f.length,d=c<<1;if(d<c)return;var v=new Array(d),l=new Array(d);r.buckets=v;for(var m=0;m<c;++m)i(e,v,l,f[m]);for(var p=0;p<d;++p){var h=l[p];void 0!==h&&(h.next=void 0)}}}var s=o.clear,u=o.isEmpty,f=n.copy,c=n.forEachU,d=n.forEach,v=n.reduceU,l=n.reduce,m=n.logStats,p=n.toArray,h=n.getBucketHistogram;t.Int=void 0,t.$$String=void 0,t.make=function(r,t){return o.make(t.hash,t.eq,r)},t.clear=s,t.isEmpty=u,t.add=function(r,t){a(r,t,r.hash,r.eq)},t.copy=f,t.has=function(r,t){var e=r.eq,n=r.buckets,o=n[r.hash(t)&(n.length-1|0)];if(void 0===o)return!1;for(var i=o;;){var a=i;if(e(a.key,t))return!0;var s=a.next;if(void 0===s)return!1;i=s}},t.remove=function(r,t){var e=r.eq,n=r.buckets,o=r.hash(t)&(n.length-1|0),i=n[o];if(void 0!==i){var a=i.next;if(e(i.key,t))return r.size=r.size-1|0,void(n[o]=a);if(void 0!==a)for(var s=i,u=a;;){var f=u,c=s,d=f.next;if(e(f.key,t))return c.next=d,void(r.size=r.size-1|0);if(void 0===d)return;u=d,s=f}}},t.forEachU=c,t.forEach=d,t.reduceU=v,t.reduce=l,t.size=function(r){return r.size},t.logStats=m,t.toArray=p,t.fromArray=function(r,t){for(var e=t.eq,n=t.hash,i=r.length,s=o.make(n,e,i),u=0;u<i;++u)a(s,r[u],n,e);return s},t.mergeMany=function(r,t){for(var e=r.eq,n=r.hash,o=t.length,i=0;i<o;++i)a(r,t[i],n,e)},t.getBucketHistogram=h},7659:(r,t,e)=>{var n=e(1863),o=e(9167),i=e(354);function a(r,t,e){for(;;){var o=e;if(void 0===o)return;var i=n.hash_final_mix(n.hash_mix_int(0,o.key))&(r.length-1|0),a=t[i];void 0!==a?a.next=o:r[i]=o,t[i]=o,e=o.next}}function s(r,t){var e=r.buckets,o=e.length,i=n.hash_final_mix(n.hash_mix_int(0,t))&(o-1|0),s=e[i];if(void 0!==s?function(r,t,e){for(;;){var n=e;if(n.key===t)return;var o=n.next;if(void 0===o)return r.size=r.size+1|0,void(n.next={key:t,next:void 0});e=o}}(r,t,s):(e[i]={key:t,next:void 0},r.size=r.size+1|0),r.size>o<<1){var u=r.buckets,f=u.length,c=f<<1;if(c<f)return;var d=new Array(c),v=new Array(c);r.buckets=d;for(var l=0;l<f;++l)a(d,v,u[l]);for(var m=0;m<c;++m){var p=v[m];void 0!==p&&(p.next=void 0)}}}var u=i.clear,f=i.isEmpty,c=o.copy,d=o.forEachU,v=o.forEach,l=o.reduceU,m=o.reduce,p=o.logStats,h=o.toArray,E=o.getBucketHistogram;t.make=function(r){return i.make(void 0,void 0,r)},t.clear=u,t.isEmpty=f,t.add=s,t.copy=c,t.has=function(r,t){var e=r.buckets,o=e[n.hash_final_mix(n.hash_mix_int(0,t))&(e.length-1|0)];if(void 0===o)return!1;for(var i=o;;){var a=i;if(a.key===t)return!0;var s=a.next;if(void 0===s)return!1;i=s}},t.remove=function(r,t){var e=r.buckets,o=n.hash_final_mix(n.hash_mix_int(0,t))&(e.length-1|0),i=e[o];if(void 0!==i){var a=i.next;if(i.key===t)return r.size=r.size-1|0,void(e[o]=a);if(void 0!==a)for(var s=i,u=a;;){var f=u,c=s,d=f.next;if(f.key===t)return c.next=d,void(r.size=r.size-1|0);if(void 0===d)return;u=d,s=f}}},t.forEachU=d,t.forEach=v,t.reduceU=l,t.reduce=m,t.size=function(r){return r.size},t.logStats=p,t.toArray=h,t.fromArray=function(r){for(var t=r.length,e=i.make(void 0,void 0,t),n=0;n<t;++n)s(e,r[n]);return e},t.mergeMany=function(r,t){for(var e=t.length,n=0;n<e;++n)s(r,t[n])},t.getBucketHistogram=E},8615:(r,t,e)=>{var n=e(1863),o=e(9167),i=e(354);function a(r,t,e){for(;;){var o=e;if(void 0===o)return;var i=n.hash_final_mix(n.hash_mix_string(0,o.key))&(r.length-1|0),a=t[i];void 0!==a?a.next=o:r[i]=o,t[i]=o,e=o.next}}function s(r,t){var e=r.buckets,o=e.length,i=n.hash_final_mix(n.hash_mix_string(0,t))&(o-1|0),s=e[i];if(void 0!==s?function(r,t,e){for(;;){var n=e;if(n.key===t)return;var o=n.next;if(void 0===o)return r.size=r.size+1|0,void(n.next={key:t,next:void 0});e=o}}(r,t,s):(e[i]={key:t,next:void 0},r.size=r.size+1|0),r.size>o<<1){var u=r.buckets,f=u.length,c=f<<1;if(c<f)return;var d=new Array(c),v=new Array(c);r.buckets=d;for(var l=0;l<f;++l)a(d,v,u[l]);for(var m=0;m<c;++m){var p=v[m];void 0!==p&&(p.next=void 0)}}}var u=i.clear,f=i.isEmpty,c=o.copy,d=o.forEachU,v=o.forEach,l=o.reduceU,m=o.reduce,p=o.logStats,h=o.toArray,E=o.getBucketHistogram;t.make=function(r){return i.make(void 0,void 0,r)},t.clear=u,t.isEmpty=f,t.add=s,t.copy=c,t.has=function(r,t){var e=r.buckets,o=e[n.hash_final_mix(n.hash_mix_string(0,t))&(e.length-1|0)];if(void 0===o)return!1;for(var i=o;;){var a=i;if(a.key===t)return!0;var s=a.next;if(void 0===s)return!1;i=s}},t.remove=function(r,t){var e=r.buckets,o=n.hash_final_mix(n.hash_mix_string(0,t))&(e.length-1|0),i=e[o];if(void 0!==i){var a=i.next;if(i.key===t)return r.size=r.size-1|0,void(e[o]=a);if(void 0!==a)for(var s=i,u=a;;){var f=u,c=s,d=f.next;if(f.key===t)return c.next=d,void(r.size=r.size-1|0);if(void 0===d)return;u=d,s=f}}},t.forEachU=d,t.forEach=v,t.reduceU=l,t.reduce=m,t.size=function(r){return r.size},t.logStats=p,t.toArray=h,t.fromArray=function(r){for(var t=r.length,e=i.make(void 0,void 0,t),n=0;n<t;++n)s(e,r[n]);return e},t.mergeMany=function(r,t){for(var e=t.length,n=0;n<e;++n)s(r,t[n])},t.getBucketHistogram=E},6638:(r,t,e)=>{var n=e(1386);t.MakeComparableU=function(r){return r},t.MakeComparable=function(r){var t=r.cmp;return{cmp:n.__2(t)}},t.comparableU=function(r){return{cmp:r}},t.comparable=function(r){return{cmp:n.__2(r)}},t.MakeHashableU=function(r){return r},t.MakeHashable=function(r){var t=r.hash,e=n.__1(t),o=r.eq;return{hash:e,eq:n.__2(o)}},t.hashableU=function(r,t){return{hash:r,eq:t}},t.hashable=function(r,t){return{hash:n.__1(r),eq:n.__2(t)}}},1094:(r,t,e)=>{var n=e(1386),o=e(7175),i=e(3163),a=e(6144);function s(r,t,e){if(void 0===r)return a.singleton(t,e);var n=r.k;if(t===n)return a.updateValue(r,e);var o=r.v;return t<n?a.bal(s(r.l,t,e),n,o,r.r):a.bal(r.l,n,o,s(r.r,t,e))}function u(r,t,e){if(void 0!==r){var n=r.k;if(t===n){var i=e(o.some(r.v));if(void 0!==i)return a.updateValue(r,o.valFromOption(i));var s=r.l,f=r.r;if(void 0===s)return f;if(void 0===f)return s;var c={contents:f.k},d={contents:f.v},v=a.removeMinAuxWithRef(f,c,d);return a.bal(s,c.contents,d.contents,v)}var l=r.v,m=r.l,p=r.r;if(t<n){var h=u(m,t,e);return m===h?r:a.bal(h,n,l,p)}var E=u(p,t,e);return p===E?r:a.bal(m,n,l,E)}var x=e(void 0);return void 0!==x?a.singleton(t,o.valFromOption(x)):r}function f(r,t){var e=r.k,n=r.l,o=r.r;if(t===e){if(void 0===n)return o;if(void 0===o)return n;var i={contents:o.k},s={contents:o.v},u=a.removeMinAuxWithRef(o,i,s);return a.bal(n,i.contents,s.contents,u)}if(t<e){if(void 0===n)return r;var c=f(n,t);return c===n?r:a.bal(c,e,r.v,o)}if(void 0===o)return r;var d=f(o,t);return a.bal(n,e,r.v,d)}var c=a.isEmpty,d=i.has,v=i.cmpU,l=i.cmp,m=i.eqU,p=i.eq,h=a.findFirstByU,E=a.findFirstBy,x=a.forEachU,g=a.forEach,y=a.reduceU,_=a.reduce,T=a.everyU,b=a.every,A=a.someU,k=a.some,S=a.size,w=a.toList,C=a.toArray,I=i.fromArray,M=a.keysToArray,j=a.valuesToArray,D=a.minKey,G=a.minKeyUndefined,N=a.maxKey,U=a.maxKeyUndefined,O=a.minimum,P=a.minUndefined,R=a.maximum,F=a.maxUndefined,V=i.get,B=i.getUndefined,L=i.getWithDefault,W=i.getExn,X=a.checkInvariantInternal,H=i.mergeU,z=i.merge,q=a.keepSharedU,$=a.keepShared,K=a.partitionSharedU,J=a.partitionShared,Q=i.split,Z=a.mapU,Y=a.map,rr=a.mapWithKeyU,tr=a.mapWithKey;t.empty=void 0,t.isEmpty=c,t.has=d,t.cmpU=v,t.cmp=l,t.eqU=m,t.eq=p,t.findFirstByU=h,t.findFirstBy=E,t.forEachU=x,t.forEach=g,t.reduceU=y,t.reduce=_,t.everyU=T,t.every=b,t.someU=A,t.some=k,t.size=S,t.toList=w,t.toArray=C,t.fromArray=I,t.keysToArray=M,t.valuesToArray=j,t.minKey=D,t.minKeyUndefined=G,t.maxKey=N,t.maxKeyUndefined=U,t.minimum=O,t.minUndefined=P,t.maximum=R,t.maxUndefined=F,t.get=V,t.getUndefined=B,t.getWithDefault=L,t.getExn=W,t.checkInvariantInternal=X,t.remove=function(r,t){if(void 0!==r)return f(r,t)},t.removeMany=function(r,t){var e=t.length;if(void 0!==r)for(var n=r,o=0;;){var i=o;if(i>=e)return n;var a=f(n,t[i]);if(void 0===a)return a;o=i+1|0,n=a}},t.set=s,t.updateU=u,t.update=function(r,t,e){return u(r,t,n.__1(e))},t.mergeU=H,t.merge=z,t.mergeMany=function(r,t){for(var e=t.length,n=r,o=0;o<e;++o){var i=t[o];n=s(n,i[0],i[1])}return n},t.keepU=q,t.keep=$,t.partitionU=K,t.partition=J,t.split=Q,t.mapU=Z,t.map=Y,t.mapWithKeyU=rr,t.mapWithKey=tr},5082:(r,t,e)=>{var n=e(1386),o=e(7175),i=e(6144),a=e(2459);function s(r,t,e){if(void 0===r)return i.singleton(t,e);var n=r.k;if(t===n)return i.updateValue(r,e);var o=r.v;return t<n?i.bal(s(r.l,t,e),n,o,r.r):i.bal(r.l,n,o,s(r.r,t,e))}function u(r,t,e){if(void 0!==r){var n=r.k;if(t===n){var a=e(o.some(r.v));if(void 0!==a)return i.updateValue(r,o.valFromOption(a));var s=r.l,f=r.r;if(void 0===s)return f;if(void 0===f)return s;var c={contents:f.k},d={contents:f.v},v=i.removeMinAuxWithRef(f,c,d);return i.bal(s,c.contents,d.contents,v)}var l=r.v,m=r.l,p=r.r;if(t<n){var h=u(m,t,e);return m===h?r:i.bal(h,n,l,p)}var E=u(p,t,e);return p===E?r:i.bal(m,n,l,E)}var x=e(void 0);return void 0!==x?i.singleton(t,o.valFromOption(x)):r}function f(r,t){var e=r.k,n=r.l,o=r.r;if(t===e){if(void 0===n)return o;if(void 0===o)return n;var a={contents:o.k},s={contents:o.v},u=i.removeMinAuxWithRef(o,a,s);return i.bal(n,a.contents,s.contents,u)}if(t<e){if(void 0===n)return r;var c=f(n,t);return c===n?r:i.bal(c,e,r.v,o)}if(void 0===o)return r;var d=f(o,t);return i.bal(n,e,r.v,d)}var c=i.isEmpty,d=a.has,v=a.cmpU,l=a.cmp,m=a.eqU,p=a.eq,h=i.findFirstByU,E=i.findFirstBy,x=i.forEachU,g=i.forEach,y=i.reduceU,_=i.reduce,T=i.everyU,b=i.every,A=i.someU,k=i.some,S=i.size,w=i.toList,C=i.toArray,I=a.fromArray,M=i.keysToArray,j=i.valuesToArray,D=i.minKey,G=i.minKeyUndefined,N=i.maxKey,U=i.maxKeyUndefined,O=i.minimum,P=i.minUndefined,R=i.maximum,F=i.maxUndefined,V=a.get,B=a.getUndefined,L=a.getWithDefault,W=a.getExn,X=i.checkInvariantInternal,H=a.mergeU,z=a.merge,q=i.keepSharedU,$=i.keepShared,K=i.partitionSharedU,J=i.partitionShared,Q=a.split,Z=i.mapU,Y=i.map,rr=i.mapWithKeyU,tr=i.mapWithKey;t.empty=void 0,t.isEmpty=c,t.has=d,t.cmpU=v,t.cmp=l,t.eqU=m,t.eq=p,t.findFirstByU=h,t.findFirstBy=E,t.forEachU=x,t.forEach=g,t.reduceU=y,t.reduce=_,t.everyU=T,t.every=b,t.someU=A,t.some=k,t.size=S,t.toList=w,t.toArray=C,t.fromArray=I,t.keysToArray=M,t.valuesToArray=j,t.minKey=D,t.minKeyUndefined=G,t.maxKey=N,t.maxKeyUndefined=U,t.minimum=O,t.minUndefined=P,t.maximum=R,t.maxUndefined=F,t.get=V,t.getUndefined=B,t.getWithDefault=L,t.getExn=W,t.checkInvariantInternal=X,t.remove=function(r,t){if(void 0!==r)return f(r,t)},t.removeMany=function(r,t){var e=t.length;if(void 0!==r)for(var n=r,o=0;;){var i=o;if(i>=e)return n;var a=f(n,t[i]);if(void 0===a)return a;o=i+1|0,n=a}},t.set=s,t.updateU=u,t.update=function(r,t,e){return u(r,t,n.__1(e))},t.mergeU=H,t.merge=z,t.mergeMany=function(r,t){for(var e=t.length,n=r,o=0;o<e;++o){var i=t[o];n=s(n,i[0],i[1])}return n},t.keepU=q,t.keep=$,t.partitionU=K,t.partition=J,t.split=Q,t.mapU=Z,t.map=Y,t.mapWithKeyU=rr,t.mapWithKey=tr},5981:(r,t,e)=>{var n=e(1386),o=e(7175),i=e(3163),a=e(6144);function s(r,t){return{data:a.mapU(r.data,t)}}function u(r,t){return{data:a.mapWithKeyU(r.data,t)}}function f(r,t,e){return a.reduceU(r.data,t,e)}function c(r,t){var e=r.k;if(t===e){var n=r.l,o=r.r;return void 0!==n?void 0!==o?(r.r=a.removeMinAuxWithRootMutate(r,o),a.balMutate(r)):n:o}if(t<e){var i=r.l;return void 0!==i?(r.l=c(i,t),a.balMutate(r)):r}var s=r.r;return void 0!==s?(r.r=c(s,t),a.balMutate(r)):r}function d(r,t,e){if(void 0!==r){var n=r.k;if(n===t){var i=e(o.some(r.v));if(void 0!==i)return r.v=o.valFromOption(i),r;var s=r.l,u=r.r;return void 0!==s?void 0!==u?(r.r=a.removeMinAuxWithRootMutate(r,u),a.balMutate(r)):s:u}var f=r.l,c=r.r;if(t<n){var v=d(f,t,e);r.l=v}else r.r=d(c,t,e);return a.balMutate(r)}var l=e(void 0);return void 0!==l?a.singleton(t,o.valFromOption(l)):r}function v(r,t,e){var n=r.data,o=d(n,t,e);o===n||(r.data=o)}function l(r,t,e){return i.cmpU(r.data,t.data,e)}function m(r,t,e){return i.eqU(r.data,t.data,e)}t.make=function(r){return{data:void 0}},t.clear=function(r){r.data=void 0},t.isEmpty=function(r){return void 0===r.data},t.has=function(r,t){return i.has(r.data,t)},t.cmpU=l,t.cmp=function(r,t,e){return l(r,t,n.__2(e))},t.eqU=m,t.eq=function(r,t,e){return m(r,t,n.__2(e))},t.forEachU=function(r,t){a.forEachU(r.data,t)},t.forEach=function(r,t){a.forEachU(r.data,n.__2(t))},t.reduceU=f,t.reduce=function(r,t,e){return f(r,t,n.__3(e))},t.everyU=function(r,t){return a.everyU(r.data,t)},t.every=function(r,t){return a.everyU(r.data,n.__2(t))},t.someU=function(r,t){return a.someU(r.data,t)},t.some=function(r,t){return a.someU(r.data,n.__2(t))},t.size=function(r){return a.size(r.data)},t.toList=function(r){return a.toList(r.data)},t.toArray=function(r){return a.toArray(r.data)},t.fromArray=function(r){return{data:i.fromArray(r)}},t.keysToArray=function(r){return a.keysToArray(r.data)},t.valuesToArray=function(r){return a.valuesToArray(r.data)},t.minKey=function(r){return a.minKey(r.data)},t.minKeyUndefined=function(r){return a.minKeyUndefined(r.data)},t.maxKey=function(r){return a.maxKey(r.data)},t.maxKeyUndefined=function(r){return a.maxKeyUndefined(r.data)},t.minimum=function(r){return a.minimum(r.data)},t.minUndefined=function(r){return a.minUndefined(r.data)},t.maximum=function(r){return a.maximum(r.data)},t.maxUndefined=function(r){return a.maxUndefined(r.data)},t.get=function(r,t){return i.get(r.data,t)},t.getUndefined=function(r,t){return i.getUndefined(r.data,t)},t.getWithDefault=function(r,t,e){return i.getWithDefault(r.data,t,e)},t.getExn=function(r,t){return i.getExn(r.data,t)},t.checkInvariantInternal=function(r){a.checkInvariantInternal(r.data)},t.remove=function(r,t){var e=r.data;if(void 0!==e){var n=c(e,t);n===e||(r.data=n)}},t.removeMany=function(r,t){var e=r.data;if(void 0!==e){var n=function(r,t,e,n){for(;;){var o=e;if(o>=n)return r;var i=c(r,t[o]);if(void 0===i)return;e=o+1|0,r=i}}(e,t,0,t.length);n===e||(r.data=n)}},t.set=function(r,t,e){var n=r.data,o=i.addMutate(n,t,e);o===n||(r.data=o)},t.updateU=v,t.update=function(r,t,e){v(r,t,n.__1(e))},t.mapU=s,t.map=function(r,t){return s(r,n.__1(t))},t.mapWithKeyU=u,t.mapWithKey=function(r,t){return u(r,n.__2(t))}},2867:(r,t,e)=>{var n=e(1386),o=e(7175),i=e(6144),a=e(2459);function s(r,t){return{data:i.mapU(r.data,t)}}function u(r,t){return{data:i.mapWithKeyU(r.data,t)}}function f(r,t,e){return i.reduceU(r.data,t,e)}function c(r,t){var e=r.k;if(t===e){var n=r.l,o=r.r;return void 0!==n?void 0!==o?(r.r=i.removeMinAuxWithRootMutate(r,o),i.balMutate(r)):n:o}if(t<e){var a=r.l;return void 0!==a?(r.l=c(a,t),i.balMutate(r)):r}var s=r.r;return void 0!==s?(r.r=c(s,t),i.balMutate(r)):r}function d(r,t,e){if(void 0!==r){var n=r.k;if(n===t){var a=e(o.some(r.v));if(void 0!==a)return r.v=o.valFromOption(a),r;var s=r.l,u=r.r;return void 0!==s?void 0!==u?(r.r=i.removeMinAuxWithRootMutate(r,u),i.balMutate(r)):s:u}var f=r.l,c=r.r;if(t<n){var v=d(f,t,e);r.l=v}else r.r=d(c,t,e);return i.balMutate(r)}var l=e(void 0);return void 0!==l?i.singleton(t,o.valFromOption(l)):r}function v(r,t,e){var n=r.data,o=d(n,t,e);o===n||(r.data=o)}function l(r,t,e){return a.cmpU(r.data,t.data,e)}function m(r,t,e){return a.eqU(r.data,t.data,e)}t.make=function(r){return{data:void 0}},t.clear=function(r){r.data=void 0},t.isEmpty=function(r){return void 0===r.data},t.has=function(r,t){return a.has(r.data,t)},t.cmpU=l,t.cmp=function(r,t,e){return l(r,t,n.__2(e))},t.eqU=m,t.eq=function(r,t,e){return m(r,t,n.__2(e))},t.forEachU=function(r,t){i.forEachU(r.data,t)},t.forEach=function(r,t){i.forEachU(r.data,n.__2(t))},t.reduceU=f,t.reduce=function(r,t,e){return f(r,t,n.__3(e))},t.everyU=function(r,t){return i.everyU(r.data,t)},t.every=function(r,t){return i.everyU(r.data,n.__2(t))},t.someU=function(r,t){return i.someU(r.data,t)},t.some=function(r,t){return i.someU(r.data,n.__2(t))},t.size=function(r){return i.size(r.data)},t.toList=function(r){return i.toList(r.data)},t.toArray=function(r){return i.toArray(r.data)},t.fromArray=function(r){return{data:a.fromArray(r)}},t.keysToArray=function(r){return i.keysToArray(r.data)},t.valuesToArray=function(r){return i.valuesToArray(r.data)},t.minKey=function(r){return i.minKey(r.data)},t.minKeyUndefined=function(r){return i.minKeyUndefined(r.data)},t.maxKey=function(r){return i.maxKey(r.data)},t.maxKeyUndefined=function(r){return i.maxKeyUndefined(r.data)},t.minimum=function(r){return i.minimum(r.data)},t.minUndefined=function(r){return i.minUndefined(r.data)},t.maximum=function(r){return i.maximum(r.data)},t.maxUndefined=function(r){return i.maxUndefined(r.data)},t.get=function(r,t){return a.get(r.data,t)},t.getUndefined=function(r,t){return a.getUndefined(r.data,t)},t.getWithDefault=function(r,t,e){return a.getWithDefault(r.data,t,e)},t.getExn=function(r,t){return a.getExn(r.data,t)},t.checkInvariantInternal=function(r){i.checkInvariantInternal(r.data)},t.remove=function(r,t){var e=r.data;if(void 0!==e){var n=c(e,t);n===e||(r.data=n)}},t.removeMany=function(r,t){var e=r.data;if(void 0!==e){var n=function(r,t,e,n){for(;;){var o=e;if(o>=n)return r;var i=c(r,t[o]);if(void 0===i)return;e=o+1|0,r=i}}(e,t,0,t.length);n===e||(r.data=n)}},t.set=function(r,t,e){var n=r.data,o=a.addMutate(n,t,e);o===n||(r.data=o)},t.updateU=v,t.update=function(r,t,e){v(r,t,n.__1(e))},t.mapU=s,t.map=function(r,t){return s(r,n.__1(t))},t.mapWithKeyU=u,t.mapWithKey=function(r,t){return u(r,n.__2(t))}},5650:(r,t,e)=>{var n=e(1386),o=e(7175);function i(r){r.length=0,r.first=void 0,r.last=void 0}function a(r,t){var e={content:t,next:void 0},n=r.last;void 0!==n?(r.length=r.length+1|0,n.next=e,r.last=e):(r.length=1,r.first=e,r.last=e)}function s(r,t){for(var e,n={length:r.length,first:void 0,last:void 0},o=r.first;;){var i=o,a=e;if(void 0===i)return n.last=a,n;var s={content:t(i.content),next:void 0};void 0!==a?a.next=s:n.first=s,o=i.next,e=s}}function u(r,t){for(var e=r.first;;){var n=e;if(void 0===n)return;t(n.content),e=n.next}}function f(r,t,e){for(var n=t,o=r.first;;){var i=o;if(void 0===i)return n;var a=e(n,i.content);o=i.next,n=a}}t.make=function(r){return{length:0,first:void 0,last:void 0}},t.clear=i,t.isEmpty=function(r){return 0===r.length},t.fromArray=function(r){for(var t={length:0,first:void 0,last:void 0},e=0,n=r.length;e<n;++e)a(t,r[e]);return t},t.add=a,t.peek=function(r){var t=r.first;if(void 0!==t)return o.some(t.content)},t.peekUndefined=function(r){var t=r.first;if(void 0!==t)return t.content},t.peekExn=function(r){var t=r.first;if(void 0!==t)return t.content;throw{RE_EXN_ID:"Not_found",Error:new Error}},t.pop=function(r){var t=r.first;if(void 0!==t){var e=t.next;return void 0===e?(i(r),o.some(t.content)):(r.length=r.length-1|0,r.first=e,o.some(t.content))}},t.popUndefined=function(r){var t=r.first;if(void 0!==t){var e=t.next;return void 0===e?(i(r),t.content):(r.length=r.length-1|0,r.first=e,t.content)}},t.popExn=function(r){var t=r.first;if(void 0!==t){var e=t.next;return void 0===e?(i(r),t.content):(r.length=r.length-1|0,r.first=e,t.content)}throw{RE_EXN_ID:"Not_found",Error:new Error}},t.copy=function(r){for(var t,e={length:r.length,first:void 0,last:void 0},n=r.first;;){var o=n,i=t;if(void 0===o)return e.last=i,e;var a={content:o.content,next:void 0};void 0!==i?i.next=a:e.first=a,n=o.next,t=a}},t.size=function(r){return r.length},t.mapU=s,t.map=function(r,t){return s(r,n.__1(t))},t.forEachU=u,t.forEach=function(r,t){u(r,n.__1(t))},t.reduceU=f,t.reduce=function(r,t,e){return f(r,t,n.__2(e))},t.transfer=function(r,t){if(!(r.length<=0)){var e=t.last;return void 0!==e?(t.length=t.length+r.length|0,e.next=r.first,t.last=r.last,i(r)):(t.length=r.length,t.first=r.first,t.last=r.last,i(r))}},t.toArray=function(r){var t=new Array(r.length);return function(r,t,e){for(;;){var n=e,o=r;if(void 0===n)return;t[o]=n.content,e=n.next,r=o+1|0}}(0,t,r.first),t}},6601:(r,t,e)=>{var n=e(1386),o=e(7175);function i(r,t){for(var e=r.root;;){var n=e;if(void 0===n)return;t(n.head),e=n.tail}}function a(r,t){for(;;){var e=r.root;if(void 0===e)return;r.root=e.tail,t(e.head)}}t.make=function(r){return{root:void 0}},t.clear=function(r){r.root=void 0},t.copy=function(r){return{root:r.root}},t.push=function(r,t){r.root={head:t,tail:r.root}},t.popUndefined=function(r){var t=r.root;if(void 0!==t)return r.root=t.tail,t.head},t.pop=function(r){var t=r.root;if(void 0!==t)return r.root=t.tail,o.some(t.head)},t.topUndefined=function(r){var t=r.root;if(void 0!==t)return t.head},t.top=function(r){var t=r.root;if(void 0!==t)return o.some(t.head)},t.isEmpty=function(r){return void 0===r.root},t.size=function(r){var t=r.root;if(void 0===t)return 0;for(var e=t,n=0;;){var o=n,i=e.tail;if(void 0===i)return o+1|0;n=o+1|0,e=i}},t.forEachU=i,t.forEach=function(r,t){i(r,n.__1(t))},t.dynamicPopIterU=a,t.dynamicPopIter=function(r,t){a(r,n.__1(t))}},6517:(r,t,e)=>{var n=e(1386),o=e(7175);function i(r,t){if(void 0!==r&&t(o.valFromOption(r)))return r}function a(r,t){if(void 0!==r)return t(o.valFromOption(r))}function s(r,t,e){return void 0!==r?e(o.valFromOption(r)):t}function u(r,t){if(void 0!==r)return o.some(t(o.valFromOption(r)))}function f(r,t){if(void 0!==r)return t(o.valFromOption(r))}function c(r,t,e){return void 0!==r?void 0!==t&&e(o.valFromOption(r),o.valFromOption(t)):void 0===t}function d(r,t,e){return void 0!==r?void 0!==t?e(o.valFromOption(r),o.valFromOption(t)):1:void 0!==t?-1:0}t.keepU=i,t.keep=function(r,t){return i(r,n.__1(t))},t.forEachU=a,t.forEach=function(r,t){a(r,n.__1(t))},t.getExn=function(r){if(void 0!==r)return o.valFromOption(r);throw{RE_EXN_ID:"Not_found",Error:new Error}},t.mapWithDefaultU=s,t.mapWithDefault=function(r,t,e){return s(r,t,n.__1(e))},t.mapU=u,t.map=function(r,t){return u(r,n.__1(t))},t.flatMapU=f,t.flatMap=function(r,t){return f(r,n.__1(t))},t.getWithDefault=function(r,t){return void 0!==r?o.valFromOption(r):t},t.orElse=function(r,t){return void 0!==r?r:t},t.isSome=function(r){return void 0!==r},t.isNone=function(r){return void 0===r},t.eqU=c,t.eq=function(r,t,e){return c(r,t,n.__2(e))},t.cmpU=d,t.cmp=function(r,t,e){return d(r,t,n.__2(e))}},6369:(r,t,e)=>{var n=e(1386);function o(r,t,e){return"Ok"===r.TAG?e(r._0):t}function i(r,t){return"Ok"===r.TAG?{TAG:"Ok",_0:t(r._0)}:{TAG:"Error",_0:r._0}}function a(r,t){return"Ok"===r.TAG?t(r._0):{TAG:"Error",_0:r._0}}function s(r,t,e){return"Ok"===r.TAG?"Ok"===t.TAG&&e(r._0,t._0):"Ok"!==t.TAG}function u(r,t,e){return"Ok"===r.TAG?"Ok"===t.TAG?e(r._0,t._0):1:"Ok"===t.TAG?-1:0}t.getExn=function(r){if("Ok"===r.TAG)return r._0;throw{RE_EXN_ID:"Not_found",Error:new Error}},t.mapWithDefaultU=o,t.mapWithDefault=function(r,t,e){return o(r,t,n.__1(e))},t.mapU=i,t.map=function(r,t){return i(r,n.__1(t))},t.flatMapU=a,t.flatMap=function(r,t){return a(r,n.__1(t))},t.getWithDefault=function(r,t){return"Ok"===r.TAG?r._0:t},t.isOk=function(r){return"Ok"===r.TAG},t.isError=function(r){return"Ok"!==r.TAG},t.eqU=s,t.eq=function(r,t,e){return s(r,t,n.__2(e))},t.cmpU=u,t.cmp=function(r,t,e){return u(r,t,n.__2(e))}},303:(r,t,e)=>{var n=e(4881),o=e(9113);function i(r,t){if(void 0===r)return n.singleton(t);var e=r.v;if(t===e)return r;var o=r.l,a=r.r;if(t<e){var s=i(o,t);return s===o?r:n.bal(s,e,a)}var u=i(a,t);return u===a?r:n.bal(o,e,u)}function a(r,t){if(void 0===r)return r;var e=r.v,o=r.l,i=r.r;if(t===e){if(void 0===o)return i;if(void 0===i)return o;var s={contents:i.v},u=n.removeMinAuxWithRef(i,s);return n.bal(o,s.contents,u)}if(t<e){var f=a(o,t);return f===o?r:n.bal(f,e,i)}var c=a(i,t);return c===i?r:n.bal(o,e,c)}function s(r,t){var e=r.v,o=r.l,i=r.r;if(t===e)return[o,i];if(t<e){if(void 0===o)return[void 0,r];var a=s(o,t);return[a[0],n.joinShared(a[1],e,i)]}if(void 0===i)return[r,void 0];var u=s(i,t);return[n.joinShared(o,e,u[0]),u[1]]}function u(r,t,e){var o=r.v,i=r.l,a=r.r;if(t===o)return e.contents=!0,[i,a];if(t<o){if(void 0===i)return[void 0,r];var s=u(i,t,e);return[s[0],n.joinShared(s[1],o,a)]}if(void 0===a)return[r,void 0];var f=u(a,t,e);return[n.joinShared(i,o,f[0]),f[1]]}var f=o.fromArray,c=n.fromSortedArrayUnsafe,d=n.isEmpty,v=o.has,l=o.subset,m=o.cmp,p=o.eq,h=n.forEachU,E=n.forEach,x=n.reduceU,g=n.reduce,y=n.everyU,_=n.every,T=n.someU,b=n.some,A=n.keepSharedU,k=n.keepShared,S=n.partitionSharedU,w=n.partitionShared,C=n.size,I=n.toList,M=n.toArray,j=n.minimum,D=n.minUndefined,G=n.maximum,N=n.maxUndefined,U=o.get,O=o.getUndefined,P=o.getExn,R=n.checkInvariantInternal;t.empty=void 0,t.fromArray=f,t.fromSortedArrayUnsafe=c,t.isEmpty=d,t.has=v,t.add=i,t.mergeMany=function(r,t){for(var e=t.length,n=r,o=0;o<e;++o)n=i(n,t[o]);return n},t.remove=a,t.removeMany=function(r,t){for(var e=t.length,n=r,o=0;o<e;++o)n=a(n,t[o]);return n},t.union=function r(t,e){if(void 0===t)return e;if(void 0===e)return t;var o=t.h,a=e.h;if(o>=a){if(1===a)return i(t,e.v);var u=t.v,f=t.l,c=t.r,d=s(e,u);return n.joinShared(r(f,d[0]),u,r(c,d[1]))}if(1===o)return i(e,t.v);var v=e.v,l=e.l,m=e.r,p=s(t,v);return n.joinShared(r(p[0],l),v,r(p[1],m))},t.intersect=function r(t,e){if(void 0!==t&&void 0!==e){var o=t.v,i=t.l,a=t.r,s={contents:!1},f=u(e,o,s),c=r(i,f[0]),d=r(a,f[1]);return s.contents?n.joinShared(c,o,d):n.concatShared(c,d)}},t.diff=function r(t,e){if(void 0===t)return t;if(void 0===e)return t;var o=t.v,i=t.l,a=t.r,s={contents:!1},f=u(e,o,s),c=r(i,f[0]),d=r(a,f[1]);return s.contents?n.concatShared(c,d):n.joinShared(c,o,d)},t.subset=l,t.cmp=m,t.eq=p,t.forEachU=h,t.forEach=E,t.reduceU=x,t.reduce=g,t.everyU=y,t.every=_,t.someU=T,t.some=b,t.keepU=A,t.keep=k,t.partitionU=S,t.partition=w,t.size=C,t.toList=I,t.toArray=M,t.minimum=j,t.minUndefined=D,t.maximum=G,t.maxUndefined=N,t.get=U,t.getUndefined=O,t.getExn=P,t.split=function(r,t){if(void 0===r)return[[void 0,void 0],!1];var e={contents:!1};return[u(r,t,e),e.contents]},t.checkInvariantInternal=R},1367:(r,t,e)=>{var n=e(4881),o=e(1572);function i(r,t){if(void 0===r)return n.singleton(t);var e=r.v;if(t===e)return r;var o=r.l,a=r.r;if(t<e){var s=i(o,t);return s===o?r:n.bal(s,e,a)}var u=i(a,t);return u===a?r:n.bal(o,e,u)}function a(r,t){if(void 0===r)return r;var e=r.v,o=r.l,i=r.r;if(t===e){if(void 0===o)return i;if(void 0===i)return o;var s={contents:i.v},u=n.removeMinAuxWithRef(i,s);return n.bal(o,s.contents,u)}if(t<e){var f=a(o,t);return f===o?r:n.bal(f,e,i)}var c=a(i,t);return c===i?r:n.bal(o,e,c)}function s(r,t){var e=r.v,o=r.l,i=r.r;if(t===e)return[o,i];if(t<e){if(void 0===o)return[void 0,r];var a=s(o,t);return[a[0],n.joinShared(a[1],e,i)]}if(void 0===i)return[r,void 0];var u=s(i,t);return[n.joinShared(o,e,u[0]),u[1]]}function u(r,t,e){var o=r.v,i=r.l,a=r.r;if(t===o)return e.contents=!0,[i,a];if(t<o){if(void 0===i)return[void 0,r];var s=u(i,t,e);return[s[0],n.joinShared(s[1],o,a)]}if(void 0===a)return[r,void 0];var f=u(a,t,e);return[n.joinShared(i,o,f[0]),f[1]]}var f=o.fromArray,c=n.fromSortedArrayUnsafe,d=n.isEmpty,v=o.has,l=o.subset,m=o.cmp,p=o.eq,h=n.forEachU,E=n.forEach,x=n.reduceU,g=n.reduce,y=n.everyU,_=n.every,T=n.someU,b=n.some,A=n.keepSharedU,k=n.keepShared,S=n.partitionSharedU,w=n.partitionShared,C=n.size,I=n.toList,M=n.toArray,j=n.minimum,D=n.minUndefined,G=n.maximum,N=n.maxUndefined,U=o.get,O=o.getUndefined,P=o.getExn,R=n.checkInvariantInternal;t.empty=void 0,t.fromArray=f,t.fromSortedArrayUnsafe=c,t.isEmpty=d,t.has=v,t.add=i,t.mergeMany=function(r,t){for(var e=t.length,n=r,o=0;o<e;++o)n=i(n,t[o]);return n},t.remove=a,t.removeMany=function(r,t){for(var e=t.length,n=r,o=0;o<e;++o)n=a(n,t[o]);return n},t.union=function r(t,e){if(void 0===t)return e;if(void 0===e)return t;var o=t.h,a=e.h;if(o>=a){if(1===a)return i(t,e.v);var u=t.v,f=t.l,c=t.r,d=s(e,u);return n.joinShared(r(f,d[0]),u,r(c,d[1]))}if(1===o)return i(e,t.v);var v=e.v,l=e.l,m=e.r,p=s(t,v);return n.joinShared(r(p[0],l),v,r(p[1],m))},t.intersect=function r(t,e){if(void 0!==t&&void 0!==e){var o=t.v,i=t.l,a=t.r,s={contents:!1},f=u(e,o,s),c=r(i,f[0]),d=r(a,f[1]);return s.contents?n.joinShared(c,o,d):n.concatShared(c,d)}},t.diff=function r(t,e){if(void 0===t)return t;if(void 0===e)return t;var o=t.v,i=t.l,a=t.r,s={contents:!1},f=u(e,o,s),c=r(i,f[0]),d=r(a,f[1]);return s.contents?n.concatShared(c,d):n.joinShared(c,o,d)},t.subset=l,t.cmp=m,t.eq=p,t.forEachU=h,t.forEach=E,t.reduceU=x,t.reduce=g,t.everyU=y,t.every=_,t.someU=T,t.some=b,t.keepU=A,t.keep=k,t.partitionU=S,t.partition=w,t.size=C,t.toList=I,t.toArray=M,t.minimum=j,t.minUndefined=D,t.maximum=G,t.maxUndefined=N,t.get=U,t.getUndefined=O,t.getExn=P,t.split=function(r,t){if(void 0===r)return[[void 0,void 0],!1];var e={contents:!1};return[u(r,t,e),e.contents]},t.checkInvariantInternal=R},2531:(r,t,e)=>{var n=e(1386),o=e(2971);function i(r,t){var e=r.length;if(0===e||1===e)return e;var n=r[0],o=r[1];if(!t(n,o))return t(o,n)?0|-function(r,t,e,n,o){for(;;){var i=e,a=t;if(i>=n)return i;var s=r[i];if(!o(s,a))return i;e=i+1|0,t=s}}(r,o,2,e,t):1;for(var i=o,a=2;;){var s=a,u=i;if(s>=e)return s;var f=r[s];if(!t(u,f))return s;a=s+1|0,i=f}}function a(r,t){var e=r.length;if(0===e)return!0;for(var n=0,o=e-1|0;;){var i=n;if(i===o)return!0;if(t(r[i],r[i+1|0])>0)return!1;n=i+1|0}}function s(r,t,e,n,i,a,s,u,f){for(var c=t+e|0,d=i+a|0,v=t,l=r[t],m=i,p=n[i],h=u;;){var E=h,x=p,g=m,y=l,_=v;if(f(y,x)<=0){s[E]=y;var T=_+1|0;if(T>=c)return o.blitUnsafe(n,g,s,E+1|0,d-g|0);h=E+1|0,l=r[T],v=T}else{s[E]=x;var b=g+1|0;if(b>=d)return o.blitUnsafe(r,_,s,E+1|0,c-_|0);h=E+1|0,p=n[b],m=b}}}function u(r,t,e,n,i,a,s,u,f){for(var c=t+e|0,d=i+a|0,v=t,l=r[t],m=i,p=n[i],h=u;;){var E=h,x=p,g=m,y=l,_=v,T=f(y,x);if(T<0){s[E]=y;var b=_+1|0,A=E+1|0;if(b<c){h=A,l=r[b],v=b;continue}return o.blitUnsafe(n,g,s,A,d-g|0),(A+d|0)-g|0}if(0!==T){s[E]=x;var k=g+1|0,S=E+1|0;if(!(k<d))return o.blitUnsafe(r,_,s,S,c-_|0),(S+c|0)-_|0;h=S,p=n[k],m=k}else{s[E]=y;var w=_+1|0,C=g+1|0,I=E+1|0;if(!(w<c&&C<d))return w===c?(o.blitUnsafe(n,C,s,I,d-C|0),(I+d|0)-C|0):(o.blitUnsafe(r,w,s,I,c-w|0),(I+c|0)-w|0);h=I,p=n[C],m=C,l=r[w],v=w}}}function f(r,t,e,n,o,i,a,s,u){for(var f=t+e|0,c=o+i|0,d=t,v=r[t],l=o,m=n[o],p=s;;){var h=p,E=l,x=v,g=d,y=u(x,m);if(y<0){var _=g+1|0;if(_>=f)return h;v=r[_],d=_}else if(0!==y){var T=E+1|0;if(T>=c)return h;m=n[T],l=T}else{a[h]=x;var b=g+1|0,A=E+1|0,k=h+1|0;if(!(b<f&&A<c))return k;p=k,m=n[A],l=A,v=r[b],d=b}}}function c(r,t,e,n,i,a,s,u,f){for(var c=t+e|0,d=i+a|0,v=t,l=r[t],m=i,p=n[i],h=u;;){var E=h,x=m,g=l,y=v,_=f(g,p);if(_<0){s[E]=g;var T=E+1|0,b=y+1|0;if(b>=c)return T;h=T,l=r[b],v=b}else if(0!==_){var A=x+1|0;if(!(A<d))return o.blitUnsafe(r,y,s,E,c-y|0),(E+c|0)-y|0;p=n[A],m=A}else{var k=y+1|0,S=x+1|0;if(!(k<c&&S<d))return k===c?E:(o.blitUnsafe(r,k,s,E,c-k|0),(E+c|0)-k|0);p=n[S],m=S,l=r[k],v=k}}}function d(r,t,e,n,o,i){for(var a=0;a<o;++a){for(var s=r[t+a|0],u=(n+a|0)-1|0;u>=n&&i(e[u],s)>0;)e[u+1|0]=e[u],u=u-1|0;e[u+1|0]=s}}function v(r,t,e,n,o,i){if(o<=5)return d(r,t,e,n,o,i);var a=o/2|0,u=o-a|0;v(r,t+a|0,e,n+a|0,u,i),v(r,t,r,t+u|0,a,i),s(r,t+u|0,a,e,n+a|0,u,e,n,i)}function l(r,t){var e=r.length;if(e<=5)return d(r,0,r,0,e,t);var n=e/2|0,o=e-n|0,i=new Array(o);v(r,n,i,0,o,t),v(r,0,r,o,n,t),s(r,o,n,i,0,o,r,0,t)}function m(r,t){var e=r.slice(0);return l(e,t),e}function p(r,t,e){var n=r.length;if(0===n)return-1;if(e(t,r[0])<0)return-1;if(e(t,r[n-1|0])>0)return 0|-(n+1|0);for(var o=0,i=n-1|0;;){var a=i,s=o,u=(s+a|0)/2|0,f=e(t,r[u]);if(0===f)return u;if(f<0){if(a===u)return 0===e(r[s],t)?s:0|-(a+1|0);i=u}else{if(s===u)return 0===e(r[a],t)?a:0|-(a+1|0);o=u}}}t.Int=void 0,t.$$String=void 0,t.strictlySortedLengthU=i,t.strictlySortedLength=function(r,t){return i(r,n.__2(t))},t.isSortedU=a,t.isSorted=function(r,t){return a(r,n.__2(t))},t.stableSortInPlaceByU=l,t.stableSortInPlaceBy=function(r,t){l(r,n.__2(t))},t.stableSortByU=m,t.stableSortBy=function(r,t){return m(r,n.__2(t))},t.binarySearchByU=p,t.binarySearchBy=function(r,t,e){return p(r,t,n.__2(e))},t.unionU=u,t.union=function(r,t,e,o,i,a,s,f,c){return u(r,t,e,o,i,a,s,f,n.__2(c))},t.intersectU=f,t.intersect=function(r,t,e,o,i,a,s,u,c){return f(r,t,e,o,i,a,s,u,n.__2(c))},t.diffU=c,t.diff=function(r,t,e,o,i,a,s,u,f){return c(r,t,e,o,i,a,s,u,n.__2(f))}},3282:(r,t,e)=>{var n=e(2971);function o(r,t,e,o,i,a,s,u){for(var f=t+e|0,c=i+a|0,d=t,v=r[t],l=i,m=o[i],p=u;;){var h=p,E=m,x=l,g=v,y=d;if(g<=E){s[h]=g;var _=y+1|0;if(_>=f)return n.blitUnsafe(o,x,s,h+1|0,c-x|0);p=h+1|0,v=r[_],d=_}else{s[h]=E;var T=x+1|0;if(T>=c)return n.blitUnsafe(r,y,s,h+1|0,f-y|0);p=h+1|0,m=o[T],l=T}}}function i(r,t,e,n,o){for(var i=0;i<o;++i){for(var a=r[t+i|0],s=(n+i|0)-1|0;s>=n&&e[s]>a;)e[s+1|0]=e[s],s=s-1|0;e[s+1|0]=a}}function a(r,t,e,n,s){if(s<=5)return i(r,t,e,n,s);var u=s/2|0,f=s-u|0;a(r,t+u|0,e,n+u|0,f),a(r,t,r,t+f|0,u),o(r,t+f|0,u,e,n+u|0,f,e,n)}function s(r){var t=r.length;if(t<=5)return i(r,0,r,0,t);var e=t/2|0,n=t-e|0,s=new Array(n);a(r,e,s,0,n),a(r,0,r,n,e),o(r,n,e,s,0,n,r,0)}t.strictlySortedLength=function(r){var t=r.length;if(0===t||1===t)return t;var e=r[0],n=r[1];if(!(e<n))return e>n?0|-function(r,t,e,n){for(;;){var o=e,i=t;if(o>=n)return o;var a=r[o];if(i<=a)return o;e=o+1|0,t=a}}(r,n,2,t):1;for(var o=n,i=2;;){var a=i,s=o;if(a>=t)return a;var u=r[a];if(s>=u)return a;i=a+1|0,o=u}},t.isSorted=function(r){var t=r.length;if(0===t)return!0;for(var e=0,n=t-1|0;;){var o=e;if(o===n)return!0;if(r[o]>r[o+1|0])return!1;e=o+1|0}},t.stableSortInPlace=s,t.stableSort=function(r){var t=r.slice(0);return s(t),t},t.binarySearch=function(r,t){var e=r.length;if(0===e)return-1;if(t<r[0])return-1;if(t>r[e-1|0])return 0|-(e+1|0);for(var n=0,o=e-1|0;;){var i=o,a=n,s=(a+i|0)/2|0,u=r[s];if(t===u)return s;if(t<u){if(i===s)return r[a]===t?a:0|-(i+1|0);o=s}else{if(a===s)return r[i]===t?i:0|-(i+1|0);n=s}}},t.union=function(r,t,e,o,i,a,s,u){for(var f=t+e|0,c=i+a|0,d=t,v=r[t],l=i,m=o[i],p=u;;){var h=p,E=m,x=l,g=v,y=d;if(g<E){s[h]=g;var _=y+1|0,T=h+1|0;if(_<f){p=T,v=r[_],d=_;continue}return n.blitUnsafe(o,x,s,T,c-x|0),(T+c|0)-x|0}if(g!==E){s[h]=E;var b=x+1|0,A=h+1|0;if(!(b<c))return n.blitUnsafe(r,y,s,A,f-y|0),(A+f|0)-y|0;p=A,m=o[b],l=b}else{s[h]=g;var k=y+1|0,S=x+1|0,w=h+1|0;if(!(k<f&&S<c))return k===f?(n.blitUnsafe(o,S,s,w,c-S|0),(w+c|0)-S|0):(n.blitUnsafe(r,k,s,w,f-k|0),(w+f|0)-k|0);p=w,m=o[S],l=S,v=r[k],d=k}}},t.intersect=function(r,t,e,n,o,i,a,s){for(var u=t+e|0,f=o+i|0,c=t,d=r[t],v=o,l=n[o],m=s;;){var p=m,h=l,E=v,x=d,g=c;if(x<h){var y=g+1|0;if(y>=u)return p;d=r[y],c=y}else if(x!==h){var _=E+1|0;if(_>=f)return p;l=n[_],v=_}else{a[p]=x;var T=g+1|0,b=E+1|0,A=p+1|0;if(!(T<u&&b<f))return A;m=A,l=n[b],v=b,d=r[T],c=T}}},t.diff=function(r,t,e,o,i,a,s,u){for(var f=t+e|0,c=i+a|0,d=t,v=r[t],l=i,m=o[i],p=u;;){var h=p,E=m,x=l,g=v,y=d;if(g<E){s[h]=g;var _=h+1|0,T=y+1|0;if(T>=f)return _;p=_,v=r[T],d=T}else if(g!==E){var b=x+1|0;if(!(b<c))return n.blitUnsafe(r,y,s,h,f-y|0),(h+f|0)-y|0;m=o[b],l=b}else{var A=y+1|0,k=x+1|0;if(!(A<f&&k<c))return A===f?h:(n.blitUnsafe(r,A,s,h,f-A|0),(h+f|0)-A|0);m=o[k],l=k,v=r[A],d=A}}}},8466:(r,t,e)=>{var n=e(2971);function o(r,t,e,o,i,a,s,u){for(var f=t+e|0,c=i+a|0,d=t,v=r[t],l=i,m=o[i],p=u;;){var h=p,E=m,x=l,g=v,y=d;if(g<=E){s[h]=g;var _=y+1|0;if(_>=f)return n.blitUnsafe(o,x,s,h+1|0,c-x|0);p=h+1|0,v=r[_],d=_}else{s[h]=E;var T=x+1|0;if(T>=c)return n.blitUnsafe(r,y,s,h+1|0,f-y|0);p=h+1|0,m=o[T],l=T}}}function i(r,t,e,n,o){for(var i=0;i<o;++i){for(var a=r[t+i|0],s=(n+i|0)-1|0;s>=n&&e[s]>a;)e[s+1|0]=e[s],s=s-1|0;e[s+1|0]=a}}function a(r,t,e,n,s){if(s<=5)return i(r,t,e,n,s);var u=s/2|0,f=s-u|0;a(r,t+u|0,e,n+u|0,f),a(r,t,r,t+f|0,u),o(r,t+f|0,u,e,n+u|0,f,e,n)}function s(r){var t=r.length;if(t<=5)return i(r,0,r,0,t);var e=t/2|0,n=t-e|0,s=new Array(n);a(r,e,s,0,n),a(r,0,r,n,e),o(r,n,e,s,0,n,r,0)}t.strictlySortedLength=function(r){var t=r.length;if(0===t||1===t)return t;var e=r[0],n=r[1];if(!(e<n))return e>n?0|-function(r,t,e,n){for(;;){var o=e,i=t;if(o>=n)return o;var a=r[o];if(i<=a)return o;e=o+1|0,t=a}}(r,n,2,t):1;for(var o=n,i=2;;){var a=i,s=o;if(a>=t)return a;var u=r[a];if(s>=u)return a;i=a+1|0,o=u}},t.isSorted=function(r){var t=r.length;if(0===t)return!0;for(var e=0,n=t-1|0;;){var o=e;if(o===n)return!0;if(r[o]>r[o+1|0])return!1;e=o+1|0}},t.stableSortInPlace=s,t.stableSort=function(r){var t=r.slice(0);return s(t),t},t.binarySearch=function(r,t){var e=r.length;if(0===e)return-1;if(t<r[0])return-1;if(t>r[e-1|0])return 0|-(e+1|0);for(var n=0,o=e-1|0;;){var i=o,a=n,s=(a+i|0)/2|0,u=r[s];if(t===u)return s;if(t<u){if(i===s)return r[a]===t?a:0|-(i+1|0);o=s}else{if(a===s)return r[i]===t?i:0|-(i+1|0);n=s}}},t.union=function(r,t,e,o,i,a,s,u){for(var f=t+e|0,c=i+a|0,d=t,v=r[t],l=i,m=o[i],p=u;;){var h=p,E=m,x=l,g=v,y=d;if(g<E){s[h]=g;var _=y+1|0,T=h+1|0;if(_<f){p=T,v=r[_],d=_;continue}return n.blitUnsafe(o,x,s,T,c-x|0),(T+c|0)-x|0}if(g!==E){s[h]=E;var b=x+1|0,A=h+1|0;if(!(b<c))return n.blitUnsafe(r,y,s,A,f-y|0),(A+f|0)-y|0;p=A,m=o[b],l=b}else{s[h]=g;var k=y+1|0,S=x+1|0,w=h+1|0;if(!(k<f&&S<c))return k===f?(n.blitUnsafe(o,S,s,w,c-S|0),(w+c|0)-S|0):(n.blitUnsafe(r,k,s,w,f-k|0),(w+f|0)-k|0);p=w,m=o[S],l=S,v=r[k],d=k}}},t.intersect=function(r,t,e,n,o,i,a,s){for(var u=t+e|0,f=o+i|0,c=t,d=r[t],v=o,l=n[o],m=s;;){var p=m,h=l,E=v,x=d,g=c;if(x<h){var y=g+1|0;if(y>=u)return p;d=r[y],c=y}else if(x!==h){var _=E+1|0;if(_>=f)return p;l=n[_],v=_}else{a[p]=x;var T=g+1|0,b=E+1|0,A=p+1|0;if(!(T<u&&b<f))return A;m=A,l=n[b],v=b,d=r[T],c=T}}},t.diff=function(r,t,e,o,i,a,s,u){for(var f=t+e|0,c=i+a|0,d=t,v=r[t],l=i,m=o[i],p=u;;){var h=p,E=m,x=l,g=v,y=d;if(g<E){s[h]=g;var _=h+1|0,T=y+1|0;if(T>=f)return _;p=_,v=r[T],d=T}else if(g!==E){var b=x+1|0;if(!(b<c))return n.blitUnsafe(r,y,s,h,f-y|0),(h+f|0)-y|0;m=o[b],l=b}else{var A=y+1|0,k=x+1|0;if(!(A<f&&k<c))return A===f?h:(n.blitUnsafe(r,A,s,h,f-A|0),(h+f|0)-A|0);m=o[k],l=k,v=r[A],d=A}}}},4881:(r,t,e)=>{var n=e(1386),o=e(7175),i=e(2531);function a(r,t,e){var n=void 0!==r?r.h:0,o=void 0!==e?e.h:0;return{v:t,h:(n>=o?n:o)+1|0,l:r,r:e}}function s(r){return{v:r,h:1,l:void 0,r:void 0}}function u(r,t){return void 0===t||void 0!==r&&r.h>=t.h}function f(r,t,e){var n=void 0!==r?r.h:0,o=void 0!==e?e.h:0;if(n>(o+2|0)){var i=r.l,s=r.r;return u(i,s)?a(i,r.v,a(s,t,e)):a(a(i,r.v,s.l),s.v,a(s.r,t,e))}if(o<=(n+2|0))return{v:t,h:(n>=o?n:o)+1|0,l:r,r:e};var f=e.l,c=e.r;return u(c,f)?a(a(r,t,f),e.v,c):a(a(r,t,f.l),f.v,a(f.r,e.v,c))}function c(r){for(;;){var t=r,e=t.l;if(void 0===e)return t.v;r=e}}function d(r){for(;;){var t=r,e=t.r;if(void 0===e)return t.v;r=e}}function v(r,t){var e=r.l;return void 0!==e?f(v(e,t),r.v,r.r):(t.contents=r.v,r.r)}function l(r,t){for(;;){if(void 0===r)return t;t={hd:r,tl:t},r=r.l}}function m(r,t){for(;;){var e=r;if(void 0===e)return;m(e.l,t),t(e.v),r=e.r}}function p(r,t,e){for(;;){var n=t,o=r;if(void 0===o)return n;t=e(p(o.l,n,e),o.v),r=o.r}}function h(r,t){for(;;){var e=r;if(void 0===e)return!0;if(!t(e.v))return!1;if(!h(e.l,t))return!1;r=e.r}}function E(r,t){for(;;){var e=r;if(void 0===e)return!1;if(t(e.v))return!0;if(E(e.l,t))return!0;r=e.r}}function x(r,t){return void 0!==r?f(x(r.l,t),r.v,r.r):s(t)}function g(r,t){return void 0!==r?f(r.l,r.v,g(r.r,t)):s(t)}function y(r,t,e){if(void 0===r)return x(e,t);if(void 0===e)return g(r,t);var n=r.h,o=e.h;return n>(o+2|0)?f(r.l,r.v,y(r.r,t,e)):o>(n+2|0)?f(y(r,t,e.l),e.v,e.r):a(r,t,e)}function _(r,t){if(void 0===r)return t;if(void 0===t)return r;var e={contents:t.v},n=v(t,e);return y(r,e.contents,n)}function T(r,t){if(void 0===r)return[void 0,void 0];var e=r.v,n=T(r.l,t),o=n[1],i=n[0],a=t(e),s=T(r.r,t),u=s[1],f=s[0];return a?[y(i,e,f),_(o,u)]:[_(i,f),y(o,e,u)]}function b(r){var t=r.l,e=r.r;return(1+(void 0!==t?b(t):0)|0)+(void 0!==e?b(e):0)|0}function A(r){return void 0!==r?b(r):0}function k(r,t){for(;;){var e=t,n=r;if(void 0===n)return e;t={hd:n.v,tl:k(n.r,e)},r=n.l}}function S(r,t,e){for(;;){var n=t,o=r,i=o.v,a=o.l,s=o.r,u=void 0!==a?S(a,n,e):n;e[u]=i;var f=u+1|0;if(void 0===s)return f;t=f,r=s}}function w(r,t,e,n){for(;;){var o=r,i=o.v,a=o.l,s=o.r;if(void 0!==a&&w(a,t,e,n),n(i)){var u=t.forward;e[u]=i,t.forward=u+1|0}else{var f=t.backward;e[f]=i,t.backward=f-1|0}if(void 0===s)return;r=s}}function C(r,t,e,n){for(;;){var o=t,i=r,a=i.v,s=i.l,u=i.r,f=void 0!==s?C(s,o,e,n):o,c=n(a)?(e[f]=a,f+1|0):f;if(void 0===u)return c;t=c,r=u}}function I(r,t,e){switch(e){case 0:return;case 1:return s(r[t]);case 2:var n=r[t];return{v:r[t-1|0],h:2,l:s(n),r:void 0};case 3:var o=r[t],i=r[t-1|0],u=r[t-2|0];return{v:i,h:2,l:s(o),r:s(u)};default:var f=e/2|0;return a(I(r,t,f),r[t-f|0],I(r,(t-f|0)-1|0,(e-f|0)-1|0))}}function M(r,t,e){switch(e){case 0:return;case 1:return s(r[t]);case 2:var n=r[t];return{v:r[t+1|0],h:2,l:s(n),r:void 0};case 3:var o=r[t],i=r[t+1|0],u=r[t+2|0];return{v:i,h:2,l:s(o),r:s(u)};default:var f=e/2|0;return a(M(r,t,f),r[t+f|0],M(r,1+(t+f|0)|0,(e-f|0)-1|0))}}function j(r,t){if(void 0!==r){var e=r.v,n=r.l,o=r.r,i=j(n,t),a=t(e),s=j(o,t);return a?n===i&&o===s?r:y(i,e,s):_(i,s)}}function D(r,t){if(void 0!==r){var e=b(r),n=new Array(e);return M(n,0,C(r,0,n,t))}}function G(r,t){if(void 0===r)return[void 0,void 0];var e=b(r),n=new Array(e),o=e-1|0,i={forward:0,backward:o};w(r,i,n,t);var a=i.forward;return[M(n,0,a),I(n,o,e-a|0)]}function N(r,t,e){var n=A(r),o=A(t);if(n!==o)return n<o?-1:1;for(var i=l(r,0),a=l(t,0);;){var s=a,u=i;if(!u)return 0;if(!s)return 0;var f=s.hd,c=u.hd,d=e(c.v,f.v);if(0!==d)return d;a=l(f.r,s.tl),i=l(c.r,u.tl)}}function U(r){var t=r.l;r.l=t.r,t.r=r;var e=r.l,n=void 0!==e?e.h:0,o=r.r,i=void 0!==o?o.h:0;r.h=(n>i?n:i)+1|0;var a=t.l,s=void 0!==a?a.h:0,u=r.h;return t.h=(s>u?s:u)+1|0,t}function O(r){var t=r.r;r.r=t.l,t.l=r;var e=r.l,n=void 0!==e?e.h:0,o=r.r,i=void 0!==o?o.h:0;r.h=(n>i?n:i)+1|0;var a=t.r,s=void 0!==a?a.h:0,u=r.h;return t.h=(s>u?s:u)+1|0,t}function P(r){var t=r.l,e=void 0!==t?t.h:0,n=r.r,o=void 0!==n?n.h:0;return r.h=(e>o?e:o)+1|0,r}function R(r){var t,e,n=r.l,o=r.r,i=void 0!==n?n.h:0,a=void 0!==o?o.h:0;if(i>(2+a|0))return u(n.l,n.r)?P(U(r)):P((e=O((t=r).l),t.l=e,U(t)));if(a>(2+i|0)){var s=o.l;return u(o.r,s)?P(O(r)):P(function(r){var t=U(r.r);return r.r=t,O(r)}(r))}return r.h=(i>a?i:a)+1|0,r}function F(r,t,e){if(void 0===t)return s(e);var n=r(e,t.v);if(0===n)return t;var o=t.l,i=t.r;if(n<0){var a=F(r,o,e);t.l=a}else t.r=F(r,i,e);return R(t)}t.copy=function r(t){return void 0!==t?{v:t.v,h:t.h,l:r(t.l),r:r(t.r)}:t},t.create=a,t.bal=f,t.singleton=s,t.minimum=function(r){if(void 0!==r)return o.some(c(r))},t.minUndefined=function(r){if(void 0!==r)return c(r)},t.maximum=function(r){if(void 0!==r)return o.some(d(r))},t.maxUndefined=function(r){if(void 0!==r)return d(r)},t.removeMinAuxWithRef=v,t.isEmpty=function(r){return void 0===r},t.stackAllLeft=l,t.forEachU=m,t.forEach=function(r,t){m(r,n.__1(t))},t.reduceU=p,t.reduce=function(r,t,e){return p(r,t,n.__2(e))},t.everyU=h,t.every=function(r,t){return h(r,n.__1(t))},t.someU=E,t.some=function(r,t){return E(r,n.__1(t))},t.joinShared=y,t.concatShared=_,t.keepSharedU=j,t.keepShared=function(r,t){return j(r,n.__1(t))},t.keepCopyU=D,t.keepCopy=function(r,t){return D(r,n.__1(t))},t.partitionSharedU=T,t.partitionShared=function(r,t){return T(r,n.__1(t))},t.partitionCopyU=G,t.partitionCopy=function(r,t){return G(r,n.__1(t))},t.lengthNode=b,t.size=A,t.toList=function(r){return k(r,0)},t.checkInvariantInternal=function r(t){for(;;){var e=t;if(void 0===e)return;var n=e.l,o=e.r,i=(void 0!==n?n.h:0)-(void 0!==o?o.h:0)|0;if(!(i<=2&&i>=-2))throw{RE_EXN_ID:"Assert_failure",_1:["belt_internalAVLset.res",319,4],Error:new Error};r(n),t=o}},t.fillArray=S,t.toArray=function(r){if(void 0===r)return[];var t=b(r),e=new Array(t);return S(r,0,e),e},t.fromSortedArrayAux=M,t.fromSortedArrayRevAux=I,t.fromSortedArrayUnsafe=function(r){return M(r,0,r.length)},t.has=function(r,t,e){for(;;){var n=r;if(void 0===n)return!1;var o=e(t,n.v);if(0===o)return!0;r=o<0?n.l:n.r}},t.cmp=N,t.eq=function(r,t,e){return 0===N(r,t,e)},t.subset=function r(t,e,n){for(;;){var o=e,i=t;if(void 0===i)return!0;if(void 0===o)return!1;var s=i.v,u=i.l,f=i.r,c=o.v,d=o.l,v=o.r,l=n(s,c);if(0!==l)if(l<0){if(!r(a(u,s,void 0),d,n))return!1;t=f}else{if(!r(a(void 0,s,f),v,n))return!1;t=u}else{if(!r(u,d,n))return!1;e=v,t=f}}},t.get=function(r,t,e){for(;;){var n=r;if(void 0===n)return;var i=n.v,a=e(t,i);if(0===a)return o.some(i);r=a<0?n.l:n.r}},t.getUndefined=function(r,t,e){for(;;){var n=r;if(void 0===n)return;var o=n.v,i=e(t,o);if(0===i)return o;r=i<0?n.l:n.r}},t.getExn=function(r,t,e){for(;;){var n=r;if(void 0===n)throw{RE_EXN_ID:"Not_found",Error:new Error};var o=n.v,i=e(t,o);if(0===i)return o;r=i<0?n.l:n.r}},t.fromArray=function(r,t){var e=r.length;if(0!==e){var n,o=i.strictlySortedLengthU(r,(function(r,e){return t(r,e)<0}));n=o>=0?M(r,0,o):I(r,(o=0|-o)-1|0,o);for(var a=o;a<e;++a)n=F(t,n,r[a]);return n}},t.addMutate=F,t.balMutate=R,t.removeMinAuxWithRootMutate=function r(t,e){var n=e.l,o=e.r;return void 0!==n?(e.l=r(t,n),R(e)):(t.v=e.v,o)}},6144:(r,t,e)=>{var n=e(1386),o=e(7175),i=e(2531);function a(r){return void 0!==r?r.h:0}function s(r,t,e,n){var o=a(r),i=a(n);return{k:t,v:e,h:o>=i?o+1|0:i+1|0,l:r,r:n}}function u(r,t){return{k:r,v:t,h:1,l:void 0,r:void 0}}function f(r,t){return void 0===t||void 0!==r&&r.h>=t.h}function c(r,t,e,n){var o=void 0!==r?r.h:0,i=void 0!==n?n.h:0;if(o>(i+2|0)){var u=r.l,f=r.r;return a(u)>=a(f)?s(u,r.k,r.v,s(f,t,e,n)):s(s(u,r.k,r.v,f.l),f.k,f.v,s(f.r,t,e,n))}if(i<=(o+2|0))return{k:t,v:e,h:o>=i?o+1|0:i+1|0,l:r,r:n};var c=n.l,d=n.r;return a(d)>=a(c)?s(s(r,t,e,c),n.k,n.v,d):s(s(r,t,e,c.l),c.k,c.v,s(c.r,n.k,n.v,d))}function d(r){for(;;){var t=r,e=t.l;if(void 0===e)return t.k;r=e}}function v(r){for(;;){var t=r,e=t.r;if(void 0===e)return t.k;r=e}}function l(r){for(;;){var t=r,e=t.l;if(void 0===e)return[t.k,t.v];r=e}}function m(r){for(;;){var t=r,e=t.r;if(void 0===e)return[t.k,t.v];r=e}}function p(r,t,e){var n=r.l;return void 0!==n?c(p(n,t,e),r.k,r.v,r.r):(t.contents=r.k,e.contents=r.v,r.r)}function h(r,t){for(;;){if(void 0===r)return t;t={hd:r,tl:t},r=r.l}}function E(r,t){if(void 0!==r){var e=E(r.l,t);if(void 0!==e)return e;var n=r.k,o=r.v;if(t(n,o))return[n,o];var i=E(r.r,t);return void 0!==i?i:void 0}}function x(r,t){for(;;){var e=r;if(void 0===e)return;x(e.l,t),t(e.k,e.v),r=e.r}}function g(r,t){if(void 0!==r){var e=g(r.l,t),n=t(r.v),o=g(r.r,t);return{k:r.k,v:n,h:r.h,l:e,r:o}}}function y(r,t){if(void 0!==r){var e=r.k,n=y(r.l,t),o=t(e,r.v),i=y(r.r,t);return{k:e,v:o,h:r.h,l:n,r:i}}}function _(r,t,e){for(;;){var n=t,o=r;if(void 0===o)return n;var i=o.k,a=o.v,s=o.l,u=o.r;t=e(_(s,n,e),i,a),r=u}}function T(r,t){for(;;){var e=r;if(void 0===e)return!0;if(!t(e.k,e.v))return!1;if(!T(e.l,t))return!1;r=e.r}}function b(r,t){for(;;){var e=r;if(void 0===e)return!1;if(t(e.k,e.v))return!0;if(b(e.l,t))return!0;r=e.r}}function A(r,t,e){return void 0!==r?c(A(r.l,t,e),r.k,r.v,r.r):u(t,e)}function k(r,t,e){return void 0!==r?c(r.l,r.k,r.v,k(r.r,t,e)):u(t,e)}function S(r,t,e,n){if(void 0===r)return A(n,t,e);if(void 0===n)return k(r,t,e);var o=r.k,i=r.v,a=r.h,u=r.l,f=r.r,d=n.k,v=n.v,l=n.h,m=n.l,p=n.r;return a>(l+2|0)?c(u,o,i,S(f,t,e,n)):l>(a+2|0)?c(S(r,t,e,m),d,v,p):s(r,t,e,n)}function w(r,t){if(void 0===r)return t;if(void 0===t)return r;var e={contents:t.k},n={contents:t.v},o=p(t,e,n);return S(r,e.contents,n.contents,o)}function C(r,t){if(void 0!==r){var e=r.k,n=r.v,o=C(r.l,t),i=t(e,n),a=C(r.r,t);return i?S(o,e,n,a):w(o,a)}}function I(r,t){if(void 0!==r){var e=r.k,n=r.v,i=I(r.l,t),a=t(e,n),s=I(r.r,t);return void 0!==a?S(i,e,o.valFromOption(a),s):w(i,s)}}function M(r,t){if(void 0===r)return[void 0,void 0];var e=r.k,n=r.v,o=M(r.l,t),i=o[1],a=o[0],s=t(e,n),u=M(r.r,t),f=u[1],c=u[0];return s?[S(a,e,n,c),w(i,f)]:[w(a,c),S(i,e,n,f)]}function j(r){var t=r.l,e=r.r;return(1+(void 0!==t?j(t):0)|0)+(void 0!==e?j(e):0)|0}function D(r){return void 0!==r?j(r):0}function G(r,t){for(;;){var e=t,n=r;if(void 0===n)return e;var o=n.k,i=n.v,a=n.l;t={hd:[o,i],tl:G(n.r,e)},r=a}}function N(r,t,e){for(;;){var n=t,o=r,i=o.k,a=o.l,s=o.r,u=void 0!==a?N(a,n,e):n;e[u]=i;var f=u+1|0;if(void 0===s)return f;t=f,r=s}}function U(r,t,e){for(;;){var n=t,o=r,i=o.l,a=o.r,s=void 0!==i?U(i,n,e):n;e[s]=o.v;var u=s+1|0;if(void 0===a)return u;t=u,r=a}}function O(r,t,e){for(;;){var n=t,o=r,i=o.l,a=o.k,s=o.r,u=void 0!==i?O(i,n,e):n;e[u]=[a,o.v];var f=u+1|0;if(void 0===s)return f;t=f,r=s}}function P(r,t,e){switch(e){case 0:return;case 1:var n=r[t];return u(n[0],n[1]);case 2:var o=r[t],i=r[t-1|0],a=o;return{k:i[0],v:i[1],h:2,l:u(a[0],a[1]),r:void 0};case 3:var f=r[t],c=r[t-1|0],d=r[t-2|0],v=c,l=f;return{k:v[0],v:v[1],h:2,l:u(l[0],l[1]),r:u(d[0],d[1])};default:var m=e/2|0,p=P(r,t,m),h=r[t-m|0],E=P(r,(t-m|0)-1|0,(e-m|0)-1|0);return s(p,h[0],h[1],E)}}function R(r,t,e){switch(e){case 0:return;case 1:var n=r[t];return u(n[0],n[1]);case 2:var o=r[t],i=r[t+1|0],a=o;return{k:i[0],v:i[1],h:2,l:u(a[0],a[1]),r:void 0};case 3:var f=r[t],c=r[t+1|0],d=r[t+2|0],v=c,l=f;return{k:v[0],v:v[1],h:2,l:u(l[0],l[1]),r:u(d[0],d[1])};default:var m=e/2|0,p=R(r,t,m),h=r[t+m|0],E=R(r,1+(t+m|0)|0,(e-m|0)-1|0);return s(p,h[0],h[1],E)}}function F(r,t,e,n){var o=D(r),i=D(t);if(o!==i)return o<i?-1:1;for(var a=h(r,0),s=h(t,0);;){var u=s,f=a;if(!f)return 0;if(!u)return 0;var c=u.hd,d=f.hd,v=e(d.k,c.k);if(0!==v)return v;var l=n(d.v,c.v);if(0!==l)return l;s=h(c.r,u.tl),a=h(d.r,f.tl)}}function V(r,t,e,n){if(D(r)!==D(t))return!1;for(var o=h(r,0),i=h(t,0);;){var a=i,s=o;if(!s)return!0;if(!a)return!0;var u=a.hd,f=s.hd;if(0!==e(f.k,u.k)||!n(f.v,u.v))return!1;i=h(u.r,a.tl),o=h(f.r,s.tl)}}function B(r){var t=r.l;r.l=t.r,t.r=r;var e=a(r.l),n=a(r.r);r.h=(e>n?e:n)+1|0;var o=a(t.l),i=r.h;return t.h=(o>i?o:i)+1|0,t}function L(r){var t=r.r;r.r=t.l,t.l=r;var e=a(r.l),n=a(r.r);r.h=(e>n?e:n)+1|0;var o=a(t.r),i=r.h;return t.h=(o>i?o:i)+1|0,t}function W(r){var t=a(r.l),e=a(r.r);return r.h=(t>e?t:e)+1|0,r}function X(r){var t,e,n=r.l,o=r.r,i=a(n),s=a(o);if(i>(2+s|0))return f(n.l,n.r)?W(B(r)):W((e=L((t=r).l),t.l=e,B(t)));if(s>(2+i|0)){var u=o.l;return f(o.r,u)?W(L(r)):W(function(r){var t=B(r.r);return r.r=t,L(r)}(r))}return r.h=(i>s?i:s)+1|0,r}function H(r,t,e,n){if(void 0===r)return u(t,e);var o=n(t,r.k);if(0===o)return r.v=e,r;var i=r.l,a=r.r;if(o<0){var s=H(i,t,e,n);r.l=s}else r.r=H(a,t,e,n);return X(r)}t.copy=function r(t){return void 0!==t?{k:t.k,v:t.v,h:t.h,l:r(t.l),r:r(t.r)}:t},t.create=s,t.bal=c,t.singleton=u,t.updateValue=function(r,t){return r.v===t?r:{k:r.k,v:t,h:r.h,l:r.l,r:r.r}},t.minKey=function(r){if(void 0!==r)return o.some(d(r))},t.minKeyUndefined=function(r){if(void 0!==r)return d(r)},t.maxKey=function(r){if(void 0!==r)return o.some(v(r))},t.maxKeyUndefined=function(r){if(void 0!==r)return v(r)},t.minimum=function(r){if(void 0!==r)return l(r)},t.minUndefined=function(r){if(void 0!==r)return l(r)},t.maximum=function(r){if(void 0!==r)return m(r)},t.maxUndefined=function(r){if(void 0!==r)return m(r)},t.removeMinAuxWithRef=p,t.isEmpty=function(r){return void 0===r},t.stackAllLeft=h,t.findFirstByU=E,t.findFirstBy=function(r,t){return E(r,n.__2(t))},t.forEachU=x,t.forEach=function(r,t){x(r,n.__2(t))},t.mapU=g,t.map=function(r,t){return g(r,n.__1(t))},t.mapWithKeyU=y,t.mapWithKey=function(r,t){return y(r,n.__2(t))},t.reduceU=_,t.reduce=function(r,t,e){return _(r,t,n.__3(e))},t.everyU=T,t.every=function(r,t){return T(r,n.__2(t))},t.someU=b,t.some=function(r,t){return b(r,n.__2(t))},t.join=S,t.concat=w,t.concatOrJoin=function(r,t,e,n){return void 0!==e?S(r,t,o.valFromOption(e),n):w(r,n)},t.keepSharedU=C,t.keepShared=function(r,t){return C(r,n.__2(t))},t.keepMapU=I,t.keepMap=function(r,t){return I(r,n.__2(t))},t.partitionSharedU=M,t.partitionShared=function(r,t){return M(r,n.__2(t))},t.lengthNode=j,t.size=D,t.toList=function(r){return G(r,0)},t.checkInvariantInternal=function r(t){for(;;){var e=t;if(void 0===e)return;var n=e.l,o=e.r,i=a(n)-a(o)|0;if(!(i<=2&&i>=-2))throw{RE_EXN_ID:"Assert_failure",_1:["belt_internalAVLtree.res",457,4],Error:new Error};r(n),t=o}},t.fillArray=O,t.toArray=function(r){if(void 0===r)return[];var t=j(r),e=new Array(t);return O(r,0,e),e},t.keysToArray=function(r){if(void 0===r)return[];var t=j(r),e=new Array(t);return N(r,0,e),e},t.valuesToArray=function(r){if(void 0===r)return[];var t=j(r),e=new Array(t);return U(r,0,e),e},t.fromSortedArrayAux=R,t.fromSortedArrayRevAux=P,t.fromSortedArrayUnsafe=function(r){return R(r,0,r.length)},t.cmpU=F,t.cmp=function(r,t,e,o){return F(r,t,e,n.__2(o))},t.eqU=V,t.eq=function(r,t,e,o){return V(r,t,e,n.__2(o))},t.get=function(r,t,e){for(;;){var n=r;if(void 0===n)return;var i=e(t,n.k);if(0===i)return o.some(n.v);r=i<0?n.l:n.r}},t.getUndefined=function(r,t,e){for(;;){var n=r;if(void 0===n)return;var o=e(t,n.k);if(0===o)return n.v;r=o<0?n.l:n.r}},t.getWithDefault=function(r,t,e,n){for(;;){var o=r;if(void 0===o)return e;var i=n(t,o.k);if(0===i)return o.v;r=i<0?o.l:o.r}},t.getExn=function(r,t,e){for(;;){var n=r;if(void 0===n)throw{RE_EXN_ID:"Not_found",Error:new Error};var o=e(t,n.k);if(0===o)return n.v;r=o<0?n.l:n.r}},t.has=function(r,t,e){for(;;){var n=r;if(void 0===n)return!1;var o=e(t,n.k);if(0===o)return!0;r=o<0?n.l:n.r}},t.fromArray=function(r,t){var e=r.length;if(0!==e){var n,o=i.strictlySortedLengthU(r,(function(r,e){return t(r[0],e[0])<0}));n=o>=0?R(r,0,o):P(r,(o=0|-o)-1|0,o);for(var a=o;a<e;++a){var s=r[a];n=H(n,s[0],s[1],t)}return n}},t.updateMutate=H,t.balMutate=X,t.removeMinAuxWithRootMutate=function r(t,e){var n=e.r,o=e.l;return void 0!==o?(e.l=r(t,o),X(e)):(t.k=e.k,t.v=e.v,n)}},5252:(r,t,e)=>{var n=e(1386),o=e(2971),i=e(7175);function a(r){if(void 0===r)return r;var t={key:r.key,value:r.value,next:void 0};return function(r,t){for(;;){var e=t,n=r;if(void 0===n)return;var o={key:n.key,value:n.value,next:void 0};e.next=o,t=o,r=n.next}}(r.next,t),t}function s(r){for(var t=r.length,e=new Array(t),n=0;n<t;++n)e[n]=a(r[n]);return e}function u(r,t){for(;;){var e=r;if(void 0===t)return e;t=t.next,r=e+1|0}}function f(r,t){for(;;){var e=t;if(void 0===e)return;r(e.key,e.value),t=e.next}}function c(r,t){for(var e=r.buckets,n=0,o=e.length;n<o;++n)f(t,e[n])}function d(r,t,e){for(;;){var n=t;if(void 0===n)return e;e=r(e,n.key,n.value),t=n.next}}function v(r,t,e){for(var n=r.buckets,o=t,i=0,a=n.length;i<a;++i)o=d(e,n[i],o);return o}function l(r){var t=function(r){return o.reduceU(r.buckets,0,(function(r,t){var e=u(0,t);return r>e?r:e}))}(r),e=o.makeByU(t+1|0,(function(r){return 0}));return o.forEachU(r.buckets,(function(r){var t=u(0,r);e[t]=e[t]+1|0})),e}function m(r,t,e,n,o){for(;;){var a=o,s=n,u=a.next,f=r(a.key,a.value);if(void 0===f){if(t.size=t.size-1|0,void 0===u)return void(void 0!==s?s.next=u:t.buckets[e]=s);o=u}else{if(void 0!==s?a.next=a:t.buckets[e]=a,a.value=i.valFromOption(f),void 0===u)return void(a.next=u);o=u,n=a}}}function p(r,t){for(var e=r.buckets,n=0,o=e.length;n<o;++n){var i=e[n];void 0!==i&&m(t,r,n,void 0,i)}}function h(r,t,e,n){for(;;){var o=e,i=r;t[i]=n(o);var a=o.next;if(void 0===a)return i+1|0;e=a,r=i+1|0}}function E(r,t){for(var e=r.buckets,n=0,o=new Array(r.size),i=0,a=e.length;i<a;++i){var s=e[i];void 0!==s&&(n=h(n,o,s,t))}return o}t.C=void 0,t.copy=function(r){return{size:r.size,buckets:s(r.buckets),hash:r.hash,eq:r.eq}},t.forEachU=c,t.forEach=function(r,t){c(r,n.__2(t))},t.reduceU=v,t.reduce=function(r,t,e){return v(r,t,n.__3(e))},t.logStats=function(r){var t=l(r);console.log({bindings:r.size,buckets:r.buckets.length,histogram:t})},t.keepMapInPlaceU=p,t.keepMapInPlace=function(r,t){p(r,n.__2(t))},t.fillArray=function(r,t,e){for(;;){var n=e,o=r;t[o]=[n.key,n.value];var i=n.next;if(void 0===i)return o+1|0;e=i,r=o+1|0}},t.keysToArray=function(r){return E(r,(function(r){return r.key}))},t.valuesToArray=function(r){return E(r,(function(r){return r.value}))},t.toArray=function(r){return E(r,(function(r){return[r.key,r.value]}))},t.getBucketHistogram=l},354:(r,t)=>{t.emptyOpt=void 0,t.make=function(r,t,e){var n=function(r,t){for(;;){if(r>=t)return r;if(r<<1<r)return r;r<<=1}}(16,e);return{size:0,buckets:new Array(n),hash:r,eq:t}},t.clear=function(r){r.size=0;for(var t=r.buckets,e=t.length,n=0;n<e;++n)t[n]=void 0},t.isEmpty=function(r){return 0===r.size}},3163:(r,t,e)=>{var n=e(6253),o=e(1386),i=e(7175),a=e(2531),s=e(6144);function u(r,t){var e=t.k,n=t.v,o=t.l,a=t.r;if(r===e)return[o,i.some(n),a];if(r<e){if(void 0===o)return[void 0,void 0,t];var f=u(r,o);return[f[0],f[1],s.join(f[2],e,n,a)]}if(void 0===a)return[t,void 0,void 0];var c=u(r,a);return[s.join(o,e,n,c[0]),c[1],c[2]]}function f(r,t){return void 0!==t?u(r,t):[void 0,void 0,void 0]}function c(r,t,e){if(void 0!==r){if(r.h>=(void 0!==t?t.h:0)){var n=r.k,o=r.v,a=r.l,u=r.r,d=f(n,t);return s.concatOrJoin(c(a,d[0],e),n,e(n,i.some(o),d[1]),c(u,d[2],e))}}else if(void 0===t)return;var v=t.k,l=t.v,m=t.l,p=t.r,h=f(v,r);return s.concatOrJoin(c(h[0],m,e),v,e(v,h[1],i.some(l)),c(h[2],p,e))}function d(r,t,e){for(;;){var o=t,i=r;if(!i)return 0;if(!o)return 0;var a=o.hd,u=i.hd,f=n.int_compare(u.k,a.k);if(0!==f)return f;var c=e(u.v,a.v);if(0!==c)return c;t=s.stackAllLeft(a.r,o.tl),r=s.stackAllLeft(u.r,i.tl)}}function v(r,t,e){var n=s.size(r),o=s.size(t);return n===o?d(s.stackAllLeft(r,0),s.stackAllLeft(t,0),e):n<o?-1:1}function l(r,t,e){for(;;){var n=t,o=r;if(!o)return!0;if(!n)return!0;var i=n.hd,a=o.hd;if(a.k!==i.k||!e(a.v,i.v))return!1;t=s.stackAllLeft(i.r,n.tl),r=s.stackAllLeft(a.r,o.tl)}}function m(r,t,e){return s.size(r)===s.size(t)&&l(s.stackAllLeft(r,0),s.stackAllLeft(t,0),e)}function p(r,t,e){if(void 0===r)return s.singleton(t,e);var n=r.k;if(t===n)return r.k=t,r.v=e,r;var o=r.l,i=r.r;if(t<n){var a=p(o,t,e);r.l=a}else r.r=p(i,t,e);return s.balMutate(r)}t.N=void 0,t.A=void 0,t.S=void 0,t.add=function r(t,e,n){if(void 0===t)return s.singleton(e,n);var o=t.k;if(e===o)return s.updateValue(t,n);var i=t.v;return e<o?s.bal(r(t.l,e,n),o,i,t.r):s.bal(t.l,o,i,r(t.r,e,n))},t.get=function(r,t){for(;;){var e=r;if(void 0===e)return;var n=e.k;if(t===n)return i.some(e.v);r=t<n?e.l:e.r}},t.getUndefined=function(r,t){for(;;){var e=r;if(void 0===e)return;var n=e.k;if(t===n)return e.v;r=t<n?e.l:e.r}},t.getExn=function(r,t){for(;;){var e=r;if(void 0===e)throw{RE_EXN_ID:"Not_found",Error:new Error};var n=e.k;if(t===n)return e.v;r=t<n?e.l:e.r}},t.getWithDefault=function(r,t,e){for(;;){var n=r;if(void 0===n)return e;var o=n.k;if(t===o)return n.v;r=t<o?n.l:n.r}},t.has=function(r,t){for(;;){var e=r;if(void 0===e)return!1;var n=e.k;if(t===n)return!0;r=t<n?e.l:e.r}},t.remove=function r(t,e){if(void 0===t)return t;var n=t.k,o=t.l,i=t.r;if(e!==n)return e<n?s.bal(r(o,e),n,t.v,i):s.bal(o,n,t.v,r(i,e));if(void 0===o)return i;if(void 0===i)return o;var a={contents:i.k},u={contents:i.v},f=s.removeMinAuxWithRef(i,a,u);return s.bal(o,a.contents,u.contents,f)},t.splitAux=u,t.split=f,t.mergeU=c,t.merge=function(r,t,e){return c(r,t,o.__3(e))},t.compareAux=d,t.cmpU=v,t.cmp=function(r,t,e){return v(r,t,o.__2(e))},t.eqAux=l,t.eqU=m,t.eq=function(r,t,e){return m(r,t,o.__2(e))},t.addMutate=p,t.fromArray=function(r){var t=r.length;if(0!==t){var e,n=a.strictlySortedLengthU(r,(function(r,t){return r[0]<t[0]}));n>=0?e=s.fromSortedArrayAux(r,0,n):(n=0|-n,e=s.fromSortedArrayRevAux(r,n-1|0,n));for(var o=n;o<t;++o){var i=r[o];e=p(e,i[0],i[1])}return e}}},2459:(r,t,e)=>{var n=e(6253),o=e(1386),i=e(7175),a=e(2531),s=e(6144);function u(r,t){var e=t.k,n=t.v,o=t.l,a=t.r;if(r===e)return[o,i.some(n),a];if(r<e){if(void 0===o)return[void 0,void 0,t];var f=u(r,o);return[f[0],f[1],s.join(f[2],e,n,a)]}if(void 0===a)return[t,void 0,void 0];var c=u(r,a);return[s.join(o,e,n,c[0]),c[1],c[2]]}function f(r,t){return void 0!==t?u(r,t):[void 0,void 0,void 0]}function c(r,t,e){if(void 0!==r){if(r.h>=(void 0!==t?t.h:0)){var n=r.k,o=r.v,a=r.l,u=r.r,d=f(n,t);return s.concatOrJoin(c(a,d[0],e),n,e(n,i.some(o),d[1]),c(u,d[2],e))}}else if(void 0===t)return;var v=t.k,l=t.v,m=t.l,p=t.r,h=f(v,r);return s.concatOrJoin(c(h[0],m,e),v,e(v,h[1],i.some(l)),c(h[2],p,e))}function d(r,t,e){for(;;){var o=t,i=r;if(!i)return 0;if(!o)return 0;var a=o.hd,u=i.hd,f=n.string_compare(u.k,a.k);if(0!==f)return f;var c=e(u.v,a.v);if(0!==c)return c;t=s.stackAllLeft(a.r,o.tl),r=s.stackAllLeft(u.r,i.tl)}}function v(r,t,e){var n=s.size(r),o=s.size(t);return n===o?d(s.stackAllLeft(r,0),s.stackAllLeft(t,0),e):n<o?-1:1}function l(r,t,e){for(;;){var n=t,o=r;if(!o)return!0;if(!n)return!0;var i=n.hd,a=o.hd;if(a.k!==i.k||!e(a.v,i.v))return!1;t=s.stackAllLeft(i.r,n.tl),r=s.stackAllLeft(a.r,o.tl)}}function m(r,t,e){return s.size(r)===s.size(t)&&l(s.stackAllLeft(r,0),s.stackAllLeft(t,0),e)}function p(r,t,e){if(void 0===r)return s.singleton(t,e);var n=r.k;if(t===n)return r.k=t,r.v=e,r;var o=r.l,i=r.r;if(t<n){var a=p(o,t,e);r.l=a}else r.r=p(i,t,e);return s.balMutate(r)}t.N=void 0,t.A=void 0,t.S=void 0,t.add=function r(t,e,n){if(void 0===t)return s.singleton(e,n);var o=t.k;if(e===o)return s.updateValue(t,n);var i=t.v;return e<o?s.bal(r(t.l,e,n),o,i,t.r):s.bal(t.l,o,i,r(t.r,e,n))},t.get=function(r,t){for(;;){var e=r;if(void 0===e)return;var n=e.k;if(t===n)return i.some(e.v);r=t<n?e.l:e.r}},t.getUndefined=function(r,t){for(;;){var e=r;if(void 0===e)return;var n=e.k;if(t===n)return e.v;r=t<n?e.l:e.r}},t.getExn=function(r,t){for(;;){var e=r;if(void 0===e)throw{RE_EXN_ID:"Not_found",Error:new Error};var n=e.k;if(t===n)return e.v;r=t<n?e.l:e.r}},t.getWithDefault=function(r,t,e){for(;;){var n=r;if(void 0===n)return e;var o=n.k;if(t===o)return n.v;r=t<o?n.l:n.r}},t.has=function(r,t){for(;;){var e=r;if(void 0===e)return!1;var n=e.k;if(t===n)return!0;r=t<n?e.l:e.r}},t.remove=function r(t,e){if(void 0===t)return t;var n=t.k,o=t.l,i=t.r;if(e!==n)return e<n?s.bal(r(o,e),n,t.v,i):s.bal(o,n,t.v,r(i,e));if(void 0===o)return i;if(void 0===i)return o;var a={contents:i.k},u={contents:i.v},f=s.removeMinAuxWithRef(i,a,u);return s.bal(o,a.contents,u.contents,f)},t.splitAux=u,t.split=f,t.mergeU=c,t.merge=function(r,t,e){return c(r,t,o.__3(e))},t.compareAux=d,t.cmpU=v,t.cmp=function(r,t,e){return v(r,t,o.__2(e))},t.eqAux=l,t.eqU=m,t.eq=function(r,t,e){return m(r,t,o.__2(e))},t.addMutate=p,t.fromArray=function(r){var t=r.length;if(0!==t){var e,n=a.strictlySortedLengthU(r,(function(r,t){return r[0]<t[0]}));n>=0?e=s.fromSortedArrayAux(r,0,n):(n=0|-n,e=s.fromSortedArrayRevAux(r,n-1|0,n));for(var o=n;o<t;++o){var i=r[o];e=p(e,i[0],i[1])}return e}}},9167:(r,t,e)=>{var n=e(1386),o=e(2971);function i(r){if(void 0===r)return r;var t={key:r.key,next:void 0};return function(r,t){for(;;){var e=t,n=r;if(void 0===n)return;var o={key:n.key,next:void 0};e.next=o,t=o,r=n.next}}(r.next,t),t}function a(r){for(var t=r.length,e=new Array(t),n=0;n<t;++n)e[n]=i(r[n]);return e}function s(r,t){for(;;){var e=r;if(void 0===t)return e;t=t.next,r=e+1|0}}function u(r,t){for(;;){var e=t;if(void 0===e)return;r(e.key),t=e.next}}function f(r,t){for(var e=r.buckets,n=0,o=e.length;n<o;++n)u(t,e[n])}function c(r,t,e){for(;;){var n=e,o=r;t[o]=n.key;var i=n.next;if(void 0===i)return o+1|0;e=i,r=o+1|0}}function d(r,t,e){for(;;){var n=t;if(void 0===n)return e;e=r(e,n.key),t=n.next}}function v(r,t,e){for(var n=r.buckets,o=t,i=0,a=n.length;i<a;++i)o=d(e,n[i],o);return o}function l(r){var t=function(r){return o.reduceU(r.buckets,0,(function(r,t){var e=s(0,t);return r>e?r:e}))}(r),e=o.makeByU(t+1|0,(function(r){return 0}));return o.forEachU(r.buckets,(function(r){var t=s(0,r);e[t]=e[t]+1|0})),e}t.C=void 0,t.copy=function(r){return{size:r.size,buckets:a(r.buckets),hash:r.hash,eq:r.eq}},t.forEachU=f,t.forEach=function(r,t){f(r,n.__1(t))},t.fillArray=c,t.toArray=function(r){for(var t=r.buckets,e=0,n=new Array(r.size),o=0,i=t.length;o<i;++o){var a=t[o];void 0!==a&&(e=c(e,n,a))}return n},t.reduceU=v,t.reduce=function(r,t,e){return v(r,t,n.__2(e))},t.logStats=function(r){var t=l(r);console.log({bindings:r.size,buckets:r.buckets.length,histogram:t})},t.getBucketHistogram=l},9113:(r,t,e)=>{var n=e(3282),o=e(4881);function i(r,t){for(;;){var e=t,n=r;if(!n)return 0;if(!e)return 0;var i=e.hd,a=n.hd,s=a.v,u=i.v;if(s!==u)return s<u?-1:1;t=o.stackAllLeft(i.r,e.tl),r=o.stackAllLeft(a.r,n.tl)}}function a(r,t){var e=o.size(r),n=o.size(t);return e===n?i(o.stackAllLeft(r,0),o.stackAllLeft(t,0)):e<n?-1:1}function s(r,t){if(void 0===r)return o.singleton(t);var e=r.v;if(t===e)return r;var n=r.l,i=r.r;return t<e?r.l=s(n,t):r.r=s(i,t),o.balMutate(r)}t.S=void 0,t.N=void 0,t.A=void 0,t.has=function(r,t){for(;;){var e=r;if(void 0===e)return!1;var n=e.v;if(t===n)return!0;r=t<n?e.l:e.r}},t.compareAux=i,t.cmp=a,t.eq=function(r,t){return 0===a(r,t)},t.subset=function r(t,e){for(;;){var n=e,i=t;if(void 0===i)return!0;if(void 0===n)return!1;var a=i.v,s=i.l,u=i.r,f=n.v,c=n.l,d=n.r;if(a!==f)if(a<f){if(!r(o.create(s,a,void 0),c))return!1;t=u}else{if(!r(o.create(void 0,a,u),d))return!1;t=s}else{if(!r(s,c))return!1;e=d,t=u}}},t.get=function(r,t){for(;;){var e=r;if(void 0===e)return;var n=e.v;if(t===n)return n;r=t<n?e.l:e.r}},t.getUndefined=function(r,t){for(;;){var e=r;if(void 0===e)return;var n=e.v;if(t===n)return n;r=t<n?e.l:e.r}},t.getExn=function(r,t){for(;;){var e=r;if(void 0===e)throw{RE_EXN_ID:"Not_found",Error:new Error};var n=e.v;if(t===n)return n;r=t<n?e.l:e.r}},t.addMutate=s,t.fromArray=function(r){var t=r.length;if(0!==t){var e,i=n.strictlySortedLength(r);i>=0?e=o.fromSortedArrayAux(r,0,i):(i=0|-i,e=o.fromSortedArrayRevAux(r,i-1|0,i));for(var a=i;a<t;++a)e=s(e,r[a]);return e}}},1572:(r,t,e)=>{var n=e(4881),o=e(8466);function i(r,t){for(;;){var e=t,o=r;if(!o)return 0;if(!e)return 0;var i=e.hd,a=o.hd,s=a.v,u=i.v;if(s!==u)return s<u?-1:1;t=n.stackAllLeft(i.r,e.tl),r=n.stackAllLeft(a.r,o.tl)}}function a(r,t){var e=n.size(r),o=n.size(t);return e===o?i(n.stackAllLeft(r,0),n.stackAllLeft(t,0)):e<o?-1:1}function s(r,t){if(void 0===r)return n.singleton(t);var e=r.v;if(t===e)return r;var o=r.l,i=r.r;return t<e?r.l=s(o,t):r.r=s(i,t),n.balMutate(r)}t.S=void 0,t.N=void 0,t.A=void 0,t.has=function(r,t){for(;;){var e=r;if(void 0===e)return!1;var n=e.v;if(t===n)return!0;r=t<n?e.l:e.r}},t.compareAux=i,t.cmp=a,t.eq=function(r,t){return 0===a(r,t)},t.subset=function r(t,e){for(;;){var o=e,i=t;if(void 0===i)return!0;if(void 0===o)return!1;var a=i.v,s=i.l,u=i.r,f=o.v,c=o.l,d=o.r;if(a!==f)if(a<f){if(!r(n.create(s,a,void 0),c))return!1;t=u}else{if(!r(n.create(void 0,a,u),d))return!1;t=s}else{if(!r(s,c))return!1;e=d,t=u}}},t.get=function(r,t){for(;;){var e=r;if(void 0===e)return;var n=e.v;if(t===n)return n;r=t<n?e.l:e.r}},t.getUndefined=function(r,t){for(;;){var e=r;if(void 0===e)return;var n=e.v;if(t===n)return n;r=t<n?e.l:e.r}},t.getExn=function(r,t){for(;;){var e=r;if(void 0===e)throw{RE_EXN_ID:"Not_found",Error:new Error};var n=e.v;if(t===n)return n;r=t<n?e.l:e.r}},t.addMutate=s,t.fromArray=function(r){var t=r.length;if(0!==t){var e,i=o.strictlySortedLength(r);i>=0?e=n.fromSortedArrayAux(r,0,i):(i=0|-i,e=n.fromSortedArrayRevAux(r,i-1|0,i));for(var a=i;a<t;++a)e=s(e,r[a]);return e}}},6253:(r,t)=>{function e(r,t){return r[1]===t[1]&&r[0]===t[0]}function n(r,t){var e=t[0],n=r[0];return n>e||!(n<e)&&r[1]>=t[1]}function o(r,t){return r[0]>t[0]||!(r[0]<t[0])&&r[1]>t[1]}t.int_compare=function(r,t){return r<t?-1:r===t?0:1},t.bool_compare=function(r,t){return r?t?0:1:t?-1:0},t.float_compare=function(r,t){return r===t?0:r<t?-1:r>t||r==r?1:t==t?-1:0},t.bigint_compare=function(r,t){return r<t?-1:r===t?0:1},t.string_compare=function(r,t){return r===t?0:r<t?-1:1},t.bool_min=function(r,t){return r?t:r},t.int_min=function(r,t){return r<t?r:t},t.float_min=function(r,t){return r<t?r:t},t.string_min=function(r,t){return r<t?r:t},t.bool_max=function(r,t){return r||t},t.int_max=function(r,t){return r>t?r:t},t.float_max=function(r,t){return r>t?r:t},t.string_max=function(r,t){return r>t?r:t},t.i64_eq=e,t.i64_neq=function(r,t){return!e(r,t)},t.i64_lt=function(r,t){return!n(r,t)},t.i64_gt=o,t.i64_le=function(r,t){return!o(r,t)},t.i64_ge=n,t.i64_min=function(r,t){return n(r,t)?t:r},t.i64_max=function(r,t){return o(r,t)?r:t}},1748:(r,t)=>{t.dup=function(r){return r.slice(0)},t.sub=function(r,t,e){for(var n=new Array(e),o=0,i=t;o<e;)n[o]=r[i],o=o+1|0,i=i+1|0;return n},t.concat=function(r){var t=function(r,t){for(;;){var e=t,n=r;if(!e)return n;t=e.tl,r=e.hd.length+n|0}}(0,r),e=new Array(t);return function(r,t,e){for(;;){var n=e,o=t;if(!n)return;for(var i=n.hd,a=i.length,s=o,u=0;u<a;)r[s]=i[u],s=s+1|0,u=u+1|0;e=n.tl,t=s}}(e,0,r),e},t.make=function(r,t){for(var e=new Array(r),n=0;n<r;++n)e[n]=t;return e},t.make_float=function(r){for(var t=new Array(r),e=0;e<r;++e)t[e]=0;return t},t.blit=function(r,t,e,n,o){if(n<=t)for(var i=0;i<o;++i)e[i+n|0]=r[i+t|0];else for(var a=o-1|0;a>=0;--a)e[a+n|0]=r[a+t|0]},t.get=function(r,t){if(t<0||t>=r.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};return r[t]},t.set=function(r,t,e){if(t<0||t>=r.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};r[t]=e}},6181:(r,t)=>{var e=new Map;t.create=function(r){var t,n=e.get(r);if(void 0!==n){var o=n+1|0;e.set(r,o),t=o}else e.set(r,1),t=1;return r+"/"+t},t.is_extension=function(r){return null!=r&&"string"==typeof r.RE_EXN_ID},t.exn_slot_name=function(r){return r.RE_EXN_ID}},1863:(r,t)=>{function e(r,t){return r<<t|r>>>(32-t|0)|0}function n(r,t){var n=t;n=e(n=Math.imul(n,-862048943),15);var o=r^(n=Math.imul(n,461845907));return((o=e(o,13))+(o<<2)|0)-430675100|0}t.hash_mix_int=n,t.hash_mix_string=function(r,t){for(var e=t.length,o=(e/4|0)-1|0,i=r,a=0;a<=o;++a){var s=a<<2;i=n(i,t.charCodeAt(s)|t.charCodeAt(s+1|0)<<8|t.charCodeAt(s+2|0)<<16|t.charCodeAt(s+3|0)<<24)}var u=3&e;return 0!==u&&(i=n(i,3===u?t.charCodeAt(e-1|0)<<16|t.charCodeAt(e-2|0)<<8|t.charCodeAt(e-3|0):2===u?t.charCodeAt(e-1|0)<<8|t.charCodeAt(e-2|0):t.charCodeAt(e-1|0))),i^e},t.hash_final_mix=function(r){var t=r^r>>>16;return t=Math.imul(t,-2048144789),t^=t>>>13,(t=Math.imul(t,-1028477387))^t>>>16}},8723:(r,t)=>{t.div=function(r,t){if(0===t)throw{RE_EXN_ID:"Division_by_zero",Error:new Error};return r/t|0},t.mod_=function(r,t){if(0===t)throw{RE_EXN_ID:"Division_by_zero",Error:new Error};return r%t}},4518:(r,t,e)=>{var n=e(7175),o=e(6181),i="JsError";t.$$Error=i,t.internalToOCamlException=function(r){return o.is_extension(r)?r:{RE_EXN_ID:"JsError",_1:r}},t.as_js_exn=function(r){if(r.RE_EXN_ID===i)return n.some(r._1)}},4923:(r,t,e)=>{var n=e(6253),o=function(r,t){for(var e in r)t(e)};function i(r,t){if(r===t)return 0;var e=typeof r,o=typeof t;switch(e){case"bigint":if("bigint"===o)return n.float_compare(r,t);break;case"boolean":if("boolean"===o)return n.bool_compare(r,t);break;case"function":if("function"===o)throw{RE_EXN_ID:"Invalid_argument",_1:"compare: functional value",Error:new Error};break;case"number":if("number"===o)return n.float_compare(r,t);break;case"string":return"string"===o?n.string_compare(r,t):1;case"undefined":return-1}switch(o){case"string":return-1;case"undefined":return 1;default:if("boolean"===e)return 1;if("boolean"===o)return-1;if("function"===e)return 1;if("function"===o)return-1;if("number"===e)return null===t||void 0!==t.BS_PRIVATE_NESTED_SOME_NONE?1:-1;if("number"===o)return null===r||void 0!==r.BS_PRIVATE_NESTED_SOME_NONE?-1:1;if(null===r)return void 0!==t.BS_PRIVATE_NESTED_SOME_NONE?1:-1;if(null===t)return void 0!==r.BS_PRIVATE_NESTED_SOME_NONE?-1:1;if(void 0!==r.BS_PRIVATE_NESTED_SOME_NONE)return void 0!==t.BS_PRIVATE_NESTED_SOME_NONE?a(r,t):-1;var s=r.TAG,u=t.TAG;if(248===s)return n.int_compare(r[1],t[1]);if(251===s)throw{RE_EXN_ID:"Invalid_argument",_1:"equal: abstract value",Error:new Error};if(s!==u)return s<u?-1:1;var f=0|r.length,c=0|t.length;if(f===c){if(!Array.isArray(r))return r instanceof Date&&t instanceof Date?r-t:a(r,t);for(var d=0;;){var v=d;if(v===f)return 0;var l=i(r[v],t[v]);if(0!==l)return l;d=v+1|0}}else if(f<c)for(var m=0;;){var p=m;if(p===f)return-1;var h=i(r[p],t[p]);if(0!==h)return h;m=p+1|0}else for(var E=0;;){var x=E;if(x===c)return 1;var g=i(r[x],t[x]);if(0!==g)return g;E=x+1|0}}}function a(r,t){var e={contents:void 0},a={contents:void 0},s=function(r,t){var e=r[2],n=r[1];if(!Object.prototype.hasOwnProperty.call(n,t)||i(r[0][t],n[t])>0){var o=e.contents;return void 0!==o&&t>=o?void 0:void(e.contents=t)}},u=[r,t,a],f=[t,r,e];o(r,(function(r){return s(u,r)})),o(t,(function(r){return s(f,r)}));var c=e.contents,d=a.contents;return void 0!==c?void 0!==d?n.string_compare(c,d):-1:void 0!==d?1:0}function s(r,t){if(r===t)return!0;var e=typeof r;if("string"===e||"number"===e||"bigint"===e||"boolean"===e||"undefined"===e||null===r)return!1;var n=typeof t;if("function"===e||"function"===n)throw{RE_EXN_ID:"Invalid_argument",_1:"equal: functional value",Error:new Error};if("number"===n||"bigint"===n||"undefined"===n||null===t)return!1;var i=r.TAG,a=t.TAG;if(248===i)return r[1]===t[1];if(251===i)throw{RE_EXN_ID:"Invalid_argument",_1:"equal: abstract value",Error:new Error};if(i!==a)return!1;var u=0|r.length;if(u!==(0|t.length))return!1;if(!Array.isArray(r)){if(r instanceof Date&&t instanceof Date)return!(r>t||r<t);var f={contents:!0};return o(r,(function(r){Object.prototype.hasOwnProperty.call(t,r)||(f.contents=!1)})),f.contents&&o(t,(function(e){Object.prototype.hasOwnProperty.call(r,e)&&s(t[e],r[e])||(f.contents=!1)})),f.contents}for(var c=0;;){var d=c;if(d===u)return!0;if(!s(r[d],t[d]))return!1;c=d+1|0}}t.obj_dup=function(r){if(Array.isArray(r)){for(var t=r.length,e=new Array(t),n=0;n<t;++n)e[n]=r[n];return void 0!==r.TAG&&(e.TAG=r.TAG),e}return Object.assign({},r)},t.update_dummy=function(r,t){if(Array.isArray(t)){for(e=0;e<t.length;++e)r[e]=t[e];void 0!==t.TAG&&(r.TAG=t.TAG)}else for(var e in t)r[e]=t[e]},t.compare=i,t.equal=s,t.equal_null=function(r,t){return null!==t?s(r,t):r===t},t.equal_undefined=function(r,t){return void 0!==t?s(r,t):r===t},t.equal_nullable=function(r,t){return null==t?r===t:s(r,t)},t.notequal=function(r,t){return"number"!=typeof r&&"bigint"!=typeof r||"number"!=typeof t&&"bigint"!=typeof t?!s(r,t):r!==t},t.greaterequal=function(r,t){return"number"!=typeof r&&"bigint"!=typeof r||"number"!=typeof t&&"bigint"!=typeof t?i(r,t)>=0:r>=t},t.greaterthan=function(r,t){return"number"!=typeof r&&"bigint"!=typeof r||"number"!=typeof t&&"bigint"!=typeof t?i(r,t)>0:r>t},t.lessthan=function(r,t){return"number"!=typeof r&&"bigint"!=typeof r||"number"!=typeof t&&"bigint"!=typeof t?i(r,t)<0:r<t},t.lessequal=function(r,t){return"number"!=typeof r&&"bigint"!=typeof r||"number"!=typeof t&&"bigint"!=typeof t?i(r,t)<=0:r<=t},t.min=function(r,t){return i(r,t)<=0?r:t},t.max=function(r,t){return i(r,t)>=0?r:t}},7175:(r,t)=>{function e(r){return void 0===r?{BS_PRIVATE_NESTED_SOME_NONE:0}:null!==r&&void 0!==r.BS_PRIVATE_NESTED_SOME_NONE?{BS_PRIVATE_NESTED_SOME_NONE:r.BS_PRIVATE_NESTED_SOME_NONE+1|0}:r}function n(r){if(null===r||void 0===r.BS_PRIVATE_NESTED_SOME_NONE)return r;var t=r.BS_PRIVATE_NESTED_SOME_NONE;return 0===t?void 0:{BS_PRIVATE_NESTED_SOME_NONE:t-1|0}}t.nullable_to_opt=function(r){return null==r?void 0:e(r)},t.undefined_to_opt=function(r){return void 0===r?void 0:e(r)},t.null_to_opt=function(r){return null===r?void 0:e(r)},t.valFromOption=n,t.some=e,t.isNested=function(r){return void 0!==r.BS_PRIVATE_NESTED_SOME_NONE},t.option_get=function(r){return void 0===r?void 0:n(r)},t.option_unwrap=function(r){return void 0!==r?r.VAL:r}},3533:(r,t)=>{t.spliceApply=function(r,t){var e,n;n=t.length;var o=[];for(e=0;e<n-1;++e)o.push(t[e]);var i=t[n-1];for(e=0;e<i.length;++e)o.push(i[e]);return r.apply(null,o)},t.spliceNewApply=function(r,t){var e,n;n=t.length;var o=[null];for(e=0;e<n-1;++e)o.push(t[e]);var i=t[n-1];for(e=0;e<i.length;++e)o.push(i[e]);return new(Function.prototype.bind.apply(r,o))},t.spliceObjApply=function(r,t,e){var n,o;o=e.length;var i=[];for(n=0;n<o-1;++n)i.push(e[n]);var a=e[o-1];for(n=0;n<a.length;++n)i.push(a[n]);return r[t].apply(r,i)}},1386:(r,t,e)=>{var n=e(1748);function o(r,t){for(;;){var e=t,i=r,a=i.length,s=0===a?1:a,u=s-e.length|0;if(0===u)return i.apply(null,e);if(u>=0)return function(r,t){return function(e){return o(r,t.concat([e]))}}(i,e);t=n.sub(e,s,0|-u),r=i.apply(null,n.sub(e,0,s))}}function i(r,t){var e=r.length;if(1===e)return r(t);switch(e){case 1:return r(t);case 2:return function(e){return r(t,e)};case 3:return function(e,n){return r(t,e,n)};case 4:return function(e,n,o){return r(t,e,n,o)};case 5:return function(e,n,o,i){return r(t,e,n,o,i)};case 6:return function(e,n,o,i,a){return r(t,e,n,o,i,a)};case 7:return function(e,n,o,i,a,s){return r(t,e,n,o,i,a,s)};default:return o(r,[t])}}function a(r,t,e){var n=r.length;if(2===n)return r(t,e);switch(n){case 1:return o(r(t),[e]);case 2:return r(t,e);case 3:return function(n){return r(t,e,n)};case 4:return function(n,o){return r(t,e,n,o)};case 5:return function(n,o,i){return r(t,e,n,o,i)};case 6:return function(n,o,i,a){return r(t,e,n,o,i,a)};case 7:return function(n,o,i,a,s){return r(t,e,n,o,i,a,s)};default:return o(r,[t,e])}}function s(r,t,e,n){var i=r.length;if(3===i)return r(t,e,n);switch(i){case 1:return o(r(t),[e,n]);case 2:return o(r(t,e),[n]);case 3:return r(t,e,n);case 4:return function(o){return r(t,e,n,o)};case 5:return function(o,i){return r(t,e,n,o,i)};case 6:return function(o,i,a){return r(t,e,n,o,i,a)};case 7:return function(o,i,a,s){return r(t,e,n,o,i,a,s)};default:return o(r,[t,e,n])}}function u(r,t,e,n,i){var a=r.length;if(4===a)return r(t,e,n,i);switch(a){case 1:return o(r(t),[e,n,i]);case 2:return o(r(t,e),[n,i]);case 3:return o(r(t,e,n),[i]);case 4:return r(t,e,n,i);case 5:return function(o){return r(t,e,n,i,o)};case 6:return function(o,a){return r(t,e,n,i,o,a)};case 7:return function(o,a,s){return r(t,e,n,i,o,a,s)};default:return o(r,[t,e,n,i])}}function f(r,t,e,n,i,a){var s=r.length;if(5===s)return r(t,e,n,i,a);switch(s){case 1:return o(r(t),[e,n,i,a]);case 2:return o(r(t,e),[n,i,a]);case 3:return o(r(t,e,n),[i,a]);case 4:return o(r(t,e,n,i),[a]);case 5:return r(t,e,n,i,a);case 6:return function(o){return r(t,e,n,i,a,o)};case 7:return function(o,s){return r(t,e,n,i,a,o,s)};default:return o(r,[t,e,n,i,a])}}function c(r,t,e,n,i,a,s){var u=r.length;if(6===u)return r(t,e,n,i,a,s);switch(u){case 1:return o(r(t),[e,n,i,a,s]);case 2:return o(r(t,e),[n,i,a,s]);case 3:return o(r(t,e,n),[i,a,s]);case 4:return o(r(t,e,n,i),[a,s]);case 5:return o(r(t,e,n,i,a),[s]);case 6:return r(t,e,n,i,a,s);case 7:return function(o){return r(t,e,n,i,a,s,o)};default:return o(r,[t,e,n,i,a,s])}}function d(r,t,e,n,i,a,s,u){var f=r.length;if(7===f)return r(t,e,n,i,a,s,u);switch(f){case 1:return o(r(t),[e,n,i,a,s,u]);case 2:return o(r(t,e),[n,i,a,s,u]);case 3:return o(r(t,e,n),[i,a,s,u]);case 4:return o(r(t,e,n,i),[a,s,u]);case 5:return o(r(t,e,n,i,a),[s,u]);case 6:return o(r(t,e,n,i,a,s),[u]);case 7:return r(t,e,n,i,a,s,u);default:return o(r,[t,e,n,i,a,s,u])}}function v(r,t,e,n,i,a,s,u,f){var c=r.length;if(8===c)return r(t,e,n,i,a,s,u,f);switch(c){case 1:return o(r(t),[e,n,i,a,s,u,f]);case 2:return o(r(t,e),[n,i,a,s,u,f]);case 3:return o(r(t,e,n),[i,a,s,u,f]);case 4:return o(r(t,e,n,i),[a,s,u,f]);case 5:return o(r(t,e,n,i,a),[s,u,f]);case 6:return o(r(t,e,n,i,a,s),[u,f]);case 7:return o(r(t,e,n,i,a,s,u),[f]);default:return o(r,[t,e,n,i,a,s,u,f])}}t.app=o,t._1=i,t.__1=function(r){return 1===r.length?r:function(t){return i(r,t)}},t._2=a,t.__2=function(r){return 2===r.length?r:function(t,e){return a(r,t,e)}},t._3=s,t.__3=function(r){return 3===r.length?r:function(t,e,n){return s(r,t,e,n)}},t._4=u,t.__4=function(r){return 4===r.length?r:function(t,e,n,o){return u(r,t,e,n,o)}},t._5=f,t.__5=function(r){return 5===r.length?r:function(t,e,n,o,i){return f(r,t,e,n,o,i)}},t._6=c,t.__6=function(r){return 6===r.length?r:function(t,e,n,o,i,a){return c(r,t,e,n,o,i,a)}},t._7=d,t.__7=function(r){return 7===r.length?r:function(t,e,n,o,i,a,s){return d(r,t,e,n,o,i,a,s)}},t._8=v,t.__8=function(r){return 8===r.length?r:function(t,e,n,o,i,a,s,u){return v(r,t,e,n,o,i,a,s,u)}}},2900:(r,t)=>{t.$$Error="JsError",t.raiseError=function(r){throw new Error(r)},t.raiseEvalError=function(r){throw new EvalError(r)},t.raiseRangeError=function(r){throw new RangeError(r)},t.raiseReferenceError=function(r){throw new ReferenceError(r)},t.raiseSyntaxError=function(r){throw new SyntaxError(r)},t.raiseTypeError=function(r){throw new TypeError(r)},t.raiseUriError=function(r){throw new URIError(r)}},1589:(r,t)=>{t.equal=function(r,t){return r===t},t.max=2147483647,t.min=-2147483648},4763:(r,t,e)=>{var n=e(1589);function o(r){return r>n.max?n.max:r<n.min?n.min:Math.ceil(r)}function i(r){return r>n.max?n.max:r<n.min?n.min:Math.floor(r)}var a=o,s=i;t.unsafe_ceil=function(r){return Math.ceil(r)},t.ceil_int=o,t.ceil=a,t.unsafe_floor=function(r){return Math.floor(r)},t.floor_int=i,t.floor=s,t.random_int=function(r,t){return i(Math.random()*(t-r|0))+r|0}},3053:(r,t,e)=>{var n=e(6517),o=e(2423),i=e(1874);function a(r,t,e,i){for(var a,s=0,u={contents:0},f=r.hyps.length-1|0;s<=f&&n.isNone(a);){var c=r.hyps[s];"E"===c.typ&&(n.getWithDefault(n.map(e,function(r){return function(t){return t===r.label}}(c)),!1)||n.getWithDefault(n.map(i,(function(r){return r===u.contents})),!1)?a=o.pnGetExpr(t[s]):u.contents=u.contents+1|0),s=s+1|0}return a}function s(r,t,e,n,o){if(n===e.frm.numOfHypsE)return!0;if(-1===n){var u={contents:!1},f=e.frm;return i.iterateSubstitutions(f.frame.asrt,r,f.frmConstParts[f.numOfHypsE],f.constParts[f.numOfHypsE],f.varGroups[f.numOfHypsE],f.subs,o,(function(i){return s(r,t,e,n+1|0,o)?(u.contents=!0,"Stop"):"Continue"})),u.contents}var c=function(r,t,e){if("object"==typeof e&&"Assertion"===e.TAG){var n=e.frame,o=e.args,i=r.hypMatchers[t];return"Label"===i.TAG?a(n,o,i._0,void 0):a(n,o,void 0,i._0)}}(e,n,t);if(void 0===c)return!1;var d={contents:!1},v=e.frm;return i.iterateSubstitutions(v.hypsE[n].expr,c,v.frmConstParts[n],v.constParts[n],v.varGroups[n],v.subs,o,(function(i){return s(r,t,e,n+1|0,o)?(d.contents=!0,"Stop"):"Continue"})),d.contents}t.exprSrcMatches=function(r,t,e,n){return e.matchAsrt?s(r,t,e,-1,n):s(r,t,e,0,n)}},6705:(r,t,e)=>{var n=e(5291),o=e(6638),i=e(2971),a=e(6517),s=e(9775),u=e(1874),f=e(5047),c=e(7653);function d(r,t){return!(!a.isNone(r.err)||!a.isNone(t.err)||r.frame.label!==t.frame.label)&&u.subsEq(r.subs,t.subs)}function v(r){return f.hash2(f.hashStr(r.frame.label),u.subsHash(r.subs))}var l=o.MakeHashableU({hash:v,eq:d});function m(r,t,e,n,o,i,a,s,u){if(e===t.length)return i.contents=i.contents+1|0,i.contents>a?s():t.some((function(r){return-1===r}))?n?"Continue":u(t):o?"Continue":u(t);for(var f="Continue",c=0,d=r[e].length-1|0;"Continue"===f&&c<=d&&i.contents<=a;)t[e]=r[e][c],-1===t[e]&&n||(f=m(r,t,e+1|0,n,o,i,a,s,u)),c=c+1|0;return f}function p(r,t,e,n,o,a,s){for(var u=i.makeBy(t,(function(r){return[]})),f=t-1|0,c=r-1|0,d=0;d<=f;++d)for(var v=-1;v<=c;++v)e(v,d)&&u[d].push(v);var l=u.findIndex((function(r){return 0===r.length}));if(-1!==l)return o>=2?s({TAG:"NoUnifForArg",args:[],errArgIdx:l}):"Continue";var p=i.make(t,0),h={contents:!1},E=m(u,p,0,!0,!1,{contents:0},n,(function(){return h.contents=!0,s({TAG:"TooManyCombinations",frmLabels:void 0})}),a);return"Continue"===E?m(u,p,0,!1,!0,{contents:0},n,(function(){return h.contents?"Continue":s({TAG:"TooManyCombinations",frmLabels:void 0})}),a):E}function h(r,t,e,n,o){var i=r.newVars.length,a=t.subs.isDefined.slice(),s={contents:(r.maxVar+1|0)+r.newVars.length|0},f=[],c=[],d=[];u.applySubs(n<t.hypsE.length?t.hypsE[n].expr:t.frame.asrt,t.subs,(function(r){var e=f.indexOf(r);if(-1!==e)return c[e];var n=s.contents;return s.contents=s.contents+1|0,f.push(r),c.push(n),d.push(t.frame.varTypes[r]),n}));for(var v=f.length-1|0,l=0;l<=v;++l){var m=f[l],p=c[l],h=d[l];t.subs.exprs[m]=[p],t.subs.begins[m]=0,t.subs.ends[m]=0,t.subs.isDefined[m]=!0,r.newVars.push(p),r.newVarTypes.push(h)}var E=e||0===r.newVars.length?o():"Continue";return a.forEach((function(r,e){t.subs.isDefined[e]=r})),r.newVars.splice(i),r.newVarTypes.splice(i),E}function E(r,t){for(var e=r+1|0;e<t.length&&t[e]>=0;)e=e+1|0;if(e<t.length&&t[e]<0)return e}function x(r,t){if(r>=t.length)throw{RE_EXN_ID:n.MmException,_1:{msg:"getNextHypIdxToMatch: hypIdx >= comb->Array.length"},Error:new Error};if(r<0||t[r]>=0){var e=function(r,t){for(var e=r+1|0;e<t.length&&t[e]<0;)e=e+1|0;if(e<t.length&&t[e]>=0)return e}(r,t);if(void 0!==e)return e;var o=E(-1,t);return void 0!==o?o:t.length}var i=E(r,t);return void 0!==i?i:t.length}function g(r,t,e,n,o,i,a,s,f,c){var d=function(){return i.map((function(r){return r>=0?n[r]:[]}))};if(a===i.length){var v={contents:!1},l=h(r,t,o,a,(function(){return v.contents=!0,f()}));return s>=2&&!v.contents?c({TAG:"NewVarsAreDisabled",args:d(),errArgIdx:a}):l}if(i[a]>=0){var m={contents:!1},p=u.iterateSubstitutions(t.hypsE[a].expr,n[i[a]],t.frmConstParts[a],t.constParts[a],t.varGroups[a],t.subs,e,(function(u){return m.contents=!0,g(r,t,e,n,o,i,x(a,i),s,f,c)}));return s>=2&&!m.contents?c({TAG:"NoUnifForArg",args:d(),errArgIdx:a}):p}var E={contents:!1},y=h(r,t,o,a,(function(){return E.contents=!0,g(r,t,e,n,o,i,x(a,i),s,f,c)}));return s>=2&&!E.contents?c({TAG:"NewVarsAreDisabled",args:d(),errArgIdx:a}):y}t.applyAssertionResultEq=d,t.applyAssertionResultHash=v,t.ApplyAssertionResultHash=l,t.applyAssertions=function(r,t,e,n,o,i,f,d,v,m,h,E,y,_,T,b){var A=void 0!==f&&f,k=void 0===d||d,S=void 0===v||v,w=void 0!==E&&E,C=void 0!==y?y:1e4,I=void 0!==T?T:0,M=function(r){return void 0!==m?_({newVars:[],newVarTypes:[],frame:r.frame,subs:u.subsClone(r.subs),err:{TAG:"NoUnifForAsrt",asrtExpr:r.frame.asrt,expr:m}}):"Continue"},j=i.length,D=function(r,t,e){if(void 0!==t)return t.length;if(void 0===e)return u.frmsGetAll(r).length;var n=u.frmsGetByType(r,e[0]);return void 0!==n?n.length:0}(t,e,m),G=c.progressTrackerMake(.01,void 0,b,void 0),N={contents:0},U={contents:"Continue"},O=s.make(16,l),P=function(t){if("Continue"===U.contents)if(a.getWithDefault(a.map(m,(function(r){return r[0]!==t.frame.asrt[0]})),!1))I>=2&&(U.contents=M(t));else{var e={contents:!1};U.contents=function(r,t,e,n){return void 0!==t?u.iterateSubstitutions(r.frame.asrt,t,r.frmConstParts[r.numOfHypsE],r.constParts[r.numOfHypsE],r.varGroups[r.numOfHypsE],r.subs,e,n):n(r.subs)}(t,m,h,(function(n){e.contents=!0;var a=t.numOfHypsE,f=[],c=[],d={maxVar:r,newVars:f,newVarTypes:c};return p(j,a,(function(r,e){return-1===r?!A&&k:(!A||r===e)&&function(r,t,e,n,o){if(n[0]!==e[0])return!1;var i={contents:!1};return u.iterateSubstitutions(n,e,r.frmConstParts[t],r.constParts[t],r.varGroups[t],r.subs,o,(function(r){return i.contents=!0,"Stop"})),i.contents}(t,e,i[r],t.hypsE[e].expr,h)}),C,I,(function(e){return g(d,t,h,i,S,e,x(-1,e),I,(function(){var e=function(r,t,e,n,o,i){return u.verifyDisjoints(r,t,(function(r,t){return!(r<=e&&t<=e&&!o(r,t))||n}),i)}(t.frame.disj,t.subs,r,w,o,I);if(void 0!==e){if(0===I)return"Continue";var n=f.slice(),i=c.slice(),a=t.frame,d=u.subsClone(t.subs);return _({newVars:n,newVarTypes:i,frame:a,subs:d,err:e})}var v={newVars:f.slice(),newVarTypes:c.slice(),frame:t.frame,subs:u.subsClone(t.subs),err:void 0};return s.has(O,v)?"Continue":(s.add(O,v),_(v))}),(function(r){return _({newVars:[],newVarTypes:[],frame:t.frame,subs:u.subsClone(t.subs),err:r})}))}),(function(r){return _({newVars:[],newVarTypes:[],frame:t.frame,subs:u.subsClone(t.subs),err:r})}))})),I>=2&&!e.contents&&(U.contents=M(t))}N.contents=N.contents+1,c.progressTrackerSetCurrPct(G,N.contents/D)};return void 0!==e?void e.forEach((function(r){a.forEach(u.frmsGetByLabel(t,r),(function(r){if(n(r.frame))return P(r)}))})):u.frmsForEach(t,a.map(m,(function(r){return r[0]})),(function(r){if(n(r.frame))return P(r)}))},t.iterateCombinations=p,t.getNextHypIdxToMatch=x},3333:(r,t,e)=>{var n=e(5291),o=e(6638),i=e(55),a=e(2971),s=e(1094),u=e(6517),f=e(303),c=e(7175),d=e(2448),v=e(5082),l=e(7356),m=e(7659),p=e(3533),h=e(2275),E=e(8615),x=e(5047),g=e(7653),y=e(9217);function _(r,t){var e=r.length;if(e!==t.length)return!1;for(var n=!0,o=0;n&&o<e;)n=r[o]===t[o],o=o+1|0;return n}function T(r,t){var e=r.length,n=t.length,o=x.intCmp(e,n);if(0!==o)return o;for(var i=0,a=0;a<e&&0===i;)i=x.intCmp(r[a],t[a]),a=a+1|0;return i}var b=x.toIntCmp(T),A=o.MakeComparableU({cmp:b}),k=o.MakeHashableU({hash:x.hashArrInt,eq:_});function S(r,t,e){if(t!==e){var n=t<=e?t:e,o=t<=e?e:t,i=l.get(r,n);return void 0!==i?m.add(c.valFromOption(i),o):l.set(r,n,m.fromArray([o]))}}function w(r,t){var e=r.parent;if(void 0===e)return t(r);var n=w(e,t);return void 0!==n?c.some(c.valFromOption(n)):t(r)}function C(r,t){for(;;){var e=r,n=t(e);if(void 0!==n)return c.some(c.valFromOption(n));var o=e.parent;if(void 0===o)return;r=o}}function I(r,t){return C(r.contents,(function(r){var e=h.get(r.frames,t);if(void 0!==e)return e.isAxiom?"A":"P";var n=h.get(r.labelToHyp,t);if(void 0!==n)return"F"===n.typ?"F":"E";var o=h.get(r.symToInt,t);return void 0!==o?o<0?"C":"V":void 0}))}function M(r,t){return u.getWithDefault(u.map(h.get(u.getExn(r.contents.root).symToInt,t),(function(r){return r<0})),!1)}function j(r,t){return u.getWithDefault(u.map(C(r.contents,(function(r){return h.get(r.symToInt,t)})),(function(r){return 0<=r})),!1)}function D(r,t){return u.isSome(C(r.contents,(function(r){return h.get(r.labelToHyp,t)})))}function G(r,t,e){var n=t<=e?t:e,o=t<=e?e:t,i=l.get(r,n);return void 0!==i&&m.has(c.valFromOption(i),o)}function N(r,t){l.forEach(r,(function(r,e){m.forEach(e,(function(e){t(r,e)}))}))}function U(r){var t=m.make(100);return l.forEach(r,(function(r,e){m.add(t,r),m.forEach(e,(function(r){m.add(t,r)}))})),t}function O(r,t,e,o,i){var a=void 0!==t&&t,s=[];N(r,(function(r,t){s.push([r,t])}));for(var f,d=function(t,e){var n={contents:!0};return t.forEach((function(t){n.contents&&e.forEach((function(e){n.contents&&t!==e&&(n.contents=G(r,t,e))}))})),n.contents},v=function(r,t){s.splice(s.findIndex((function(r){return _(r,t)})),1),t.forEach((function(t){r.includes(t)||r.push(t)}))},p=function(){for(var r,t=0,e=s.length-2|0;t<=e;++t)if(u.isNone(r))for(var n=t+1|0,o=s.length;n<o;++n)if(u.isNone(r)){var i=s[t],a=s[n];d(i,a)&&(r=[i,a])}return r},h=!0;h;){var E=p();void 0!==E?v(E[0],E[1]):h=!1}if(a&&void 0!==o&&void 0!==i&&void 0!==e){var g=U(r),y=l.make(m.size(g)),b=l.make(m.size(g));m.forEach(g,(function(r){var t=o(r);void 0!==t&&l.set(y,r,t);var n=e(r);if(void 0!==n)return l.set(b,r,n)}));var A=n.createVarTypeComparator(y,c.valFromOption(i)),k=n.createVarNameComparator(b);f=x.comparatorAndThen(A,k)}else f=x.intCmp;return s.forEach((function(r){x.sortInPlaceWith(r,f)})),x.sortInPlaceWith(s,T)}function P(r,t){var e=t.expr,n=e.length,o=n>0?e[0]:0,i=n>1?e[1]:0,a=l.get(r.exprToHyp,n);if(void 0===a)return l.set(r.exprToHyp,n,l.fromArray([[o,l.fromArray([[i,[t]]])]]));var s=c.valFromOption(a),u=l.get(s,o);if(void 0===u)return l.set(s,o,l.fromArray([[i,[t]]]));var f=c.valFromOption(u),d=l.get(f,i);return void 0===d?l.set(f,i,[t]):void 0!==d.find((function(r){return _(r.expr,t.expr)}))?void 0:void d.push(t)}function R(r,t){return C(r.contents,(function(r){return h.get(r.frames,t)}))}function F(r,t){return w(r.contents,(function(r){return x.arrForEach(r.hyps,t)}))}function V(r,t){return C(r.contents,(function(r){return h.get(r.symToInt,t)}))}function B(r,t){var e=V(r,t);if(void 0!==e)return e;throw{RE_EXN_ID:n.MmException,_1:{msg:"The symbol '"+t+"' is not declared."},Error:new Error}}function L(r,t){return t.map((function(t){return B(r,t)}))}function W(r,t){return t<0?a.get(u.getExn(r.contents.root).consts,0|-t):C(r.contents,(function(r){return t<r.varsBaseIdx?void 0:r.vars[t-r.varsBaseIdx|0]}))}function X(r,t){var e=W(r,t);if(void 0!==e)return e;throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot convert "+String(t)+" to a symbol."},Error:new Error}}function H(r,t){return t.map((function(t){return X(r,t)}))}function z(r,t){return t.map((function(t){return X(r,t)})).join(" ")}function q(r,t,e){return e<0?W(r,e):a.get(t.frameVarToSymb,e)}function $(r,t,e){var o=q(r,t,e);if(void 0!==o)return o;throw{RE_EXN_ID:n.MmException,_1:{msg:"Could not convert from int "+String(e)+" to a symbol."},Error:new Error}}function K(r,t,e){return e.map((function(e){return $(r,t,e)}))}function J(r,t){return C(r.contents,(function(r){return l.get(r.varTypes,t)}))}function Q(r,t){var e=J(r,t);if(void 0!==e)return e;var o=W(r,t),i=void 0!==o?"'"+o+"'":String(t);throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot determine type of the variable "+i},Error:new Error}}function Z(r,t,e,n){var o=void 0!==e&&e,i=m.make(16);return o||(void 0!==n?n.forEach((function(r){r.forEach((function(r){if(r>=0)return m.add(i,r)}))})):F(r,(function(r){"E"===r.typ&&r.expr.forEach((function(r){if(r>=0)return m.add(i,r)}))}))),t.forEach((function(r){if(r>=0)return m.add(i,r)})),i}function Y(r,t,e,n){var o=void 0!==e&&e,i=[];return F(r,(function(r){("E"===r.typ&&!o&&u.isNone(n)||"F"===r.typ&&m.has(t,r.expr[1]))&&i.push(r)})),void 0!==n&&n.forEach((function(r,t){i.push({typ:"E",label:String(t),expr:r})})),i}function rr(r){return u.getExn(r.contents.root).consts.slice(1)}function tr(r,t){return w(r.contents,(function(r){var e={contents:void 0};return h.forEach(r.frames,(function(r,n){u.isNone(e.contents)&&(e.contents=t(n))})),e.contents}))}function er(r){var t=r.parent;return void 0!==t?1+er(t)|0:0}function nr(r,t){var e=void 0!==t&&t,n=void 0!==r?r.contents:void 0,o={contents:{root:void 0,parent:n,consts:void 0!==n?[]:[""],varsBaseIdx:void 0!==n?n.varsBaseIdx+n.vars.length|0:0,vars:[],symToInt:h.make(0),disj:l.make(16),hyps:[],labelToHyp:h.make(4),exprToHyp:l.make(4),varTypes:l.make(4),lastComment:void 0,frames:h.make(1),totalNumOfFrames:void 0!==n?n.totalNumOfFrames:0,deprOrTranDeprFrms:E.make(1),debug:u.getWithDefault(u.map(n,(function(r){return r.debug})),e)}};return o.contents.root=void 0!==n?n.root:o.contents,o}function or(r){r.contents=nr(r,void 0).contents}function ir(r){var t,e=r.contents,o=e.parent;if(void 0===o)throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot close the root context."},Error:new Error};o.totalNumOfFrames=o.totalNumOfFrames+h.size(e.frames)|0,h.forEach(e.frames,(function(r,t){h.set(o.frames,r,t)}));var i=o.deprOrTranDeprFrms;E.forEach(e.deprOrTranDeprFrms,(function(r){return E.add(i,r)})),t=o,r.contents=t}function ar(r,t,e){if(""===t.trim())throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot use an empty string as a name of "+e+"."},Error:new Error};var o=I(r,t);if(void 0!==o)switch(o){case"C":throw{RE_EXN_ID:n.MmException,_1:{msg:"An attempt to re-declare the constant '"+t+"' as "+e+"."},Error:new Error};case"V":throw{RE_EXN_ID:n.MmException,_1:{msg:"An attempt to re-declare the variable '"+t+"' as "+e+"."},Error:new Error};case"F":throw{RE_EXN_ID:n.MmException,_1:{msg:"An attempt to re-declare a floating label '"+t+"' as "+e+"."},Error:new Error};case"E":throw{RE_EXN_ID:n.MmException,_1:{msg:"An attempt to re-declare an essential label '"+t+"' as "+e+"."},Error:new Error};case"A":throw{RE_EXN_ID:n.MmException,_1:{msg:"An attempt to re-declare an axiom label '"+t+"' as "+e+"."},Error:new Error};case"P":throw{RE_EXN_ID:n.MmException,_1:{msg:"An attempt to re-declare a provable label '"+t+"' as "+e+"."},Error:new Error}}}function sr(r,t){if(t<0)return t;var e=l.get(r,t);if(void 0!==e)return e;throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot determine frame variable for the context variable "+String(t)+"."},Error:new Error}}function ur(r,t){return t.map((function(t){return sr(r,t)}))}function fr(r,t){var e=l.make(16);return N(t,(function(t,n){S(e,sr(r,t),sr(r,n))})),s.fromArray(l.toArray(e).map((function(r){return[r[0],f.fromArray(m.toArray(r[1]))]})))}function cr(r,t){return u.getWithDefault(u.map(t,(function(t){return t.test(r)})),!1)}function dr(r,t,e,n){return!!u.getWithDefault(u.map(r,(function(r){return cr(r,e)})),!1)||cr(t,n)}function vr(r,t){if(void 0===t)return!1;var e=t.labels;return u.getWithDefault(w(r.contents,(function(r){if(e.some((function(t){return E.has(r.deprOrTranDeprFrms,t)})))return!0})),!1)}function lr(r,t){var e=a.make(r,-1);if(t.forEach((function(t,o){if("F"===t.typ){var i=t.expr[1];if(i>=r)throw{RE_EXN_ID:n.MmException,_1:{msg:"Internal error: hyp.expr[1] >= numOfVars"},Error:new Error};e[i]=o}})),e.some((function(r){return r<0})))throw{RE_EXN_ID:n.MmException,_1:{msg:"Internal error: varHyps->Array.some(idx => idx < 0)"},Error:new Error};return e}var mr=new RegExp("\\s+","g");function pr(r){return r.trim().toLowerCase().replaceAll(mr," ")}function hr(r,t,e,o,i,a,s,f,c,v,p,h,E,x,g){var y=void 0!==f&&f,_=void 0!==c&&c,T=void 0!==v&&v;if(ar(r,o,void 0!==s?s:"a frame"),i.length<1)throw{RE_EXN_ID:n.MmException,_1:{msg:"Length of an assertion expression must be at least 1."},Error:new Error};if(!_&&!M(r,i[0]))throw{RE_EXN_ID:n.MmException,_1:{msg:"The first symbol in an assertion expression must be a constant."},Error:new Error};var b=i.find((function(t){return u.isNone(V(r,t))}));if(void 0!==b)throw{RE_EXN_ID:n.MmException,_1:{msg:"The symbol '"+b+"' must be either a constant or a variable."},Error:new Error};var A=i.map((function(t){return B(r,t)})),k=Z(r,A,y,p),w=m.toArray(k),I=T?l.make(16):function(r,t){var e=l.make(16);return C(r.contents,(function(r){l.forEach(r.disj,(function(r,n){if(m.has(t,r))return m.forEach(n,(function(n){if(m.has(t,n))return S(e,r,n)}))}))})),e}(r,k),j=Y(r,k,y,p),D=l.fromArray(w.map((function(r,t){return[r,t]}))),G=r.contents.lastComment,N=d.map(G,pr),U=j.map((function(r){return{typ:r.typ,label:r.label,expr:ur(D,r.expr)}})),P=w.length;return{ord:t,isAxiom:e,disj:fr(D,I),hyps:U,asrt:ur(D,A),label:o,frameVarToSymb:w.map((function(t){return X(r,t)})),varTypes:w.map((function(t){return Q(r,t)})),varHyps:lr(P,U),numOfVars:P,numOfArgs:j.length,descr:G,descrNorm:N,proof:a,isDisc:dr(G,o,h,E),isDepr:dr(G,o,x,g),isTranDepr:vr(r,a),dbg:r.contents.debug?{disj:O(I,void 0,void 0,void 0,void 0).map((function(t){return z(r,t)})),hyps:j.map((function(t){return z(r,t.expr)})),asrt:z(r,A)}:void 0}}function Er(r,t,e,n,o,i,a,s,f){var c=r.contents,d=hr(r,c.totalNumOfFrames,t,e,n,o,u.isNone(o)?"an axiom":"a theorem",void 0,void 0,void 0,void 0,i,a,s,f);if(h.set(c.frames,e,d),c.totalNumOfFrames=c.totalNumOfFrames+1|0,d.isDepr||d.isTranDepr)return E.add(c.deprOrTranDeprFrms,e)}function xr(r,t,e,o,i,a){switch(t.TAG){case"Comment":var s=t.text;return void(r.contents.lastComment=s);case"Const":return void t.symbols.forEach((function(t){if(u.isSome(r.contents.parent))throw{RE_EXN_ID:n.MmException,_1:{msg:"An attempt to declare a constant '"+t+"' in an inner block."},Error:new Error};ar(r,t,"a constant");var e=r.contents;h.set(e.symToInt,t,0|-e.consts.length),e.consts.push(t)}));case"Block":throw{RE_EXN_ID:n.MmException,_1:{msg:"Block statements are not accepted by applySingleStmt()."},Error:new Error};case"Var":return void t.symbols.forEach((function(t){ar(r,t,"a variable");var e=r.contents;h.set(e.symToInt,t,e.varsBaseIdx+e.vars.length|0),e.vars.push(t)}));case"Disj":var f=t.vars,c=f.find((function(t){return!j(r,t)}));if(void 0!==c)throw{RE_EXN_ID:n.MmException,_1:{msg:"The symbol '"+c+"' is not a variable but it is used in a disjoint statement."},Error:new Error};for(var d=f.map((function(t){return B(r,t)})),v=d.length-1|0,m=0;m<=v;++m)for(var p=m+1|0;p<=v;++p)S(r.contents.disj,d[m],d[p]);return;case"Floating":var E=t.label,x=t.expr;if(2!==x.length)throw{RE_EXN_ID:n.MmException,_1:{msg:"Length of a floating expression must be 2."},Error:new Error};ar(r,E,"a floating label");var g=x[0],y=x[1];if(!M(r,g))throw{RE_EXN_ID:n.MmException,_1:{msg:"The first symbol in the floating '"+g+"' must be a constant."},Error:new Error};if(!j(r,y))throw{RE_EXN_ID:n.MmException,_1:{msg:"The second symbol in the floating '"+y+"' must be a variable."},Error:new Error};var _=B(r,y);if(u.isSome(J(r,_)))throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot redefine typecode for the variable '"+y+"'"},Error:new Error};var T=B(r,g),b={typ:"F",label:E,expr:[T,_]},A=r.contents;return A.hyps.push(b),h.set(A.labelToHyp,E,b),P(A,b),l.set(A.varTypes,_,T);case"Essential":var k=t.label,w=t.expr;if(w.length<1)throw{RE_EXN_ID:n.MmException,_1:{msg:"Length of an essential expression must be at least 1."},Error:new Error};if(!M(r,w[0]))throw{RE_EXN_ID:n.MmException,_1:{msg:"The first symbol in an essential expression must be a constant."},Error:new Error};var C={typ:"E",label:k,expr:L(r,w)},I=r.contents;return I.hyps.push(C),h.set(I.labelToHyp,k,C),P(I,C);case"Axiom":return Er(r,!0,t.label,t.expr,void 0,e,o,i,a);case"Provable":return Er(r,!1,t.label,t.expr,t.proof,e,o,i,a)}}function gr(r,t){return u.getWithDefault(l.get(r,t),t)}function yr(r,t){for(var e=t.length-1|0,n=0;n<=e;++n){var o=t[n];o<0&&(t[n]=gr(r,o))}}function _r(r,t,e){return{ord:r.ord,isAxiom:r.isAxiom,disj:r.disj,hyps:r.hyps,asrt:r.asrt,label:r.label,frameVarToSymb:r.frameVarToSymb,varTypes:r.varTypes,varHyps:r.varHyps,numOfVars:r.numOfVars,numOfArgs:r.numOfArgs,descr:t?void 0:r.descr,descrNorm:t?void 0:r.descrNorm,proof:e?void 0:r.proof,isDisc:r.isDisc,isDepr:r.isDepr,isTranDepr:r.isTranDepr,dbg:r.dbg}}function Tr(r,t,e){var n=function(r){var n=r.parent;return{root:r.root,parent:r.parent,consts:r.consts,varsBaseIdx:r.varsBaseIdx,vars:r.vars,symToInt:r.symToInt,disj:r.disj,hyps:r.hyps,labelToHyp:r.labelToHyp,exprToHyp:r.exprToHyp,varTypes:r.varTypes,lastComment:t?void 0:r.lastComment,frames:h.fromArray(h.toArray(r.frames).map((function(r){return[r[0],_r(r[1],t,e)]}))),totalNumOfFrames:void 0!==n?n.totalNumOfFrames+h.size(r.frames)|0:h.size(r.frames),deprOrTranDeprFrms:E.make(0),debug:r.debug}},o=r.parent;if(void 0!==o){var i=Tr(o,t,e),a=i[0],s=n(r);return[a,{root:a,parent:i[1],consts:s.consts,varsBaseIdx:s.varsBaseIdx,vars:s.vars,symToInt:s.symToInt,disj:s.disj,hyps:s.hyps,labelToHyp:s.labelToHyp,exprToHyp:s.exprToHyp,varTypes:s.varTypes,lastComment:s.lastComment,frames:s.frames,totalNumOfFrames:s.totalNumOfFrames,deprOrTranDeprFrms:s.deprOrTranDeprFrms,debug:s.debug}]}var u=n(r);return u.root=u,[u,u]}function br(r,t){return L(r,H(r,t).sort())}function Ar(r,t){var e=m.fromArray(L(r,rr(r))),o=m.size(e),i=m.make(o),s=m.make(o);tr(r,(function(r){var t=r.asrt[1];t<0&&m.add(i,t);var e=r.asrt[r.asrt.length-1|0];e<0&&m.add(s,e)}));var f=m.fromArray(m.toArray(i).filter((function(r){return m.has(s,r)})));m.forEach(f,(function(r){return m.remove(i,r)})),m.forEach(f,(function(r){return m.remove(s,r)}));var c=n.getSpaceSeparatedValuesAsArray(t).map((function(t){return V(r,t)})).filter((function(r){return u.mapWithDefault(r,!1,(function(r){return r<0}))})).map(u.getExn);c.forEach((function(r){m.remove(i,r),m.remove(f,r),m.remove(s,r)}));var d,v=m.fromArray(m.toArray(e).filter((function(r){return!(c.includes(r)||m.has(i,r)||m.has(f,r)||m.has(s,r))}))),l=a.concatMany([c,(d=m.toArray(i),br(r,d)),function(t){return br(r,t)}(m.toArray(f)),function(t){return br(r,t)}(m.toArray(s)),function(t){return br(r,t)}(m.toArray(v))]),p=0|-c.length,h=p-1|0,E=(1+(h-m.size(i)|0)|0)-1|0,x=1+(E-m.size(f)|0)|0,g=1+((x-1|0)-m.size(s)|0)|0;return{allConsts:H(r,l),parenMin:p,canBeFirstMin:x,canBeFirstMax:h,canBeLastMin:g,canBeLastMax:E}}t.createContext=nr,t.applySingleStmt=xr,t.openChildContext=or,t.closeChildContext=ir,t.resetToParentContext=function(r){var t,e=r.contents.parent;if(void 0===e)throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot reset the root context."},Error:new Error};t=e,r.contents=t},t.loadContext=function(r,t,e,n,o,a,s,u,f,d,v,l){var m=void 0!==e?e:"",p=void 0!==n?n:"",h=void 0!==a?a:-1,E=void 0!==v?v:function(r){},x=void 0!==l&&l,y={contents:0},_=g.progressTrackerMake(.1,void 0,E,void 0);return i.traverseAst(void 0!==t?t:nr(void 0,x),r,(function(r,t){void 0!==o&&o(r,t.stmt);var e=t.stmt;switch(e.TAG){case"Block":return e.level>0&&or(r),void(r.contents.lastComment=void 0);case"Axiom":case"Provable":break;default:return}if(h>0&&(y.contents=y.contents+1,g.progressTrackerSetCurrPct(_,y.contents/h)),m===e.label)return c.some(void 0)}),(function(r,t){var e=t.stmt;"Block"!==e.TAG&&xr(r,e,s,u,f,d)}),(function(r,t){var e=t.stmt;switch(e.TAG){case"Block":return void(e.level>0&&ir(r));case"Axiom":case"Provable":break;default:return}if(p===e.label)return c.some(void 0)}))[0]},t.ctxOptimizeForProver=function(r,t,e,n){var o=void 0===e||e,i=void 0===n||n,a={contents:Tr(r.contents,o,i)[1]};return function(r,t){for(var e=u.getExn(r.contents.root),n=t.slice(),o=-1,i=0|-(e.consts.length-1|0);o>=i;--o)n.includes(o)||n.push(o);var a=e.consts.slice(),s=l.make(e.consts.length);n.forEach((function(r,t){var n=a[0|-r],o=0|-(t+1|0);l.set(s,r,o),e.consts[0|-o]=n,h.set(e.symToInt,n,o)})),F(r,(function(r){yr(s,r.expr)})),tr(r,(function(r){r.hyps.forEach((function(r){yr(s,r.expr)})),yr(s,r.asrt),yr(s,r.varTypes)})),w(r.contents,(function(r){for(var t=r.vars.length-1|0,e=0;e<=t;++e){var n=r.varsBaseIdx+e|0,o=l.get(r.varTypes,n);void 0!==o&&l.set(r.varTypes,n,gr(s,o))}l.clear(r.exprToHyp),r.hyps.forEach((function(t){P(r,t)}))}))}(a,L(a,Ar(a,t).allConsts)),a},t.ctxGetOptimizedConstsOrder=Ar,t.isDebug=function(r){return r.contents.debug},t.isConst=M,t.isVar=j,t.isHyp=D,t.isAsrt=function(r,t){return u.isSome(C(r.contents,(function(r){return h.get(r.frames,t)})))},t.isDisj=function(r,t,e){return u.getWithDefault(C(r.contents,(function(r){if(G(r.disj,t,e))return!0})),!1)},t.getAllConsts=rr,t.getHypothesis=function(r,t){return C(r.contents,(function(r){return h.get(r.labelToHyp,t)}))},t.getHypByExpr=function(r,t){return C(r.contents,(function(r){var e=t.length,n=l.get(r.exprToHyp,e);if(void 0!==n){var o=e>0?t[0]:0,i=l.get(c.valFromOption(n),o);if(void 0!==i){var a=e>1?t[1]:0,s=l.get(c.valFromOption(i),a);return void 0!==s?s.find((function(r){return _(r.expr,t)})):void 0}}}))},t.getMandHyps=function(r,t,e,n){var o=void 0!==e&&e;return Y(r,Z(r,t,o,n),o,n)},t.getAllHyps=function(r){var t=[];return F(r,(function(r){t.push(r)})),v.fromArray(t.map((function(r){return[r.label,r]})))},t.getAllFrames=function(r){var t=[];return C(r.contents,(function(r){h.forEach(r.frames,(function(r,e){t.push([r,e])}))})),v.fromArray(t)},t.getAllFramesArr=function(r){var t=[];return C(r.contents,(function(r){p.spliceObjApply(t,"push",[h.valuesToArray(r.frames)])})),t},t.getAllDisj=function(r){var t=l.make(16);return C(r.contents,(function(r){l.forEach(r.disj,(function(r,e){m.forEach(e,(function(e){S(t,r,e)}))}))})),t},t.getLocalDisj=function(r){var t=l.make(16);return l.forEach(r.contents.disj,(function(r,e){m.forEach(e,(function(e){S(t,r,e)}))})),t},t.getFrame=R,t.getFrameExn=function(r,t){var e=R(r,t);if(void 0!==e)return e;throw{RE_EXN_ID:n.MmException,_1:{msg:"Could not find a frame by the label '"+t+"'"},Error:new Error}},t.frameIsAllowed=function(r,t){return!(r.isDisc&&!t.useDisc||r.isDepr&&!t.useDepr)&&(!r.isTranDepr||t.useTranDepr)},t.getLocalVars=function(r){return r.contents.vars.slice()},t.getLocalHyps=function(r){return r.contents.hyps.slice()},t.getNumOfVars=function(r){return r.contents.varsBaseIdx+r.contents.vars.length|0},t.forEachFrame=tr,t.forEachHypothesisInDeclarationOrder=F,t.getNestingLevel=function(r){return er(r.contents)},t.findParentheses=function(r,t){for(var e,o=function(r,t,e){for(var n=!0,o=!1,i=!1,a=y.parenCntMake([t,e],!1),s="Balanced",u=r.length,f=0;f<u&&n;){for(var c=r[f],d=c.length,v=0;v<d&&n;){var l=c[v];o||l!==t||(o=!0),i||l!==e||(i=!0),n="Failed"!==(s=y.parenCntPut(a,l)),v=v+1|0}n="Balanced"===s,f=f+1|0}return!(!n||!o)&&i},i=function(r){var t=[];return tr(r,(function(r){r.hyps.forEach((function(r){"E"!==r.typ||t.push(r.expr)})),t.push(r.asrt)})),t}(r),s=(e=n.getSpaceSeparatedValuesAsArray('( ) [ ] { } [. ]. [_ ]_ <. >. <" "> << >> [s ]s (. ). (( ))').filter((function(t){return M(r,t)})),L(r,e)).concat(a.range(1,u.getExn(r.contents.root).consts.length-1|0).map((function(r){return 0|-r}))),f=s.length-2|0,c=g.progressTrackerMake(.01,void 0,t,void 0),d=[],v=0;v<=f;++v){var l=s[v],m=s[v+1|0];d.includes(l)||d.includes(m)||!o(i,l,m)||(d.push(l),d.push(m)),g.progressTrackerSetCurrPct(c,v/f)}return d},t.getTypeOfVar=J,t.getTypeOfVarExn=Q,t.getTokenType=I,t.ctxSymToInt=V,t.ctxIntToSym=W,t.ctxSymToIntExn=B,t.ctxSymsToIntsExn=L,t.ctxStrToIntsExn=function(r,t){return L(r,n.getSpaceSeparatedValuesAsArray(t))},t.ctxIntToSymExn=X,t.ctxIntsToSymsExn=H,t.ctxIntsToStrExn=z,t.frmIntToSym=q,t.frmIntToSymExn=$,t.frmIntsToStrExn=function(r,t,e){return K(r,t,e).join(" ")},t.frmIntsToSymsExn=K,t.createFrame=hr,t.generateNewVarNames=function(r,t,e,n){for(var o=void 0!==e?c.valFromOption(e):void 0,i=h.make(v.size(o)),a=function(r){return u.getWithDefault(h.get(i,r),0)},s=function(r){h.set(i,r,a(r)+1|0)},f=t.length-1|0,d=[],l=0;l<=f;++l){var m=X(r,t[l]),p=v.getWithDefault(o,m,m);s(p);for(var x={contents:p+String(a(p))};u.isSome(I(r,x.contents))||u.getWithDefault(u.map(n,function(r){return function(t){return E.has(t,r.contents)}}(x)),!1);)s(p),x.contents=p+String(a(p));d.push(x.contents)}return d},t.generateNewLabels=function(r,t,e,n,o){for(var i=void 0!==o&&o,a=function(t){return!!(u.getWithDefault(u.map(n,(function(r){return E.has(r,t)})),!1)||!i&&u.isSome(I(r,t)))||!!i&&D(r,t)},s=e-1|0,f=0,c=[],d=0;d<=s;++d){f=f+1|0;for(var v=t+String(f);a(v);)f=f+1|0,v=t+String(f);c.push(v)}return c},t.disjMake=function(){return l.make(16)},t.disjAddPair=S,t.disjContains=G,t.disjImmContains=function(r,t,e){var n=t<=e?t:e,o=t<=e?e:t,i=s.get(r,n);return void 0!==i&&f.has(c.valFromOption(i),o)},t.disjToArr=O,t.disjForEachArr=function(r,t,e,n,o,i){O(r,void 0!==t&&t,e,n,o).forEach(i)},t.disjForEach=N,t.disjIsEmpty=function(r){return 0===l.size(r)},t.disjMutToDisjImm=function(r){return s.fromArray(l.toArray(r).map((function(r){return[r[0],f.fromArray(m.toArray(r[1]))]})))},t.disjGetAllVars=U,t.exprEq=_,t.ExprCmp=A,t.ExprHash=k,t.normalizeDescr=pr},4792:(r,t,e)=>{var n=e(5291);t.parenCntMake=function(r,t,e,o,i){if(r%2!=0)throw{RE_EXN_ID:n.MmException,_1:{msg:"mod(parenMin, 2)  != 0 in parenCntMake"},Error:new Error};return{stack:new Array(1e3),len:0,failed:!1,parenMin:r,canBeFirstMin:t,canBeFirstMax:e,canBeLastMin:o,canBeLastMax:i}},t.parenCntReset=function(r){r.len=0,r.failed=!1},t.parenCntPut=function(r,t){return r.failed?"Failed":r.parenMin<=t&&t<0?t%2==-1?(function(r,t){if(r.stack.length===r.len)for(var e=1;e<=1e3;++e)r.stack.push(0);r.stack[r.len]=t,r.len=r.len+1|0}(r,t),"Opened"):0===r.len||r.stack[r.len-1|0]!==(t+1|0)?(r.failed=!0,"Failed"):(r.len=r.len-1|0,0===r.len?"Balanced":"Opened"):0===r.len?"Balanced":"Opened"},t.parenCntCanBeFirst=function(r,t){return 0<=t||r.parenMin<t&&t%2==-1||r.canBeFirstMin<=t&&t<=r.canBeFirstMax},t.parenCntCanBeLast=function(r,t){return 0<=t||r.parenMin<=t&&t%2==0||r.canBeLastMin<=t&&t<=r.canBeLastMax}},9217:(r,t,e)=>{var n=e(5291),o=e(2761),i=e(5047);t.parenCntMake=function(r,t){var e=void 0===t||t,i=r.length;if(i%2!=0)throw{RE_EXN_ID:n.MmException,_1:{msg:"mod(parenLen, 2)  != 0 in parenCntMake"},Error:new Error};if(0===i)return{min:0,parens:[],parentStack:[],failed:!1};for(var a=[],s=(i/2|0)-1|0,u=0;u<=s;++u){var f=r[u<<1],c=r[1+(u<<1)|0];a.push({code:f,isOpen:!0,opposite:c}),a.push({code:c,isOpen:!1,opposite:f})}var d=o.reduce(r,r[0],(function(r,t){return r<=t?r:t}));return e&&Math.abs(d)!==i&&console.log("Warning: parentheses are not optimized (this may slow down the unification process)."),{min:d,parens:a,parentStack:[],failed:!1}},t.parenCntReset=function(r){i.clearArray(r.parentStack),r.failed=!1},t.parenCntPut=function(r,t){if(!r.failed&&r.min<=t&&t<0){var e=r.parens.find((function(r){return r.code===t}));if(void 0!==e)if(e.isOpen)r.parentStack.push(e);else{var n=r.parentStack.pop();void 0!==n&&n.opposite===e.code||(r.failed=!0)}}return r.failed?"Failed":0===r.parentStack.length?"Balanced":"Opened"}},55:(r,t,e)=>{var n=e(5291),o=e(6517),i=e(7175),a=e(3533),s=e(368),u=e(7653);function f(r){return" "===r||"\t"===r||"\n"===r||"\r"===r}function c(r,t){var e=(t+20|0)<r.length?"...":"";return"'"+r.substr(t,20)+e+"'"}function d(r,t,e,n,o){return s.traverseTree(r,t,(function(r,t){var e=t.stmt;if("Block"===e.TAG)return e.statements}),e,n,o)}function v(r){return void 0!==r?"Uncompressed"===r.TAG?r.labels.join(" "):"( "+r.labels.join(" ")+" ) "+r.compressedProofBlock:"?"}function l(r){var t=r.stmt;switch(t.TAG){case"Comment":return"$( "+t.text+" $)";case"Const":return"$c "+t.symbols.join(" ")+" $.";case"Block":return"block(level="+String(t.level)+")";case"Var":return"$v "+t.symbols.join(" ")+" $.";case"Disj":return"$d "+t.vars.join(" ")+" $.";case"Floating":return t.label+" $f "+t.expr.join(" ")+" $.";case"Essential":return t.label+" $e "+t.expr.join(" ")+" $.";case"Axiom":return t.label+" $a "+t.expr.join(" ")+" $.";case"Provable":return t.label+" $p "+t.expr.join(" ")+" $= "+v(t.proof)+" $."}}t.parseMmFile=function(r,t,e,s){var d=void 0!==t&&t,v=void 0!==e&&e,l=void 0!==s?s:function(r){},m=r.length,p={contents:0},h={contents:!1},E={contents:""},x=u.progressTrackerMake(.1,void 0,l,!0),g=[],y=function(t){p.contents=t,p.contents>=m?(h.contents=!0,E.contents=""):(h.contents=!1,E.contents=r.charAt(p.contents))};y(0);var _=function(){if(!h.contents)return p.contents=p.contents+1|0,void(p.contents>=m?(h.contents=!0,E.contents=""):E.contents=r.charAt(p.contents))},T=function(t){for(var e,n=p.contents;o.isNone(e);){var a=r.indexOf(t,p.contents);if(a<0)e=i.some(void 0);else{var s=a+t.length|0;y(s),h.contents||f(E.contents)?e=i.some(r.substring(n,a)):y(a+1|0)}}return o.getExn(e)},b=function(t){var e=T("$)");if(void 0!==e)return{begin:t,end:p.contents-1|0,stmt:{TAG:"Comment",text:e}};throw{RE_EXN_ID:n.MmException,_1:{msg:"A comment is not closed at "+c(r,t)},Error:new Error}},A=function(t){if(void 0===t||t){for(var e=A(!1);"$("===e;)b(p.contents),e=A(!1);return e}!function(){for(;!h.contents&&f(E.contents);)_()}();for(var n=p.contents;!h.contents&&!f(E.contents);)_();return r.substring(n,p.contents)},k=function(r){for(var t,e=[];o.isNone(t);){var n=A(void 0);""===n?t=i.some(void 0):"$("===n?b(p.contents):n===r?t=i.some(e):e.push(n)}return o.getExn(t)},S=function(t){var e=k("$.");if(void 0!==e)return{begin:t,end:p.contents-1|0,stmt:{TAG:"Const",symbols:e}};throw{RE_EXN_ID:n.MmException,_1:{msg:"A constant statement is not closed at "+c(r,t)},Error:new Error}},w=function(t){var e=k("$.");if(void 0!==e)return{begin:t,end:p.contents-1|0,stmt:{TAG:"Var",symbols:e}};throw{RE_EXN_ID:n.MmException,_1:{msg:"A variable statement is not closed at "+c(r,t)},Error:new Error}},C=function(t){var e=k("$.");if(void 0!==e)return{begin:t,end:p.contents-1|0,stmt:{TAG:"Disj",vars:e}};throw{RE_EXN_ID:n.MmException,_1:{msg:"A disjoint statement is not closed at "+c(r,t)},Error:new Error}},I=function(t,e){var o=k("$.");if(void 0!==o)return{begin:t,end:p.contents-1|0,stmt:{TAG:"Floating",label:e,expr:o}};throw{RE_EXN_ID:n.MmException,_1:{msg:"A floating statement is not closed at "+c(r,t)},Error:new Error}},M=function(t,e){var o=k("$.");if(void 0!==o)return{begin:t,end:p.contents-1|0,stmt:{TAG:"Essential",label:e,expr:o}};throw{RE_EXN_ID:n.MmException,_1:{msg:"An essential statement is not closed at "+c(r,t)},Error:new Error}},j=function(t,e){var o=k("$.");if(void 0!==o)return{begin:t,end:p.contents-1|0,stmt:{TAG:"Axiom",label:e,expr:o}};throw{RE_EXN_ID:n.MmException,_1:{msg:"An axiom statement is not closed at "+c(r,t)},Error:new Error}},D=function(t,e){var o=k("$=");if(void 0!==o){var i=A(void 0);if("("===i){var s=k(")");if(void 0!==s){var u=k("$.");if(void 0!==u)return{begin:t,end:p.contents-1|0,stmt:{TAG:"Provable",label:e,expr:o,proof:v?void 0:{TAG:"Compressed",labels:s,compressedProofBlock:a.spliceObjApply("","concat",[u])}}};throw{RE_EXN_ID:n.MmException,_1:{msg:"A probale statement is not closed[3] at "+c(r,t)},Error:new Error}}throw{RE_EXN_ID:n.MmException,_1:{msg:"A provable statement is not closed[2] at "+c(r,t)},Error:new Error}}var f=k("$.");if(void 0!==f)return{begin:t,end:p.contents-1|0,stmt:{TAG:"Provable",label:e,expr:o,proof:v?void 0:{TAG:"Uncompressed",labels:[i].concat(f)}}};throw{RE_EXN_ID:n.MmException,_1:{msg:"A provable statement is not closed[4] at "+c(r,t)},Error:new Error}}throw{RE_EXN_ID:n.MmException,_1:{msg:"A provable statement is not closed[1] at "+c(r,t)},Error:new Error}},G=function(t,e){for(var i,a=[];o.isNone(i);){var s=A(!1),f=p.contents-s.length|0;if(""===s){if(0!==e)throw{RE_EXN_ID:n.MmException,_1:{msg:"Unexpected end of a block. The block begins at "+c(r,t)+" and is not closed."},Error:new Error};i={begin:t,end:p.contents-1|0,stmt:{TAG:"Block",level:e,statements:a}}}else if("$}"===s)i={begin:t,end:p.contents-1|0,stmt:{TAG:"Block",level:e,statements:a}};else if("${"===s){var v=G(f,e+1|0);a.push(v)}else if("$("===s){var l=b(f);d||a.push(l)}else if("$["===s)T("$]");else if("$c"===s){var h=S(f);a.push(h)}else if("$v"===s){var E=w(f);a.push(E)}else if("$d"===s){var y=C(f);a.push(y)}else{var _=A(void 0),k=p.contents-_.length|0;if(""===_)throw{RE_EXN_ID:n.MmException,_1:{msg:"Unexpected end of file at "+c(r,f)},Error:new Error};if("$f"===_){var N=I(f,s);a.push(N)}else if("$e"===_){var U=M(f,s);a.push(U)}else if("$a"===_){g.push(s);var O=j(f,s);a.push(O)}else{if("$p"!==_)throw{RE_EXN_ID:n.MmException,_1:{msg:"Unexpected token '"+_+"' at "+c(r,k)},Error:new Error};g.push(s);var P=D(f,s);a.push(P)}}u.progressTrackerSetCurrPct(x,f/m)}return o.getExn(i)};return[G(p.contents,0),g]},t.textAt=c,t.traverseAst=d,t.stmtToStr=l,t.stmtToStrRec=function(r){return d([{contents:0},[]],r,(function(r,t){var e=r[0],n=t.stmt;if("Block"===n.TAG){var o=n.level;0!==o&&r[1].push("    ".repeat(e.contents)+"${"),e.contents=o}}),(function(r,t){var e;""!==(e="Block"===t.stmt.TAG?"":l(t))&&r[1].push("    ".repeat(r[0].contents)+e)}),(function(r,t){var e=r[0],n=t.stmt;if("Block"===n.TAG){var o=n.level;e.contents=o-1|0,0!==o&&r[1].push("    ".repeat(e.contents)+"$}")}}))[0][1]},t.astToStr=function(r){var t=[];return d(void 0,r,(function(r,e){var n=e.stmt;"Block"===n.TAG&&n.level>0&&t.push("${")}),(function(r,e){var n=e.stmt;switch(n.TAG){case"Comment":t.push("$( "+n.text+" $)");break;case"Const":var o="$c "+n.symbols.join(" ")+" $.";t.push(o);break;case"Block":break;case"Var":var i="$v "+n.symbols.join(" ")+" $.";t.push(i);break;case"Disj":var a="$d "+n.vars.join(" ")+" $.";t.push(a);break;case"Floating":var s=n.label+" $f "+n.expr.join(" ")+" $.";t.push(s);break;case"Essential":var u=n.label+" $e "+n.expr.join(" ")+" $.";t.push(u);break;case"Axiom":var f=n.label+" $a "+n.expr.join(" ")+" $.";t.push(f);break;case"Provable":var c=n.label+" $p "+n.expr.join(" ")+" $= "+v(n.proof)+" $.";t.push(c)}}),(function(r,e){var n=e.stmt;"Block"===n.TAG&&n.level>0&&t.push("$}")})),t.join("\n")}},6134:(r,t,e)=>{var n=e(5291),o=e(4923),i=e(5300),a=e(3333),s=e(6517),u=e(2761),f=e(7356),c=e(7659),d=e(368),v=e(9702),l=e(2275);function m(r,t,e){var n=r.length;return e<=n?r:r+t.repeat(e-n|0)}function p(r){return u.reduce(r.map((function(r){return r.length})),0,(function(r,t){return Math.max(r,t)}))}function h(r,t){var e=t.map((function(r){var t=r.proof;return"Hypothesis"===t.TAG?"":t.args.map((function(r){return r+1|0})).join(",")})),n=t.map((function(r){var t=r.proof;return t.TAG,t.label})),o=t.map((function(t){return a.ctxIntsToStrExn(r,t.expr)})),s=1+(i.Int.floor(Math.log10(t.length))+1|0)|0,u=p(e)+1|0,f=p(n)+1|0;return t.map((function(r,t){return i=String(t+1|0)," ",((a=s)<=(c=i.length)?i:" ".repeat(a-c|0)+i)+"| "+m(e[t]," ",u)+"| "+m(n[t]," ",f)+"| "+o[t];var i,a,c}))}function E(r,t,e){var n=h(r,t);return m("--- "+e+" ","-",p(n))+"\n"+n.join("\n")+"\n"+m("","-",p(n))}function x(r,t,e,n){var o=c.make(64);d.traverseTree(void 0,t,(function(t,e){var n=r[e].proof;return"Hypothesis"===n.TAG||c.has(o,e)?void 0:n.args}),void 0,void 0,(function(t,i){"Hypothesis"===r[i].proof.TAG?e(i):c.has(o,i)?n(i):(c.add(o,i),e(i))}))}t.createProof=function(r,t,e){if(t.length<=e)throw{RE_EXN_ID:n.MmException,_1:{msg:"tblLen <= rootIdx"},Error:new Error};var o=r.length,i=l.fromArray(r.map((function(r,t){return[r.label,t+1|0]}))),a=[],u=l.make(64),d=function(r,t){var e=c.make(64);return x(r,t,(function(r){}),(function(r){c.add(e,r)})),e}(t,e),m=f.make(64),p=[];x(t,e,(function(r){var e,n=t[r].proof;if(n.TAG,e=function(r){var t=l.get(i,r);if(void 0!==t)return t;var e=l.get(u,r);if(void 0!==e)return e;a.push(r);var n=o+a.length|0;return l.set(u,r,n),n}(n.label),p.push(e),c.has(d,r))return p.push(0),f.set(m,r,f.size(m)+1|0)}),(function(r){p.push(0|-s.getExn(f.get(m,r)))}));var h=o+a.length|0;return{TAG:"Compressed",labels:a,compressedProofBlock:p.map((function(r){return 0===r?"Z":r<0?v.intToCompressedProofStr(h-r|0):v.intToCompressedProofStr(r)})).join("")}},t.createProofTableFromProof=function(r,t){var e=void 0===t||t,i=f.make(v.proofNodeGetId(r)),u=[],c=function(r,t,e){u.push({expr:t,proof:e});var n=u.length-1|0;f.set(i,r,n)},l=function(r,t,d){if(s.isSome(f.get(i,r)))throw{RE_EXN_ID:n.MmException,_1:{msg:"getIdxByNodeId(nodeId)->Belt_Option.isSome in createProofTableFromProof()"},Error:new Error};if(!e)return c(r,t,d);var v=u.findIndex((function(r){return!!a.exprEq(r.expr,t)&&o.equal(r.proof,d)}));return-1!==v?f.set(i,r,v):c(r,t,d)};return d.traverseTree(void 0,r,(function(r,t){return"Hypothesis"===t.TAG?void 0:t.args}),void 0,void 0,(function(r,t){if("Hypothesis"===t.TAG){var e=t.id;s.isNone(f.get(i,e))&&l(e,t.expr,{TAG:"Hypothesis",label:t.hypLabel})}else{var o=t.id;s.isNone(f.get(i,o))&&l(o,t.expr,{TAG:"Assertion",args:t.args.map((function(r){var t=v.proofNodeGetId(r),e=f.get(i,t);if(void 0!==e)return e;throw{RE_EXN_ID:n.MmException,_1:{msg:"Could not determine idx by nodeId in createProofTableFromProof()."},Error:new Error}})),label:t.asrtLabel})}})),u},t.proofTableToArrStr=h,t.proofTableToStr=E,t.proofTablePrint=function(r,t,e){console.log(E(r,t,e))}},2423:(r,t,e)=>{var n=e(5291),o=e(3333),i=e(6517),a=e(2815),s=e(9775),u=e(5082),f=e(5650),c=e(2275),d=e(5047);function v(r){if("object"!=typeof r)return!0;switch(r.TAG){case"Hypothesis":return!0;case"Assertion":return r.args.every((function(r){return i.isSome(r.proof)}));case"AssertionWithErr":return!1}}function l(r){var t=r.pnDbg;return void 0!==t?t.exprStr:r.expr.map((function(r){return String(r)})).join(" ")}function m(r){var t=r.fParents,e=void 0!==t?t.find(v):void 0;return i.isSome(e)?e:r.eParents.find(v)}t.ptMake=function(r,t,e,n,f,d){var v=u.toArray(t);return{frms:r,hypsByExpr:a.fromArray(v.map((function(r){var t=r[1];return[t.expr,t]})),o.ExprHash),hypsByLabel:c.fromArray(v),ctxMaxVar:e,ctxDisj:n,maxVar:e,newVars:s.make(16,o.ExprHash),parenCnt:f,nextNodeId:0,nodes:a.make(128,o.ExprHash),rootStmts:[],syntaxProofs:a.make(128,o.ExprHash),ptDbg:i.map(d,(function(r){return{newVars:[],exprToStr:r}}))}},t.ptGetFrms=function(r){return r.frms},t.ptGetHypByExpr=function(r,t){return a.get(r.hypsByExpr,t)},t.ptGetHypByLabel=function(r,t){return c.get(r.hypsByLabel,t)},t.ptGetMaxVar=function(r){return r.maxVar},t.ptGetCtxMaxVar=function(r){return r.ctxMaxVar},t.ptGetParenCnt=function(r){return r.parenCnt},t.ptIsDisjInCtx=function(r,t,e){return o.disjContains(r.ctxDisj,t,e)},t.ptIsNewVarDef=function(r,t){return s.has(r.newVars,t)},t.ptGetRootStmts=function(r){return r.rootStmts},t.ptGetNode=function(r,t){var e=a.get(r.nodes,t);if(void 0!==e)return e;var n={id:r.nextNodeId,expr:t,fParents:void 0,eParents:[],children:[],proof:void 0,isInvalidFloating:!1,dist:void 0,pnDbg:i.map(r.ptDbg,(function(r){return{exprStr:r.exprToStr(t)}}))};return a.set(r.nodes,t,n),r.nextNodeId=r.nextNodeId+1|0,n},t.ptAddNewVar=function(r,t){r.maxVar=r.maxVar+1|0;var e=r.maxVar;s.add(r.newVars,[t,e]);var n=r.ptDbg;return void 0!==n&&n.newVars.push(n.exprToStr([t,e])),e},t.ptAddRootStmt=function(r,t){return void 0!==r.rootStmts.find((function(r){return o.exprEq(r.expr,t.expr)}))?void 0:void r.rootStmts.push(t)},t.ptAddSyntaxProof=function(r,t,e){a.set(r.syntaxProofs,t,e)},t.ptGetSyntaxProof=function(r,t){return a.get(r.syntaxProofs,t)},t.ptGetAllSyntaxProofs=function(r){return a.toArray(r.syntaxProofs)},t.ptClearDists=function(r){a.forEach(r.nodes,(function(r,t){t.dist=void 0}))},t.ptGetDbg=function(r){return r.ptDbg},t.ptGetCopyOfNewVars=function(r){return s.toArray(r.newVars)},t.ptGetCtxDisj=function(r){return r.ctxDisj},t.pnGetId=function(r){return r.id},t.pnGetExpr=function(r){return r.expr},t.pnGetProof=function(r){return r.proof},t.pnGetFParents=function(r){return r.fParents},t.pnGetEParents=function(r){return r.eParents},t.pnAddParent=function(r,t,e,o){if(i.isNone(r.proof)||o){var a,s=!1;if(e)a=r.eParents;else{var u=r.fParents;if(void 0!==u)a=u;else{var c=[t];r.fParents=c,s=!0,a=c}}if(!s){var d=a.find((function(r){if("object"!=typeof r)return"object"!=typeof t;switch(r.TAG){case"Hypothesis":return"object"==typeof t&&"Hypothesis"===t.TAG&&r.label===t.label;case"Assertion":var e=r.args;if("object"!=typeof t)return!1;if("Assertion"!==t.TAG)return!1;var n=t.args;return r.frame.label===t.frame.label&&e.length===n.length&&e.every((function(r,t){return r.id===n[t].id}));case"AssertionWithErr":return!1}}));if(void 0!==d){if(v(d))throw{RE_EXN_ID:n.MmException,_1:{msg:"Unexpected: an unproved node '"+l(r)+"' has a proved parent."},Error:new Error}}else a.push(t),s=!0}if(s)return"object"==typeof t&&"Assertion"===t.TAG&&t.args.forEach((function(t){if(t.id!==r.id)return void 0!==t.children.find((function(t){return t.id===r.id}))?void 0:void t.children.push(r)})),v(t)?(function(r){if(i.isNone(r.proof)){var t=m(r);if(void 0!==t){r.proof=t;for(var e=f.fromArray(r.children);!f.isEmpty(e);){var n=i.getExn(f.pop(e));if(i.isNone(n.proof)){var o=m(n);void 0!==o&&(n.proof=o,n.children.forEach((function(r){f.add(e,r)})))}}}}}(r),o?void(r.proof=t):void 0):void 0}},t.pnIsInvalidFloating=function(r){return r.isInvalidFloating},t.pnSetInvalidFloating=function(r){r.isInvalidFloating=!0},t.pnGetDist=function(r){return r.dist},t.pnSetDist=function(r,t){r.dist=t},t.pnGetDbg=function(r){return r.pnDbg},t.jstfEqSrc=function(r,t,e){if("object"!=typeof e)return!1;if("Assertion"!==e.TAG)return!1;var n=e.frame;if(t!==n.label)return!1;var i=e.args,a=r.length,s=n.hyps.length;if(a>s)return!1;for(var u=0,f=0,c=!0;c&&u<a&&f<s;)"F"===n.hyps[f].typ||(c=o.exprEq(r[u],i[f].expr),u=u+1|0),f=f+1|0;for(;c&&f<s;)"F"===n.hyps[f].typ?f=f+1|0:c=!1;return!(!c||u!==a)&&f===s},t.ptPrintStats=function(r){var t=a.toArray(r.nodes).map((function(r){return r[1]})),e=t.length;console.log("nodeCnt",e);var o=t.filter((function(r){return i.isSome(r.proof)})).length;console.log("provedNodeCnt",o,n.floatToPctStr(o/e));var s=t.filter((function(r){return r.isInvalidFloating})).length;console.log("invalidFloatingCnt",s,n.floatToPctStr(s/e));var u=r.ptDbg;if(void 0===u)return"Debug is off";var f=t.filter((function(r){return!!i.isNone(r.proof)&&!r.isInvalidFloating}));return d.sortInPlaceWith(f,(function(r,t){return r.expr.length-t.expr.length|0})),f.map((function(r){return r.expr})).map(u.exprToStr).join("\n")}},1717:(r,t,e)=>{var n=e(6253),o=e(5291),i=e(3333),a=e(6517),s=e(2815),u=e(9775),f=e(2423),c=e(368),d=e(6601);function v(r,t){var e=function(r){var e=s.get(t,f.pnGetExpr(r));if(void 0!==e)return e;throw{RE_EXN_ID:o.MmException,_1:{msg:"exprSrcToDto: cannot get idx by expr."},Error:new Error}};if("object"!=typeof r)return"VarType";switch(r.TAG){case"Hypothesis":return{TAG:"Hypothesis",label:r.label};case"Assertion":return{TAG:"Assertion",args:r.args.map(e),label:r.frame.label};case"AssertionWithErr":return{TAG:"AssertionWithErr",args:r.args.map(e),label:r.frame.label,err:r.err}}}function l(r,t){if("object"!=typeof r)return"object"!=typeof t?0:-1;if("Hypothesis"===r.TAG){if("object"!=typeof t)return 1;switch(t.TAG){case"Hypothesis":return n.string_compare(r.label,t.label);case"Assertion":case"AssertionWithErr":return-1}}if("object"!=typeof t)return 1;switch(t.TAG){case"Hypothesis":return 1;case"Assertion":case"AssertionWithErr":return n.string_compare(r.label,t.label)}}function m(r,t,e){return f.ptGetAllSyntaxProofs(r).map((function(r){var n,i=s.get(t,f.pnGetExpr(r[1]));if(void 0===i)throw{RE_EXN_ID:o.MmException,_1:{msg:"Could not convert proofNode to proofNodeDto for a syntax proof."},Error:new Error};return n=e[i],[r[0],n]}))}t.proofTreeToDto=function(r,t){var e=function(r,t){var e=d.make();f.ptGetAllSyntaxProofs(r).forEach((function(r){d.push(e,r[1])})),t.forEach((function(t){d.push(e,f.ptGetNode(r,t))}));for(var n=u.make(100,i.ExprHash),o=s.make(100,i.ExprHash),c=function(r){"object"==typeof r&&"Hypothesis"!==r.TAG&&r.args.forEach((function(r){d.push(e,r)}))};!d.isEmpty(e);){var v=a.getExn(d.pop(e)),l=f.pnGetExpr(v);u.has(n,l)||(u.add(n,l),s.set(o,l,s.size(o)),f.pnGetEParents(v).forEach(c),a.forEach(f.pnGetProof(v),c))}return o}(r,t),n=new Array(s.size(e));return s.forEach(e,(function(t,o){n[o]=function(r,t){return{expr:f.pnGetExpr(r),parents:f.pnGetEParents(r).map((function(r){return v(r,t)})).toSorted(l),proof:a.map(f.pnGetProof(r),(function(r){return v(r,t)})),dbg:a.map(f.pnGetDbg(r),(function(r){return{exprStr:r.exprStr}}))}}(f.ptGetNode(r,t),e)})),{newVars:f.ptGetCopyOfNewVars(r),nodes:n,syntaxProofs:m(r,e,n),dbg:a.map(f.ptGetDbg(r),(function(r){return{newVars:r.newVars}}))}},t.createProofTable=function(r,t,e,n){var u=void 0!==e&&e;if(u&&a.isNone(n))throw{RE_EXN_ID:o.MmException,_1:{msg:"Error in createProofTable: ctx must be set when essentialsOnly == true."},Error:new Error};var f=function(r,t){if(!(u&&r.length>0))return r;var e=[];return i.getFrameExn(a.getExn(n),t).hyps.forEach((function(t,n){"E"!==t.typ||e.push(r[n])})),e},d=s.make(64,i.ExprHash),v=[],l=function(r,t){if(a.isSome(s.get(d,r)))throw{RE_EXN_ID:o.MmException,_1:{msg:"getIdxByExpr(expr)->Belt_Option.isSome in createProofTable()."},Error:new Error};v.push({expr:r,proof:t});var e=v.length-1|0;s.set(d,r,e)};return c.traverseTree(void 0,t,(function(t,e){var n=e.proof;if(void 0===n)throw{RE_EXN_ID:o.MmException,_1:{msg:"Cannot create proofTable from an unproved proofNodeDto [1]."},Error:new Error};if("object"!=typeof n)throw{RE_EXN_ID:o.MmException,_1:{msg:"VarType is not supported in createProofTable [1]."},Error:new Error};switch(n.TAG){case"Hypothesis":return;case"Assertion":return f(n.args,n.label).map((function(t){return r.nodes[t]}));case"AssertionWithErr":throw{RE_EXN_ID:o.MmException,_1:{msg:"AssertionWithErr is not supported in createProofTable [1]."},Error:new Error}}}),void 0,void 0,(function(t,e){var n=e.proof;if(void 0===n)throw{RE_EXN_ID:o.MmException,_1:{msg:"Cannot create proofTable from an unproved proofNodeDto [2]."},Error:new Error};if("object"!=typeof n)throw{RE_EXN_ID:o.MmException,_1:{msg:"VarType is not supported in createProofTable [2]."},Error:new Error};switch(n.TAG){case"Hypothesis":a.isNone(s.get(d,e.expr))&&l(e.expr,{TAG:"Hypothesis",label:n.label});break;case"Assertion":var i=n.label;a.isNone(s.get(d,e.expr))&&l(e.expr,{TAG:"Assertion",args:f(n.args,i).map((function(t){var e=r.nodes[t].expr,n=s.get(d,e);if(void 0!==n)return n;throw{RE_EXN_ID:o.MmException,_1:{msg:"Could not determine idx by expr in createProofTable()."},Error:new Error}})),label:i});break;case"AssertionWithErr":throw{RE_EXN_ID:o.MmException,_1:{msg:"AssertionWithErr is not supported in createProofTable [2]."},Error:new Error}}})),v}},9702:(r,t,e)=>{var n=e(5291),o=e(4923),i=e(2971),a=e(3333),s=e(1094),u=e(6517),f=e(303),c=e(5047),d=e(1725);function v(r){return r.TAG,r.expr}function l(r,t){return v(r.nodes[t])}function m(r,t,e,n,i){var a=t,s=n,u=r.length,f=e.length;if(u<(t+i|0)||f<(n+i|0))return!1;for(var c=(t+i|0)-1|0;a<=c&&o.equal(r[a],e[s]);)s=s+1|0,a=a+1|0;return a>c}var p=u.getExn("Z".codePointAt(0)),h=u.getExn("A".codePointAt(0)),E=h-1|0,x=u.getExn("T".codePointAt(0)),g=u.getExn("U".codePointAt(0)),y=g-1|0;function _(r){for(var t=r.length,e=[],n=0,o=0;o<t;){var i=u.getExn(r.codePointAt(o));i===p?(e.push("Z"),n=o=o+1|0):h<=i&&i<=x?(e.push(r.substring(n,o+1|0)),n=o=o+1|0):o=o+1|0}return e}function T(r){return r<=x?r-E|0:r-y|0}function b(r){for(var t=0,e=1,n=r.length,o=n-2|0;o>=0;--o)t=t+Math.imul(e,T(u.getExn(r.codePointAt(o))))|0,e=Math.imul(e,5);return Math.imul(t,20)+T(u.getExn(r.codePointAt(n-1|0)))|0}function A(r,t,e){var n={contents:void 0};return s.forEach(t,(function(t,o){if(u.isNone(n.contents))return f.forEach(o,(function(o){if(u.isNone(n.contents))for(var i=r[t],a=i.length-1|0,s=r[o],f=s.length-1|0,c=1;c<=a;++c)if(u.isNone(n.contents)){var d=i[c];if(d>=0)for(var v=1;v<=f;++v)if(u.isNone(n.contents)){var l=s[v];l>=0&&(d===l?n.contents={TAG:"DisjCommonVar",frmVar1:t,expr1:i.slice(1,a+1|0),frmVar2:o,expr2:s.slice(1,f+1|0),commonVar:d}:e(d,l)||(n.contents={TAG:"Disj",frmVar1:t,expr1:i.slice(1,a+1|0),var1:d,frmVar2:o,expr2:s.slice(1,f+1|0),var2:l}))}}}))})),n.contents}function k(r,t,e,o){var s=r.nodes.length;if(s<t.numOfArgs)throw{RE_EXN_ID:n.MmException,_1:{msg:"stackLength < numOfArgs"},Error:new Error};var u=function(r,t){var e=new Array(t.numOfVars),o=i.make(t.numOfVars,!1),a=r.nodes.length-t.numOfArgs|0;if(t.hyps.forEach((function(t,i){if("F"===t.typ){var s=t.expr[0],u=t.expr[1];if(o[u])throw{RE_EXN_ID:n.MmException,_1:{msg:"subsLock[v]"},Error:new Error};var f=l(r,a+i|0);if(f.length<2)throw{RE_EXN_ID:n.MmException,_1:{msg:"subsExpr->Array.length < 2"},Error:new Error};if(f[0]!==s)throw{RE_EXN_ID:n.MmException,_1:{msg:"subsExpr[0] != t"},Error:new Error};o[u]=!0,e[u]=f}})),o.some((function(r){return!r})))throw{RE_EXN_ID:n.MmException,_1:{msg:"subsLock->Array.some(lock => !lock)"},Error:new Error};return e}(r,t),f=A(u,t.disj,o);if(void 0!==f){var v=d.unifErrToStr(f,(function(r){return a.ctxIntsToStrExn(e,r)}),(function(r){return a.frmIntsToStrExn(e,t,r)}));throw{RE_EXN_ID:n.MmException,_1:{msg:"Disjoint verification failed: "+v},Error:new Error}}!function(r,t,e){var o=r.nodes.length-t.numOfArgs|0;t.hyps.forEach((function(t,i){if("E"===t.typ&&!function(r,t,e){for(var n=0,o=0,i=!0,a=r.length,s=e.length;i&&n<a&&o<s;){var u=r[n];if(u<0)i=u===e[o],o=o+1|0;else{var f=t[u],c=f.length-1|0;i=m(f,1,e,o,c),o=o+c|0}n=n+1|0}return!(!i||n!==a)&&o===s}(t.expr,e,l(r,o+i|0)))throw{RE_EXN_ID:n.MmException,_1:{msg:"!compareExprAfterSubstitution(ess, subs, stack->stGetExpr(baseIdx+i))"},Error:new Error}}))}(r,t,u);var p=function(r,t){var e={contents:0};r.forEach((function(r){e.contents=r<0?e.contents+1|0:(e.contents+t[r].length|0)-1|0}));for(var n=new Array(e.contents),o=0,i=0;i<e.contents;){var a=r[o];if(a<0)n[i]=a,i=i+1|0;else{var s=t[a],u=s.length-1|0;c.copySubArray(s,1,n,i,u),i=i+u|0}o=o+1|0}return n}(t.asrt,u),h={TAG:"Calculated",id:r.nextId,args:r.nodes.slice(s-t.numOfArgs|0),asrtLabel:t.label,expr:p,dbg:a.isDebug(e)?{exprStr:a.ctxIntsToStrExn(e,p)}:void 0};r.nextId=r.nextId+1|0;for(var E=1,x=t.numOfArgs;E<=x;++E)r.nodes.pop();r.nodes.push(h)}t.proofNodeGetId=function(r){return r.id},t.proofNodeGetExpr=v,t.verifyProof=function(r,t,e,o){var s,u={nextId:0,nodes:[]};if("Uncompressed"===e.TAG?function(r,t,e,o){e.forEach((function(e){var i=a.getHypothesis(r,e);if(void 0!==i)return t.nodes.push({TAG:"Hypothesis",id:t.nextId,hypLabel:i.label,expr:i.expr,dbg:a.isDebug(r)?{exprStr:a.ctxIntsToStrExn(r,i.expr)}:void 0}),void(t.nextId=t.nextId+1|0);var s=a.getFrame(r,e);if(void 0!==s)return k(t,s,r,o);throw{RE_EXN_ID:n.MmException,_1:{msg:"The proof step '"+e+"' doesn't refer to a hypothesis or assertion (in uncompressed proof)."},Error:new Error}}))}(r,u,e.labels,o):function(r,t,e,o,s,u){var f=function(r){o.nodes.push({TAG:"Hypothesis",id:o.nextId,hypLabel:r.label,expr:r.expr,dbg:a.isDebug(e)?{exprStr:a.ctxIntsToStrExn(e,r.expr)}:void 0}),o.nextId=o.nextId+1|0},c=_(t),d=a.getMandHyps(e,r,void 0,void 0),v=d.length,l=v+u.length|0,m=[];i.forEach(c,(function(r){if("Z"!==r){var t=b(r);if(t<1)throw{RE_EXN_ID:n.MmException,_1:{msg:"Unexpected condition when applying compressed proof: i < 1."},Error:new Error};if(t<=v)return f(d[t-1|0]);if(t<=l){var c=u[(t-v|0)-1|0],p=a.getHypothesis(e,c);if(void 0!==p)return f(p);var h=a.getFrame(e,c);if(void 0!==h)return k(o,h,e,s);throw{RE_EXN_ID:n.MmException,_1:{msg:"The proof step '"+c+"' doesn't refer to a hypothesis or assertion (in compressed proof)."},Error:new Error}}var E=i.get(m,(t-l|0)-1|0);if(void 0===E)throw{RE_EXN_ID:n.MmException,_1:{msg:"Compressed proof refers to a saved step by the index which is out of bounds."},Error:new Error};o.nodes.push(E)}else{var x=o.nodes.length;if(0===x)throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot execute 'Z' command because the stack is empty."},Error:new Error};m.push(o.nodes[x-1|0])}}))}(t,e.compressedProofBlock,r,u,o,e.labels),1!==u.nodes.length)throw{RE_EXN_ID:n.MmException,_1:{msg:"stack->Array.length is "+String(u.nodes.length)+" but must be 1."},Error:new Error};if(!a.exprEq(l(u,0),t))throw{RE_EXN_ID:n.MmException,_1:{msg:"stack[0] != expr\nstack[0] is '"+(s=l(u,0),a.ctxIntsToStrExn(r,s)+"'\nexpr is     '"+function(t){return a.ctxIntsToStrExn(r,t)}(t)+"'")},Error:new Error};return u.nodes[0]},t.compressedProofBlockToArray=_,t.compressedProofStrToInt=b,t.intToCompressedProofStr=function(r){if(r<1)throw{RE_EXN_ID:n.MmException,_1:{msg:"intToCompressedProofStr: i < 1"},Error:new Error};for(var t=[String.fromCharCode(h+(r-1|0)%20|0)],e=(r-1|0)/20|0;e>0;)t.push(String.fromCharCode(g+(e-1|0)%5|0)),e=(e-1|0)/5|0;return t.reverse(),t.join("")},t.verifyDisjoints=A},9592:(r,t,e)=>{var n=e(5291),o=e(4923),i=e(2971),a=e(3333),s=e(6517),u=e(7175),f=e(6705),c=e(2423),d=e(5082),v=e(7659),l=e(4792),m=e(1874),p=e(5650),h=e(5981),E=e(5047),x=e(7653),g=e(3053);function y(r){switch(r){case"Less":return"Less";case"LessEq":return"LessEq";case"No":return"No";default:return}}function _(r,t){if(c.ptIsNewVarDef(r,t))return"VarType";var e=c.ptGetHypByExpr(r,t);return void 0!==e?{TAG:"Hypothesis",label:e.label}:void 0}function T(r,t,e,o,i){var u=t.length;m.frmsForEach(c.ptGetFrms(r),t[0],(function(f){if(a.frameIsAllowed(f.frame,o)){var d=f.frame.asrt;m.iterateSubstitutions(d,t,f.frmConstParts[f.numOfHypsE],f.constParts[f.numOfHypsE],f.varGroups[f.numOfHypsE],f.subs,c.ptGetParenCnt(r),(function(t){if(t.isDefined.every((function(r){return r}))&&s.isNone(m.verifyDisjoints(f.frame.disj,t,(function(t,e){return c.ptIsDisjInCtx(r,t,e)}),0))){for(var o=f.frame.hyps,a=o.length,d=new Array(a),v=!0,l=0,p=a-1|0;l<=p&&v;){var h,E=m.applySubs(o[l].expr,t,(function(r){throw{RE_EXN_ID:n.MmException,_1:{msg:"Work variables are not supported in findAsrtParentsWithoutNewVars()."},Error:new Error}}));switch(e){case"No":h=!0;break;case"LessEq":h=E.length<=u;break;case"Less":h=E.length<u}if(v=h){var x=c.ptGetNode(r,E);d[l]=x,v=!c.pnIsInvalidFloating(x)}l=l+1|0}v&&i({TAG:"Assertion",args:d,frame:f.frame})}return"Continue"}))}}))}function b(r,t,e,o){if(s.isNone(c.pnGetProof(t))&&!c.pnIsInvalidFloating(t)){n.arrayQueueReset(o);var i=v.make(128),a=function(r){if(void 0===c.pnGetProof(r)){var t=c.pnGetId(r);return v.has(i,t)?void 0:(v.add(i,t),n.arrayQueueAdd(o,r))}},u=function(r){"object"==typeof r&&"Assertion"===r.TAG&&r.args.forEach(a)},f=function(){for(var r=n.arrayQueuePop(o);s.mapWithDefault(r,!1,(function(r){return!!s.isSome(c.pnGetProof(r))||c.pnIsInvalidFloating(r)}));)r=n.arrayQueuePop(o);return r};a(t);for(var d={contents:!1},l=f();s.isNone(c.pnGetProof(t))&&s.isSome(l);){var m=s.getExn(l),p=c.pnGetFParents(m);if(void 0!==p)p.forEach(u);else{var h=c.pnGetExpr(m),E=_(r,h);void 0!==E?c.pnAddParent(m,E,!1,!1):(d.contents=!1,T(r,h,"LessEq",e,function(r){return function(t){c.pnAddParent(r,t,!1,!1),u(t),d.contents=!0}}(m)),d.contents||c.pnSetInvalidFloating(m))}l=f()}return s.isNone(c.pnGetProof(t))?c.pnSetInvalidFloating(t):void 0}}function A(r,t,e,o,i,u,d,v,l,p,E,x,g){var y=void 0!==E?E:0,_=n.arrayQueueMake(1e3),T=[],A=s.isSome(x),k=s.getWithDefault(x,0),S=c.ptGetMaxVar(r);f.applyAssertions(S,c.ptGetFrms(r),v,(function(r){return a.frameIsAllowed(r,l.inEssen)}),(function(t,e){return c.ptIsDisjInCtx(r,t,e)}),e,o,i,u,t,c.ptGetParenCnt(r),d,p,(function(r){T.push(r);var t=T.length;return void 0!==g&&t%100==0&&g(t),A&&t>=k?"Stop":"Continue"}),y,void 0);var w=[];return T.forEach((function(t){var e=t.frame,o=t.err,i=0;if(void 0!==o&&"object"==typeof o)switch(o.TAG){case"NoUnifForAsrt":case"NoUnifForArg":case"NewVarsAreDisabled":i=1;break;case"TooManyCombinations":return void w.push({TAG:"AssertionWithErr",args:[],frame:e,err:s.getExn(t.err)});default:i=2}else i=2;switch(i){case 1:return 0!==y?void w.push({TAG:"AssertionWithErr",args:[],frame:e,err:s.getExn(t.err)}):void 0;case 2:var a=h.make();t.newVars.forEach((function(e,n){var o=t.newVarTypes[n],i=c.ptAddNewVar(r,o);h.set(a,e,i)}));for(var u,f=e.hyps.length,d=new Array(f),v=0,p=f-1|0;v<=p&&(s.isNone(u)||0!==y);){for(var E=m.applySubs(e.hyps[v].expr,t.subs,(function(r){throw{RE_EXN_ID:n.MmException,_1:{msg:"New work variables are not expected here [findAsrtParentsWithNewVars]."},Error:new Error}})),x=E.length-1|0,g=0;g<=x;++g){var T=E[g];if(T>S){var A,k=h.get(a,T);if(void 0===k)throw{RE_EXN_ID:n.MmException,_1:{msg:"Could not replace an applVar with a treeVar."},Error:new Error};A=k,E[g]=A}}var C=c.ptGetNode(r,E);d[v]=C,"F"===e.hyps[v].typ&&s.isNone(t.err)&&s.isNone(u)&&(b(r,C,l.inSyntax,_),s.isNone(c.pnGetProof(C))&&(u=c.pnGetExpr(C))),v=v+1|0}var I=void 0!==t.err?t.err:s.map(u,(function(r){return{TAG:"UnprovedFloating",expr:r}}));return void 0!==I?0!==y?void w.push({TAG:"AssertionWithErr",args:d,frame:e,err:I}):void 0:void w.push({TAG:"Assertion",args:d,frame:e})}})),w}function k(r,t){return"object"==typeof t&&"Assertion"===t.TAG&&t.args.some((function(t){return a.exprEq(r,c.pnGetExpr(t))}))}function S(r,t,e){return void 0!==r?r<=t&&(void 0===e||t<=e):void 0===e||t<=e}function w(r,t,e){return void 0===t||t.some((function(t){if(!t.matchAsrt)return!0;var n=t.frm;if(r[0]!==n.frame.asrt[0])return!1;var o={contents:!1};return m.iterateSubstitutions(n.frame.asrt,r,n.frmConstParts[n.numOfHypsE],n.constParts[n.numOfHypsE],n.varGroups[n.numOfHypsE],n.subs,e,(function(r){return o.contents=!0,"Stop"})),o.contents}))}function C(r,t,e,o,a,f,d,v){void 0!==o?function(r,t,e,o,a,u,f){(function(r,t,e,o,i){var a=p.make(),u=String(o),f=x.progressTrackerMake(.01,void 0,(function(r){}),void 0);c.ptClearDists(r);var d=c.ptGetNode(r,t);c.pnSetDist(d,0),p.add(a,d);for(var v=0,l=1,m=0,h=s.map(i,(function(r){return function(t){r("Proving bottom-up: 0/"+u+" "+String(t))}}));s.isNone(c.pnGetProof(d))&&!p.isEmpty(a);){var E=s.getExn(p.pop(a));if(s.isNone(c.pnGetProof(E))){var g,y=c.pnGetDist(E);if(void 0===y)throw{RE_EXN_ID:n.MmException,_1:{msg:"Encountered a node without dist."},Error:new Error};if(g=y,void 0!==i){if(v!==g){h=void 0,v=g;var T=String(g);f=x.progressTrackerMake(.01,void 0,function(r){return function(t){var e=String(0|Math.round(100*t));i("Proving bottom-up: "+r+"/"+u+" "+e+"%")}}(T),void 0),l=p.size(a)+1|0,m=0}x.progressTrackerSetCurrPct(f,m/l),m=m+1|0}var b=c.pnGetExpr(E),A=_(r,b);if(void 0!==A)c.pnAddParent(E,A,!0,!1);else{var S=g+1|0;S<=o&&e(b,g,h).forEach(function(r,t,e){return function(n){k(t,n)||(c.pnAddParent(r,n,!0,!1),"object"==typeof n&&"Assertion"===n.TAG&&n.args.forEach((function(r){if(s.isNone(c.pnGetProof(r))&&s.isNone(c.pnGetDist(r)))return c.pnSetDist(r,e),p.add(a,r)})))}}(E,b,S))}}}})(r,t,(function(t,n,s){for(var f=[],d=0,v=e.frameParams.length;d<v;++d){var l=e.frameParams[d];if(S(l.minDist,n,l.maxDist)&&w(t,l.matches,c.ptGetParenCnt(r))){var m,p=A(r,t,l.args,!1,l.allowNewStmts,l.allowNewVars,l.allowNewDisjForExistingVars,l.frmsToUse,o,a,u,l.maxNumberOfBranches,s),h=0;switch(l.lengthRestrict){case"No":m=p;break;case"LessEq":case"Less":h=1}if(1===h){var E=t.length;m=p.filter(function(r,t){return function(e){if("object"!=typeof e)return!0;if("Assertion"!==e.TAG)return!0;for(var n=e.frame,o=e.args,i=!0,a=n.hyps.length-1|0,s=0;s<=a&&i;){var u=o[s];if("E"===n.hyps[s].typ){var f;switch(r.lengthRestrict){case"No":f=!0;break;case"LessEq":f=c.pnGetExpr(u).length<=t;break;case"Less":f=c.pnGetExpr(u).length<t}i=f}s=s+1|0}return i}}(l,E))}var x=l.matches,y=void 0!==x?m.filter(function(e){return function(n){return e.some((function(e){return g.exprSrcMatches(t,n,e,c.ptGetParenCnt(r))}))}}(x)):m;f.push(y)}}return i.concatMany(f)}),e.maxSearchDepth,f),c.ptGetNode(r,t)}(r,t,o,a,f,d,v):void 0!==e?function(r,t,e,n,o){var i=function(i,a){return A(r,t,i,!0,!1,!1,!1,[e.label],n,o,a,void 0,void 0)},a=c.ptGetNode(r,t),f=function(r,t){var e=t.args.map((function(t){var e=c.ptGetRootStmts(r).find((function(r){return r.label===t}));if(void 0!==e)return e.expr;var n=c.ptGetHypByLabel(r,t);return void 0!==n?n.expr:void 0})).filter(s.isSome).map(s.getExn);if(e.length===t.args.length)return e}(r,e);void 0!==f&&s.getWithDefault(s.map(c.pnGetProof(a),(function(r){return!c.jstfEqSrc(f,e.label,r)})),!0)&&(E.arrForEach(i(f,0),(function(r){var t=c.jstfEqSrc(f,e.label,r);if(c.pnAddParent(a,r,!0,t),t)return u.some(void 0)})),s.isNone(c.pnGetProof(a))&&E.arrForEach(i(f,2),(function(r){var t=c.jstfEqSrc(f,e.label,r);if(c.pnAddParent(a,r,!0,t),t)return u.some(void 0)})))}(r,t,e,a,f):function(r,t,e,n){var o=c.ptGetNode(r,t);if(s.isNone(c.pnGetProof(o))){var i=A(r,t,c.ptGetRootStmts(r).map((function(r){return r.expr})),!1,!1,!1,!1,void 0,e,n,void 0,void 0,void 0);E.arrForEach(i,(function(r){return c.pnAddParent(o,r,!0,!1),c.pnGetProof(o)}))}}(r,t,a,f)}function I(r,t,e){var n=a.getNumOfVars(r)-1|0,o=a.getAllHyps(r),i=c.ptMake(t,o,n,a.getAllDisj(r),e,function(r,t){if(a.isDebug(r)){var e=function(e){return e<=t?a.ctxIntToSymExn(r,e):"&"+String(e)};return function(r){return r.map(e).join(" ")}}}(r,n));return d.forEach(o,(function(r,t){if("E"===t.typ){var e=c.ptGetNode(i,t.expr);c.pnAddParent(e,{TAG:"Hypothesis",label:r},!0,!1),c.ptAddRootStmt(i,{isHyp:!0,label:r,expr:t.expr,jstf:void 0})}})),i}function M(r,t,e,o,i,a,f,d){if(s.isNone(r)&&(s.isNone(t)||s.isNone(e)||s.isNone(i)))throw{RE_EXN_ID:n.MmException,_1:{msg:"Either proofTree or (wrkCtx and frms and parenCnt) should be passed."},Error:new Error};var v=x.progressTrackerMake(.01,void 0,d,void 0),l=void 0!==r?u.valFromOption(r):I(s.getExn(t),s.getExn(e),s.getExn(i));if(0===f.length)return l;for(var m=n.arrayQueueMake(1e3),p=f[0],h=0,E=a.length;h<E;++h){var g=a[h],y=c.ptGetNode(l,[p].concat(g));b(l,y,o,m);for(var _=0;s.isNone(c.pnGetProof(y))&&_<f.length;){var T=f[_];_=_+1|0,T!==p&&b(l,y=c.ptGetNode(l,[T].concat(g)),o,m)}void 0!==c.pnGetProof(y)&&(c.ptAddSyntaxProof(l,g,y),p=c.pnGetExpr(y)[0]),x.progressTrackerSetCurrPct(v,(h+1|0)/a.length)}return l}function j(r,t){var e=a.createContext(u.some(r),void 0);return t.forEach((function(t){if(t.isHyp)return a.applySingleStmt(e,{TAG:"Essential",label:t.label,expr:a.ctxIntsToSymsExn(r,t.expr)},void 0,void 0,void 0,void 0)})),e}function D(r,t,e){return r.slice(t,e).sort()}function G(r,t,e,n){return o.equal(D(r,e,n),D(t,e,n))}t.bottomUpProverParamsMakeDefault=function(r,t,e,n,o,i,a,u,f){var c=void 0!==e?e:"Less",d=void 0===n||n,v=void 0===o||o,l=void 0!==i&&i,m=void 0!==a?a:[],p=void 0!==u?u:[];return{maxSearchDepth:void 0!==t?t:4,frameParams:[{minDist:0,maxDist:0,frmsToUse:s.map(r,(function(r){return[r]})),matches:void 0,args:m,allowNewDisjForExistingVars:d,allowNewStmts:v,allowNewVars:l,lengthRestrict:"No",maxNumberOfBranches:f},{minDist:1,maxDist:void 0,frmsToUse:void 0,matches:void 0,args:p,allowNewDisjForExistingVars:d,allowNewStmts:v,allowNewVars:!1,lengthRestrict:c,maxNumberOfBranches:f}]}},t.lengthRestrictToStr=function(r){switch(r){case"No":return"No";case"LessEq":return"LessEq";case"Less":return"Less"}},t.lengthRestrictFromStr=y,t.lengthRestrictFromStrExn=function(r){var t=y(r);if(void 0!==t)return t;throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot convert '"+r+"' to lengthRestrict."},Error:new Error}},t.createProofCtx=j,t.proveFloatings=function(r,t,e,o,i){var a=I(r,t,i),s=n.arrayQueueMake(1e3);return o.forEach((function(r){b(a,c.ptGetNode(a,r),e,s)})),a},t.proveSyntaxTypes=M,t.unifyAll=function(r,t,e,o,i,a,f,d,v,l,m){var p=void 0!==l?l:0,h=x.progressTrackerMake(.01,void 0,s.map(m,(function(r){return function(t){r("Unifying all: "+n.floatToPctStr(t))}})),void 0),E=I(j(r,e),t,o);void 0!==d&&d.length>0&&void 0!==v&&M(u.some(E),void 0,void 0,a.inSyntax,void 0,v,d,s.map(m,(function(r){return function(t){r("Checking syntax: "+n.floatToPctStr(t))}})));var g=e.filter((function(r){return!r.isHyp})),y=g.length,_=y-1|0;return g.forEach((function(r,t){C(E,r.expr,r.jstf,t===_?i:void 0,a,f,p,t!==_||s.isNone(i)?void 0:m),c.ptAddRootStmt(E,r),x.progressTrackerSetCurrPct(h,(t+1|0)/y)})),E},t.makeParenCnt=function(r,t){var e=a.ctxGetOptimizedConstsOrder(r,t),i=e.canBeLastMax,s=e.canBeLastMin,u=e.canBeFirstMax,f=e.canBeFirstMin,c=e.parenMin,d=e.allConsts,v=a.getAllConsts(r);if(d.length!==v.length)throw{RE_EXN_ID:n.MmException,_1:{msg:"allConsts.length != allConstsActual.length"},Error:new Error};if(c<0&&o.notequal(d.slice(0,0|-c),v.slice(0,0|-c)))throw{RE_EXN_ID:n.MmException,_1:{msg:"allConsts.parens != allConstsActual.parens"},Error:new Error};if(f<=u&&!G(d,v,(0|-u)-1|0,0|-f))throw{RE_EXN_ID:n.MmException,_1:{msg:"allConsts.canBeFirst != allConstsActual.canBeFirst"},Error:new Error};if(s<=i&&!G(d,v,(0|-i)-1|0,0|-s))throw{RE_EXN_ID:n.MmException,_1:{msg:"allConsts.canBeLast != allConstsActual.canBeLast"},Error:new Error};if(!G(d,v,0,d.length))throw{RE_EXN_ID:n.MmException,_1:{msg:"allConsts.remaining != allConstsActual.remaining"},Error:new Error};return l.parenCntMake(c,f,u,s,i)}},5090:(r,t,e)=>{var n=e(4923);t.jstfEq=function(r,t){return r.label===t.label&&n.equal(r.args,t.args)},t.jstfToStr=function(r){return(r.args.join(" ")+" : "+r.label).trim()}},1874:(r,t,e)=>{var n=e(2971),o=e(3333),i=e(1094),a=e(6517),s=e(303),u=e(7356),f=e(4792),c=e(2275),d=e(8615),v=e(5047);function l(r,t,e){return r<0?t[0][0]:r<(t.length-1|0)?(t[r+1|0][0]-t[r][1]|0)-1|0:(e-t[r][1]|0)-1|0}function m(r,t,e){return r<0?t.begins[0]:r<(t.length-1|0)?(t.begins[r+1|0]-t.ends[r]|0)-1|0:(e-t.ends[r]|0)-1|0}function p(r){for(var t=[],e=0,n=r.length;e<n;++e){var o=t.length;r[e]<0?(0===o||t[o-1|0][1]>=0)&&t.push([e,-1]):o>0&&t[o-1|0][1]<0&&(t[o-1|0][1]=e-1|0)}var i=t.length,a=r.length;i>0&&t[i-1|0][1]<0&&(t[i-1|0][1]=a-1|0);for(var s=new Array(i),u=new Array(i),f=new Array(i),c={length:i,begins:s,ends:u,remainingMinLength:f},d=0,v=i-1|0;v>=0;--v)s[v]=t[v][0],u[v]=t[v][1],d=(d+(1+(u[v]-s[v]|0)|0)|0)+l(v,t,a)|0,f[v]=d;return c}function h(r){return{length:r.length,begins:new Array(r.length),ends:new Array(r.length),remainingMinLength:[]}}function E(r,t,e,n,o,i,s){var u=function(){return E(r,t,e,n,o+1|0,i,s)},c=t.length,d=r.length;if(c<d)return"Continue";if(o===e.length){if(e.length<=0)return f.parenCntCanBeFirst(i,t[0])&&f.parenCntCanBeLast(i,t[c-1|0])?s(n):"Continue";if(n.ends[o-1|0]===(c-1|0))return s(n);if(e.ends[o-1|0]===(d-1|0))return"Continue";var v=m(o-1|0,e,d);if(m(o-1|0,n,c)<v)return"Continue";if(!f.parenCntCanBeFirst(i,t[n.ends[o-1|0]+1|0])||!f.parenCntCanBeLast(i,t[c-1|0]))return"Continue";f.parenCntReset(i);for(var l="Balanced",p=n.ends[o-1|0]+1|0;p<c&&"Failed"!==l;)l=f.parenCntPut(i,t[p]),p=p+1|0;return"Balanced"===l?s(n):"Continue"}if(0===o&&0===e.begins[0]){if((c-1|0)<e.ends[0])return"Continue";for(var h,x=e.ends[0],g=0;a.isNone(h)&&g<=x;)r[g]!==t[g]&&(h="Continue"),g=g+1|0;return void 0!==h?h:x===(c-1|0)||f.parenCntCanBeFirst(i,t[x+1|0])?(n.begins[0]=0,n.ends[0]=x,u()):"Continue"}var y=0===o?0:n.ends[o-1|0]+1|0,_=c-e.remainingMinLength[o]|0;f.parenCntReset(i);for(var T="Balanced",b=m(o-1|0,e,d),A=1;A<=b;++A)T=f.parenCntPut(i,t[y]),y=y+1|0;for(var k=1+(e.ends[o]-e.begins[o]|0)|0,S="Continue";y<=_&&"Failed"!==T&&"Continue"===S;){if("Balanced"===T){for(var w=0,C=!0;w<k&&C;)C=r[e.begins[o]+w|0]===t[y+w|0],w=w+1|0;var I=(y+k|0)-1|0;w===k&&C&&f.parenCntCanBeLast(i,t[y-1|0])&&(I===(c-1|0)||f.parenCntCanBeFirst(i,t[I+1|0]))&&(n.begins[o]=y,n.ends[o]=I,S=u(),f.parenCntReset(i))}T=f.parenCntPut(i,t[y]),y=y+1|0}return S}function x(r,t){var e=r.length;if(0===t.length)return[{leftConstPartIdx:-1,frmExpr:r,varsBeginIdx:0,numOfVars:e,exprBeginIdx:0,exprEndIdx:0}];var n=[];0!==t.begins[0]&&n.push({leftConstPartIdx:-1,frmExpr:r,varsBeginIdx:0,numOfVars:t.begins[0],exprBeginIdx:0,exprEndIdx:0});for(var o=0,i=t.length-2|0;o<=i;++o)n.push({leftConstPartIdx:o,frmExpr:r,varsBeginIdx:t.ends[o]+1|0,numOfVars:m(o,t,e),exprBeginIdx:0,exprEndIdx:0});var a=t.length-1|0;return t.ends[a]!==(e-1|0)&&n.push({leftConstPartIdx:a,frmExpr:r,varsBeginIdx:t.ends[a]+1|0,numOfVars:m(a,t,e),exprBeginIdx:0,exprEndIdx:0}),n}function g(r,t,e,n,o,i,a,s){var u=e[n],c=u.frmExpr[u.varsBeginIdx+o|0],d=(1+(u.exprEndIdx-i|0)|0)-((u.numOfVars-o|0)-1|0)|0,v=function(f){return o<(u.numOfVars-1|0)?g(r,t,e,n,o+1|0,i+f|0,a,s):n<(e.length-1|0)?g(r,t,e,n+1|0,0,e[n+1|0].exprBeginIdx,a,s):s(t)},l="Continue";if(t.isDefined[c]){var m=t.exprs[c],p=t.begins[c],h=1+(t.ends[c]-p|0)|0;if(h<=d&&(o<(u.numOfVars-1|0)||h===d)){for(var E=0;E<h&&m[p+E|0]===r[i+E|0];)E=E+1|0;E===h&&(l=v(h))}}else{if(t.isDefined[c]=!0,t.exprs[c]=r,t.begins[c]=i,o===(u.numOfVars-1|0))t.ends[c]=u.exprEndIdx,l=v(d);else if(f.parenCntCanBeFirst(a,r[i])){var x=1,y=i;f.parenCntReset(a);for(var _="Balanced";x<=d&&"Continue"===l&&"Failed"!==_;)t.ends[c]=y,"Balanced"===(_=f.parenCntPut(a,r[y]))&&f.parenCntCanBeLast(a,r[y])&&(l=v(x),f.parenCntReset(a)),x=x+1|0,y=y+1|0}t.isDefined[c]=!1}return l}function y(r,t,e,n,i,a,s,u){if(0===a.size)return o.exprEq(r,t)?u(a):"Continue";var f=t.length,c=r.length;if(f<c||0===f||0===c)return"Continue";var d=r[c-1|0];if(d<0&&d!==t[f-1|0])return"Continue";var l=r[0];return l<0&&l!==t[0]?"Continue":E(r,t,e,n,0,s,(function(r){return i.length>0?(function(r,t,e){var n=e.length;0===t.length?(r[0].exprBeginIdx=0,r[0].exprEndIdx=n-1|0):(r.forEach((function(r){-1===r.leftConstPartIdx?(r.exprBeginIdx=0,r.exprEndIdx=t.begins[0]-1|0):r.leftConstPartIdx===(t.length-1|0)?(r.exprBeginIdx=t.ends[r.leftConstPartIdx]+1|0,r.exprEndIdx=n-1|0):(r.exprBeginIdx=t.ends[r.leftConstPartIdx]+1|0,r.exprEndIdx=t.begins[r.leftConstPartIdx+1|0]-1|0)})),v.sortInPlaceWith(r,(function(r,t){return r.numOfVars-t.numOfVars|0})))}(i,r,t),g(t,a,i,0,0,i[0].exprBeginIdx,s,u)):u(a)}))}function _(r){return{size:r,begins:n.make(r,0),ends:n.make(r,0),exprs:n.make(r,[]),isDefined:n.make(r,!1)}}function T(r){var t=r.hyps.filter((function(r){return"E"===r.typ})),e=[],n=[],o=[];t.forEach((function(r){var t=p(r.expr),i=h(t),a=x(r.expr,t);e.push(t),n.push(i),o.push(a)}));var i=p(r.asrt),a=h(i),s=x(r.asrt,i);e.push(i),n.push(a),o.push(s);var u=_(r.numOfVars);return{frame:r,hypsE:t,numOfHypsE:t.length,frmConstParts:e,constParts:n,varGroups:o,subs:u}}t.subsClone=function(r){return{size:r.size,begins:r.begins.slice(),ends:r.ends.slice(),exprs:r.exprs.slice(),isDefined:r.isDefined.slice()}},t.subsEq=function(r,t){if(r.size!==t.size||!r.isDefined.every((function(r){return r}))||!t.isDefined.every((function(r){return r})))return!1;for(var e=!0,n=0;e&&n<r.size;){var o=r.exprs[n],i=r.begins[n],a=r.ends[n],s=1+(a-i|0)|0,u=t.exprs[n],f=t.begins[n];if(s===(1+(t.ends[n]-f|0)|0))for(var c=i,d=f;e&&c<=a;)e=o[c]===u[d],c=c+1|0,d=d+1|0;else e=!1;n=n+1|0}return e},t.subsHash=function(r){if(!r.isDefined.every((function(r){return r})))return 0;for(var t=0,e=0;e<r.size;)t=v.hash2(t,v.hashArrIntFromTo(r.exprs[e],r.begins[e],r.ends[e])),e=e+1|0;return t},t.createConstParts=p,t.createMatchingConstParts=h,t.createSubs=_,t.prepareFrmSubsDataForFrame=T,t.prepareFrmSubsData=function(r){var t=v.comparatorAndThen(v.comparatorBy((function(r){return r.hypsE.length})),v.comparatorBy((function(r){return r.frame.ord}))),e=v.sortInPlaceWith(o.getAllFramesArr(r).map(T),t),n=c.make(1e3),i=u.make(16);return e.forEach((function(r){c.set(n,r.frame.label,r);var t=r.frame.asrt[0],e=u.get(i,t);return void 0!==e?void e.push(r):u.set(i,t,[r])})),{all:e,byType:i,byLabel:n}},t.sortFrames=function(r,t){var e=d.fromArray(t);return r.all.filter((function(r){return d.has(e,r.frame.label)})).map((function(r){return r.frame.label}))},t.iterateSubstitutions=y,t.applySubs=function(r,t,e){var n={contents:0};r.forEach((function(r){r<0||!t.isDefined[r]?n.contents=n.contents+1|0:n.contents=n.contents+(1+(t.ends[r]-t.begins[r]|0)|0)|0}));for(var o=new Array(n.contents),i=0,a=0;a<n.contents;){var s=r[i];if(s<0)o[a]=s,a=a+1|0;else if(t.isDefined[s]){var u=t.exprs[s],f=1+(t.ends[s]-t.begins[s]|0)|0;v.copySubArray(u,t.begins[s],o,a,f),a=a+f|0}else o[a]=e(s),a=a+1|0;i=i+1|0}return o},t.verifyDisjoints=function(r,t,e,n){var o={contents:void 0};return i.forEach(r,(function(r,i){if(a.isNone(o.contents))return s.forEach(i,(function(i){if(a.isNone(o.contents))for(var s=t.exprs[r],u=t.begins[r],f=t.ends[r],c=t.exprs[i],d=t.begins[i],v=t.ends[i],l=u;l<=f;++l)if(a.isNone(o.contents)){var m=s[l];if(m>=0)for(var p=d;p<=v;++p)if(a.isNone(o.contents)){var h=c[p];h>=0&&(m===h?o.contents=0===n?"UnifErr":{TAG:"DisjCommonVar",frmVar1:r,expr1:s.slice(u,f+1|0),frmVar2:i,expr2:c.slice(d,v+1|0),commonVar:m}:e(m,h)||(o.contents=0===n?"UnifErr":{TAG:"Disj",frmVar1:r,expr1:s.slice(u,f+1|0),var1:m,frmVar2:i,expr2:c.slice(d,v+1|0),var2:h}))}}}))})),o.contents},t.frmsEmpty=function(){return{all:[],byType:u.make(0),byLabel:c.make(0)}},t.frmsSize=function(r){return r.all.length},t.frmsForEach=function(r,t,e){return void 0!==t?a.forEach(u.get(r.byType,t),(function(r){r.forEach(e)})):void r.all.forEach(e)},t.frmsGetAll=function(r){return r.all},t.frmsGetByLabel=function(r,t){return c.get(r.byLabel,t)},t.frmsGetByType=function(r,t){return u.get(r.byType,t)},t.frmsSelect=function(r,t,e){if(void 0!==t){if(void 0!==e){var n=a.keep(c.get(r.byLabel,e),(function(r){return r.frame.asrt[0]===t}));return void 0!==n?[n]:[]}var o=u.get(r.byType,t);return void 0!==o?o.slice():[]}if(void 0===e)return r.all.slice();var i=c.get(r.byLabel,e);return void 0!==i?[i]:[]},t.frmsGetAllTypes=function(r){return u.keysToArray(r.byType)},t.frmsGetAllGroupedByLabel=function(r){return r.byLabel},t.test_iterateConstParts=function(r,t,e){var n=function(r){return r.begins.map((function(t,e){return[t,r.ends[e]]}))},o=p(r),i=h(o),a=[];return E(r,t,o,i,0,e,(function(r){return a.push(n(r)),"Continue"})),[n(o),a]},t.test_iterateSubstitutions=function(r,t,e){var n=p(r),o=h(n),i=x(r,n),a=s.size(s.fromArray(r.filter((function(r){return r>=0})))),u=_(a),f=[];return y(r,t,n,o,i,u,e,(function(r){for(var t=[],e=0;e<a;++e)t.push(r.exprs[e].slice(r.begins[e],r.ends[e]+1|0));return f.push(t),"Continue"})),f}},3591:(r,t,e)=>{var n=e(4923),o=e(2971),i=e(3333),a=e(6517),s=e(303),u=e(2761),f=e(3533),c=e(368),d=e(1717),v=e(2275),l=e(5047);function m(r){return u.reduce(r,0,(function(r,t){return Math.max(r,function(r){return"Subtree"===r.TAG?r._0.height:0}(t))}))}function p(r,t,e,n,s){var u=s.proof;if("Hypothesis"===u.TAG){for(var f=u.label,c=s.expr.length-1|0,d=r(),v=s.expr[0],l=new Array(c),h={id:d,parent:n,typ:v,label:f,children:l,height:0},E=1;E<=c;++E)l[E-1|0]={TAG:"Symbol",id:r(),parent:h,symInt:s.expr[E],sym:i.ctxIntToSymExn(t,s.expr[E]),color:void 0,isVar:s.expr[E]>=0};return{TAG:"Ok",_0:{id:d,parent:n,typ:v,label:f,children:l,height:m(l)+1|0}}}var x=u.label,g=i.getFrame(t,x);if(void 0===g)return{TAG:"Error",_0:"Cannot find a frame by label '"+x+"' in buildSyntaxTreeInner."};var y=function(r,t){var e=new Array(t.numOfVars),n=o.make(t.numOfVars,!1);if(r.length!==t.numOfArgs)return{TAG:"Error",_0:"extractVarToRecIdxMapping: args.Array.length != frame.numOfArgs"};var i={contents:void 0};t.hyps.forEach((function(t,o){if(a.isNone(i.contents)&&"F"===t.typ){var s=t.expr[1];n[s]?i.contents={TAG:"Error",_0:"extractVarToRecIdxMapping: locks[v]"}:(n[s]=!0,e[s]=r[o])}}));var s=i.contents;return void 0!==s?s:n.some((function(r){return!r}))?{TAG:"Error",_0:"extractVarToRecIdxMapping: locks->Array.some(lock => !lock)"}:{TAG:"Ok",_0:e}}(u.args,g);if("Ok"!==y.TAG)return{TAG:"Error",_0:y._0};var _=y._0,T=r(),b=g.asrt[0],A=new Array(g.asrt.length-1|0),k={id:T,parent:n,typ:b,label:x,children:A,height:0},S={contents:void 0};g.asrt.forEach((function(n,o){if(o>0&&a.isNone(S.contents))if(n<0)A[o-1|0]={TAG:"Symbol",id:r(),parent:k,symInt:n,sym:i.ctxIntToSymExn(t,n),color:void 0,isVar:!1};else{var s=p(r,t,e,k,e[_[n]]);"Ok"===s.TAG?A[o-1|0]={TAG:"Subtree",_0:s._0}:S.contents={TAG:"Error",_0:s._0}}}));var w=S.contents;return void 0!==w?w:{TAG:"Ok",_0:{id:T,parent:n,typ:b,label:x,children:A,height:m(A)+1|0}}}function h(r,t,e){var n={contents:0};return p((function(){return n.contents=n.contents+1|0,n.contents-1|0}),r,t,void 0,t[e])}function E(r,t,e){var n=t.nodes.find((function(r){return i.exprEq(r.expr,e)}));return void 0!==n?{TAG:"Ok",_0:d.createProofTable(t,n,void 0,void 0)}:{TAG:"Error",_0:"buildSyntaxProofTableFromProofTreeDto: could not find a proof for: "+i.ctxIntsToStrExn(r,e)}}function x(r,t){if(1===r.children.length){var e=r.children[0];if("Subtree"!==e.TAG){var n=e.sym;return e.isVar&&t(n)?[e.symInt,n]:void 0}}}function g(r,t){v.forEachU(t,(function(t,e){for(var n=0;n<r.length;)r[n]===t?(f.spliceObjApply(r,"splice",[n,1,e]),n=n+e.length|0):n=n+1|0}))}function y(r,t,e){if(e.includes(t))return!1;g(e,r);var o=v.get(r,t);return void 0!==o?n.equal(e,o):(v.set(r,t,e),v.forEachU(r,(function(t,e){g(e,r)})),!0)}function _(r){return l.arrFlatMap(r.children,(function(r){return"Subtree"===r.TAG?_(r._0):[r.sym]}))}function T(r,t){return c.traverseTree(void 0,r,(function(r,t){if("Subtree"===t.TAG)return t._0.children}),void 0,(function(r,e){return t(e)}),void 0)[1]}t.buildSyntaxTree=h,t.buildSyntaxProofTableFromProofTreeDto=E,t.buildSyntaxTreeFromProofTreeDto=function(r,t,e){var n=E(r,t,e);if("Ok"!==n.TAG)return{TAG:"Error",_0:n._0};var o=n._0;return h(r,o,o.length-1|0)},t.syntaxTreeToSymbols=function r(t){return o.concatMany(t.children.map((function(t){return"Subtree"===t.TAG?r(t._0):[t.sym]})))},t.syntaxTreeIsEmpty=function(r){return 0===r.children.length},t.getNodeById=function(r,t){return c.traverseTree(void 0,{TAG:"Subtree",_0:r},(function(r,t){if("Subtree"===t.TAG)return t._0.children}),void 0,(function(r,e){if(("Subtree"===e.TAG?e._0.id:e.id)===t)return e}),void 0)[1]},t.syntaxTreeForEachNode=T,t.syntaxTreeGetIdsOfAllChildSymbols=function(r){var t=[];return T(r,(function(r){"Subtree"!==r.TAG&&t.push(r.id)})),s.fromArray(t)},t.syntaxTreeToText=function(r){var t=[];return T(r,(function(r){"Subtree"!==r.TAG&&t.push(r.sym)})),t.join(" ")},t.syntaxTreeGetNumberOfSymbols=function(r){var t={contents:0};return T(r,(function(r){"Subtree"!==r.TAG&&(t.contents=t.contents+1|0)})),t.contents},t.isVar=x,t.unify=function r(t,e,n,o,i){if(t.typ===e.typ){var a=x(t,n);if(void 0!==a){var s=a[1],u=x(e,n);return void 0!==u&&s===u[1]?void 0:void(i.contents=y(o,s,_(e)))}var f=x(e,n);if(void 0===f)if(t.children.length===e.children.length)for(var c=t.children.length-1|0,d=0;i.contents&&d<=c;){var v=t.children[d];if("Subtree"===v.TAG){var l=e.children[d];"Subtree"===l.TAG?r(v._0,l._0,n,o,i):i.contents=!1}else{var m=e.children[d];"Subtree"===m.TAG?i.contents=!1:i.contents=v.sym===m.sym}d=d+1|0}else i.contents=!1;else i.contents=y(o,f[1],_(t))}else i.contents=!1}},1725:(r,t)=>{function e(r,t){return r.map((function(r,e){return String(e+1|0)+": "+(0===r.length?"?":t(r))})).join("\n")}t.unifErrToStr=function(r,t,n){if("object"!=typeof r)return"Details of the error were not stored.";switch(r.TAG){case"DisjCommonVar":var o=String.fromCharCode(8594);return"Unsatisfied disjoint, common variable "+t([r.commonVar])+":\n"+n([r.frmVar1])+" "+o+" "+t(r.expr1)+"\n"+n([r.frmVar2])+" "+o+" "+t(r.expr2);case"Disj":var i=String.fromCharCode(8594);return"Missing disjoint "+t([r.var1])+","+t([r.var2])+":\n"+n([r.frmVar1])+" "+i+" "+t(r.expr1)+"\n"+n([r.frmVar2])+" "+i+" "+t(r.expr2);case"UnprovedFloating":return"Could not prove this floating statement:\n"+t(r.expr);case"NoUnifForAsrt":var a=String.fromCharCode(8594);return"Could not find a match for assertion:\n"+n(r.asrtExpr)+"\n"+a+"\n"+t(r.expr);case"NoUnifForArg":var s=r.args,u=0===s.length?"":":";return"Could not match essential hypothesis #"+String(r.errArgIdx+1|0)+u+"\n"+e(s,t);case"NewVarsAreDisabled":var f=r.errArgIdx,c=r.args;return"New variables are not allowed, but one had to be created when unifying "+(c.length===f?"assertion":"essential hypothesis #"+String(f+1|0))+(0===c.length?"":":")+"\n"+e(c,t);case"TooManyCombinations":var d=r.frmLabels;return void 0!==d?"Some assertions produce too big search space. Only part of that search space was examined. Those assertions are: "+d.join(", ")+" .":"This assertion produces too big search space. Only part of that search space was examined."}}},5291:(r,t,e)=>{var n=e(2971),o=e(6517),i=e(7175),a=e(2448),s=e(7356),u=e(6181),f=e(4518),c=e(5047),d=String.fromCharCode(160),v=String.fromCharCode(9679),l=u.create("Common.MmException");function m(r,t){var e=r.depVer;if(void 0!==e&&r.depVerEq(i.valFromOption(e),t))return r.data}function p(r,t){return r.split(t).map((function(r){return o.getWithDefault(r,"").trim()})).filter((function(r){return r.length>0}))}var h=/[\n\r]/,E=/[\s\n\r]/;function x(r){return p(r,E)}var g=/\+/g,y=/-/g,_=/\//g,T=/_/g;t.nbsp=d,t.circleChar=v,t.MmException=l,t.catchExn=function(r){try{return{TAG:"Ok",_0:r()}}catch(r){var t=f.internalToOCamlException(r);if(t.RE_EXN_ID===l)return{TAG:"Error",_0:{exn:void 0,msg:t._1.msg,stack:""}};var e=f.as_js_exn(t);return{TAG:"Error",_0:{exn:t,msg:a.getOr(a.flatMap(e,(function(r){return r.message})),"Unknown error."),stack:a.getOr(a.flatMap(e,(function(r){return r.stack})),"")}}}},t.currTimeStr=function(){return new Date(Date.now()).toISOString()},t.compareDates=function(r,t){var e=r.getTime(),n=t.getTime();return e<n?-1:n<e?1:0},t.floatToPctStr=function(r){return String(0|Math.round(100*r))+"%"},t.cacheMake=function(r,t){return{recalc:r,depVerEq:t,depVer:void 0,data:void 0}},t.cacheGetByDepVer=m,t.cacheGet=function(r,t,e){var n=m(r,t);if(void 0!==n)return i.valFromOption(n);r.depVer=i.some(t);var o=r.recalc(e);return r.data=i.some(o),o},t.multilineTextToNonEmptyLines=function(r){return p(r,h)},t.getSpaceSeparatedValuesAsArray=x,t.strToBase64=function(r){return btoa(r)},t.base64ToStr=function(r){return atob(r)},t.strToSafeBase64=function(r){return btoa(r).replace(g,"-").replace(_,"_")},t.safeBase64ToStr=function(r){return atob(r.replace(T,"/").replace(y,"+"))},t.strToRegex=function(r){try{return{TAG:"Ok",_0:new RegExp(r)}}catch(e){var t=f.internalToOCamlException(e);return{TAG:"Error",_0:o.getWithDefault(o.flatMap(f.as_js_exn(t),(function(r){return r.message})),"could not create a regular expression from string '"+r+"'")}}},t.versionMake=function(r){return{ver:0,val:r}},t.versionSet=function(r,t){return{ver:r.ver+1|0,val:t}},t.arrayQueueMake=function(r){var t=new Array(r);return{begin:0,end:-1,maxEnd:t.length-1|0,data:t}},t.arrayQueueAdd=function(r,t){r.end===r.maxEnd&&(console.log("q.end == q.maxEnd"),r.data=n.concat(r.data,new Array(r.data.length)),r.maxEnd=r.data.length-1|0),r.end=r.end+1|0,r.data[r.end]=t},t.arrayQueuePop=function(r){if(!(r.begin>r.end)){var t=r.data[r.begin];return r.begin=r.begin+1|0,i.some(t)}},t.arrayQueueReset=function(r){r.begin=0,r.end=-1},t.createVarTypeComparator=function(r,t){var e=s.make(s.size(r));return s.forEach(r,(function(r,n){var o=s.get(t,n);if(void 0!==o)return s.set(e,r,o)})),function(r,t){var n=s.get(e,r);if(void 0!==n){var o=s.get(e,t);return void 0!==o?c.intCmp(n,o):-1}return void 0!==s.get(e,t)?1:0}},t.createVarNameComparator=function(r){return function(t,e){var n=s.get(r,t);if(void 0!==n){var o=s.get(r,e);return void 0!==o?n.localeCompare(o):-1}return void 0!==s.get(r,e)?1:0}},t.createTypeOrderFromStr=function(r,t){var e=s.make(4);return x(r).forEach((function(r){var n=t(r);if(void 0!==n)return s.set(e,n,s.size(e))})),e}},7653:(r,t,e)=>{var n=e(8723);function o(r,t){return n.div(1e5*r|0,t)}function i(r,t,e,n){var i=void 0!==n&&n,a=1e5*r|0,s=o(void 0!==t?t:0,a);return{step:a,numOfSteps:s,lastSentNumOfSteps:s,onProgress:e,dontDecrease:i}}function a(r,t){var e=r.onProgress;if(void 0!==e){var n,i,a=o(t,r.step);return r.dontDecrease&&a>r.lastSentNumOfSteps||!r.dontDecrease&&a!==r.lastSentNumOfSteps?(e((n=a,i=r.step,Math.imul(n,i)/1e5)),void(r.lastSentNumOfSteps=a)):void 0}}t.progressTrackerMake=i,t.progressTrackerSetCurrPct=a,t.progressTrackerIntMake=function(r,t,e,n,o){var a=void 0!==t?t:0;return{progressState:i(r,a/e,n,void 0!==o&&o),cnt:a,maxCnt:e,stepInt:Math.max(e*r/2|0,1)}},t.progressTrackerIntIncCnt=function(r){if(r.cnt=r.cnt+1|0,0===n.mod_(r.cnt,r.stepInt))return a(r.progressState,r.cnt/r.maxCnt)}},5376:(r,t,e)=>{var n=e(3333),o=e(2605),i="MM_wrk_FindParens";t.procName=i,t.beginFindParens=function(r,t,e){o.beginWorkerInteraction(i,{TAG:"FindParens",ctx:r},(function(r,n,o){if("FindParensProgress"===r.TAG)return t(r.pct);o(),e(r.parens)}),void 0,void 0,void 0)},t.processOnWorkerSide=function(r,t){var e,o=r.ctx;t({TAG:"FindParensDone",parens:(e=n.findParentheses(o,(function(r){t({TAG:"FindParensProgress",pct:r})})),n.ctxIntsToStrExn(o,e))})},t.reqToStr=function(r){return"FindParens"},t.respToStr=function(r){return"FindParensProgress"===r.TAG?"FindParensProgress(pct="+String(r.pct)+")":'FindParensDone(parens="'+r.parens+'")'}},5171:(r,t,e)=>{var n=e(5291),o=e(2900),i=e(3333),a=e(6517),s=e(7175),u=e(2761),f=e(2605),c=e(7709),d=e(4518),v="MM_wrk_LoadCtx";function l(r){var t=r.trim();if(0!==t.length){var e=n.strToRegex(t);if("Ok"===e.TAG)return s.some(e._0);throw{RE_EXN_ID:n.MmException,_1:{msg:"Could not parse a regex: "+e._0},Error:new Error}}}t.procName=v,t.beginLoadingMmContext=function(r,t,e,n,o,i,a){f.beginWorkerInteraction(v,{TAG:"LoadMmContext",scopes:r,descrRegexToDisc:t,labelRegexToDisc:e,descrRegexToDepr:n,labelRegexToDepr:o},(function(r,t,e){if("MmContextLoadProgress"===r.TAG)return i(r.pct);e(),a(r.ctx)}),void 0,void 0,void 0)},t.processOnWorkerSide=function(r,t){var e=r.labelRegexToDepr,f=r.descrRegexToDepr,c=r.labelRegexToDisc,v=r.descrRegexToDisc,m=r.scopes,p=u.reduce(m,0,(function(r,t){return r+t.expectedNumOfAssertions|0})),h=m.map((function(r){return r.expectedNumOfAssertions/p}));try{for(var E=i.createContext(void 0,void 0),x=0,g=m.length;x<g;++x){var y=m[x],_=u.reduceWithIndex(h,0,function(r){return function(t,e,n){return n<r?t+e:t}}(x)),T=h[x];if(i.loadContext(m[x].ast,s.some(E),y.stopBefore,y.stopAfter,void 0,y.expectedNumOfAssertions,l(v),l(c),l(f),l(e),function(r,e){return function(n){t({TAG:"MmContextLoadProgress",pct:r+n*e})}}(_,T),void 0),y.resetNestingLevel)for(;0!==i.getNestingLevel(E);)i.closeChildContext(E)}return t({TAG:"MmContextLoadProgress",pct:1}),t({TAG:"MmContextLoaded",ctx:{TAG:"Ok",_0:E}})}catch(r){var b=d.internalToOCamlException(r);if(b.RE_EXN_ID===n.MmException)return t({TAG:"MmContextLoaded",ctx:{TAG:"Error",_0:b._1.msg}});if(b.RE_EXN_ID===o.$$Error)return t({TAG:"MmContextLoaded",ctx:{TAG:"Error",_0:a.getWithDefault(b._1.message,"Internal error.")}});throw b}},t.reqToStr=function(r){return"LoadMmContext"},t.respToStr=function(r){return"MmContextLoadProgress"===r.TAG?"MmContextLoadProgress(pct="+String(r.pct)+")":"MmContextLoaded"},t.createMmScopesForFrame=function(r,t){var e=[];return u.reduce(r,!1,(function(r,o){if(r)return r;var i=function(r){switch(c.readInstrFromStr(r.readInstr)){case"ReadAll":return[void 0,void 0,r.allLabels];case"StopBefore":var t=r.allLabels.findIndex((function(t){return t===r.label}));return-1!==t?[r.label,void 0,r.allLabels.slice(0,t)]:[void 0,void 0,r.allLabels];case"StopAfter":var e=r.allLabels.findIndex((function(t){return t===r.label}));return-1!==e?[void 0,r.label,r.allLabels.slice(0,e+1|0)]:[void 0,void 0,r.allLabels]}}(o),a=i[2],s=a.includes(t)?[t,void 0,a.indexOf(t),!1]:[i[0],i[1],a.length,!0],u=s[2],f=o.ast;if(void 0===f)throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot create MM context for a frame without ast."},Error:new Error};var d={ast:f,expectedNumOfAssertions:u,stopBefore:s[0],stopAfter:s[1],resetNestingLevel:s[3]};return e.push(d),a.length!==u})),e}},8152:(r,t,e)=>{var n=e(5291),o=e(55),i=e(2605),a=e(4518),s="MM_wrk_ParseMmFile";t.procName=s,t.beginParsingMmFile=function(r,t,e){i.beginWorkerInteraction(s,{TAG:"ParseMmFile",mmFileText:r},(function(r,n,o){if("MmFileParseProgress"===r.TAG)return t(r.pct);o(),e(r.parseResult)}),void 0,void 0,void 0)},t.processOnWorkerSide=function(r,t){try{var e=o.parseMmFile(r.mmFileText,void 0,void 0,(function(r){t({TAG:"MmFileParseProgress",pct:r})}));return t({TAG:"MmFileParseProgress",pct:1}),t({TAG:"MmFileParsed",parseResult:{TAG:"Ok",_0:e}})}catch(r){var i=a.internalToOCamlException(r);if(i.RE_EXN_ID===n.MmException)return t({TAG:"MmFileParsed",parseResult:{TAG:"Error",_0:i._1.msg}});throw i}},t.reqToStr=function(r){return"ParseMmFile"},t.respToStr=function(r){return"MmFileParseProgress"===r.TAG?"MmFileParseProgress(pct="+String(r.pct)+")":"MmFileParsed"}},6862:(r,t,e)=>{var n=e(5291),o=e(6517);t.serialize=function(r){return r},t.deserialize=function(r){return r},t.logClientIsSendingRequest=function(r,t,e,i){var a=o.getWithDefault(o.map(i,(function(r){return r(e)})),"");console.log(n.currTimeStr()+" ["+String(r)+","+t+"] C~> "+a)},t.logClientReceivedResponse=function(r,t,e,i){var a=o.getWithDefault(o.map(i,(function(r){return r(e)})),"");console.log(n.currTimeStr()+" ["+String(r)+","+t+"] ->C "+a)},t.logWorkerIsSendingResponse=function(r,t,e,o){console.log(n.currTimeStr()+" ["+String(r)+","+t+"] W~> "+o(e))},t.logWorkerReceivedRequest=function(r,t,e,o){console.log(n.currTimeStr()+" ["+String(r)+","+t+"] ->W "+o(e))}},2605:(r,t,e)=>{var n=e(6862),o=e(6517),i=e(7175),a=e(6181),s=e(5047),u=a.create("MM_wrk_client.WorkerException"),f={contents:void 0},c=[],d={contents:0};t.beginWorkerInteraction=function(r,t,e,a,v,l){var m=void 0!==a&&a,p={contents:-1},h={contents:function(r){}};p.contents=function(r,t){var e=(d.contents=d.contents+1|0,d.contents-1|0);return c.push({id:e,callback:r,traceEnabled:t}),e}((function(t){var o=n.deserialize(t);m&&n.logClientReceivedResponse(p.contents,r,o,l),e(o,h.contents,(function(){for(var r=p.contents,t=0;t<c.length;)c[t].id===r?c.splice(t,1):t=t+1|0}))}),m),h.contents=function(t){m&&n.logClientIsSendingRequest(p.contents,r,t,v);var e={clientId:p.contents,procName:r,body:n.serialize(t),traceEnabled:m};if(o.isNone(f.contents)){var a=new Worker("./webworker-main.js");a.onmessage=function(r){var t=r.data;s.arrForEach(c,(function(r){if(r.id===t.clientId)return r.callback(t.body),i.some(void 0)}))},f.contents=i.some(a)}var d=f.contents;if(void 0!==d)return i.valFromOption(d).postMessage(e);throw{RE_EXN_ID:u,_1:"Could not instantiate a webworker.",Error:new Error}},h.contents(t)},t.terminateWorker=function(){var r=f.contents;if(void 0!==r)return i.valFromOption(r).terminate(),f.contents=void 0,void c.splice(0,c.length)}},9010:(r,t,e)=>{var n=e(5291),o=e(3333),i=e(7175),a=e(2761),s=e(4518);function u(r){var t=n.multilineTextToNonEmptyLines(r);return 0===t.length?{TAG:"Ok",_0:[]}:a.reduce(t,{TAG:"Ok",_0:[]},(function(r,t){if("Ok"!==r.TAG)return r;var e=r._0,o=function(r){var t=n.getSpaceSeparatedValuesAsArray(r);return 3!==t.length?{TAG:"Error",_0:"A line representing a variable definition should consist of exactly three parts separated with a whitespace."}:{TAG:"Ok",_0:t}}(t);return"Ok"!==o.TAG?{TAG:"Error",_0:o._0}:(e.push(o._0),{TAG:"Ok",_0:e})}))}t.prepareParenInts=function(r,t){for(var e=n.getSpaceSeparatedValuesAsArray(t),i=[],a=(e.length/2|0)-1|0,s=0;s<=a;++s){var u=e[s<<1],f=e[1+(s<<1)|0],c=o.ctxSymToInt(r,u);if(void 0!==c&&o.isConst(r,u)){var d=o.ctxSymToInt(r,f);void 0!==d&&o.isConst(r,f)&&(i.push(c),i.push(d))}}return i},t.textToVarDefs=u,t.createWrkCtx=function(r,t,e){var f=o.createContext(i.some(r),void 0),c=a.reduce([function(){var r=u(t);if("Ok"!==r.TAG){return{varsErr:r._0,disjErr:void 0}}try{return void r._0.forEach((function(r){o.applySingleStmt(f,{TAG:"Var",symbols:[r[2]]},void 0,void 0,void 0,void 0),o.applySingleStmt(f,{TAG:"Floating",label:r[0],expr:[r[1],r[2]]},void 0,void 0,void 0,void 0)}))}catch(r){var e=s.internalToOCamlException(r);if(e.RE_EXN_ID===n.MmException){return{varsErr:e._1.msg,disjErr:void 0}}throw e}},function(){try{return void n.multilineTextToNonEmptyLines(e).forEach((function(r){o.applySingleStmt(f,{TAG:"Disj",vars:r.split(" ").map((function(r){return r.trim()})).filter((function(r){return""!==r}))},void 0,void 0,void 0,void 0)}))}catch(t){var r=s.internalToOCamlException(t);if(r.RE_EXN_ID===n.MmException)return{varsErr:void 0,disjErr:r._1.msg};throw r}}],void 0,(function(r,t){return void 0!==r?r:t()}));return void 0!==c?{TAG:"Error",_0:c}:{TAG:"Ok",_0:f}}},9662:(r,t,e)=>{var n=e(5291),o=e(9592),i=e(7175),a=e(2605),s=e(1874),u=e(9010),f=e(5047),c="MM_wrk_ctx",d={contents:void 0},v=n.cacheMake((function(r){return r}),(function(r,t){return r===t})),l=n.cacheMake((function(r){return r}),(function(r,t){return r===t})),m=n.cacheMake((function(r){return s.prepareFrmSubsData(r)}),(function(r,t){return r===t})),p=n.cacheMake((function(r){return o.makeParenCnt(r[1],r[0].parens)}),(function(r,t){return r[0]===t[0]&&r[1]===t[1]})),h=n.cacheMake((function(r){return f.sortInPlaceWith(s.frmsSelect(r,void 0,void 0),(function(r,t){return r.frame.ord-t.frame.ord|0})).map((function(r){return r.frame}))}),(function(r,t){return r===t}));t.procName=c,t.beginWorkerInteractionUsingCtx=function(r,t,e,n,o,i,s,u,f,d){var v=void 0!==d&&d,l={TAG:"PrepareWrkPrecalcData",settingsVer:r,preCtxVer:e,varsText:o,disjText:i};a.beginWorkerInteraction(c,l,(function(o,i,c){if("object"==typeof o)return"GetSettings"===o.TAG?o.settingsVer===r?(i({TAG:"SetSettings",settingsVer:r,settings:t}),i(l)):void 0:o.preCtxVer===e?(i({TAG:"SetPreCtx",preCtxVer:e,preCtx:n}),i(l)):void 0;c(),a.beginWorkerInteraction(s,u,f,v,void 0,void 0)}),v,void 0,void 0)},t.getWrkCtxExn=function(){var r=d.contents;if(void 0!==r)return r.wrkCtx;throw{RE_EXN_ID:n.MmException,_1:{msg:"wrkCtx is not created in the worker thread."},Error:new Error}},t.getWrkParenCntExn=function(){var r=d.contents;if(void 0!==r)return r.wrkParenCnt;throw{RE_EXN_ID:n.MmException,_1:{msg:"wrkParenCnt is not created in the worker thread."},Error:new Error}},t.getWrkFrmsExn=function(){var r=d.contents;if(void 0!==r)return r.wrkFrms;throw{RE_EXN_ID:n.MmException,_1:{msg:"wrkFrms is not created in the worker thread."},Error:new Error}},t.getAllFramesInDeclarationOrderExn=function(){var r=d.contents;if(void 0!==r)return r.allFramesInDeclarationOrder;throw{RE_EXN_ID:n.MmException,_1:{msg:"wrkFrms is not created in the worker thread."},Error:new Error}},t.processOnWorkerSide=function(r,t){switch(r.TAG){case"PrepareWrkPrecalcData":d.contents=void 0;var e=function(r,t,e,o){var a=n.cacheGetByDepVer(v,r);if(void 0===a)return{TAG:"Error",_0:{TAG:"GetSettings",settingsVer:r}};var s=n.cacheGetByDepVer(l,t);if(void 0===s)return{TAG:"Error",_0:{TAG:"GetPreCtx",preCtxVer:t}};var f=i.valFromOption(s),c=u.createWrkCtx(f,e,o);if("Ok"===c.TAG){var d=n.cacheGet(m,t,f);return{TAG:"Ok",_0:{wrkFrms:d,wrkParenCnt:n.cacheGet(p,[r,t],[a,f]),wrkCtx:c._0,allFramesInDeclarationOrder:n.cacheGet(h,t,d)}}}throw{RE_EXN_ID:n.MmException,_1:{msg:"There was an error creating wrkCtx in the worker thread."},Error:new Error}}(r.settingsVer,r.preCtxVer,r.varsText,r.disjText);return"Ok"!==e.TAG?t(e._0):(d.contents=e._0,t("Ok"));case"SetSettings":return void n.cacheGet(v,r.settingsVer,r.settings);case"SetPreCtx":return void n.cacheGet(l,r.preCtxVer,r.preCtx)}},t.reqToStr=function(r){switch(r.TAG){case"PrepareWrkPrecalcData":return"PrepareWrkPrecalcData";case"SetSettings":return"SetSettings(settingsVer="+String(r.settingsVer)+")";case"SetPreCtx":return"SetPreCtx(preCtxVer="+String(r.preCtxVer)+")"}},t.respToStr=function(r){return"object"!=typeof r?"Ok":"GetSettings"===r.TAG?"GetSettings(settingsVer="+String(r.settingsVer)+")":"GetPreCtx(preCtxVer="+String(r.preCtxVer)+")"}},7709:(r,t,e)=>{var n=e(5291),o=e(4923),i=e(2971),a=e(5300),s=e(3333),u=e(9592),f=e(6517),c=e(6369),d=e(7175),v=e(2761),l=e(2815),m=e(9775),p=e(2448),h=e(2423),E=e(5082),x=e(6134),g=e(3591),y=e(7659),_=e(4792),T=e(1874),b=e(9010),A=e(5650),k=e(1717),S=e(9702),w=e(5090),C=e(2275),I=e(8615),M=e(5981),j=e(4518),D=e(5047),G=e(1725),N=e(2867);function U(r){return"Text"===r.TAG?n.getSpaceSeparatedValuesAsArray(r.text):n.getSpaceSeparatedValuesAsArray(r._0.text)}function O(r){return"Text"===r.TAG?r.text:r._0.text}function P(r,t,e){var o=n.getSpaceSeparatedValuesAsArray(r);return{TAG:"Text",text:o.join(" "),syms:o.map((function(r){var n,o=f.flatMap(t,(function(t){return C.get(t,r)}));if(void 0!==o)n=o;else{var i=f.flatMap(e,(function(t){return C.get(t,r)}));n=void 0!==i?i:void 0}return{sym:r,color:n}}))}}function R(r){switch(r){case"H":return["E",!1];case"P":return["P",!1];case"G":return["P",!0]}}function F(r,t,e,n){return{id:r,label:e,labelEditMode:!1,typ:t,typEditMode:!1,isGoal:n,isBkm:!1,cont:{TAG:"Text",text:"",syms:[]},contEditMode:!0,isDuplicated:!1,jstfText:"",jstfEditMode:!1,stmtErr:void 0,expr:void 0,jstf:void 0,proofTreeDto:void 0,src:void 0,proof:void 0,proofStatus:void 0,unifErr:void 0,syntaxErr:void 0}}function V(r){var t,e=r.expr;if(void 0===e)throw{RE_EXN_ID:n.MmException,_1:{msg:"Expr must be set for a userStmt before converting to rootStmt."},Error:new Error};return t=e,{isHyp:"E"===r.typ,label:r.label,expr:t,jstf:r.jstf}}function B(r){var t=r.cont;if("Text"===t.TAG)return r;var e=t._0;if(void 0===e.clickedNodeId)return r;var n=o.obj_dup(r);return n.cont={TAG:"Tree",_0:{text:e.text,exprTyp:e.exprTyp,root:e.root,clickedNodeId:void 0,expLvl:e.expLvl}},n}function L(r,t){return r.stmts.find((function(r){return r.id===t}))}function W(r,t){return r.stmts.find((function(r){return r.label===t}))}function X(r,t){var e=L(r,t);if(void 0!==e)return e;throw{RE_EXN_ID:n.MmException,_1:{msg:"editorGetStmtByIdExn: Cannot find a step by id."},Error:new Error}}function H(r,t,e){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts.map((function(r){return r.id===t?e(r):r})),checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}}function z(r,t){return r.checkedStmtIds.some((function(r){return r[0]===t}))}function q(r,t){return z(r,t)?{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds.filter((function(r){return r[0]!==t})),nextAction:r.nextAction}:{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds.concat([[t,new Date]]),nextAction:r.nextAction}}function $(r){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts.map(B),checkedStmtIds:[],nextAction:r.nextAction}}function K(r,t){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts.filter((function(r){return r.id!==t})),checkedStmtIds:r.checkedStmtIds.filter((function(r){return r[0]!==t})),nextAction:r.nextAction}}function J(r,t){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts.filter((function(r){return!t.includes(r.id)})),checkedStmtIds:r.checkedStmtIds.filter((function(r){return!t.includes(r[0])})),nextAction:r.nextAction}}function Q(r,t){var e=r.stmts.length;return 0!==e&&0!==r.checkedStmtIds.length&&(!(!t||z(r,r.stmts[0].id))||!t&&!z(r,r.stmts[e-1|0].id))}function Z(r,t){if(!Q(r,t))return r;var e=r.stmts.length,n=r.stmts.slice();if(t){for(var o=e-2|0,i=0;i<=o;++i)if(!z(r,n[i].id)&&z(r,n[i+1|0].id)){var a=n[i];n[i]=n[i+1|0],n[i+1|0]=a}}else for(var s=e-1|0;s>=1;--s)if(z(r,n[s-1|0].id)&&!z(r,n[s].id)){var u=n[s];n[s]=n[s-1|0],n[s-1|0]=u}return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:n,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}}function Y(r,t,e){var n,o=void 0!==e&&e,i=I.fromArray(r.stmts.map((function(r){return r.label}))),a=b.textToVarDefs(r.varsText);if("Ok"===a.TAG&&a._0.forEach((function(r){I.add(i,r[0])})),void 0!==t)n=t;else if(o){var u=r.stmts.find((function(r){return r.isGoal}));n=void 0!==u?u.label+".":""}else n="";for(var c,d=1,v=n+String(d);c=v,I.has(i,c)||s.isHyp(r.preCtxData.ctxMinV.val,c)||o&&f.isSome(s.getTokenType(r.preCtxData.ctxMinV.val,c));)d=d+1|0,v=n+String(d);return v}function rr(r){return 0===r.checkedStmtIds.length?void 0:r.stmts.find((function(t){return z(r,t.id)}))}function tr(r,t,e){var n,a=void 0!==t&&t,s=String(r.nextStmtId),u=v.reduce(r.stmts,0,(function(r,t){return"P"===t.typ?r+1|0:r})),c=r.preCtxData.settingsV.val.defaultStmtLabel.trim(),d=0===u&&c.length>0?r.stmts.some((function(r){return r.label===c}))?Y(r,c,a):c:Y(r,"",a),l=0===u&&r.preCtxData.settingsV.val.initStmtIsGoal,m=f.map(rr(r),(function(r){return r.id}));if(void 0!==m)n=i.concatMany(r.stmts.map((function(r){if(r.id!==m)return[r];var t=o.obj_dup(F(s,"P",d,l));return[(t.isBkm=f.getWithDefault(e,r.isBkm),t),r]})));else{var p=o.obj_dup(F(s,"P",d,l));n=r.stmts.concat([(p.isBkm=f.getWithDefault(e,!1),p)])}return[{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId+1|0,stmts:n,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction},s]}function er(r,t,e){var n=void 0!==e&&e,o=r.checkedStmtIds,i=$(r),a=tr(0<=t&&t<i.stmts.length?q(i,i.stmts[t].id):i,n,void 0),s=a[0];return[{preCtxData:s.preCtxData,tabTitle:s.tabTitle,descr:s.descr,descrEditMode:s.descrEditMode,varsText:s.varsText,varsEditMode:s.varsEditMode,varsErr:s.varsErr,wrkCtxColors:s.wrkCtxColors,disjText:s.disjText,disjEditMode:s.disjEditMode,disjErr:s.disjErr,wrkCtx:s.wrkCtx,nextStmtId:s.nextStmtId,stmts:s.stmts,checkedStmtIds:o,nextAction:s.nextAction},a[1]]}function nr(r){return 1===r.checkedStmtIds.length}function or(r,t){return!r.stmts.some((function(r){return r.id===t&&(!!(r.labelEditMode||r.typEditMode||r.contEditMode)||r.jstfEditMode)}))}function ir(r,t){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:t,disjEditMode:!1,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}}function ar(r,t,e){return H(r,t,(function(r){if(""===e.trim())return r;var t=o.obj_dup(r);return t.labelEditMode=!1,t.label=e,t}))}function sr(r,t,e){return H(r,t,(function(t){if(""===e.trim())return t;var n=o.obj_dup(t);return n.isDuplicated=!1,n.contEditMode=!1,n.cont=P(e,d.some(r.preCtxData.symColors),d.some(r.wrkCtxColors)),n}))}function ur(r){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:(t=r.varsText,e=r.preCtxData.typeColors,n=C.make(16),o=b.textToVarDefs(t),"Ok"===o.TAG&&o._0.forEach((function(r){var t=r[2],o=r[1],i=C.get(e,o);if(void 0!==i)return C.set(n,t,i)})),n),disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction};var t,e,n,o}function fr(r){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts.map((function(t){var e=o.obj_dup(t);return e.cont=P(O(t.cont),d.some(r.preCtxData.symColors),d.some(r.wrkCtxColors)),e})),checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}}function cr(r){return fr(ur(r))}function dr(r,t){return cr({preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:t,varsEditMode:!1,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction})}function vr(r){var t=function(t){return"E"===t.typ?1:r.preCtxData.settingsV.val.stickGoalToBottom&&t.isGoal?3:2},e=r.stmts.length;if(e<2)return r;for(var n,o,i=r.stmts.slice(),a=!0,s=e-2|0;s>=0&&a;){a=!1;for(var u=0;u<=s;++u)if(n=i[u],o=i[u+1|0],(t(n)-t(o)|0)>0){var f=i[u];i[u]=i[u+1|0],i[u+1|0]=f,a=!0}s=s-1|0}return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:i,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}}function lr(r){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:void 0,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:void 0,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts.map((function(r){var t=o.obj_dup(r);return t.syntaxErr=void 0,t.unifErr=void 0,t.proofStatus=void 0,t.proof=void 0,t.src=void 0,t.proofTreeDto=void 0,t.jstf=void 0,t.expr=void 0,t.stmtErr=void 0,t})),checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}}function mr(r){return f.isSome(r.stmtErr)}function pr(r){return!(!f.isSome(r.stmtErr)&&!f.isSome(r.syntaxErr))||f.isSome(r.unifErr)}function hr(r){return!(!f.isSome(r.varsErr)&&!f.isSome(r.disjErr))||r.stmts.some(mr)}function Er(r){var t=[];return p.forEach(r.varsErr,(function(r){t.push("Variable definition error: "+r)})),p.forEach(r.disjErr,(function(r){t.push("Disjoints error: "+r)})),r.stmts.some(mr)&&(t.push("Errors for steps:"),r.stmts.forEach((function(r){p.forEach(r.stmtErr,(function(e){t.push(O(r.cont)+":"),t.push(e.msg)}))}))),t.join(" \n")}function xr(r){var t=b.createWrkCtx(r.preCtxData.ctxMinV.val,r.varsText,r.disjText);if("Ok"===t.TAG)return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:d.some(t._0),nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction};var e=t._0,n=e.varsErr,o=void 0!==n?{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:n,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}:r,i=e.disjErr;return void 0!==i?{preCtxData:o.preCtxData,tabTitle:o.tabTitle,descr:o.descr,descrEditMode:o.descrEditMode,varsText:o.varsText,varsEditMode:o.varsEditMode,varsErr:o.varsErr,wrkCtxColors:o.wrkCtxColors,disjText:o.disjText,disjEditMode:o.disjEditMode,disjErr:i,wrkCtx:o.wrkCtx,nextStmtId:o.nextStmtId,stmts:o.stmts,checkedStmtIds:o.checkedStmtIds,nextAction:o.nextAction}:o}function gr(r){var t=r.trim();if(0===t.length)return{TAG:"Ok",_0:void 0};var e=t.split(":");return 2!==e.length?{TAG:"Error",_0:"Cannot parse justification: '"+t+"'. A justification must contain exactly one colon symbol."}:""===e[1].trim()?{TAG:"Error",_0:"Cannot parse justification: '"+t+"'. Reference must not be empty."}:{TAG:"Ok",_0:{args:n.getSpaceSeparatedValuesAsArray(e[0]),label:e[1].trim()}}}function yr(r){if(f.isSome(r.stmtErr)||"E"===r.typ)return r;var t=gr(r.jstfText);if("Ok"===t.TAG){var e=o.obj_dup(r);return e.jstf=t._0,e}var n=o.obj_dup(r);return n.stmtErr={code:-1,msg:t._0},n}function _r(r,t,e){return!!I.has(e,r)||s.isHyp(t,r)}function Tr(r){var t=r.wrkCtx;if(void 0!==t){var e=d.valFromOption(t),i=r.stmts.length,a=I.make(i),u=l.make(i,s.ExprHash),c={contents:void 0},m=[function(r){if(f.isSome(r.stmtErr))return r;if(!("E"===r.typ||"P"===r.typ&&r.isGoal)){if(!_r(r.label,e,a))return r;var t=o.obj_dup(r);return t.stmtErr={code:-1,msg:"[4] Cannot reuse label '"+r.label+"'."},t}var n=s.getTokenType(e,r.label);if(void 0===n){if(!_r(r.label,e,a))return r;var i=o.obj_dup(r);return i.stmtErr={code:-1,msg:"[3] Cannot reuse label '"+r.label+"'."},i}if("E"===r.typ){var u=o.obj_dup(r);return u.stmtErr={code:-1,msg:"[1] Cannot reuse label '"+r.label+"'."},u}switch(n){case"A":case"P":return r;default:var c=o.obj_dup(r);return c.stmtErr={code:-1,msg:"[2] Cannot reuse label '"+r.label+"'."},c}},function(r){if(f.isSome(r.stmtErr))return r;try{var t=o.obj_dup(r);return t.expr=s.ctxSymsToIntsExn(e,U(r.cont)),t}catch(t){var i=j.internalToOCamlException(t);if(i.RE_EXN_ID===n.MmException){var a=o.obj_dup(r);return a.stmtErr={code:-1,msg:i._1.msg},a}throw i}},function(r){if(f.isSome(r.stmtErr))return r;var t=c.contents;if(void 0===t)return r;if(!r.isGoal)return r;var e=o.obj_dup(r);return e.stmtErr={code:-1,msg:"Cannot re-define the goal. Previously defined goal is the step labeled '"+t+"'"},e},yr,function(t){var i=r.preCtxData.frms;if(f.isSome(t.stmtErr))return t;var u=t.jstf;if(void 0===u)return t;var c=u.label,d=u.args,v=d.find((function(r){return!_r(r,e,a)}));if(void 0!==v){var l=o.obj_dup(t);return l.stmtErr={code:-1,msg:"The label '"+v+"' is not defined."},l}if(s.isAsrt(e,c)){var m=T.frmsGetByLabel(i,c);if(void 0!==m){var p=m.numOfHypsE,h=d.length;if(h===p)return t;var E=1===p?"essential hypothesis":"essential hypotheses",x=1===h?"is":"are",g=o.obj_dup(t);return g.stmtErr={code:-1,msg:"'"+c+"' assertion expects "+String(p)+" "+E+" but "+String(h)+" "+x+" provided."},g}throw{RE_EXN_ID:n.MmException,_1:{msg:"Could not get frame by label '"+c+"'"},Error:new Error}}var y=o.obj_dup(t);return y.stmtErr={code:-1,msg:"The label '"+c+"' doesn't refer to any assertion."},y},function(r){if(f.isSome(r.stmtErr))return r;var t=r.expr;if(void 0!==t){var i=s.getHypByExpr(e,t);if(void 0!==i){var a=o.obj_dup(r);return a.stmtErr={code:1,msg:"This statement is the same as the previously defined hypothesis - '"+i.label+"'"},a}var c=l.get(u,t);if(void 0!==c){var d=o.obj_dup(r);return d.stmtErr={code:1,msg:"This statement is the same as the previous one - '"+c+"'"},d}if(r.contEditMode||!(0===t.length||t[0]>=0))return r;var v=o.obj_dup(r);return v.stmtErr={code:-1,msg:"Any statement must begin with a constant."},v}throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot validateStmtExpr without expr."},Error:new Error}}];return v.reduce(r.stmts,r,(function(r,t){if(hr(r))return r;var e=v.reduce(m,t,(function(r,t){return f.isSome(r.stmtErr)?r:t(r)}));if(I.add(a,e.label),!f.isSome(e.stmtErr)){var o=e.expr;if(void 0===o)throw{RE_EXN_ID:n.MmException,_1:{msg:"Expr must be set in prepareUserStmtsForUnification."},Error:new Error};l.set(u,o,e.label),e.isGoal&&(c.contents=e.label)}return H(r,e.id,(function(r){return e}))}))}throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot prepareUserStmtsForUnification without wrkCtx."},Error:new Error}}function br(r){var t=lr(r);return v.reduce([vr,xr,Tr],t,(function(r,t){return hr(r)?r:t(r)}))}function Ar(r,t,e,o){var i=void 0!==o&&o,a=r.wrkCtx;if(void 0!==a){var u,f=d.valFromOption(a),c=t.length;if(0===c)return[r,[]];if(void 0!==e){if(t.length!==e.length)throw{RE_EXN_ID:n.MmException,_1:{msg:"varTypes->Array.length != varNames->Array.length"},Error:new Error};u=e}else{var v=E.fromArray(r.preCtxData.settingsV.val.typeSettings.map((function(r){return[r.typ,r.prefix]})));u=s.generateNewVarNames(f,t,d.some(v),void 0)}var l=s.generateNewLabels(f,"var",c,void 0,void 0),m=s.ctxIntsToSymsExn(f,t);i||(s.applySingleStmt(f,{TAG:"Var",symbols:u},void 0,void 0,void 0,void 0),l.forEach((function(r,t){s.applySingleStmt(f,{TAG:"Floating",label:r,expr:[m[t],u[t]]},void 0,void 0,void 0,void 0)})));var p=s.ctxSymsToIntsExn(f,u),h=l.map((function(r,t){return r+" "+m[t]+" "+u[t]})).join("\n");return[ur({preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:[r.varsText,h].join("\n").trim(),varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}),p]}throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot create new variables without wrkCtx."},Error:new Error}}function kr(r,t){var e=r.wrkCtx;if(void 0!==e){var o=d.valFromOption(e),i=[];if(s.disjForEachArr(t,void 0,void 0,void 0,void 0,(function(r){var t=s.ctxIntsToSymsExn(o,r);s.applySingleStmt(o,{TAG:"Disj",vars:t},void 0,void 0,void 0,void 0),i.push(t.join(" "))})),0===i.length)return r;var a=i.join("\n");return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:[r.disjText,a].join("\n").trim(),disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}}throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot create new disjoints without wrkCtx."},Error:new Error}}function Sr(r,t){var e=r.expr;if(void 0!==e)return s.exprEq(e,t.expr);throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot compare steps without expr."},Error:new Error}}function wr(r){var t=r.wrkCtx;if(void 0!==t){var e=d.valFromOption(t),o=I.fromArray(D.arrFlatMap(r.stmts,(function(r){return U(r.cont)})));s.getLocalHyps(e).forEach((function(r){if("F"===r.typ&&r.label.startsWith("."))return I.add(o,s.ctxIntToSymExn(e,r.expr[1]))}));var i,a=s.getLocalVars(e).filter((function(r){return!I.has(o,r)}));if(0===a.length)i=r;else{var u=y.fromArray(s.ctxSymsToIntsExn(e,a));i=dr(r,s.getLocalHyps(e).filter((function(r){return"F"===r.typ&&!y.has(u,r.expr[1])})).map((function(r){return r.label+" "+s.ctxIntToSymExn(e,r.expr[0])+" "+s.ctxIntToSymExn(e,r.expr[1])})).join("\n"))}var f=s.disjMake();s.disjForEach(s.getLocalDisj(e),(function(r,t){if(I.has(o,s.ctxIntToSymExn(e,r))&&I.has(o,s.ctxIntToSymExn(e,t)))return s.disjAddPair(f,r,t)}));var c=s.disjToArr(f,!0,(function(r){return s.ctxIntToSym(e,r)}),(function(r){return s.getTypeOfVar(e,r)}),d.some(i.preCtxData.typeOrderInDisj)).map((function(r){return s.ctxIntsToSymsExn(e,r).join(" ")})).join("\n");return i.disjText!==c?ir(i,c):i}throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot remove unused variables without wrkCtx."},Error:new Error}}function Cr(r,t,e,o){if("object"==typeof e&&"Assertion"===e.TAG){var a=e.label,u=e.args,f=s.getFrame(r,a);if(void 0!==f){var c=[],d={contents:!0};return f.hyps.forEach((function(r,e){if("E"===r.typ&&d.contents){var s=i.get(u,e);if(void 0===s)throw{RE_EXN_ID:n.MmException,_1:{msg:"Too few arguments for '"+a+"' in srcToJstf."},Error:new Error};var f=l.get(o,t.nodes[s].expr);void 0!==f?c.push(f.label):d.contents=!1}})),d.contents?{args:c,label:a}:void 0}throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot find an assertion '"+a+"' in srcToJstf."},Error:new Error}}}function Ir(r,t,e){if(void 0===t)return f.flatMap(e,(function(t){return C.get(t,r)}));var n=C.get(d.valFromOption(t),r);return void 0!==n?n:f.flatMap(e,(function(t){return C.get(t,r)}))}function Mr(r,t,e){return{id:r.id,parent:r.parent,typ:r.typ,label:r.label,children:r.children.map((function(r){return"Subtree"===r.TAG?{TAG:"Subtree",_0:Mr(r._0,t,e)}:{TAG:"Symbol",id:r.id,parent:r.parent,symInt:r.symInt,sym:r.sym,color:Ir(r.sym,t,e),isVar:r.isVar}})),height:r.height}}function jr(r,t,e,n,o,i,u){if("Uncompressed"===u.TAG)return"Error: only compressed proofs are supported.";var f=function(r,t){var e=r.length;if(e<=50)return[r];for(var n=[],o=a.Int.ceil(e/50),i=1;i<=o;++i){var s=Math.imul(i-1|0,50);n.push(r.substr(s,50))}return n}(u.compressedProofBlock).join(" "),c=i.label+" $p "+O(i.cont)+" $= ( "+u.labels.join(" ")+" ) "+f+" $.",v=0===o.trim().length,l=e.length>0||!s.disjIsEmpty(n)||!v,m=[];l&&m.push("${");var p=e.filter((function(r){return"F"===r.typ})).map((function(t){return s.ctxIntToSymExn(r,t.expr[1])}));return p.length>0&&m.push("$v "+p.join(" ")+" $."),e.forEach((function(t){"F"!==t.typ||m.push(t.label+" $f "+s.ctxIntsToStrExn(r,t.expr)+" $.")})),s.disjForEachArr(n,!0,(function(t){return s.ctxIntToSym(r,t)}),(function(t){return s.getTypeOfVar(r,t)}),d.some(t),(function(t){m.push("$d "+s.ctxIntsToStrExn(r,t)+" $.")})),e.forEach((function(t){"E"!==t.typ||m.push(t.label+" $e "+s.ctxIntsToStrExn(r,t.expr)+" $.")})),v||m.push("$( "+o+" $)"),m.push(c),l&&m.push("$}"),m.join("\r\n")}function Dr(r,t,e){return v.reduce(r.stmts,{TAG:"Ok",_0:r},(function(r,n){if("Ok"!==r.TAG)return r;var i=r._0;if("E"===n.typ)return{TAG:"Ok",_0:i};var a=gr(n.jstfText);if("Ok"!==a.TAG)return{TAG:"Error",_0:"Cannot parse justification '"+n.jstfText+"' for the step '"+n.label+"'"};var s=a._0;if(void 0===s)return{TAG:"Ok",_0:i};if(!s.args.includes(t))return{TAG:"Ok",_0:i};var u={args:s.args.map((function(r){return r===t?e:r})),label:s.label};return{TAG:"Ok",_0:H(i,n.id,(function(r){var t=o.obj_dup(r);return t.jstfText=w.jstfToStr(u),t}))}}))}var Gr=/[\s:]+/g;function Nr(r,t,e){var n=e.replace(Gr,"");if(""===n)return{TAG:"Error",_0:"label must not be empty."};var i=r.stmts.find((function(r){return r.id!==t&&r.label===n}));if(void 0!==i)return{TAG:"Error",_0:"label '"+n+"' is used by another step."};var a=L(r,t);if(void 0===a)return{TAG:"Ok",_0:r};if(a.label===n)return{TAG:"Ok",_0:r};var s=Dr(r,a.label,n);return"Ok"===s.TAG?{TAG:"Ok",_0:H(s._0,t,(function(r){var t=o.obj_dup(r);return t.label=n,t}))}:{TAG:"Error",_0:s._0}}function Ur(r,t,e){var n=L(r,t);if(void 0===n)return{TAG:"Error",_0:"Cannot find a step with id = '"+t+"'"};var i=L(r,e);if(void 0===i)return{TAG:"Error",_0:"Cannot find a step with id = '"+e+"'"};if(O(n.cont)!==O(i.cont))return{TAG:"Error",_0:"Steps to merge must have identical expressions."};var a=Dr(r,i.label,n.label);if("Ok"!==a.TAG)return{TAG:"Error",_0:a._0};var s=K(a._0,e);return"P"===i.typ&&i.isGoal&&"E"!==n.typ?Nr(H(s,t,(function(r){var t=o.obj_dup(r);return t.isGoal=!0,t.typ="P",t})),t,i.label):{TAG:"Ok",_0:s}}var Or=/^\d+$/;function Pr(r){return f.isSome(d.null_to_opt(r.match(Or)))}function Rr(r,t,e){if(t.id!==e.id)throw{RE_EXN_ID:n.MmException,_1:{msg:"renameHypToMatchGoal: oldStmt.id != newStmt.id"},Error:new Error};var o=t.id;if("P"!==t.typ||"E"!==e.typ||!Pr(e.label))return r;var i=f.isSome(r.stmts.find((function(r){return r.isGoal})))||f.isSome(s.getTokenType(r.preCtxData.ctxMinV.val,e.label))?Y(r,void 0,!0):e.label;if(i===e.label)return r;var a=Nr(r,o,i);return"Ok"===a.TAG?a._0:r}function Fr(r,t,e,n){var i=X(r,t),a=H(r,t,(function(r){var t,i=o.obj_dup(r);return t="E"!==e&&n,i.isGoal=t,i.typEditMode=!1,i.typ=e,i}));return Rr(a,i,X(a,t))}var Vr="HYP";function Br(r,t,e){var n=X(r,t),i=H(r,t,(function(n){var i=e.trim().toLocaleUpperCase(),a=i===Vr?"E":"P",s=i===Vr?"":e.trim(),u=v.reduce(r.stmts,0,(function(r,e){return e.id!==t&&"P"===e.typ?r+1|0:r})),f=r.preCtxData.settingsV.val,c="E"!==a&&(n.isGoal||f.initStmtIsGoal&&0===u),d=c&&!n.isGoal&&f.defaultStmtLabel.length>0?f.defaultStmtLabel:n.label,l=o.obj_dup(n);return l.jstfEditMode=!1,l.jstfText=s,l.isGoal=c,l.typ=a,l.label=d,l}));return Rr(i,n,X(i,t))}function Lr(r){if(void 0===r)return!1;switch(r){case"H":return!0;case"P":case"G":return!1}}function Wr(r,t,e){var n=[function(r,t,e){var n=e.cont;return void 0!==n&&""!==n.trim()?{TAG:"Ok",_0:sr(r,t,n)}:{TAG:"Error",_0:"Steps must not have empty statements."}},function(r,t,e){var n=e.label;return void 0!==n?""===n.trim()?{TAG:"Error",_0:"Steps must not have empty labels."}:{TAG:"Ok",_0:ar(r,t,n)}:{TAG:"Ok",_0:r}},function(r,t,e){var n=e.typ;if(void 0===n)return{TAG:"Ok",_0:r};var o=R(n);return{TAG:"Ok",_0:Fr(r,t,o[0],o[1])}},function(r,t,e){var n=e.jstf;return void 0!==n?{TAG:"Ok",_0:Br(r,t,n)}:{TAG:"Ok",_0:r}},function(r,t,e){var n=e.isBkm;return void 0!==n?{TAG:"Ok",_0:H(r,t,(function(r){var t=o.obj_dup(r);return t.isBkm=n,t}))}:{TAG:"Ok",_0:r}}],i=[],a=v.reduceWithIndex(e,{TAG:"Ok",_0:r},(function(r,e,o){if("Ok"!==r.TAG)return r;var a=r._0,s=void 0!==t?er(a,t+o|0,Lr(e.typ)):tr(a,Lr(e.typ),void 0),u=s[1];return i.push(u),v.reduce(n,{TAG:"Ok",_0:s[0]},(function(r,t){return c.flatMap(r,(function(r){return t(r,u,e)}))}))}));return"Ok"===a.TAG?{TAG:"Ok",_0:[a._0,i]}:{TAG:"Error",_0:a._0}}function Xr(r){return r.stmts.find((function(r){return!r.isDuplicated&&f.getWithDefault(f.map(r.stmtErr,(function(r){return 1===r.code})),!1)}))}function Hr(r,t){var e=O(t.cont);return r.stmts.find((function(r){return!r.isDuplicated&&r.id!==t.id&&O(r.cont)===e}))}function zr(r,t){for(var e=[],n=r,o=!0;o;){var i=Xr(n);if(void 0!==i){var a=Hr(n,i);if(void 0!==a){var s=i.jstfText.trim(),u=a.jstfText.trim();if(t)if(""===s)o=!1;else{var f=Ur(n,a.id,i.id);"Ok"===f.TAG?(e.push([i.label,a.label]),n=br(f._0)):o=!1}else if(""!==s&&""===u){var c=Ur(n,i.id,a.id);"Ok"===c.TAG?(e.push([a.label,i.label]),n=br(c._0)):o=!1}else if(""===u||""!==s&&s!==u)o=!1;else{var d=Ur(n,a.id,i.id);"Ok"===d.TAG?(e.push([i.label,a.label]),n=br(d._0)):o=!1}}else o=!1}else o=!1}return[n,e]}function qr(r){var t=r.clickedNodeId;if(void 0!==t){var e=g.getNodeById(r.root,t[0]);if(void 0!==e&&"Subtree"!==e.TAG){var n=e.parent;if(0===r.expLvl)return{TAG:"Symbol",id:e.id,parent:n,symInt:e.symInt,sym:e.sym,color:e.color,isVar:e.isVar};for(var o=n,i=r.expLvl;i>1&&f.isSome(o);)i=i-1|0,o=f.getExn(o).parent;return void 0!==o?{TAG:"Subtree",_0:o}:{TAG:"Subtree",_0:r.root}}}}function $r(r){return f.getWithDefault(f.map(qr(r),g.syntaxTreeGetNumberOfSymbols),0)}function Kr(r){return{text:r.text,exprTyp:r.exprTyp,root:r.root,clickedNodeId:r.clickedNodeId,expLvl:Math.min(r.expLvl+1|0,r.root.height)}}function Jr(r){return{text:r.text,exprTyp:r.exprTyp,root:r.root,clickedNodeId:r.clickedNodeId,expLvl:Math.max(r.expLvl-1|0,0)}}function Qr(r,t){for(var e=t?Kr:Jr,n=r,o=$r(n),i=e(n),a=$r(i);o===a&&(t&&i.expLvl<i.root.height||!t&&i.expLvl>0);)o=$r(n=i),a=$r(i=e(n));return i}function Zr(r,t,e,n){var o=br(r);if(hr(o))return{TAG:"Error",_0:"Cannot perform renumbering because there is an error in the editor content. Please resolve the error before renumbering."};var i=o.stmts.filter(t).map((function(r){return r.id})),a=I.fromArray(i),s=v.reduce(o.stmts,{TAG:"Ok",_0:o},(function(r,t){if("Ok"!==r.TAG)return r;var e=r._0;return I.has(a,t.id)?Nr(e,t.id,"###tmp###"+t.label):{TAG:"Ok",_0:e}})),u=v.reduce(i,s,(function(r,t){if("Ok"!==r.TAG)return r;var o=r._0;return Nr(o,t,Y(o,e,n))}));if("Ok"!==u.TAG)return u;var f=br(u._0);return hr(f)?{TAG:"Error",_0:"Cannot renumber steps due to an internal error. An error was detected in the editor content after a renumbering attempt. All errors detected are: "+Er(f)}:{TAG:"Ok",_0:f}}function Yr(r,t,e,n,o,a,c,v){if(0===e.length)return{TAG:"Error",_0:"Could not determine syntax types."};var l=function(t){return t.find((function(t){return f.isNone(s.ctxSymToInt(r,t))}))}(i.concatMany(t));if(void 0!==l)return{TAG:"Error",_0:"Unrecognized symbol: '"+l+"'"};var m=f.getWithDefault(f.flatMap(c,(function(t){return s.ctxSymToInt(r,t)})),0),p=D.sortInPlaceWith(e.slice(),(function(r,t){return r===m?-1:t===m?1:r-t|0})),E=t.map((function(t){return s.ctxSymsToIntsExn(r,t)})),x=u.proveSyntaxTypes(void 0,d.some(r),d.some(n),o,d.some(a),E,p,void 0),y=E.map((function(r){var t=h.ptGetSyntaxProof(x,r);if(void 0!==t)return h.pnGetExpr(d.valFromOption(t))})),_=k.proofTreeToDto(x,y.filter(f.isSome).map(f.getExn)),T=y.find(f.isSome);if(void 0!==T){var b=d.valFromOption(T);void 0!==b&&(void 0!==c?f.forEach(s.ctxIntToSym(r,b[0]),(function(r){if(c!==r)return v(r)})):f.forEach(s.ctxIntToSym(r,b[0]),v))}return{TAG:"Ok",_0:y.map((function(t){return void 0!==t?g.buildSyntaxProofTableFromProofTreeDto(r,_,t):{TAG:"Error",_0:"Could not prove this statement is of any of the types: "+s.ctxIntsToSymsExn(r,p).join(", ")}}))}}t.defaultJstfForHyp=Vr,t.contIsEmpty=function(r){return"Text"===r.TAG?0===r.text.length:0===r._0.text.length},t.contToArrStr=U,t.contToStr=O,t.strToCont=P,t.userStmtTypeFromStr=function(r){switch(r){case"e":return"E";case"p":return"P";default:throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot convert '"+r+"' to userStmtType"},Error:new Error}}},t.userStmtTypeToStr=function(r){return"E"===r?"e":"p"},t.userStmtTypeExtendedFromStrExn=function(r){switch(r){case"g":return"G";case"h":return"H";case"p":return"P";default:throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot convert '"+r+"' to userStmtTypeExtended. Possible values are h, p, g."},Error:new Error}}},t.readInstrToStr=function(r){switch(r){case"ReadAll":return"ReadAll";case"StopBefore":return"StopBefore";case"StopAfter":return"StopAfter"}},t.readInstrFromStr=function(r){switch(r){case"ReadAll":return"ReadAll";case"StopAfter":return"StopAfter";case"StopBefore":return"StopBefore";default:throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot convert string '"+r+"' to a readInstr."},Error:new Error}}},t.mmFileSourceTypeToStr=function(r){return"Local"===r?"Local":"Web"},t.mmFileSourceTypeFromStr=function(r){switch(r){case"Local":return"Local";case"Web":return"Web";default:throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot convert string '"+r+"' to an mmFileSourceType."},Error:new Error}}},t.mmFileSourceTypeFromStrOpt=function(r){switch(r){case"Local":return"Local";case"Web":return"Web";default:return}},t.someStmtErrCode=-1,t.duplicatedStmtErrCode=1,t.createEmptyUserStmt=F,t.userStmtToRootStmt=V,t.updateStmt=H,t.isStmtChecked=z,t.toggleStmtChecked=q,t.toggleStmtCheckedWithShift=function(r,t,e){if(z(r,t))return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds.filter((function(r){return r[0]!==t})),nextAction:r.nextAction};var n,o,i,a=r.stmts.filter((function(r){return!e||r.isBkm})).map((function(r){return r.id})),s=r.checkedStmtIds.toSorted((function(r,t){var e=r[1].getTime(),n=t[1].getTime();return e<n?1:e>n?-1:0})).at(0),u=void 0!==s?(n=a,o=s[0],i=t,v.reduce(n,[!1,[]],(function(r,t){var e=r[1],n=r[0];return t===o||t===i?(e.push(t),[!n,e]):(n&&e.push(t),[n,e])}))[1]):[t],f=r.preCtxData,c=r.tabTitle,d=r.descr,l=r.descrEditMode,m=r.varsText,p=r.varsEditMode,h=r.varsErr,E=r.wrkCtxColors,x=r.disjText,g=r.disjEditMode,y=r.disjErr,_=r.wrkCtx,T=r.nextStmtId,b=r.stmts,A=r.checkedStmtIds.filter((function(r){return!u.includes(r[0])})),k=r.nextAction;return{preCtxData:f,tabTitle:c,descr:d,descrEditMode:l,varsText:m,varsEditMode:p,varsErr:h,wrkCtxColors:E,disjText:x,disjEditMode:g,disjErr:y,wrkCtx:_,nextStmtId:T,stmts:b,checkedStmtIds:A.concat(u.map((function(r){return[r,new Date]}))),nextAction:k}},t.checkAllStmts=function(r){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.stmts.map((function(r){return[r.id,new Date]})),nextAction:r.nextAction}},t.uncheckAllStmts=$,t.deleteCheckedStmts=function(r){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts.filter((function(t){return!z(r,t.id)})),checkedStmtIds:[],nextAction:r.nextAction}},t.deleteStmt=K,t.deleteStmts=J,t.canMoveCheckedStmts=Q,t.moveCheckedStmts=Z,t.moveCheckedStmtsToTop=function(r){var t=r.stmts.filter((function(t){return z(r,t.id)})),e=r.stmts.filter((function(t){return!z(r,t.id)}));return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:i.concatMany([t,e]),checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}},t.moveCheckedStmtsToBottom=function(r){var t=r.stmts.filter((function(t){return z(r,t.id)})),e=r.stmts.filter((function(t){return!z(r,t.id)}));return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:i.concatMany([e,t]),checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}},t.getRootStmtsForUnification=function(r){var t,e=I.fromArray(r.checkedStmtIds.map((function(r){return r[0]})));if(0===I.size(e))return r.stmts;for(var n=r.stmts.length-1|0;n>=0&&f.isNone(t);){var o=r.stmts[n];I.has(e,o.id)&&(t=n),n=n-1|0}var i=t;return void 0!==i?r.stmts.slice(0,i+1|0):r.stmts},t.addNewStmt=tr,t.addNewStatements=function(r,t,e){var i=void 0!==e&&e,a=Ar(r,t.newVarTypes,void 0,void 0),u=a[1],c=M.make();t.newVars.forEach((function(r,t){M.set(c,r,u[t])}));var l=function(r,t){return{newVars:r.newVars,newVarTypes:r.newVarTypes,newDisj:r.newDisj,newDisjStr:r.newDisjStr,stmts:r.stmts.map((function(r){return{label:r.label,expr:r.expr.map((function(r){return M.getWithDefault(t,r,r)})),exprStr:r.exprStr,jstf:r.jstf,isProved:r.isProved}}))}}(t,c),m=s.disjMake();s.disjForEach(l.newDisj,(function(r,t){s.disjAddPair(m,M.getWithDefault(c,r,r),M.getWithDefault(c,t,t))}));var p=kr(a[0],m),h=function(r){return 0===r.checkedStmtIds.length?void 0:r.stmts.toReversed().find((function(t){return z(r,t.id)}))}(p),E=N.make(),x=function(r){return{args:r.args.map((function(r){return N.getWithDefault(E,r,r)})),label:r.label}},g=l.stmts.some((function(r){return p.stmts.some((function(t){return Sr(t,r)}))})),y=f.isSome(h)&&!g,_={contents:p};return l.stmts.forEach((function(r){if(f.isSome(h)&&Sr(f.getExn(h),r)){var t=f.getExn(h);return _.contents=H(_.contents,t.id,(function(t){var e=o.obj_dup(t),n=r.jstf;return e.jstfText=void 0!==n?w.jstfToStr(x(n)):t.jstfText,e})),N.set(E,r.label,t.label)}var e=function(r,t,e,i,a,u){var c=r.wrkCtx;if(void 0!==c){var l,m,p=d.valFromOption(c),h=s.getHypByExpr(p,t);if(void 0!==h)return[r,h.label];if(void 0!==i){var E=r.stmts.findIndex((function(r){return r.id===i}));l=-1!==E?E:r.stmts.length}else l=r.stmts.length;if(void 0!==e){var x=I.fromArray(e.args),g=v.reduceWithIndex(r.stmts,0,(function(r,t,e){return I.isEmpty(x)?r:(I.remove(x,t.label),e+1|0)}));m=l<g?l:g}else m=0;var y=function(r,n){var i;if(void 0!==n){var c=function(r,t){return r.stmts.findIndex((function(r){return r.id===t}))}(r,n.id)+1|0;i=m<=c&&c<=l?c:m}else i=a?l:m;var v=er(r,i,void 0),h=v[1],E=v[0],x=H(E,h,(function(r){var n=o.obj_dup(r);return n.expr=t,n.jstfText=f.mapWithDefault(e,"",w.jstfToStr),n.contEditMode=!1,n.cont=P(s.ctxIntsToStrExn(p,t),d.some(E.preCtxData.symColors),d.some(E.wrkCtxColors)),n.isBkm=u,n.typ="P",n}));return[x,X(x,h).label]},_=function(r,t){return r.stmts.find((function(r){var e=r.expr;if(void 0!==e)return s.exprEq(e,t);throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot getUserStmtByExpr without stmt.expr."},Error:new Error}}))}(r,t);if(void 0===_)return y(r,void 0);if("E"===_.typ||f.isNone(e))return[r,_.label];var T=gr(_.jstfText);if("Ok"!==T.TAG)return y(r,_);var b=T._0;return void 0!==b?function(r){return void 0!==e&&w.jstfEq(r,e)}(b)?[r,_.label]:y(r,_):[void 0!==e?H(r,_.id,(function(r){var t=o.obj_dup(r);return t.jstfText=w.jstfToStr(e),t})):r,_.label]}throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot insertStmt without wrkCtx."},Error:new Error}}(_.contents,r.expr,f.map(r.jstf,x),f.map(h,(function(r){return r.id})),y,i);_.contents=e[0],N.set(E,r.label,e[1])})),_.contents},t.isSingleStmtChecked=nr,t.duplicateCheckedStmt=function(r,t){if(!nr(r))return r;var e=String(r.nextStmtId),n=r.checkedStmtIds[0][0],a={preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId+1|0,stmts:i.concatMany(r.stmts.map((function(t){if(t.id!==n)return[t];var i=o.obj_dup(t);return[t,(i.jstfText="",i.isDuplicated=!0,i.isGoal=!1,i.label=Y(r,void 0,"E"===t.typ),i.id=e,i)]}))),checkedStmtIds:[[e,new Date]],nextAction:r.nextAction};return t?Z(a,!0):a},t.bookmarkCheckedStmts=function(r,t){var e=r.checkedStmtIds.map((function(r){return r[0]}));return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts.map((function(r){if(!e.includes(r.id))return r;var n=o.obj_dup(r);return n.isBkm=t,n})),checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}},t.canGoEditModeForStmt=or,t.setDescrEditMode=function(r){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:!0,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}},t.completeDescrEditMode=function(r,t){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:t,descrEditMode:!1,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}},t.setVarsEditMode=function(r){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:!0,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}},t.completeVarsEditMode=dr,t.setDisjEditMode=function(r){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:!0,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}},t.completeDisjEditMode=ir,t.setLabelEditMode=function(r,t){return or(r,t)?H(r,t,(function(r){var t=o.obj_dup(r);return t.labelEditMode=!0,t})):r},t.completeLabelEditMode=ar,t.setContEditMode=function(r,t){return or(r,t)?H(r,t,(function(r){var t=o.obj_dup(r);return t.contEditMode=!0,t})):r},t.completeContEditMode=sr,t.setStmtCont=function(r,t,e){var n=O(e),i=r.preCtxData.settingsV.val.autoMergeStmts&&r.stmts.some((function(r){return O(r.cont)===n}));return H(r,t,(function(r){var t=o.obj_dup(r);return t.isDuplicated=i,t.cont=e,t}))},t.setTypEditMode=function(r,t){return or(r,t)?H(r,t,(function(r){var t=o.obj_dup(r);return t.typEditMode=!0,t})):r},t.completeTypEditMode=Fr,t.setJstfEditMode=function(r,t){return or(r,t)?H(r,t,(function(r){var t=o.obj_dup(r);return t.jstfEditMode=!0,t})):r},t.completeJstfEditMode=Br,t.setNextAction=function(r,t){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:t}},t.setPreCtxData=function(r,t){return cr({preCtxData:t,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction})},t.editorStateHasCriticalErrors=hr,t.editorStateHasAnyErrors=function(r){return!!hr(r)||r.stmts.some(pr)},t.editorStateHasDuplicatedStmts=function(r){return r.stmts.some((function(r){return f.getWithDefault(f.map(r.stmtErr,(function(r){return 1===r.code})),!1)}))},t.createNewDisj=kr,t.removeUnusedVars=wr,t.applyUnifyAllResults=function(r,t){var e=r.wrkCtx;if(void 0!==e){var i=d.valFromOption(e),a=l.fromArray(t.nodes.map((function(r){return[r.expr,r]})),s.ExprHash),u=l.fromArray(r.stmts.map((function(r){var t=r.expr;if(void 0!==t)return[t,r];throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot applyUnifyAllResults without stmt.expr [1]."},Error:new Error}})),s.ExprHash),c=l.fromArray(t.syntaxProofs,s.ExprHash);return v.reduce(r.stmts,r,(function(r,e){var v=o.obj_dup(e);return v.proofStatus=void 0,v.proof=void 0,H(r,v.id,(function(e){var v=e.expr;if(void 0!==v){var m=function(r,t,e,n,i,a){var s=t.cont;if("Text"!==s.TAG)return t;var u=l.get(i,e.slice(1)),f=void 0!==u?g.buildSyntaxTreeFromProofTreeDto(n,a,u.expr):void 0;if(void 0!==f){if("Ok"===f.TAG){var c=o.obj_dup(t);return c.cont={TAG:"Tree",_0:{text:s.text,exprTyp:s.syms[0].sym,root:Mr(f._0,d.some(r.preCtxData.symColors),d.some(r.wrkCtxColors)),clickedNodeId:void 0,expLvl:0}},c}var v=o.obj_dup(t);return v.syntaxErr=f._0,v}if(!r.preCtxData.settingsV.val.checkSyntax)return t;var m=o.obj_dup(t);return m.syntaxErr=function(r,t){var e="Balanced";_.parenCntReset(t);for(var n=0;n<r.length&&"Failed"!==e;)e=_.parenCntPut(t,r[n]),n=n+1|0;return"Balanced"===e}(e,r.preCtxData.parenCnt)?"":"parentheses mismatch",m}(r,e,v,i,c,t);if("P"!==m.typ)return m;var p=l.get(a,v);if(void 0!==p){var h=function(r,t,e,n,i){var a,s=n.proof;if(void 0!==s){var u=Cr(t,e,s,i);if(void 0!==u){var f=r.jstf;if(void 0!==f)if(w.jstfEq(u,f)){var c=o.obj_dup(r);c.proof=n,c.proofTreeDto=e,a=c}else a=r;else{var d=o.obj_dup(r);d.proof=n,d.proofTreeDto=e,d.jstfText=w.jstfToStr(u),a=d}}else a=r}else a=r;var v=o.obj_dup(a);return v.proofTreeDto=e,v}(m,i,t,p,u),E=h.proof;if(void 0!==E){var x=o.obj_dup(h);return x.proofStatus="Ready",x.src=E.proof,x}var y=h.jstf;if(void 0!==y){var T=p.parents.find((function(r){var e=Cr(i,t,r,u);return void 0!==e&&w.jstfEq(y,e)}));if(void 0!==T){var b=o.obj_dup(h);return b.proofStatus="Waiting",b.src=T,b}var A=p.parents.map((function(r){return"object"!=typeof r||"AssertionWithErr"!==r.TAG?void 0:[r.label,r.err]})).filter(f.isSome).map(f.getExn),k=A.length>0?A.map((function(r){var t=r[0];return G.unifErrToStr(r[1],(function(r){return s.ctxIntsToStrExn(i,r)}),(function(r){return s.frmIntsToStrExn(i,s.getFrameExn(i,t),r)}))})).join("\n\n"):void 0,S=o.obj_dup(h);return S.unifErr=f.orElse(h.unifErr,k),S.proofStatus="JstfIsIncorrect",S}var C=p.parents.map((function(r){if("object"==typeof r&&"AssertionWithErr"===r.TAG){var t=r.err;return"object"!=typeof t||"TooManyCombinations"!==t.TAG?void 0:r.label}})).filter(f.isSome).map(f.getExn),I=C.length>0?G.unifErrToStr({TAG:"TooManyCombinations",frmLabels:C},(function(r){return s.ctxIntsToStrExn(i,r)}),(function(r){return"<frmExprToStr is not defined>"})):void 0,M=o.obj_dup(h);return M.unifErr=f.orElse(h.unifErr,I),M.proofStatus="NoJstf",M}throw{RE_EXN_ID:n.MmException,_1:{msg:"exprToNode->Belt_HashMap.get(expr) is None"},Error:new Error}}throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot applyUnifyAllResults without stmt.expr [2]."},Error:new Error}}))}))}throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot applyUnifyAllResults without wrkCtx."},Error:new Error}},t.verifyEditorState=function(r){var t=br(r);if(!f.isSome(t.wrkCtx))return t;var e=wr(t);return br(e.preCtxData.settingsV.val.autoMergeStmts?zr(e,!1)[0]:e)},t.generateCompressedProof=function(r,t,e){var o=void 0!==e&&e,i=r.wrkCtx;if(void 0!==i){var a=d.valFromOption(i),c=L(r,t);if(void 0!==c){var v=c.proofTreeDto;if(void 0!==v){var l=c.proof;if(void 0!==l){var p=r.preCtxData.ctxMinV.val,h=V(c).expr,E=k.createProofTable(v,l,void 0,void 0),g=k.createProofTable(v,l,!0,d.some(a)),_=m.fromArray(E.map((function(r){return r.expr})),s.ExprHash),T=r.stmts.map(V);o&&T.forEach((function(r){if(r.isHyp)return m.add(_,r.expr)}));var b=u.createProofCtx(a,T.filter((function(r){return!!r.isHyp&&m.has(_,r.expr)}))),A=s.getMandHyps(b,h,void 0,void 0),w=x.createProof(A,E,E.length-1|0),C=[];A.forEach((function(r){f.isNone(s.getHypByExpr(p,r.expr))&&C.push(r)}));var I=y.make(16);m.forEach(_,(function(r){r.forEach((function(r){if(r>=0)return y.add(I,r)}))}));var M=y.fromArray(A.map((function(r){return r.expr[1]})));s.getLocalHyps(a).forEach((function(r){if("F"===r.typ){var t=r.expr[1];!y.has(I,t)||y.has(M,t)||C.push(r)}}));var j=s.disjMake();return S.verifyProof(b,h,w,(function(r,t){if(!s.isDisj(a,r,t))throw{RE_EXN_ID:n.MmException,_1:{msg:"!(wrkCtx->isDisj(n,m))"},Error:new Error};return s.isDisj(p,r,t)||s.disjAddPair(j,r,t),!0})),[jr(a,r.preCtxData.typeOrderInDisj,C,j,r.descr,c,w),x.proofTableToStr(a,E,c.label),x.proofTableToStr(a,g,c.label)]}}}}},t.updateColorsInAllStmts=fr,t.getTheOnlyCheckedStmt=function(r){return 1!==r.checkedStmtIds.length?void 0:rr(r)},t.editorGetStmtById=L,t.editorGetStmtByIdExn=X,t.editorGetStmtByLabel=W,t.getAllExprsToSyntaxCheck=function(r,t){var e=[];return r.stmts.forEach((function(r,n){"Text"===r.cont.TAG&&e.push(t[n].expr.slice(1))})),e},t.mergeStmts=Ur,t.renameStmt=Nr,t.findStmtsToMerge=function(r){var t;if(0===r.checkedStmtIds.length)t=r.stmts.find((function(r){return f.getWithDefault(f.map(r.stmtErr,(function(r){return 1===r.code})),!1)}));else{var e=r.checkedStmtIds[0];t=L(r,e[0])}if(void 0===t)return{TAG:"Error",_0:"[1] Cannot determine a duplicated step."};var n=O(t.cont),o=r.stmts.find((function(r){return r.id!==t.id&&O(r.cont)===n}));return void 0===o?{TAG:"Error",_0:"[2] Cannot find another step to merge with."}:r.stmts.findIndex((function(r){return r.id===t.id}))<r.stmts.findIndex((function(r){return r.id===o.id}))?{TAG:"Ok",_0:[t,o]}:{TAG:"Ok",_0:[o,t]}},t.parseJstf=gr,t.removeAllTempData=lr,t.isEditMode=function(r){return!!(r.descrEditMode||r.varsEditMode||r.disjEditMode)||r.stmts.some((function(r){return!!(r.labelEditMode||r.typEditMode||r.contEditMode)||r.jstfEditMode}))},t.resetEditorContent=function(r){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:"",descrEditMode:!1,varsText:"",varsEditMode:!1,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:"",disjEditMode:!1,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:[],checkedStmtIds:[],nextAction:r.nextAction}},t.deleteUnrelatedSteps=function(r,t,e){var n=br(r);if(hr(n))return{TAG:"Error",_0:"Cannot perform deletion because there is an error in the editor content. Please resolve the error before deleting steps."};var o=A.fromArray(t);n.stmts.forEach((function(r){if(!e&&"E"===r.typ||r.isGoal||r.isBkm)return A.add(o,r.id)}));for(var i=I.make(Math.imul(t.length,5));!A.isEmpty(o);){var a=f.getExn(A.pop(o));if(!I.has(i,a)){I.add(i,a);var s=L(n,a);if(void 0!==s){var u=s.jstf;void 0!==u&&u.args.forEach((function(r){var t=W(n,r);if(void 0!==t)return A.add(o,t.id)}))}}}var c=n.stmts.map((function(r){return r.id})).filter((function(r){return!I.has(i,r)}));return{TAG:"Ok",_0:J(n,c)}},t.autoMergeDuplicatedStatements=zr,t.userStmtHasCriticalErrors=mr,t.userStmtHasAnyErrors=pr,t.createNewVars=Ar,t.addSteps=function(r,t,e,n,o){var i=void 0!==n?n:[];if(0===i.length)return Wr(r,t,e);var a=r.wrkCtx;if(void 0===a)return{TAG:"Error",_0:"Cannot add new variables because of errors in the editor."};var u=d.valFromOption(a),c=i.map((function(r){return r[0]})),v=c.map((function(r){return s.ctxSymToInt(u,r)})),l=v.findIndex(f.isNone);if(l>=0)return{TAG:"Error",_0:"Unknown type - "+c[l]};var m=v.map(f.getExn);return function(r){return!!r.every((function(r){return f.isNone(r[1])}))||r.every((function(r){return f.isSome(r[1])}))}(i)?Wr(i.some((function(r){return f.isNone(r[1])}))?Ar(r,m,void 0,o)[0]:Ar(r,m,i.map((function(r){return f.getExn(r[1])})),o)[0],t,e):{TAG:"Error",_0:"All variable names must be either defined or undefined."}},t.updateSteps=function(r,t){var e=[function(t,e){var n=e.cont;if(void 0===n)return{TAG:"Ok",_0:t};if(""===n.trim())return{TAG:"Error",_0:"Steps must not have empty statements."};var i=o.obj_dup(t);return{TAG:"Ok",_0:(i.isDuplicated=!1,i.contEditMode=!1,i.cont=P(n,d.some(r.preCtxData.symColors),d.some(r.wrkCtxColors)),i)}},function(r,t){var e=t.typ;if(void 0===e)return{TAG:"Ok",_0:r};var n=R(e),i=o.obj_dup(r);return{TAG:"Ok",_0:(i.isGoal=n[1],i.typEditMode=!1,i.typ=n[0],i)}},function(r,t){var e=t.jstf;if(void 0===e)return{TAG:"Ok",_0:r};var n=o.obj_dup(r);return{TAG:"Ok",_0:(n.jstfEditMode=!1,n.jstfText=e,n)}},function(r,t){var e=t.isBkm;if(void 0===e)return{TAG:"Ok",_0:r};var n=o.obj_dup(r);return{TAG:"Ok",_0:(n.isBkm=e,n)}}],n=C.fromArray(t.filter((function(r){return f.isSome(r.id)})).map((function(r){return[f.getExn(r.id),r]}))),i=v.reduce(r.stmts,{TAG:"Ok",_0:[]},(function(r,t){if("Ok"!==r.TAG)return r;var o=r._0,i=C.get(n,t.id),a=void 0!==i?v.reduce(e,{TAG:"Ok",_0:t},(function(r,t){return c.flatMap(r,(function(r){return t(r,i)}))})):{TAG:"Ok",_0:t};return"Ok"!==a.TAG?{TAG:"Error",_0:a._0}:(o.push(a._0),{TAG:"Ok",_0:o})}));return"Ok"===i.TAG?{TAG:"Ok",_0:{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:i._0,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}}:{TAG:"Error",_0:i._0}},t.getSelectedSubtree=qr,t.getSelectedSubtreeFromStmtCont=function(r){return f.flatMap(function(r){return"Text"===r.TAG?void 0:r._0}(r),qr)},t.getIdsOfSelectedNodes=function(r){if("Text"===r.TAG)return[-1,void 0];var t=r._0,e=t.clickedNodeId;if(void 0===e)return[-1,void 0];var n=qr(t);return void 0!==n?[e[0],g.syntaxTreeGetIdsOfAllChildSymbols(n)]:[-1,void 0]},t.hasSelectedText=function(r){return"Text"!==r.TAG&&void 0!==r._0.clickedNodeId},t.getSelectedText=function(r){return"Text"===r.TAG?void 0:f.map(qr(r._0),g.syntaxTreeToText)},t.getNodeIdBySymIdx=function(r,t){var e={contents:0};return g.syntaxTreeForEachNode({TAG:"Subtree",_0:t},(function(t){if("Subtree"!==t.TAG)return e.contents=e.contents+1|0,e.contents===r?t.id:void 0}))},t.incExpLvl=Kr,t.decExpLvl=Jr,t.incExpLvlIfConstClicked=function(r){if(0!==r.expLvl)return r;var t=r.clickedNodeId;if(void 0===t)return r;var e=g.getNodeById(r.root,t[0]);return void 0!==e&&"Subtree"!==e.TAG&&1!==g.syntaxTreeGetNumberOfSymbols({TAG:"Subtree",_0:e.parent})?Qr(r,!0):r},t.getNumberOfSelectedSymbols=$r,t.updateExpLevel=Qr,t.addColorsToSyntaxTree=Mr,t.getColorForSymbol=Ir,t.renumberProvableSteps=function(r){return Zr(r,(function(r){return"P"===r.typ&&!r.isGoal&&Pr(r.label)}),"",!1)},t.renumberHypothesisSteps=function(r,t){return Zr(r,(function(r){return"E"===r.typ}),t+".",!0)},t.textToSyntaxProofTable=Yr,t.textToSyntaxTree=function(r,t,e,n,o,i,a,s){var u=Yr(r,t,e,n,o,i,a,s);return"Ok"===u.TAG?{TAG:"Ok",_0:u._0.map((function(t){if("Ok"!==t.TAG)return{TAG:"Error",_0:t._0};var e=t._0;return g.buildSyntaxTree(r,e,e.length-1|0)}))}:{TAG:"Error",_0:u._0}},t.recalcWrkColors=cr},7115:(r,t,e)=>{var n=e(2971),o=e(3333),i=e(1094),a=e(303),s=e(2761),u=e(2448),f=e(7356),c=e(9662),d=e(5047),v=e(8492),l=e(7653),m="MM_wrk_search_asrt";function p(r){switch(r){case"!":return{TAG:"Ok",_0:"Exact"};case"+":return{TAG:"Ok",_0:"Adj"};case"a":return{TAG:"Ok",_0:"Asrt"};case"h":return{TAG:"Ok",_0:"Hyp"};default:return{TAG:"Error",_0:"Cannot convert '"+r+"' to patternModifier"}}}function h(r){for(var t=[],e=!1,n=[],o=[],i=[],a={contents:0},s=r.length-1|0,f={contents:void 0},c=function(r){f.contents=function(r){return r+" at position "+String(a.contents+1|0)+"."}(r)},d=function(r){r.splice(0,r.length)},v=function(){if(i.length>0)return o.push(i.join("")),d(i)},l=function(){return v(),n.length>0&&0===o.length?c("At least one symbol is expected"):o.length>0?(t.push([n.slice(),o.slice()]),d(n),d(o)):void 0};a.contents<=s&&u.isNone(f.contents);){var m=r.charAt(a.contents);if(""===m.trim())e?e=!1:v();else if(e){var h=p(m);"Ok"===h.TAG?(n.push(h._0),n.includes("Hyp")&&n.includes("Asrt")?c("A sub-pattern cannot be both a hypothesis and an assertion"):n.includes("Adj")&&n.includes("Exact")&&c("A sub-pattern cannot be both Adjacent and Exact")):c(h._0)}else"$"===m?(l(),e=!0):i.push(m);a.contents=a.contents+1|0}var E=f.contents;if(void 0!==E)return{TAG:"Error",_0:E};l();var x=f.contents;return void 0!==x?{TAG:"Error",_0:x}:t.length>1&&t.some((function(r){var t=r[0];return!(t.includes("Hyp")||t.includes("Asrt"))}))?{TAG:"Error",_0:"Each sub-pattern must be either a hypothesis or an assertion."}:{TAG:"Ok",_0:t}}function E(r,t,e,n){for(var o=0,i=t.length-1|0,a=n,s=r.length-1|0,u=!0;u&&o<=i&&a<=s;){var f=r[a],c=t[o];u=f<0&&f===c||f>=0&&e[f]===c,o=o+1|0,a=a+1|0}return!!u&&o>i}function x(r,t,e,n,o,i){for(var a=0,s=t.length-1|0,u=i,c=r.length-1|0,d=!0;d&&a<=s&&u<=c;){var v=r[u],l=t[a];if(v<0)d=v===l;else if((d=n[v]===e[a])&&l>=0){var m=f.get(o,l);void 0!==m?d=m===v:f.set(o,l,v)}a=a+1|0,u=u+1|0}return f.clear(o),!!d&&a>s}function g(r,t,e,n,o,i,a){if(i===t.length)return!0;for(var s={contents:a},u=function(){return g(r,t,e,n,o,i+1|0,s.contents+1|0)},c=!1,d=r.length-(t.length-i|0)|0;!c&&s.contents<=d;){var v=r[s.contents],l=t[i];if(v<0&&v===l)c=u();else if(v>=0&&n[v]===e[i])if(l<0)c=u();else{var m=f.get(o,l);void 0!==m?m===v&&(c=u()):(f.set(o,l,v),c=u(),f.remove(o,l))}s.contents=s.contents+1|0}return c}function y(r,t,e,n,o,i){if(function(r,t,e,n){var o=t.length,i=r.length;if(n.includes("Exact"))return o===i&&E(r,t,e,0);if(n.includes("Adj")){for(var a=!1,s=0,u=i-o|0;!a&&s<=u;)a=E(r,t,e,s),s=s+1|0;return a}for(var f=0,c=0;f<o&&c<i;){var d=r[c],v=t[f];(d<0&&d===v||d>=0&&e[d]===v)&&(f=f+1|0),c=c+1|0}return f===o}(r,e,n,o)){var a=e.length,s=r.length;if(o.includes("Exact"))return a===s&&x(r,t,e,n,i,0);if(!o.includes("Adj"))return g(r,t,e,n,i,0,0);for(var u=!1,f=0,c=s-a|0;!u&&f<=c;)u=x(r,t,e,n,i,f),f=f+1|0;return u}return!1}function _(r,t,e){if(1!==t.length||t[0].flags.includes("Hyp")||t[0].flags.includes("Asrt")){var n=function(r,t,e){return t===r.length||r[t].some((function(o){if(e.includes(o))return!1;e.push(o);var i=n(r,t+1|0,e);return e.pop(),i}))},o=r.varTypes,i=t.filter((function(r){return r.flags.includes("Asrt")})),a=i.find((function(t){return!y(r.asrt,t.varPat,t.constPat,o,t.flags,e)}));if(void 0!==a)return!1;var u=t.filter((function(r){return r.flags.includes("Hyp")}));if(0===u.length)return!0;var f=r.hyps.filter((function(r){return"E"===r.typ}));if(f.length<u.length)return!1;var c=s.reduce(u,[],(function(r,t){if(void 0!==r){var n=f.map((function(r,t){return[r,t]})).filter((function(r){return y(r[0].expr,t.varPat,t.constPat,o,t.flags,e)})).map((function(r){return r[1]}));return 0===n.length?void 0:(r.push(n),r)}}));return void 0!==c&&n(c,0,[])}var d=t[0],v=d.varPat,l=d.constPat,m=d.flags,p=r.varTypes;return!!y(r.asrt,v,l,p,m,e)||s.reduce(r.hyps,!1,(function(r,t){return!!r||"E"===t.typ&&y(t.expr,v,l,p,m,e)}))}function T(r,t){var e=o.disjMake();i.forEach(t.disj,(function(r,t){a.forEach(t,(function(t){o.disjAddPair(e,r,t)}))}));var s=[];o.disjForEachArr(e,void 0,void 0,void 0,void 0,(function(e){s.push(o.frmIntsToStrExn(r,t,e))}));var u=[],f=[];return t.hyps.forEach((function(e){if("E"===e.typ){var n=e.label;f.push(n),u.push({label:n,expr:e.expr,exprStr:o.frmIntsToStrExn(r,t,e.expr),jstf:void 0,isProved:!1})}})),u.push({label:t.label,expr:t.asrt,exprStr:o.frmIntsToStrExn(r,t,t.asrt),jstf:{args:f,label:t.label},isProved:!1}),{newVars:n.range(0,t.numOfVars-1|0),newVarTypes:t.varTypes,newDisj:e,newDisjStr:s,stmts:u}}function b(r,t){return void 0===r||r===t}function A(r,t,e,n,o,i,a,s,c){var d=l.progressTrackerMake(.01,void 0,c,void 0),v={contents:0},m=r.length,p=f.make(10),h=n.trim().toLowerCase();return r.filter((function(r){return void 0!==c&&(v.contents=v.contents+1,l.progressTrackerSetCurrPct(d,v.contents/m)),!!(u.mapOr(t,!0,(function(t){return t===r.isAxiom}))&&u.mapOr(e,!0,(function(t){return t===r.asrt[0]}))&&r.label.toLowerCase().includes(h)&&b(i,r.isDisc)&&b(a,r.isDepr)&&b(s,r.isTranDepr))&&_(r,o,p)}))}t.procName=m,t.parseSearchStr=h,t.makeSearchPattern=function(r,t){var e=h(r);return"Ok"===e.TAG?s.reduce(e._0,{TAG:"Ok",_0:[]},(function(r,e){var n=e[1];if("Ok"!==r.TAG)return r;var i=r._0,a=n.find((function(r){return u.isNone(o.ctxSymToInt(t,r))}));if(void 0!==a)return{TAG:"Error",_0:"'"+a+"' - is not a constant or a variable."};var s=o.ctxSymsToIntsExn(t,n),f=s.map((function(r){return r<0?r:o.getTypeOfVarExn(t,r)}));return i.push({flags:e[0],varPat:s,constPat:f}),{TAG:"Ok",_0:i}})):{TAG:"Error",_0:e._0}},t.threeStateBoolMatchesTwoStateBool=b,t.doSearchAssertions=A,t.searchAssertions=function(r,t,e,n,o,i,a,s,u,f,d,l,p){return v.promise((function(v){c.beginWorkerInteractionUsingCtx(r,t,e,n,"","",m,{TAG:"FindAssertions",isAxiom:o,typ:i,label:a,searchPattern:s,isDisc:u,isDepr:f,isTranDepr:d,returnLabelsOnly:l},(function(r,t,e){if("OnProgress"===r.TAG)return p(r._0);e(),v([r.found,r.foundLabels])}),!1)}))},t.frameToStmtsDto=T,t.processOnWorkerSide=function(r,t){var e=A(c.getAllFramesInDeclarationOrderExn(),r.isAxiom,r.typ,r.label,r.searchPattern,r.isDisc,r.isDepr,r.isTranDepr,(function(r){t({TAG:"OnProgress",_0:r})})),n=r.returnLabelsOnly?[[],e.map((function(r){return r.label}))]:[e.map((function(r){return T(c.getWrkCtxExn(),r)})),[]];t({TAG:"SearchResult",found:n[0],foundLabels:n[1]})},t.frameMatchesPattern=_,t.reqToStr=function(r){return'FindAssertions(label="'+r.label+'", pattern='+d.stringify(r.searchPattern)+")"},t.respToStr=function(r){return"OnProgress"===r.TAG?"OnProgress(pct="+String(r._0)+")":"SearchResult"}},4186:(r,t,e)=>{var n=e(5291),o=e(3333),i=e(9592),a=e(6517),s=e(7175),u=e(2815),f=e(9775),c=e(7356),d=e(9662),v=e(368),l=e(1717),m=e(9702),p=e(8615),h=e(8492),E="MM_wrk_unify";function x(r,t,e){var n=new Array(r.numOfVars);return r.hyps.forEach((function(r,o){"F"!==r.typ||(n[r.expr[1]]=e.nodes[t[o]].expr)})),n}t.procName=E,t.unify=function(r,t,e,n,o,i,a,s,u,f,c,v,l){return h.promise((function(m){d.beginWorkerInteractionUsingCtx(r,t,e,n,o,i,E,{TAG:"Unify",rootStmts:a,bottomUpProverParams:s,allowedFrms:u,combCntMax:t.combCntMax,syntaxTypes:f,exprsToSyntaxCheck:c,debugLevel:v},(function(r,t,e){if("OnProgress"===r.TAG)return l(r._0);e(),m(r._0)}),!1)}))},t.processOnWorkerSide=function(r,t){var e=r.rootStmts,n=i.unifyAll(d.getWrkCtxExn(),d.getWrkFrmsExn(),e,d.getWrkParenCntExn(),r.bottomUpProverParams,r.allowedFrms,r.combCntMax,r.syntaxTypes,r.exprsToSyntaxCheck,r.debugLevel,(function(r){t({TAG:"OnProgress",_0:r})}));t({TAG:"Result",_0:l.proofTreeToDto(n,e.map((function(r){return r.expr})))})},t.proofTreeDtoToNewStmtsDto=function(r,t,e,i,d,l){var h=c.fromArray(r.newVars.map((function(r){if(2!==r.length)throw{RE_EXN_ID:"Match_failure",_1:["MM_wrk_unify.res",391,64],Error:new Error};var t=r[0];return[r[1],t]}))),E=r.nodes.find((function(r){return o.exprEq(r.expr,t)}));if(void 0===E)throw{RE_EXN_ID:n.MmException,_1:{msg:"the proof tree DTO doesn't contain the node to prove."},Error:new Error};return E.parents.map((function(E){if("object"==typeof E&&"Assertion"===E.TAG){var g=E.args,y={contents:!1},_={contents:!1},T=[],b=[],A=o.disjMake(),k=[],S=[],w={newVars:T,newVarTypes:b,newDisj:A,newDisjStr:k,stmts:S},C=u.toArray(d),I=u.fromArray(C,o.ExprHash),M=p.fromArray(l),j=function(r,t,i){var a=u.get(I,r);if(void 0!==a)return a;var f=o.getHypByExpr(e,r);if(void 0!==f)return f.label;if(i){var c=o.generateNewLabels(e,t,1,s.some(M),!0)[0];return u.set(I,r,c),p.add(M,c),c}throw{RE_EXN_ID:n.MmException,_1:{msg:"Could not find a label for an expr."},Error:new Error}},D=function(r,t){return j(r,t,!0)},G=function(r){return j(r,"",!1)},N=c.make(8),U=p.make(8),O=o.getNumOfVars(e)-1|0,P=function(r){if(r<=O){var t=o.ctxIntToSym(e,r);if(void 0!==t)return t;throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot determine sym for an existing int in srcToNewStmts."},Error:new Error}}var i=c.get(N,r);if(void 0!==i)return i;throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot determine name of a new var in srcToNewStmts."},Error:new Error}},R=function(r){var t=o.getFrame(e,r);if(void 0!==t)return t;throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot get a frame by label '"+r+" in srcToNewStmts.'"},Error:new Error}},F=function(t,a,u,f){a.forEach((function(r){if(r>O&&!T.includes(r)){var t=c.get(h,r);if(void 0!==t){T.push(r),b.push(t);var a=o.generateNewVarNames(e,[t],s.some(i),s.some(U))[0];return c.set(N,r,a),p.add(U,a),void D([t,r],"v")}throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot determine type of a new var in srcToNewStmts."},Error:new Error}}}));var d,v=a.map(P).join(" ");if(void 0!==u&&"object"==typeof u)switch(u.TAG){case"Hypothesis":d=void 0;break;case"Assertion":var l=u.label,m=u.args,E=[];R(l).hyps.forEach((function(t,e){"E"!==t.typ||E.push(G(r.nodes[m[e]].expr))})),d={args:E,label:l};break;case"AssertionWithErr":y.contents=!0,d=void 0}else d=void 0;S.push({label:t,expr:a,exprStr:v,jstf:d,isProved:f})},V=R(E.label),B=[];V.hyps.forEach((function(t,e){"E"!==t.typ||B.push(r.nodes[g[e]])}));var L=f.make(16,o.ExprHash),W=f.make(16,o.ExprHash);return B.forEach((function(n){v.traverseTree(f.fromArray([t],o.ExprHash),n,(function(t,e){if(!f.has(L,e.expr)){f.add(L,e.expr);var n=e.proof;if(void 0!==n&&"object"==typeof n)switch(n.TAG){case"Hypothesis":return;case"Assertion":var o=n.args,i=[];return R(n.label).hyps.forEach((function(t,e){"E"!==t.typ||i.push(r.nodes[o[e]])})),i;case"AssertionWithErr":return void(y.contents=!0)}}}),(function(r,t){return y.contents||_.contents?s.some(void 0):f.has(r,t.expr)?(_.contents=!0,s.some(void 0)):void f.add(r,t.expr)}),void 0,(function(t,n){if(f.remove(t,n.expr),y.contents||_.contents)return s.some(void 0);if(!f.has(W,n.expr)){f.add(W,n.expr);var i=n.proof;if(void 0!==i){if("object"==typeof i)switch(i.TAG){case"Hypothesis":return;case"Assertion":var a=R(i.label);return m.verifyDisjoints(x(a,i.args,r),a.disj,(function(r,t){return o.isDisj(e,r,t)||o.disjAddPair(A,r,t),!0})),void F(D(n.expr,""),n.expr,n.proof,!0);case"AssertionWithErr":return y.contents=!0,s.some(void 0)}}else F(D(n.expr,""),n.expr,void 0,!1)}}))})),y.contents||_.contents?void 0:(F(G(t),t,E,g.every((function(t){return a.isSome(r.nodes[t].proof)}))),m.verifyDisjoints(x(V,g,r),V.disj,(function(r,t){return o.isDisj(e,r,t)||o.disjAddPair(A,r,t),!0})),o.disjForEachArr(A,void 0,void 0,void 0,void 0,(function(r){k.push("$d "+r.map(P).join(" ")+" $.")})),w)}})).filter(a.isSome).map(a.getExn)},t.reqToStr=function(r){return"Unify(debugLevel="+String(r.debugLevel)+", bottomUpProverParams="+(void 0!==(t=r.bottomUpProverParams)?t.frameParams.map((function(r){return"{allowNewDisjForExistingVars="+(r.allowNewDisjForExistingVars?"true":"false")+"}"})).join("; "):"None")+")";var t},t.respToStr=function(r){return"OnProgress"===r.TAG?'OnProgress("'+r._0+'")':"Result"}},2855:(r,t,e)=>{var n=e(6862),o=e(6517),i=e(4186),a=e(5082),s=e(5171),u=e(9662),f=e(5376),c=e(8152),d=e(7115);function v(r,t,e){return function(o,i){var a=n.deserialize(o.body);o.traceEnabled&&n.logWorkerReceivedRequest(o.clientId,o.procName,a,t),r(a,(function(r){o.traceEnabled&&n.logWorkerIsSendingResponse(o.clientId,o.procName,r,e),i({clientId:o.clientId,body:n.serialize(r)})}))}}var l=a.fromArray([[c.procName,v(c.processOnWorkerSide,c.reqToStr,c.respToStr)],[s.procName,v(s.processOnWorkerSide,s.reqToStr,s.respToStr)],[f.procName,v(f.processOnWorkerSide,f.reqToStr,f.respToStr)],[u.procName,v(u.processOnWorkerSide,u.reqToStr,u.respToStr)],[d.procName,v(d.processOnWorkerSide,d.reqToStr,d.respToStr)],[i.procName,v(i.processOnWorkerSide,i.reqToStr,i.respToStr)]]);t.U=function(r){o.forEach(a.get(l,r.procName),(function(t){t(r,(function(r){postMessage(r)}))}))}},5047:(r,t,e)=>{var n=e(2900),o=e(2971),i=e(5300),a=e(6517),s=e(303),u=e(1367),f=e(6181),c=n.raiseError,d=f.create("Expln_utils_common.ExplnUtilsException");t.exn=c,t.clearArray=r=>r.length=0,t.arrFlatMap=function(r,t){return o.concatMany(o.map(r,t))},t.arrStrDistinct=function(r){return u.toArray(u.fromArray(r))},t.arrIntDistinct=function(r){return s.toArray(s.fromArray(r))},t.arrForEach=function(r,t){for(var e,n=r.length,o=0;o<n&&a.isNone(e);)e=t(r[o]),o=o+1|0;return e},t.arrJoin=function(r,t){var e=r.length;if(e<2)return r;for(var n=new Array((e<<1)-1|0),o=e-1|0,i=0;i<=o;++i)n[i<<1]=r[i],i!==o&&(n[1+(i<<1)|0]=t);return n},t.copySubArray=function(r,t,e,n,o){for(var i=t,a=n,s=r.length,u=e.length,f=Math.min(s-1|0,(t+o|0)-1|0);i<=f&&a<u;)e[a]=r[i],a=a+1|0,i=i+1|0},t.toIntCmp=function(r){return function(t,e){return i.Int.floor(Math.sign(r(t,e)))}},t.intCmp=function(r,t){return r<t?-1:r===t?0:1},t.floatCmp=function(r,t){return r<t?-1:r===t?0:1},t.strCmp=function(r,t){return r.localeCompare(t)},t.strCmpI=function(r,t){return r.toLocaleUpperCase().localeCompare(t.toLocaleUpperCase())},t.cmpRev=function(r){return function(t,e){return-r(t,e)}},t.stringify=function(r){var t=JSON.stringify(r);return void 0!==t?t:"undefined"},t.ExplnUtilsException=d,t.comparatorBy=function(r){return function(t,e){var n=r(t),o=r(e);return n<o?-1:n===o?0:1}},t.comparatorAndThen=function(r,t){return function(e,n){var o=r(e,n);return 0!==o?o:t(e,n)}},t.comparatorInverse=function(r){return function(t,e){return-r(t,e)}},t.hashStr=r=>{let t=0;for(let e=0;e<r.length;e++)t=(t<<5)-t+r.charCodeAt(e),t|=0;return t},t.hashArrInt=r=>{let t=0;for(let e=0;e<r.length;e++)t=(t<<5)-t+r[e],t|=0;return t},t.hashArrIntFromTo=(r,t,e)=>{let n=0;for(let o=t;o<=e;o++)n=(n<<5)-n+r[o],n|=0;return n},t.hash2=(r,t)=>(r<<5)-r+t|0,t.sortInPlaceWith=function(r,t){return r.sort(t),r}},368:(r,t,e)=>{var n=e(6517),o=e(6601),i=e(5047);t.log=function(r){console.log(r)},t.log2=function(r,t){console.log(r,t)},t.traverseTree=function(r,t,e,a,s,u){var f,c=n.isSome(a),d=n.isSome(s),v=n.isSome(u),l=o.make();for(o.push(l,{node:t,nodesToPostProcess:v?[t]:void 0});!o.isEmpty(l)&&n.isNone(f);){var m=o.pop(l);if(void 0!==m&&(c&&(f=n.flatMap(a,function(t){return function(e){return e(r,t.node)}}(m))),d&&n.isNone(f)&&(f=n.flatMap(s,function(t){return function(e){return e(r,t.node)}}(m))),n.isNone(f))){var p=e(r,m.node),h=0;if(void 0!==p&&0!==p.length)for(var E=p.length-1|0,x=E;x>=0;--x){var g;if(v)if(x===E){var y=m.nodesToPostProcess;if(void 0===y)throw{RE_EXN_ID:i.ExplnUtilsException,_1:{msg:"this case is not possible, because each node has itself in its nodesToPostProcess (2)"},Error:new Error};y.push(p[x]),g=y}else g=[p[x]];else g=void 0;o.push(l,{node:p[x],nodesToPostProcess:g})}else h=1;if(1===h&&v){var _=m.nodesToPostProcess;if(void 0===_)throw{RE_EXN_ID:i.ExplnUtilsException,_1:{msg:"this case is not possible, because each node has itself in its nodesToPostProcess (1)"},Error:new Error};for(var T={contents:_.length-1|0};T.contents>=0&&n.isNone(f);)f=n.flatMap(u,function(t,e){return function(n){return n(r,e[t.contents])}}(T,_)),T.contents=T.contents-1|0}}}return[r,f]}},8492:(r,t,e)=>{var n=e(4518);function o(r){return new Promise((function(t,e){try{return r((function(r){t(r)}))}catch(r){return e(n.internalToOCamlException(r))}}))}t.promise=o,t.promiseFlatMap=function(r,t){return r.then(t)},t.promiseMap=function(r,t){return r.then((function(r){return Promise.resolve(t(r))}))},t.promiseResolved=function(r){return o((function(t){t(r)}))}}},e={};r=function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}(2855),onmessage=t=>{(0,r.U)(t.data)}})();