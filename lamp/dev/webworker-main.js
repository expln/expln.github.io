(()=>{"use strict";var r,t={2761:(r,t,e)=>{var n=e(7175);function o(r,t,e){var n=r[t];r[t]=r[e],r[e]=n}function i(r){for(var t,e,n=r.length,i=0;i<n;++i)o(r,i,(t=i,e=n,(0|Math.floor(Math.random()*(e-t|0)))+t|0))}function a(r,t){for(var e=r.length,o=new Array(e),i=0,a=0;a<e;++a){var s=t(r[a]);void 0!==s&&(o[i]=n.valFromOption(s),i=i+1|0)}return o.length=i,o}t.make=function(r,t){if(r<=0)return[];var e=new Array(r);return e.fill(t),e},t.fromInitializer=function(r,t){if(r<=0)return[];for(var e=new Array(r),n=0;n<r;++n)e[n]=t(n);return e},t.equal=function(r,t,e){var n=r.length;if(n!==t.length)return!1;for(var o=0;;){var i=o;if(i===n)return!0;if(!e(r[i],t[i]))return!1;o=i+1|0}},t.compare=function(r,t,e){var n=r.length,o=t.length;if(n<o)return-1;if(n>o)return 1;for(var i=0;;){var a=i;if(a===n)return 0;var s=e(r[a],t[a]);if(0!==s)return s;i=a+1|0}},t.indexOfOpt=function(r,t){var e=r.indexOf(t);if(-1!==e)return e},t.lastIndexOfOpt=function(r,t){var e=r.lastIndexOf(t);if(-1!==e)return e},t.reduce=function(r,t,e){return r.reduce(e,t)},t.reduceWithIndex=function(r,t,e){return r.reduce(e,t)},t.reduceRight=function(r,t,e){return r.reduceRight(e,t)},t.reduceRightWithIndex=function(r,t,e){return r.reduceRight(e,t)},t.findIndexOpt=function(r,t){var e=r.findIndex(t);if(-1!==e)return e},t.filterMap=a,t.keepSome=function(r){return a(r,(function(r){return r}))},t.toShuffled=function(r){var t=r.slice();return i(t),t},t.shuffle=i,t.findMap=function(r,t){for(var e=0;;){var n=e;if(n===r.length)return;var o=t(r[n]);if(void 0!==o)return o;e=n+1|0}},t.last=function(r){return r[r.length-1|0]}},5015:(r,t)=>{t.$$EvalError={},t.$$RangeError={},t.$$ReferenceError={},t.$$SyntaxError={},t.$$TypeError={},t.$$URIError={},t.panic=function(r){throw new Error("Panic! "+r)}},5300:(r,t)=>{var e={floor:function(r){return 0|Math.floor(r)},ceil:function(r){return 0|Math.ceil(r)},random:function(r,t){var e=Math.random()*(t-r|0);return(0|Math.floor(e))+r|0}};t.Constants={},t.Int=e},2448:(r,t,e)=>{var n=e(7175),o=e(5015);function i(r,t,e){return void 0!==r?e(n.valFromOption(r)):t}function a(r,t){return void 0!==r?n.valFromOption(r):t}var s=i,u=a;t.filter=function(r,t){if(void 0!==r&&t(n.valFromOption(r)))return r},t.forEach=function(r,t){if(void 0!==r)return t(n.valFromOption(r))},t.getExn=function(r,t){return void 0!==r?n.valFromOption(r):o.panic(void 0!==t?t:"Option.getExn called for None value")},t.mapOr=i,t.mapWithDefault=s,t.map=function(r,t){if(void 0!==r)return n.some(t(n.valFromOption(r)))},t.flatMap=function(r,t){if(void 0!==r)return t(n.valFromOption(r))},t.getOr=a,t.getWithDefault=u,t.orElse=function(r,t){return void 0!==r?r:t},t.isSome=function(r){return void 0!==r},t.isNone=function(r){return void 0===r},t.equal=function(r,t,e){return void 0!==r?void 0!==t&&e(n.valFromOption(r),n.valFromOption(t)):void 0===t},t.compare=function(r,t,e){return void 0!==r?void 0!==t?e(n.valFromOption(r),n.valFromOption(t)):1:void 0!==t?-1:0}},119:(r,t)=>{t.isLess=function(r){return r<0},t.isEqual=function(r){return 0===r},t.isGreater=function(r){return r>0},t.invert=function(r){return-r},t.fromInt=function(r){return r<0?-1:r>0?1:0}},6778:(r,t)=>{function e(r,t,e){return"Ok"===r.TAG?e(r._0):t}function n(r,t){return"Ok"===r.TAG?r._0:t}var o=e,i=n;t.getExn=function(r){if("Ok"===r.TAG)return r._0;throw{RE_EXN_ID:"Not_found",Error:new Error}},t.mapOr=e,t.mapWithDefault=o,t.map=function(r,t){return"Ok"===r.TAG?{TAG:"Ok",_0:t(r._0)}:r},t.flatMap=function(r,t){return"Ok"===r.TAG?t(r._0):r},t.getOr=n,t.getWithDefault=i,t.isOk=function(r){return"Ok"===r.TAG},t.isError=function(r){return"Ok"!==r.TAG},t.equal=function(r,t,e){return"Ok"===r.TAG?"Ok"===t.TAG&&e(r._0,t._0):"Ok"!==t.TAG},t.compare=function(r,t,e){return"Ok"===r.TAG?"Ok"===t.TAG?e(r._0,t._0):1:"Ok"===t.TAG?-1:0},t.forEach=function(r,t){if("Ok"===r.TAG)return t(r._0)},t.mapError=function(r,t){return"Ok"===r.TAG?r:{TAG:"Error",_0:t(r._0)}}},2971:(r,t,e)=>{var n=e(6253),o=e(1386),i=e(4763),a=e(7175);function s(r,t,e){var n=r[t];r[t]=r[e],r[e]=n}function u(r){for(var t=r.length,e=0;e<t;++e)s(r,e,i.random_int(e,t))}function c(r,t){if(r<=0)return[];for(var e=new Array(r),n=0;n<r;++n)e[n]=t(n);return e}function f(r,t){var e=c(r,t);return u(e),e}function d(r,t,e){for(var n=r.length,o=t.length,i=n<o?n:o,a=new Array(i),s=0;s<i;++s)a[s]=e(r[s],t[s]);return a}function v(r){for(var t=r.length,e=0,n=0;n<t;++n)e=e+r[n].length|0;var o=new Array(e);e=0;for(var i=0;i<t;++i)for(var a=r[i],s=0,u=a.length;s<u;++s)o[e]=a[s],e=e+1|0;return o}function l(r,t){for(var e=0,n=r.length;e<n;++e)t(r[e])}function m(r,t){for(var e=r.length,n=new Array(e),o=0;o<e;++o)n[o]=t(r[o]);return n}function p(r,t){for(var e,n=r.length,o=0;void 0===e&&o<n;){var i=r[o];t(i)&&(e=a.some(i)),o=o+1|0}return e}function h(r,t){for(var e,n=r.length,o=0;void 0===e&&o<n;)t(r[o])&&(e=o),o=o+1|0;return e}function E(r,t){for(var e=r.length,n=new Array(e),o=0,i=0;i<e;++i){var a=r[i];t(a)&&(n[o]=a,o=o+1|0)}return n.length=o,n}function x(r,t){for(var e=r.length,n=new Array(e),o=0,i=0;i<e;++i){var a=r[i];t(a,i)&&(n[o]=a,o=o+1|0)}return n.length=o,n}function g(r,t){for(var e=r.length,n=new Array(e),o=0,i=0;i<e;++i){var s=t(r[i]);void 0!==s&&(n[o]=a.valFromOption(s),o=o+1|0)}return n.length=o,n}function y(r,t){for(var e=0,n=r.length;e<n;++e)t(e,r[e])}function _(r,t){for(var e=r.length,n=new Array(e),o=0;o<e;++o)n[o]=t(o,r[o]);return n}function T(r,t,e){for(var n=t,o=0,i=r.length;o<i;++o)n=e(n,r[o]);return n}function A(r,t,e){for(var n=t,o=r.length-1|0;o>=0;--o)n=e(n,r[o]);return n}function b(r,t,e,o){for(var i=e,a=n.int_min(r.length,t.length)-1|0;a>=0;--a)i=o(i,r[a],t[a]);return i}function k(r,t,e){for(var n=t,o=0,i=r.length;o<i;++o)n=e(n,r[o],o);return n}function S(r,t){for(var e=r.length,n=0;;){var o=n;if(o===e)return!0;if(!t(r[o]))return!1;n=o+1|0}}function C(r,t){for(var e=r.length,n=0;;){var o=n;if(o===e)return!1;if(t(r[o]))return!0;n=o+1|0}}function w(r,t,e,n,o){for(;;){var i=e;if(i===o)return!0;if(!n(r[i],t[i]))return!1;e=i+1|0}}function I(r,t,e){return w(r,t,0,e,n.int_min(r.length,t.length))}function M(r,t,e){for(var o=0,i=n.int_min(r.length,t.length);;){var a=o;if(a===i)return!1;if(e(r[a],t[a]))return!0;o=a+1|0}}function G(r,t,e){var n=r.length;return n===t.length&&w(r,t,0,e,n)}function j(r,t,e){var n=r.length,o=t.length;if(n>o)return 1;if(n<o)return-1;for(var i=0;;){var a=i;if(a===n)return 0;var s=e(r[a],t[a]);if(0!==s)return s;i=a+1|0}}function D(r,t){for(var e=r.length,n=0,o=0,i=new Array(e),a=new Array(e),s=0;s<e;++s){var u=r[s];t(u)?(i[n]=u,n=n+1|0):(a[o]=u,o=o+1|0)}return i.length=n,a.length=o,[i,a]}function O(r,t,e){var n=r.length;if(0===n)return"";for(var o=n-1|0,i=0,a="";;){var s=a,u=i;if(u===o)return s+e(r[u]);a=s+(e(r[u])+t),i=u+1|0}}function N(r,t){for(var e=new Array(r),n=0;n<r;++n)e[n]=t(n);return e}t.get=function(r,t){if(t>=0&&t<r.length)return a.some(r[t])},t.getExn=function(r,t){if(!(t>=0&&t<r.length))throw{RE_EXN_ID:"Assert_failure",_1:["belt_Array.res",36,2],Error:new Error};return r[t]},t.set=function(r,t,e){return t>=0&&t<r.length&&(r[t]=e,!0)},t.setExn=function(r,t,e){if(!(t>=0&&t<r.length))throw{RE_EXN_ID:"Assert_failure",_1:["belt_Array.res",49,2],Error:new Error};r[t]=e},t.shuffleInPlace=u,t.shuffle=function(r){var t=r.slice(0);return u(t),t},t.reverseInPlace=function(r){for(var t=r.length,e=0,n=t/2|0;e<n;++e)s(r,0+e|0,((0+t|0)-e|0)-1|0)},t.reverse=function(r){for(var t=r.length,e=new Array(t),n=0;n<t;++n)e[n]=r[(t-1|0)-n|0];return e},t.make=function(r,t){if(r<=0)return[];for(var e=new Array(r),n=0;n<r;++n)e[n]=t;return e},t.range=function(r,t){var e=t-r|0;if(e<0)return[];for(var n=new Array(e+1|0),o=0;o<=e;++o)n[o]=r+o|0;return n},t.rangeBy=function(r,t,e){var n=t-r|0;if(n<0||e<=0)return[];for(var o=1+(n/e|0)|0,i=new Array(o),a=r,s=0;s<o;++s)i[s]=a,a=a+e|0;return i},t.makeByU=c,t.makeBy=function(r,t){return c(r,o.__1(t))},t.makeByAndShuffleU=f,t.makeByAndShuffle=function(r,t){return f(r,o.__1(t))},t.zip=function(r,t){for(var e=r.length,n=t.length,o=e<n?e:n,i=new Array(o),a=0;a<o;++a)i[a]=[r[a],t[a]];return i},t.zipByU=d,t.zipBy=function(r,t,e){return d(r,t,o.__2(e))},t.unzip=function(r){for(var t=r.length,e=new Array(t),n=new Array(t),o=0;o<t;++o){var i=r[o];e[o]=i[0],n[o]=i[1]}return[e,n]},t.concat=function(r,t){for(var e=r.length,n=t.length,o=new Array(e+n|0),i=0;i<e;++i)o[i]=r[i];for(var a=0;a<n;++a)o[e+a|0]=t[a];return o},t.concatMany=v,t.slice=function(r,t,e){if(e<=0)return[];var o=r.length,i=t<0?n.int_max(o+t|0,0):t,a=o-i|0,s=a<e?a:e;if(s<=0)return[];for(var u=new Array(s),c=0;c<s;++c)u[c]=r[i+c|0];return u},t.sliceToEnd=function(r,t){for(var e=r.length,o=t<0?n.int_max(e+t|0,0):t,i=e>o?e-o|0:0,a=new Array(i),s=0;s<i;++s)a[s]=r[o+s|0];return a},t.fill=function(r,t,e,o){if(!(e<=0)){var i=r.length,a=t<0?n.int_max(i+t|0,0):t,s=i-a|0,u=s<e?s:e;if(!(u<=0))for(var c=a,f=a+u|0;c<f;++c)r[c]=o}},t.blit=function(r,t,e,o,i){var a=r.length,s=e.length,u=t<0?n.int_max(a+t|0,0):t,c=o<0?n.int_max(s+o|0,0):o,f=n.int_min(i,n.int_min(a-u|0,s-c|0));if(c<=u)for(var d=0;d<f;++d)e[d+c|0]=r[d+u|0];else for(var v=f-1|0;v>=0;--v)e[v+c|0]=r[v+u|0]},t.blitUnsafe=function(r,t,e,n,o){if(n<=t)for(var i=0;i<o;++i)e[i+n|0]=r[i+t|0];else for(var a=o-1|0;a>=0;--a)e[a+n|0]=r[a+t|0]},t.forEachU=l,t.forEach=function(r,t){l(r,o.__1(t))},t.mapU=m,t.map=function(r,t){return m(r,o.__1(t))},t.flatMapU=function(r,t){return v(m(r,t))},t.flatMap=function(r,t){return v(m(r,o.__1(t)))},t.getByU=p,t.getBy=function(r,t){return p(r,o.__1(t))},t.getIndexByU=h,t.getIndexBy=function(r,t){return h(r,o.__1(t))},t.keepU=E,t.keep=function(r,t){return E(r,o.__1(t))},t.keepWithIndexU=x,t.keepWithIndex=function(r,t){return x(r,o.__2(t))},t.keepMapU=g,t.keepMap=function(r,t){return g(r,o.__1(t))},t.forEachWithIndexU=y,t.forEachWithIndex=function(r,t){y(r,o.__2(t))},t.mapWithIndexU=_,t.mapWithIndex=function(r,t){return _(r,o.__2(t))},t.partitionU=D,t.partition=function(r,t){return D(r,o.__1(t))},t.reduceU=T,t.reduce=function(r,t,e){return T(r,t,o.__2(e))},t.reduceReverseU=A,t.reduceReverse=function(r,t,e){return A(r,t,o.__2(e))},t.reduceReverse2U=b,t.reduceReverse2=function(r,t,e,n){return b(r,t,e,o.__3(n))},t.reduceWithIndexU=k,t.reduceWithIndex=function(r,t,e){return k(r,t,o.__3(e))},t.joinWithU=O,t.joinWith=function(r,t,e){return O(r,t,o.__1(e))},t.someU=C,t.some=function(r,t){return C(r,o.__1(t))},t.everyU=S,t.every=function(r,t){return S(r,o.__1(t))},t.every2U=I,t.every2=function(r,t,e){return I(r,t,o.__2(e))},t.some2U=M,t.some2=function(r,t,e){return M(r,t,o.__2(e))},t.cmpU=j,t.cmp=function(r,t,e){return j(r,t,o.__2(e))},t.eqU=G,t.eq=function(r,t,e){return G(r,t,o.__2(e))},t.initU=N,t.init=function(r,t){return N(r,o.__1(t))}},2815:(r,t,e)=>{var n=e(7175),o=e(5252),i=e(354);function a(r,t,e,n){for(;;){var o=n;if(void 0===o)return;var i=r(o.key)&(t.length-1|0),a=e[i];void 0!==a?a.next=o:t[i]=o,e[i]=o,n=o.next}}function s(r,t,e,n,o){var i=r.buckets,s=i.length,u=o(t)&(s-1|0),c=i[u];if(void 0!==c?function(r,t,e,n){for(;;){var o=n;if(r(o.key,t))return o.value=e,!1;var i=o.next;if(void 0===i)return!0;n=i}}(n,t,e,c)&&(i[u]={key:t,value:e,next:c},r.size=r.size+1|0):(i[u]={key:t,value:e,next:void 0},r.size=r.size+1|0),r.size>s<<1){var f=r.buckets,d=f.length,v=d<<1;if(v<d)return;var l=new Array(v),m=new Array(v);r.buckets=l;for(var p=0;p<d;++p)a(o,l,m,f[p]);for(var h=0;h<v;++h){var E=m[h];void 0!==E&&(E.next=void 0)}}}var u=i.clear,c=i.isEmpty,f=o.copy,d=o.forEachU,v=o.forEach,l=o.reduceU,m=o.reduce,p=o.keepMapInPlaceU,h=o.keepMapInPlace,E=o.toArray,x=o.keysToArray,g=o.valuesToArray,y=o.getBucketHistogram,_=o.logStats;t.Int=void 0,t.$$String=void 0,t.make=function(r,t){return i.make(t.hash,t.eq,r)},t.clear=u,t.isEmpty=c,t.set=function(r,t,e){s(r,t,e,r.eq,r.hash)},t.copy=f,t.get=function(r,t){var e=r.buckets,o=e[r.hash(t)&(e.length-1|0)];if(void 0!==o){var i=r.eq;if(i(t,o.key))return n.some(o.value);var a=o.next;if(void 0!==a){if(i(t,a.key))return n.some(a.value);var s=a.next;if(void 0!==s){if(i(t,s.key))return n.some(s.value);for(var u=s.next;;){var c=u;if(void 0===c)return;if(i(t,c.key))return n.some(c.value);u=c.next}}}}},t.has=function(r,t){var e=r.buckets,n=e[r.hash(t)&(e.length-1|0)];if(void 0===n)return!1;for(var o=n,i=r.eq;;){var a=o;if(i(a.key,t))return!0;var s=a.next;if(void 0===s)return!1;o=s}},t.remove=function(r,t){var e=r.buckets,n=r.hash(t)&(e.length-1|0),o=e[n];if(void 0!==o){var i=r.eq;if(i(o.key,t))return e[n]=o.next,void(r.size=r.size-1|0);for(var a=o,s=o.next;;){var u=s,c=a;if(void 0===u)return;var f=u.next;if(i(u.key,t))return c.next=f,void(r.size=r.size-1|0);s=f,a=u}}},t.forEachU=d,t.forEach=v,t.reduceU=l,t.reduce=m,t.keepMapInPlaceU=p,t.keepMapInPlace=h,t.size=function(r){return r.size},t.toArray=E,t.keysToArray=x,t.valuesToArray=g,t.fromArray=function(r,t){for(var e=t.hash,n=t.eq,o=r.length,a=i.make(e,n,o),u=0;u<o;++u){var c=r[u];s(a,c[0],c[1],n,e)}return a},t.mergeMany=function(r,t){for(var e=r.hash,n=r.eq,o=t.length,i=0;i<o;++i){var a=t[i];s(r,a[0],a[1],n,e)}},t.getBucketHistogram=y,t.logStats=_},7356:(r,t,e)=>{var n=e(7175),o=e(1863),i=e(5252),a=e(354);function s(r,t,e){for(;;){var n=e;if(void 0===n)return;var i=o.hash_final_mix(o.hash_mix_int(0,n.key))&(r.length-1|0),a=t[i];void 0!==a?a.next=n:r[i]=n,t[i]=n,e=n.next}}function u(r,t,e){var n=r.buckets,i=n.length,a=o.hash_final_mix(o.hash_mix_int(0,t))&(i-1|0),u=n[a];if(void 0!==u?function(r,t,e){for(;;){var n=e;if(n.key===r)return n.value=t,!1;var o=n.next;if(void 0===o)return!0;e=o}}(t,e,u)&&(n[a]={key:t,value:e,next:u},r.size=r.size+1|0):(n[a]={key:t,value:e,next:void 0},r.size=r.size+1|0),r.size>i<<1){var c=r.buckets,f=c.length,d=f<<1;if(d<f)return;var v=new Array(d),l=new Array(d);r.buckets=v;for(var m=0;m<f;++m)s(v,l,c[m]);for(var p=0;p<d;++p){var h=l[p];void 0!==h&&(h.next=void 0)}}}var c=a.clear,f=a.isEmpty,d=i.copy,v=i.forEachU,l=i.forEach,m=i.reduceU,p=i.reduce,h=i.keepMapInPlaceU,E=i.keepMapInPlace,x=i.toArray,g=i.keysToArray,y=i.valuesToArray,_=i.getBucketHistogram,T=i.logStats;t.make=function(r){return a.make(void 0,void 0,r)},t.clear=c,t.isEmpty=f,t.set=u,t.copy=d,t.get=function(r,t){var e=r.buckets,i=e[o.hash_final_mix(o.hash_mix_int(0,t))&(e.length-1|0)];if(void 0!==i){if(t===i.key)return n.some(i.value);var a=i.next;if(void 0!==a){if(t===a.key)return n.some(a.value);var s=a.next;if(void 0!==s){if(t===s.key)return n.some(s.value);for(var u=s.next;;){var c=u;if(void 0===c)return;if(t===c.key)return n.some(c.value);u=c.next}}}}},t.has=function(r,t){var e=r.buckets,n=e[o.hash_final_mix(o.hash_mix_int(0,t))&(e.length-1|0)];if(void 0===n)return!1;for(var i=n;;){var a=i;if(a.key===t)return!0;var s=a.next;if(void 0===s)return!1;i=s}},t.remove=function(r,t){var e=r.buckets,n=o.hash_final_mix(o.hash_mix_int(0,t))&(e.length-1|0),i=e[n];if(void 0!==i){if(i.key===t)return e[n]=i.next,void(r.size=r.size-1|0);for(var a=i,s=i.next;;){var u=s,c=a;if(void 0===u)return;var f=u.next;if(u.key===t)return c.next=f,void(r.size=r.size-1|0);s=f,a=u}}},t.forEachU=v,t.forEach=l,t.reduceU=m,t.reduce=p,t.keepMapInPlaceU=h,t.keepMapInPlace=E,t.size=function(r){return r.size},t.toArray=x,t.keysToArray=g,t.valuesToArray=y,t.fromArray=function(r){for(var t=r.length,e=a.make(void 0,void 0,t),n=0;n<t;++n){var o=r[n];u(e,o[0],o[1])}return e},t.mergeMany=function(r,t){for(var e=t.length,n=0;n<e;++n){var o=t[n];u(r,o[0],o[1])}},t.getBucketHistogram=_,t.logStats=T},2275:(r,t,e)=>{var n=e(7175),o=e(1863),i=e(5252),a=e(354);function s(r,t,e){for(;;){var n=e;if(void 0===n)return;var i=o.hash_final_mix(o.hash_mix_string(0,n.key))&(r.length-1|0),a=t[i];void 0!==a?a.next=n:r[i]=n,t[i]=n,e=n.next}}function u(r,t,e){var n=r.buckets,i=n.length,a=o.hash_final_mix(o.hash_mix_string(0,t))&(i-1|0),u=n[a];if(void 0!==u?function(r,t,e){for(;;){var n=e;if(n.key===r)return n.value=t,!1;var o=n.next;if(void 0===o)return!0;e=o}}(t,e,u)&&(n[a]={key:t,value:e,next:u},r.size=r.size+1|0):(n[a]={key:t,value:e,next:void 0},r.size=r.size+1|0),r.size>i<<1){var c=r.buckets,f=c.length,d=f<<1;if(d<f)return;var v=new Array(d),l=new Array(d);r.buckets=v;for(var m=0;m<f;++m)s(v,l,c[m]);for(var p=0;p<d;++p){var h=l[p];void 0!==h&&(h.next=void 0)}}}var c=a.clear,f=a.isEmpty,d=i.copy,v=i.forEachU,l=i.forEach,m=i.reduceU,p=i.reduce,h=i.keepMapInPlaceU,E=i.keepMapInPlace,x=i.toArray,g=i.keysToArray,y=i.valuesToArray,_=i.getBucketHistogram,T=i.logStats;t.make=function(r){return a.make(void 0,void 0,r)},t.clear=c,t.isEmpty=f,t.set=u,t.copy=d,t.get=function(r,t){var e=r.buckets,i=e[o.hash_final_mix(o.hash_mix_string(0,t))&(e.length-1|0)];if(void 0!==i){if(t===i.key)return n.some(i.value);var a=i.next;if(void 0!==a){if(t===a.key)return n.some(a.value);var s=a.next;if(void 0!==s){if(t===s.key)return n.some(s.value);for(var u=s.next;;){var c=u;if(void 0===c)return;if(t===c.key)return n.some(c.value);u=c.next}}}}},t.has=function(r,t){var e=r.buckets,n=e[o.hash_final_mix(o.hash_mix_string(0,t))&(e.length-1|0)];if(void 0===n)return!1;for(var i=n;;){var a=i;if(a.key===t)return!0;var s=a.next;if(void 0===s)return!1;i=s}},t.remove=function(r,t){var e=r.buckets,n=o.hash_final_mix(o.hash_mix_string(0,t))&(e.length-1|0),i=e[n];if(void 0!==i){if(i.key===t)return e[n]=i.next,void(r.size=r.size-1|0);for(var a=i,s=i.next;;){var u=s,c=a;if(void 0===u)return;var f=u.next;if(u.key===t)return c.next=f,void(r.size=r.size-1|0);s=f,a=u}}},t.forEachU=v,t.forEach=l,t.reduceU=m,t.reduce=p,t.keepMapInPlaceU=h,t.keepMapInPlace=E,t.size=function(r){return r.size},t.toArray=x,t.keysToArray=g,t.valuesToArray=y,t.fromArray=function(r){for(var t=r.length,e=a.make(void 0,void 0,t),n=0;n<t;++n){var o=r[n];u(e,o[0],o[1])}return e},t.mergeMany=function(r,t){for(var e=t.length,n=0;n<e;++n){var o=t[n];u(r,o[0],o[1])}},t.getBucketHistogram=_,t.logStats=T},9775:(r,t,e)=>{var n=e(9167),o=e(354);function i(r,t,e,n){for(;;){var o=n;if(void 0===o)return;var i=r(o.key)&(t.length-1|0),a=e[i];void 0!==a?a.next=o:t[i]=o,e[i]=o,n=o.next}}function a(r,t,e,n){var o=r.buckets,a=o.length,s=e(t)&(a-1|0),u=o[s];if(void 0!==u?function(r,t,e,n){for(;;){var o=e;if(n(o.key,t))return;var i=o.next;if(void 0===i)return r.size=r.size+1|0,void(o.next={key:t,next:void 0});e=i}}(r,t,u,n):(r.size=r.size+1|0,o[s]={key:t,next:void 0}),r.size>a<<1){var c=r.buckets,f=c.length,d=f<<1;if(d<f)return;var v=new Array(d),l=new Array(d);r.buckets=v;for(var m=0;m<f;++m)i(e,v,l,c[m]);for(var p=0;p<d;++p){var h=l[p];void 0!==h&&(h.next=void 0)}}}var s=o.clear,u=o.isEmpty,c=n.copy,f=n.forEachU,d=n.forEach,v=n.reduceU,l=n.reduce,m=n.logStats,p=n.toArray,h=n.getBucketHistogram;t.Int=void 0,t.$$String=void 0,t.make=function(r,t){return o.make(t.hash,t.eq,r)},t.clear=s,t.isEmpty=u,t.add=function(r,t){a(r,t,r.hash,r.eq)},t.copy=c,t.has=function(r,t){var e=r.eq,n=r.buckets,o=n[r.hash(t)&(n.length-1|0)];if(void 0===o)return!1;for(var i=o;;){var a=i;if(e(a.key,t))return!0;var s=a.next;if(void 0===s)return!1;i=s}},t.remove=function(r,t){var e=r.eq,n=r.buckets,o=r.hash(t)&(n.length-1|0),i=n[o];if(void 0!==i){var a=i.next;if(e(i.key,t))return r.size=r.size-1|0,void(n[o]=a);if(void 0!==a)for(var s=i,u=a;;){var c=u,f=s,d=c.next;if(e(c.key,t))return f.next=d,void(r.size=r.size-1|0);if(void 0===d)return;u=d,s=c}}},t.forEachU=f,t.forEach=d,t.reduceU=v,t.reduce=l,t.size=function(r){return r.size},t.logStats=m,t.toArray=p,t.fromArray=function(r,t){for(var e=t.eq,n=t.hash,i=r.length,s=o.make(n,e,i),u=0;u<i;++u)a(s,r[u],n,e);return s},t.mergeMany=function(r,t){for(var e=r.eq,n=r.hash,o=t.length,i=0;i<o;++i)a(r,t[i],n,e)},t.getBucketHistogram=h},7659:(r,t,e)=>{var n=e(1863),o=e(9167),i=e(354);function a(r,t,e){for(;;){var o=e;if(void 0===o)return;var i=n.hash_final_mix(n.hash_mix_int(0,o.key))&(r.length-1|0),a=t[i];void 0!==a?a.next=o:r[i]=o,t[i]=o,e=o.next}}function s(r,t){var e=r.buckets,o=e.length,i=n.hash_final_mix(n.hash_mix_int(0,t))&(o-1|0),s=e[i];if(void 0!==s?function(r,t,e){for(;;){var n=e;if(n.key===t)return;var o=n.next;if(void 0===o)return r.size=r.size+1|0,void(n.next={key:t,next:void 0});e=o}}(r,t,s):(e[i]={key:t,next:void 0},r.size=r.size+1|0),r.size>o<<1){var u=r.buckets,c=u.length,f=c<<1;if(f<c)return;var d=new Array(f),v=new Array(f);r.buckets=d;for(var l=0;l<c;++l)a(d,v,u[l]);for(var m=0;m<f;++m){var p=v[m];void 0!==p&&(p.next=void 0)}}}var u=i.clear,c=i.isEmpty,f=o.copy,d=o.forEachU,v=o.forEach,l=o.reduceU,m=o.reduce,p=o.logStats,h=o.toArray,E=o.getBucketHistogram;t.make=function(r){return i.make(void 0,void 0,r)},t.clear=u,t.isEmpty=c,t.add=s,t.copy=f,t.has=function(r,t){var e=r.buckets,o=e[n.hash_final_mix(n.hash_mix_int(0,t))&(e.length-1|0)];if(void 0===o)return!1;for(var i=o;;){var a=i;if(a.key===t)return!0;var s=a.next;if(void 0===s)return!1;i=s}},t.remove=function(r,t){var e=r.buckets,o=n.hash_final_mix(n.hash_mix_int(0,t))&(e.length-1|0),i=e[o];if(void 0!==i){var a=i.next;if(i.key===t)return r.size=r.size-1|0,void(e[o]=a);if(void 0!==a)for(var s=i,u=a;;){var c=u,f=s,d=c.next;if(c.key===t)return f.next=d,void(r.size=r.size-1|0);if(void 0===d)return;u=d,s=c}}},t.forEachU=d,t.forEach=v,t.reduceU=l,t.reduce=m,t.size=function(r){return r.size},t.logStats=p,t.toArray=h,t.fromArray=function(r){for(var t=r.length,e=i.make(void 0,void 0,t),n=0;n<t;++n)s(e,r[n]);return e},t.mergeMany=function(r,t){for(var e=t.length,n=0;n<e;++n)s(r,t[n])},t.getBucketHistogram=E},8615:(r,t,e)=>{var n=e(1863),o=e(9167),i=e(354);function a(r,t,e){for(;;){var o=e;if(void 0===o)return;var i=n.hash_final_mix(n.hash_mix_string(0,o.key))&(r.length-1|0),a=t[i];void 0!==a?a.next=o:r[i]=o,t[i]=o,e=o.next}}function s(r,t){var e=r.buckets,o=e.length,i=n.hash_final_mix(n.hash_mix_string(0,t))&(o-1|0),s=e[i];if(void 0!==s?function(r,t,e){for(;;){var n=e;if(n.key===t)return;var o=n.next;if(void 0===o)return r.size=r.size+1|0,void(n.next={key:t,next:void 0});e=o}}(r,t,s):(e[i]={key:t,next:void 0},r.size=r.size+1|0),r.size>o<<1){var u=r.buckets,c=u.length,f=c<<1;if(f<c)return;var d=new Array(f),v=new Array(f);r.buckets=d;for(var l=0;l<c;++l)a(d,v,u[l]);for(var m=0;m<f;++m){var p=v[m];void 0!==p&&(p.next=void 0)}}}var u=i.clear,c=i.isEmpty,f=o.copy,d=o.forEachU,v=o.forEach,l=o.reduceU,m=o.reduce,p=o.logStats,h=o.toArray,E=o.getBucketHistogram;t.make=function(r){return i.make(void 0,void 0,r)},t.clear=u,t.isEmpty=c,t.add=s,t.copy=f,t.has=function(r,t){var e=r.buckets,o=e[n.hash_final_mix(n.hash_mix_string(0,t))&(e.length-1|0)];if(void 0===o)return!1;for(var i=o;;){var a=i;if(a.key===t)return!0;var s=a.next;if(void 0===s)return!1;i=s}},t.remove=function(r,t){var e=r.buckets,o=n.hash_final_mix(n.hash_mix_string(0,t))&(e.length-1|0),i=e[o];if(void 0!==i){var a=i.next;if(i.key===t)return r.size=r.size-1|0,void(e[o]=a);if(void 0!==a)for(var s=i,u=a;;){var c=u,f=s,d=c.next;if(c.key===t)return f.next=d,void(r.size=r.size-1|0);if(void 0===d)return;u=d,s=c}}},t.forEachU=d,t.forEach=v,t.reduceU=l,t.reduce=m,t.size=function(r){return r.size},t.logStats=p,t.toArray=h,t.fromArray=function(r){for(var t=r.length,e=i.make(void 0,void 0,t),n=0;n<t;++n)s(e,r[n]);return e},t.mergeMany=function(r,t){for(var e=t.length,n=0;n<e;++n)s(r,t[n])},t.getBucketHistogram=E},6638:(r,t,e)=>{var n=e(1386);t.MakeComparableU=function(r){return r},t.MakeComparable=function(r){var t=r.cmp;return{cmp:n.__2(t)}},t.comparableU=function(r){return{cmp:r}},t.comparable=function(r){return{cmp:n.__2(r)}},t.MakeHashableU=function(r){return r},t.MakeHashable=function(r){var t=r.hash,e=n.__1(t),o=r.eq;return{hash:e,eq:n.__2(o)}},t.hashableU=function(r,t){return{hash:r,eq:t}},t.hashable=function(r,t){return{hash:n.__1(r),eq:n.__2(t)}}},1094:(r,t,e)=>{var n=e(1386),o=e(7175),i=e(3163),a=e(6144);function s(r,t,e){if(void 0===r)return a.singleton(t,e);var n=r.k;if(t===n)return a.updateValue(r,e);var o=r.v;return t<n?a.bal(s(r.l,t,e),n,o,r.r):a.bal(r.l,n,o,s(r.r,t,e))}function u(r,t,e){if(void 0!==r){var n=r.k;if(t===n){var i=e(o.some(r.v));if(void 0!==i)return a.updateValue(r,o.valFromOption(i));var s=r.l,c=r.r;if(void 0===s)return c;if(void 0===c)return s;var f={contents:c.k},d={contents:c.v},v=a.removeMinAuxWithRef(c,f,d);return a.bal(s,f.contents,d.contents,v)}var l=r.v,m=r.l,p=r.r;if(t<n){var h=u(m,t,e);return m===h?r:a.bal(h,n,l,p)}var E=u(p,t,e);return p===E?r:a.bal(m,n,l,E)}var x=e(void 0);return void 0!==x?a.singleton(t,o.valFromOption(x)):r}function c(r,t){var e=r.k,n=r.l,o=r.r;if(t===e){if(void 0===n)return o;if(void 0===o)return n;var i={contents:o.k},s={contents:o.v},u=a.removeMinAuxWithRef(o,i,s);return a.bal(n,i.contents,s.contents,u)}if(t<e){if(void 0===n)return r;var f=c(n,t);return f===n?r:a.bal(f,e,r.v,o)}if(void 0===o)return r;var d=c(o,t);return a.bal(n,e,r.v,d)}var f=a.isEmpty,d=i.has,v=i.cmpU,l=i.cmp,m=i.eqU,p=i.eq,h=a.findFirstByU,E=a.findFirstBy,x=a.forEachU,g=a.forEach,y=a.reduceU,_=a.reduce,T=a.everyU,A=a.every,b=a.someU,k=a.some,S=a.size,C=a.toList,w=a.toArray,I=i.fromArray,M=a.keysToArray,G=a.valuesToArray,j=a.minKey,D=a.minKeyUndefined,O=a.maxKey,N=a.maxKeyUndefined,P=a.minimum,U=a.minUndefined,F=a.maximum,V=a.maxUndefined,R=i.get,B=i.getUndefined,W=i.getWithDefault,L=i.getExn,H=a.checkInvariantInternal,q=i.mergeU,X=i.merge,z=a.keepSharedU,$=a.keepShared,K=a.partitionSharedU,J=a.partitionShared,Q=i.split,Z=a.mapU,Y=a.map,rr=a.mapWithKeyU,tr=a.mapWithKey;t.empty=void 0,t.isEmpty=f,t.has=d,t.cmpU=v,t.cmp=l,t.eqU=m,t.eq=p,t.findFirstByU=h,t.findFirstBy=E,t.forEachU=x,t.forEach=g,t.reduceU=y,t.reduce=_,t.everyU=T,t.every=A,t.someU=b,t.some=k,t.size=S,t.toList=C,t.toArray=w,t.fromArray=I,t.keysToArray=M,t.valuesToArray=G,t.minKey=j,t.minKeyUndefined=D,t.maxKey=O,t.maxKeyUndefined=N,t.minimum=P,t.minUndefined=U,t.maximum=F,t.maxUndefined=V,t.get=R,t.getUndefined=B,t.getWithDefault=W,t.getExn=L,t.checkInvariantInternal=H,t.remove=function(r,t){if(void 0!==r)return c(r,t)},t.removeMany=function(r,t){var e=t.length;if(void 0!==r)for(var n=r,o=0;;){var i=o;if(i>=e)return n;var a=c(n,t[i]);if(void 0===a)return a;o=i+1|0,n=a}},t.set=s,t.updateU=u,t.update=function(r,t,e){return u(r,t,n.__1(e))},t.mergeU=q,t.merge=X,t.mergeMany=function(r,t){for(var e=t.length,n=r,o=0;o<e;++o){var i=t[o];n=s(n,i[0],i[1])}return n},t.keepU=z,t.keep=$,t.partitionU=K,t.partition=J,t.split=Q,t.mapU=Z,t.map=Y,t.mapWithKeyU=rr,t.mapWithKey=tr},5082:(r,t,e)=>{var n=e(1386),o=e(7175),i=e(6144),a=e(2459);function s(r,t,e){if(void 0===r)return i.singleton(t,e);var n=r.k;if(t===n)return i.updateValue(r,e);var o=r.v;return t<n?i.bal(s(r.l,t,e),n,o,r.r):i.bal(r.l,n,o,s(r.r,t,e))}function u(r,t,e){if(void 0!==r){var n=r.k;if(t===n){var a=e(o.some(r.v));if(void 0!==a)return i.updateValue(r,o.valFromOption(a));var s=r.l,c=r.r;if(void 0===s)return c;if(void 0===c)return s;var f={contents:c.k},d={contents:c.v},v=i.removeMinAuxWithRef(c,f,d);return i.bal(s,f.contents,d.contents,v)}var l=r.v,m=r.l,p=r.r;if(t<n){var h=u(m,t,e);return m===h?r:i.bal(h,n,l,p)}var E=u(p,t,e);return p===E?r:i.bal(m,n,l,E)}var x=e(void 0);return void 0!==x?i.singleton(t,o.valFromOption(x)):r}function c(r,t){var e=r.k,n=r.l,o=r.r;if(t===e){if(void 0===n)return o;if(void 0===o)return n;var a={contents:o.k},s={contents:o.v},u=i.removeMinAuxWithRef(o,a,s);return i.bal(n,a.contents,s.contents,u)}if(t<e){if(void 0===n)return r;var f=c(n,t);return f===n?r:i.bal(f,e,r.v,o)}if(void 0===o)return r;var d=c(o,t);return i.bal(n,e,r.v,d)}var f=i.isEmpty,d=a.has,v=a.cmpU,l=a.cmp,m=a.eqU,p=a.eq,h=i.findFirstByU,E=i.findFirstBy,x=i.forEachU,g=i.forEach,y=i.reduceU,_=i.reduce,T=i.everyU,A=i.every,b=i.someU,k=i.some,S=i.size,C=i.toList,w=i.toArray,I=a.fromArray,M=i.keysToArray,G=i.valuesToArray,j=i.minKey,D=i.minKeyUndefined,O=i.maxKey,N=i.maxKeyUndefined,P=i.minimum,U=i.minUndefined,F=i.maximum,V=i.maxUndefined,R=a.get,B=a.getUndefined,W=a.getWithDefault,L=a.getExn,H=i.checkInvariantInternal,q=a.mergeU,X=a.merge,z=i.keepSharedU,$=i.keepShared,K=i.partitionSharedU,J=i.partitionShared,Q=a.split,Z=i.mapU,Y=i.map,rr=i.mapWithKeyU,tr=i.mapWithKey;t.empty=void 0,t.isEmpty=f,t.has=d,t.cmpU=v,t.cmp=l,t.eqU=m,t.eq=p,t.findFirstByU=h,t.findFirstBy=E,t.forEachU=x,t.forEach=g,t.reduceU=y,t.reduce=_,t.everyU=T,t.every=A,t.someU=b,t.some=k,t.size=S,t.toList=C,t.toArray=w,t.fromArray=I,t.keysToArray=M,t.valuesToArray=G,t.minKey=j,t.minKeyUndefined=D,t.maxKey=O,t.maxKeyUndefined=N,t.minimum=P,t.minUndefined=U,t.maximum=F,t.maxUndefined=V,t.get=R,t.getUndefined=B,t.getWithDefault=W,t.getExn=L,t.checkInvariantInternal=H,t.remove=function(r,t){if(void 0!==r)return c(r,t)},t.removeMany=function(r,t){var e=t.length;if(void 0!==r)for(var n=r,o=0;;){var i=o;if(i>=e)return n;var a=c(n,t[i]);if(void 0===a)return a;o=i+1|0,n=a}},t.set=s,t.updateU=u,t.update=function(r,t,e){return u(r,t,n.__1(e))},t.mergeU=q,t.merge=X,t.mergeMany=function(r,t){for(var e=t.length,n=r,o=0;o<e;++o){var i=t[o];n=s(n,i[0],i[1])}return n},t.keepU=z,t.keep=$,t.partitionU=K,t.partition=J,t.split=Q,t.mapU=Z,t.map=Y,t.mapWithKeyU=rr,t.mapWithKey=tr},5981:(r,t,e)=>{var n=e(1386),o=e(7175),i=e(3163),a=e(6144);function s(r,t){return{data:a.mapU(r.data,t)}}function u(r,t){return{data:a.mapWithKeyU(r.data,t)}}function c(r,t,e){return a.reduceU(r.data,t,e)}function f(r,t){var e=r.k;if(t===e){var n=r.l,o=r.r;return void 0!==n?void 0!==o?(r.r=a.removeMinAuxWithRootMutate(r,o),a.balMutate(r)):n:o}if(t<e){var i=r.l;return void 0!==i?(r.l=f(i,t),a.balMutate(r)):r}var s=r.r;return void 0!==s?(r.r=f(s,t),a.balMutate(r)):r}function d(r,t,e){if(void 0!==r){var n=r.k;if(n===t){var i=e(o.some(r.v));if(void 0!==i)return r.v=o.valFromOption(i),r;var s=r.l,u=r.r;return void 0!==s?void 0!==u?(r.r=a.removeMinAuxWithRootMutate(r,u),a.balMutate(r)):s:u}var c=r.l,f=r.r;if(t<n){var v=d(c,t,e);r.l=v}else r.r=d(f,t,e);return a.balMutate(r)}var l=e(void 0);return void 0!==l?a.singleton(t,o.valFromOption(l)):r}function v(r,t,e){var n=r.data,o=d(n,t,e);o===n||(r.data=o)}function l(r,t,e){return i.cmpU(r.data,t.data,e)}function m(r,t,e){return i.eqU(r.data,t.data,e)}t.make=function(r){return{data:void 0}},t.clear=function(r){r.data=void 0},t.isEmpty=function(r){return void 0===r.data},t.has=function(r,t){return i.has(r.data,t)},t.cmpU=l,t.cmp=function(r,t,e){return l(r,t,n.__2(e))},t.eqU=m,t.eq=function(r,t,e){return m(r,t,n.__2(e))},t.forEachU=function(r,t){a.forEachU(r.data,t)},t.forEach=function(r,t){a.forEachU(r.data,n.__2(t))},t.reduceU=c,t.reduce=function(r,t,e){return c(r,t,n.__3(e))},t.everyU=function(r,t){return a.everyU(r.data,t)},t.every=function(r,t){return a.everyU(r.data,n.__2(t))},t.someU=function(r,t){return a.someU(r.data,t)},t.some=function(r,t){return a.someU(r.data,n.__2(t))},t.size=function(r){return a.size(r.data)},t.toList=function(r){return a.toList(r.data)},t.toArray=function(r){return a.toArray(r.data)},t.fromArray=function(r){return{data:i.fromArray(r)}},t.keysToArray=function(r){return a.keysToArray(r.data)},t.valuesToArray=function(r){return a.valuesToArray(r.data)},t.minKey=function(r){return a.minKey(r.data)},t.minKeyUndefined=function(r){return a.minKeyUndefined(r.data)},t.maxKey=function(r){return a.maxKey(r.data)},t.maxKeyUndefined=function(r){return a.maxKeyUndefined(r.data)},t.minimum=function(r){return a.minimum(r.data)},t.minUndefined=function(r){return a.minUndefined(r.data)},t.maximum=function(r){return a.maximum(r.data)},t.maxUndefined=function(r){return a.maxUndefined(r.data)},t.get=function(r,t){return i.get(r.data,t)},t.getUndefined=function(r,t){return i.getUndefined(r.data,t)},t.getWithDefault=function(r,t,e){return i.getWithDefault(r.data,t,e)},t.getExn=function(r,t){return i.getExn(r.data,t)},t.checkInvariantInternal=function(r){a.checkInvariantInternal(r.data)},t.remove=function(r,t){var e=r.data;if(void 0!==e){var n=f(e,t);n===e||(r.data=n)}},t.removeMany=function(r,t){var e=r.data;if(void 0!==e){var n=function(r,t,e,n){for(;;){var o=e;if(o>=n)return r;var i=f(r,t[o]);if(void 0===i)return;e=o+1|0,r=i}}(e,t,0,t.length);n===e||(r.data=n)}},t.set=function(r,t,e){var n=r.data,o=i.addMutate(n,t,e);o===n||(r.data=o)},t.updateU=v,t.update=function(r,t,e){v(r,t,n.__1(e))},t.mapU=s,t.map=function(r,t){return s(r,n.__1(t))},t.mapWithKeyU=u,t.mapWithKey=function(r,t){return u(r,n.__2(t))}},2867:(r,t,e)=>{var n=e(1386),o=e(7175),i=e(6144),a=e(2459);function s(r,t){return{data:i.mapU(r.data,t)}}function u(r,t){return{data:i.mapWithKeyU(r.data,t)}}function c(r,t,e){return i.reduceU(r.data,t,e)}function f(r,t){var e=r.k;if(t===e){var n=r.l,o=r.r;return void 0!==n?void 0!==o?(r.r=i.removeMinAuxWithRootMutate(r,o),i.balMutate(r)):n:o}if(t<e){var a=r.l;return void 0!==a?(r.l=f(a,t),i.balMutate(r)):r}var s=r.r;return void 0!==s?(r.r=f(s,t),i.balMutate(r)):r}function d(r,t,e){if(void 0!==r){var n=r.k;if(n===t){var a=e(o.some(r.v));if(void 0!==a)return r.v=o.valFromOption(a),r;var s=r.l,u=r.r;return void 0!==s?void 0!==u?(r.r=i.removeMinAuxWithRootMutate(r,u),i.balMutate(r)):s:u}var c=r.l,f=r.r;if(t<n){var v=d(c,t,e);r.l=v}else r.r=d(f,t,e);return i.balMutate(r)}var l=e(void 0);return void 0!==l?i.singleton(t,o.valFromOption(l)):r}function v(r,t,e){var n=r.data,o=d(n,t,e);o===n||(r.data=o)}function l(r,t,e){return a.cmpU(r.data,t.data,e)}function m(r,t,e){return a.eqU(r.data,t.data,e)}t.make=function(r){return{data:void 0}},t.clear=function(r){r.data=void 0},t.isEmpty=function(r){return void 0===r.data},t.has=function(r,t){return a.has(r.data,t)},t.cmpU=l,t.cmp=function(r,t,e){return l(r,t,n.__2(e))},t.eqU=m,t.eq=function(r,t,e){return m(r,t,n.__2(e))},t.forEachU=function(r,t){i.forEachU(r.data,t)},t.forEach=function(r,t){i.forEachU(r.data,n.__2(t))},t.reduceU=c,t.reduce=function(r,t,e){return c(r,t,n.__3(e))},t.everyU=function(r,t){return i.everyU(r.data,t)},t.every=function(r,t){return i.everyU(r.data,n.__2(t))},t.someU=function(r,t){return i.someU(r.data,t)},t.some=function(r,t){return i.someU(r.data,n.__2(t))},t.size=function(r){return i.size(r.data)},t.toList=function(r){return i.toList(r.data)},t.toArray=function(r){return i.toArray(r.data)},t.fromArray=function(r){return{data:a.fromArray(r)}},t.keysToArray=function(r){return i.keysToArray(r.data)},t.valuesToArray=function(r){return i.valuesToArray(r.data)},t.minKey=function(r){return i.minKey(r.data)},t.minKeyUndefined=function(r){return i.minKeyUndefined(r.data)},t.maxKey=function(r){return i.maxKey(r.data)},t.maxKeyUndefined=function(r){return i.maxKeyUndefined(r.data)},t.minimum=function(r){return i.minimum(r.data)},t.minUndefined=function(r){return i.minUndefined(r.data)},t.maximum=function(r){return i.maximum(r.data)},t.maxUndefined=function(r){return i.maxUndefined(r.data)},t.get=function(r,t){return a.get(r.data,t)},t.getUndefined=function(r,t){return a.getUndefined(r.data,t)},t.getWithDefault=function(r,t,e){return a.getWithDefault(r.data,t,e)},t.getExn=function(r,t){return a.getExn(r.data,t)},t.checkInvariantInternal=function(r){i.checkInvariantInternal(r.data)},t.remove=function(r,t){var e=r.data;if(void 0!==e){var n=f(e,t);n===e||(r.data=n)}},t.removeMany=function(r,t){var e=r.data;if(void 0!==e){var n=function(r,t,e,n){for(;;){var o=e;if(o>=n)return r;var i=f(r,t[o]);if(void 0===i)return;e=o+1|0,r=i}}(e,t,0,t.length);n===e||(r.data=n)}},t.set=function(r,t,e){var n=r.data,o=a.addMutate(n,t,e);o===n||(r.data=o)},t.updateU=v,t.update=function(r,t,e){v(r,t,n.__1(e))},t.mapU=s,t.map=function(r,t){return s(r,n.__1(t))},t.mapWithKeyU=u,t.mapWithKey=function(r,t){return u(r,n.__2(t))}},5650:(r,t,e)=>{var n=e(1386),o=e(7175);function i(r){r.length=0,r.first=void 0,r.last=void 0}function a(r,t){var e={content:t,next:void 0},n=r.last;void 0!==n?(r.length=r.length+1|0,n.next=e,r.last=e):(r.length=1,r.first=e,r.last=e)}function s(r,t){for(var e,n={length:r.length,first:void 0,last:void 0},o=r.first;;){var i=o,a=e;if(void 0===i)return n.last=a,n;var s={content:t(i.content),next:void 0};void 0!==a?a.next=s:n.first=s,o=i.next,e=s}}function u(r,t){for(var e=r.first;;){var n=e;if(void 0===n)return;t(n.content),e=n.next}}function c(r,t,e){for(var n=t,o=r.first;;){var i=o;if(void 0===i)return n;var a=e(n,i.content);o=i.next,n=a}}t.make=function(r){return{length:0,first:void 0,last:void 0}},t.clear=i,t.isEmpty=function(r){return 0===r.length},t.fromArray=function(r){for(var t={length:0,first:void 0,last:void 0},e=0,n=r.length;e<n;++e)a(t,r[e]);return t},t.add=a,t.peek=function(r){var t=r.first;if(void 0!==t)return o.some(t.content)},t.peekUndefined=function(r){var t=r.first;if(void 0!==t)return t.content},t.peekExn=function(r){var t=r.first;if(void 0!==t)return t.content;throw{RE_EXN_ID:"Not_found",Error:new Error}},t.pop=function(r){var t=r.first;if(void 0!==t){var e=t.next;return void 0===e?(i(r),o.some(t.content)):(r.length=r.length-1|0,r.first=e,o.some(t.content))}},t.popUndefined=function(r){var t=r.first;if(void 0!==t){var e=t.next;return void 0===e?(i(r),t.content):(r.length=r.length-1|0,r.first=e,t.content)}},t.popExn=function(r){var t=r.first;if(void 0!==t){var e=t.next;return void 0===e?(i(r),t.content):(r.length=r.length-1|0,r.first=e,t.content)}throw{RE_EXN_ID:"Not_found",Error:new Error}},t.copy=function(r){for(var t,e={length:r.length,first:void 0,last:void 0},n=r.first;;){var o=n,i=t;if(void 0===o)return e.last=i,e;var a={content:o.content,next:void 0};void 0!==i?i.next=a:e.first=a,n=o.next,t=a}},t.size=function(r){return r.length},t.mapU=s,t.map=function(r,t){return s(r,n.__1(t))},t.forEachU=u,t.forEach=function(r,t){u(r,n.__1(t))},t.reduceU=c,t.reduce=function(r,t,e){return c(r,t,n.__2(e))},t.transfer=function(r,t){if(!(r.length<=0)){var e=t.last;return void 0!==e?(t.length=t.length+r.length|0,e.next=r.first,t.last=r.last,i(r)):(t.length=r.length,t.first=r.first,t.last=r.last,i(r))}},t.toArray=function(r){var t=new Array(r.length);return function(r,t,e){for(;;){var n=e,o=r;if(void 0===n)return;t[o]=n.content,e=n.next,r=o+1|0}}(0,t,r.first),t}},6601:(r,t,e)=>{var n=e(1386),o=e(7175);function i(r,t){for(var e=r.root;;){var n=e;if(void 0===n)return;t(n.head),e=n.tail}}function a(r,t){for(;;){var e=r.root;if(void 0===e)return;r.root=e.tail,t(e.head)}}t.make=function(r){return{root:void 0}},t.clear=function(r){r.root=void 0},t.copy=function(r){return{root:r.root}},t.push=function(r,t){r.root={head:t,tail:r.root}},t.popUndefined=function(r){var t=r.root;if(void 0!==t)return r.root=t.tail,t.head},t.pop=function(r){var t=r.root;if(void 0!==t)return r.root=t.tail,o.some(t.head)},t.topUndefined=function(r){var t=r.root;if(void 0!==t)return t.head},t.top=function(r){var t=r.root;if(void 0!==t)return o.some(t.head)},t.isEmpty=function(r){return void 0===r.root},t.size=function(r){var t=r.root;if(void 0===t)return 0;for(var e=t,n=0;;){var o=n,i=e.tail;if(void 0===i)return o+1|0;n=o+1|0,e=i}},t.forEachU=i,t.forEach=function(r,t){i(r,n.__1(t))},t.dynamicPopIterU=a,t.dynamicPopIter=function(r,t){a(r,n.__1(t))}},6517:(r,t,e)=>{var n=e(1386),o=e(7175);function i(r,t){if(void 0!==r&&t(o.valFromOption(r)))return r}function a(r,t){if(void 0!==r)return t(o.valFromOption(r))}function s(r,t,e){return void 0!==r?e(o.valFromOption(r)):t}function u(r,t){if(void 0!==r)return o.some(t(o.valFromOption(r)))}function c(r,t){if(void 0!==r)return t(o.valFromOption(r))}function f(r,t,e){return void 0!==r?void 0!==t&&e(o.valFromOption(r),o.valFromOption(t)):void 0===t}function d(r,t,e){return void 0!==r?void 0!==t?e(o.valFromOption(r),o.valFromOption(t)):1:void 0!==t?-1:0}t.keepU=i,t.keep=function(r,t){return i(r,n.__1(t))},t.forEachU=a,t.forEach=function(r,t){a(r,n.__1(t))},t.getExn=function(r){if(void 0!==r)return o.valFromOption(r);throw{RE_EXN_ID:"Not_found",Error:new Error}},t.mapWithDefaultU=s,t.mapWithDefault=function(r,t,e){return s(r,t,n.__1(e))},t.mapU=u,t.map=function(r,t){return u(r,n.__1(t))},t.flatMapU=c,t.flatMap=function(r,t){return c(r,n.__1(t))},t.getWithDefault=function(r,t){return void 0!==r?o.valFromOption(r):t},t.orElse=function(r,t){return void 0!==r?r:t},t.isSome=function(r){return void 0!==r},t.isNone=function(r){return void 0===r},t.eqU=f,t.eq=function(r,t,e){return f(r,t,n.__2(e))},t.cmpU=d,t.cmp=function(r,t,e){return d(r,t,n.__2(e))}},6369:(r,t,e)=>{var n=e(1386);function o(r,t,e){return"Ok"===r.TAG?e(r._0):t}function i(r,t){return"Ok"===r.TAG?{TAG:"Ok",_0:t(r._0)}:{TAG:"Error",_0:r._0}}function a(r,t){return"Ok"===r.TAG?t(r._0):{TAG:"Error",_0:r._0}}function s(r,t,e){return"Ok"===r.TAG?"Ok"===t.TAG&&e(r._0,t._0):"Ok"!==t.TAG}function u(r,t,e){return"Ok"===r.TAG?"Ok"===t.TAG?e(r._0,t._0):1:"Ok"===t.TAG?-1:0}t.getExn=function(r){if("Ok"===r.TAG)return r._0;throw{RE_EXN_ID:"Not_found",Error:new Error}},t.mapWithDefaultU=o,t.mapWithDefault=function(r,t,e){return o(r,t,n.__1(e))},t.mapU=i,t.map=function(r,t){return i(r,n.__1(t))},t.flatMapU=a,t.flatMap=function(r,t){return a(r,n.__1(t))},t.getWithDefault=function(r,t){return"Ok"===r.TAG?r._0:t},t.isOk=function(r){return"Ok"===r.TAG},t.isError=function(r){return"Ok"!==r.TAG},t.eqU=s,t.eq=function(r,t,e){return s(r,t,n.__2(e))},t.cmpU=u,t.cmp=function(r,t,e){return u(r,t,n.__2(e))}},303:(r,t,e)=>{var n=e(4881),o=e(9113);function i(r,t){if(void 0===r)return n.singleton(t);var e=r.v;if(t===e)return r;var o=r.l,a=r.r;if(t<e){var s=i(o,t);return s===o?r:n.bal(s,e,a)}var u=i(a,t);return u===a?r:n.bal(o,e,u)}function a(r,t){if(void 0===r)return r;var e=r.v,o=r.l,i=r.r;if(t===e){if(void 0===o)return i;if(void 0===i)return o;var s={contents:i.v},u=n.removeMinAuxWithRef(i,s);return n.bal(o,s.contents,u)}if(t<e){var c=a(o,t);return c===o?r:n.bal(c,e,i)}var f=a(i,t);return f===i?r:n.bal(o,e,f)}function s(r,t){var e=r.v,o=r.l,i=r.r;if(t===e)return[o,i];if(t<e){if(void 0===o)return[void 0,r];var a=s(o,t);return[a[0],n.joinShared(a[1],e,i)]}if(void 0===i)return[r,void 0];var u=s(i,t);return[n.joinShared(o,e,u[0]),u[1]]}function u(r,t,e){var o=r.v,i=r.l,a=r.r;if(t===o)return e.contents=!0,[i,a];if(t<o){if(void 0===i)return[void 0,r];var s=u(i,t,e);return[s[0],n.joinShared(s[1],o,a)]}if(void 0===a)return[r,void 0];var c=u(a,t,e);return[n.joinShared(i,o,c[0]),c[1]]}var c=o.fromArray,f=n.fromSortedArrayUnsafe,d=n.isEmpty,v=o.has,l=o.subset,m=o.cmp,p=o.eq,h=n.forEachU,E=n.forEach,x=n.reduceU,g=n.reduce,y=n.everyU,_=n.every,T=n.someU,A=n.some,b=n.keepSharedU,k=n.keepShared,S=n.partitionSharedU,C=n.partitionShared,w=n.size,I=n.toList,M=n.toArray,G=n.minimum,j=n.minUndefined,D=n.maximum,O=n.maxUndefined,N=o.get,P=o.getUndefined,U=o.getExn,F=n.checkInvariantInternal;t.empty=void 0,t.fromArray=c,t.fromSortedArrayUnsafe=f,t.isEmpty=d,t.has=v,t.add=i,t.mergeMany=function(r,t){for(var e=t.length,n=r,o=0;o<e;++o)n=i(n,t[o]);return n},t.remove=a,t.removeMany=function(r,t){for(var e=t.length,n=r,o=0;o<e;++o)n=a(n,t[o]);return n},t.union=function r(t,e){if(void 0===t)return e;if(void 0===e)return t;var o=t.h,a=e.h;if(o>=a){if(1===a)return i(t,e.v);var u=t.v,c=t.l,f=t.r,d=s(e,u);return n.joinShared(r(c,d[0]),u,r(f,d[1]))}if(1===o)return i(e,t.v);var v=e.v,l=e.l,m=e.r,p=s(t,v);return n.joinShared(r(p[0],l),v,r(p[1],m))},t.intersect=function r(t,e){if(void 0!==t&&void 0!==e){var o=t.v,i=t.l,a=t.r,s={contents:!1},c=u(e,o,s),f=r(i,c[0]),d=r(a,c[1]);return s.contents?n.joinShared(f,o,d):n.concatShared(f,d)}},t.diff=function r(t,e){if(void 0===t)return t;if(void 0===e)return t;var o=t.v,i=t.l,a=t.r,s={contents:!1},c=u(e,o,s),f=r(i,c[0]),d=r(a,c[1]);return s.contents?n.concatShared(f,d):n.joinShared(f,o,d)},t.subset=l,t.cmp=m,t.eq=p,t.forEachU=h,t.forEach=E,t.reduceU=x,t.reduce=g,t.everyU=y,t.every=_,t.someU=T,t.some=A,t.keepU=b,t.keep=k,t.partitionU=S,t.partition=C,t.size=w,t.toList=I,t.toArray=M,t.minimum=G,t.minUndefined=j,t.maximum=D,t.maxUndefined=O,t.get=N,t.getUndefined=P,t.getExn=U,t.split=function(r,t){if(void 0===r)return[[void 0,void 0],!1];var e={contents:!1};return[u(r,t,e),e.contents]},t.checkInvariantInternal=F},1367:(r,t,e)=>{var n=e(4881),o=e(1572);function i(r,t){if(void 0===r)return n.singleton(t);var e=r.v;if(t===e)return r;var o=r.l,a=r.r;if(t<e){var s=i(o,t);return s===o?r:n.bal(s,e,a)}var u=i(a,t);return u===a?r:n.bal(o,e,u)}function a(r,t){if(void 0===r)return r;var e=r.v,o=r.l,i=r.r;if(t===e){if(void 0===o)return i;if(void 0===i)return o;var s={contents:i.v},u=n.removeMinAuxWithRef(i,s);return n.bal(o,s.contents,u)}if(t<e){var c=a(o,t);return c===o?r:n.bal(c,e,i)}var f=a(i,t);return f===i?r:n.bal(o,e,f)}function s(r,t){var e=r.v,o=r.l,i=r.r;if(t===e)return[o,i];if(t<e){if(void 0===o)return[void 0,r];var a=s(o,t);return[a[0],n.joinShared(a[1],e,i)]}if(void 0===i)return[r,void 0];var u=s(i,t);return[n.joinShared(o,e,u[0]),u[1]]}function u(r,t,e){var o=r.v,i=r.l,a=r.r;if(t===o)return e.contents=!0,[i,a];if(t<o){if(void 0===i)return[void 0,r];var s=u(i,t,e);return[s[0],n.joinShared(s[1],o,a)]}if(void 0===a)return[r,void 0];var c=u(a,t,e);return[n.joinShared(i,o,c[0]),c[1]]}var c=o.fromArray,f=n.fromSortedArrayUnsafe,d=n.isEmpty,v=o.has,l=o.subset,m=o.cmp,p=o.eq,h=n.forEachU,E=n.forEach,x=n.reduceU,g=n.reduce,y=n.everyU,_=n.every,T=n.someU,A=n.some,b=n.keepSharedU,k=n.keepShared,S=n.partitionSharedU,C=n.partitionShared,w=n.size,I=n.toList,M=n.toArray,G=n.minimum,j=n.minUndefined,D=n.maximum,O=n.maxUndefined,N=o.get,P=o.getUndefined,U=o.getExn,F=n.checkInvariantInternal;t.empty=void 0,t.fromArray=c,t.fromSortedArrayUnsafe=f,t.isEmpty=d,t.has=v,t.add=i,t.mergeMany=function(r,t){for(var e=t.length,n=r,o=0;o<e;++o)n=i(n,t[o]);return n},t.remove=a,t.removeMany=function(r,t){for(var e=t.length,n=r,o=0;o<e;++o)n=a(n,t[o]);return n},t.union=function r(t,e){if(void 0===t)return e;if(void 0===e)return t;var o=t.h,a=e.h;if(o>=a){if(1===a)return i(t,e.v);var u=t.v,c=t.l,f=t.r,d=s(e,u);return n.joinShared(r(c,d[0]),u,r(f,d[1]))}if(1===o)return i(e,t.v);var v=e.v,l=e.l,m=e.r,p=s(t,v);return n.joinShared(r(p[0],l),v,r(p[1],m))},t.intersect=function r(t,e){if(void 0!==t&&void 0!==e){var o=t.v,i=t.l,a=t.r,s={contents:!1},c=u(e,o,s),f=r(i,c[0]),d=r(a,c[1]);return s.contents?n.joinShared(f,o,d):n.concatShared(f,d)}},t.diff=function r(t,e){if(void 0===t)return t;if(void 0===e)return t;var o=t.v,i=t.l,a=t.r,s={contents:!1},c=u(e,o,s),f=r(i,c[0]),d=r(a,c[1]);return s.contents?n.concatShared(f,d):n.joinShared(f,o,d)},t.subset=l,t.cmp=m,t.eq=p,t.forEachU=h,t.forEach=E,t.reduceU=x,t.reduce=g,t.everyU=y,t.every=_,t.someU=T,t.some=A,t.keepU=b,t.keep=k,t.partitionU=S,t.partition=C,t.size=w,t.toList=I,t.toArray=M,t.minimum=G,t.minUndefined=j,t.maximum=D,t.maxUndefined=O,t.get=N,t.getUndefined=P,t.getExn=U,t.split=function(r,t){if(void 0===r)return[[void 0,void 0],!1];var e={contents:!1};return[u(r,t,e),e.contents]},t.checkInvariantInternal=F},2531:(r,t,e)=>{var n=e(1386),o=e(2971);function i(r,t){var e=r.length;if(0===e||1===e)return e;var n=r[0],o=r[1];if(!t(n,o))return t(o,n)?0|-function(r,t,e,n,o){for(;;){var i=e,a=t;if(i>=n)return i;var s=r[i];if(!o(s,a))return i;e=i+1|0,t=s}}(r,o,2,e,t):1;for(var i=o,a=2;;){var s=a,u=i;if(s>=e)return s;var c=r[s];if(!t(u,c))return s;a=s+1|0,i=c}}function a(r,t){var e=r.length;if(0===e)return!0;for(var n=0,o=e-1|0;;){var i=n;if(i===o)return!0;if(t(r[i],r[i+1|0])>0)return!1;n=i+1|0}}function s(r,t,e,n,i,a,s,u,c){for(var f=t+e|0,d=i+a|0,v=t,l=r[t],m=i,p=n[i],h=u;;){var E=h,x=p,g=m,y=l,_=v;if(c(y,x)<=0){s[E]=y;var T=_+1|0;if(T>=f)return o.blitUnsafe(n,g,s,E+1|0,d-g|0);h=E+1|0,l=r[T],v=T}else{s[E]=x;var A=g+1|0;if(A>=d)return o.blitUnsafe(r,_,s,E+1|0,f-_|0);h=E+1|0,p=n[A],m=A}}}function u(r,t,e,n,i,a,s,u,c){for(var f=t+e|0,d=i+a|0,v=t,l=r[t],m=i,p=n[i],h=u;;){var E=h,x=p,g=m,y=l,_=v,T=c(y,x);if(T<0){s[E]=y;var A=_+1|0,b=E+1|0;if(A<f){h=b,l=r[A],v=A;continue}return o.blitUnsafe(n,g,s,b,d-g|0),(b+d|0)-g|0}if(0!==T){s[E]=x;var k=g+1|0,S=E+1|0;if(!(k<d))return o.blitUnsafe(r,_,s,S,f-_|0),(S+f|0)-_|0;h=S,p=n[k],m=k}else{s[E]=y;var C=_+1|0,w=g+1|0,I=E+1|0;if(!(C<f&&w<d))return C===f?(o.blitUnsafe(n,w,s,I,d-w|0),(I+d|0)-w|0):(o.blitUnsafe(r,C,s,I,f-C|0),(I+f|0)-C|0);h=I,p=n[w],m=w,l=r[C],v=C}}}function c(r,t,e,n,o,i,a,s,u){for(var c=t+e|0,f=o+i|0,d=t,v=r[t],l=o,m=n[o],p=s;;){var h=p,E=l,x=v,g=d,y=u(x,m);if(y<0){var _=g+1|0;if(_>=c)return h;v=r[_],d=_}else if(0!==y){var T=E+1|0;if(T>=f)return h;m=n[T],l=T}else{a[h]=x;var A=g+1|0,b=E+1|0,k=h+1|0;if(!(A<c&&b<f))return k;p=k,m=n[b],l=b,v=r[A],d=A}}}function f(r,t,e,n,i,a,s,u,c){for(var f=t+e|0,d=i+a|0,v=t,l=r[t],m=i,p=n[i],h=u;;){var E=h,x=m,g=l,y=v,_=c(g,p);if(_<0){s[E]=g;var T=E+1|0,A=y+1|0;if(A>=f)return T;h=T,l=r[A],v=A}else if(0!==_){var b=x+1|0;if(!(b<d))return o.blitUnsafe(r,y,s,E,f-y|0),(E+f|0)-y|0;p=n[b],m=b}else{var k=y+1|0,S=x+1|0;if(!(k<f&&S<d))return k===f?E:(o.blitUnsafe(r,k,s,E,f-k|0),(E+f|0)-k|0);p=n[S],m=S,l=r[k],v=k}}}function d(r,t,e,n,o,i){for(var a=0;a<o;++a){for(var s=r[t+a|0],u=(n+a|0)-1|0;u>=n&&i(e[u],s)>0;)e[u+1|0]=e[u],u=u-1|0;e[u+1|0]=s}}function v(r,t,e,n,o,i){if(o<=5)return d(r,t,e,n,o,i);var a=o/2|0,u=o-a|0;v(r,t+a|0,e,n+a|0,u,i),v(r,t,r,t+u|0,a,i),s(r,t+u|0,a,e,n+a|0,u,e,n,i)}function l(r,t){var e=r.length;if(e<=5)return d(r,0,r,0,e,t);var n=e/2|0,o=e-n|0,i=new Array(o);v(r,n,i,0,o,t),v(r,0,r,o,n,t),s(r,o,n,i,0,o,r,0,t)}function m(r,t){var e=r.slice(0);return l(e,t),e}function p(r,t,e){var n=r.length;if(0===n)return-1;if(e(t,r[0])<0)return-1;if(e(t,r[n-1|0])>0)return 0|-(n+1|0);for(var o=0,i=n-1|0;;){var a=i,s=o,u=(s+a|0)/2|0,c=e(t,r[u]);if(0===c)return u;if(c<0){if(a===u)return 0===e(r[s],t)?s:0|-(a+1|0);i=u}else{if(s===u)return 0===e(r[a],t)?a:0|-(a+1|0);o=u}}}t.Int=void 0,t.$$String=void 0,t.strictlySortedLengthU=i,t.strictlySortedLength=function(r,t){return i(r,n.__2(t))},t.isSortedU=a,t.isSorted=function(r,t){return a(r,n.__2(t))},t.stableSortInPlaceByU=l,t.stableSortInPlaceBy=function(r,t){l(r,n.__2(t))},t.stableSortByU=m,t.stableSortBy=function(r,t){return m(r,n.__2(t))},t.binarySearchByU=p,t.binarySearchBy=function(r,t,e){return p(r,t,n.__2(e))},t.unionU=u,t.union=function(r,t,e,o,i,a,s,c,f){return u(r,t,e,o,i,a,s,c,n.__2(f))},t.intersectU=c,t.intersect=function(r,t,e,o,i,a,s,u,f){return c(r,t,e,o,i,a,s,u,n.__2(f))},t.diffU=f,t.diff=function(r,t,e,o,i,a,s,u,c){return f(r,t,e,o,i,a,s,u,n.__2(c))}},3282:(r,t,e)=>{var n=e(2971);function o(r,t,e,o,i,a,s,u){for(var c=t+e|0,f=i+a|0,d=t,v=r[t],l=i,m=o[i],p=u;;){var h=p,E=m,x=l,g=v,y=d;if(g<=E){s[h]=g;var _=y+1|0;if(_>=c)return n.blitUnsafe(o,x,s,h+1|0,f-x|0);p=h+1|0,v=r[_],d=_}else{s[h]=E;var T=x+1|0;if(T>=f)return n.blitUnsafe(r,y,s,h+1|0,c-y|0);p=h+1|0,m=o[T],l=T}}}function i(r,t,e,n,o){for(var i=0;i<o;++i){for(var a=r[t+i|0],s=(n+i|0)-1|0;s>=n&&e[s]>a;)e[s+1|0]=e[s],s=s-1|0;e[s+1|0]=a}}function a(r,t,e,n,s){if(s<=5)return i(r,t,e,n,s);var u=s/2|0,c=s-u|0;a(r,t+u|0,e,n+u|0,c),a(r,t,r,t+c|0,u),o(r,t+c|0,u,e,n+u|0,c,e,n)}function s(r){var t=r.length;if(t<=5)return i(r,0,r,0,t);var e=t/2|0,n=t-e|0,s=new Array(n);a(r,e,s,0,n),a(r,0,r,n,e),o(r,n,e,s,0,n,r,0)}t.strictlySortedLength=function(r){var t=r.length;if(0===t||1===t)return t;var e=r[0],n=r[1];if(!(e<n))return e>n?0|-function(r,t,e,n){for(;;){var o=e,i=t;if(o>=n)return o;var a=r[o];if(i<=a)return o;e=o+1|0,t=a}}(r,n,2,t):1;for(var o=n,i=2;;){var a=i,s=o;if(a>=t)return a;var u=r[a];if(s>=u)return a;i=a+1|0,o=u}},t.isSorted=function(r){var t=r.length;if(0===t)return!0;for(var e=0,n=t-1|0;;){var o=e;if(o===n)return!0;if(r[o]>r[o+1|0])return!1;e=o+1|0}},t.stableSortInPlace=s,t.stableSort=function(r){var t=r.slice(0);return s(t),t},t.binarySearch=function(r,t){var e=r.length;if(0===e)return-1;if(t<r[0])return-1;if(t>r[e-1|0])return 0|-(e+1|0);for(var n=0,o=e-1|0;;){var i=o,a=n,s=(a+i|0)/2|0,u=r[s];if(t===u)return s;if(t<u){if(i===s)return r[a]===t?a:0|-(i+1|0);o=s}else{if(a===s)return r[i]===t?i:0|-(i+1|0);n=s}}},t.union=function(r,t,e,o,i,a,s,u){for(var c=t+e|0,f=i+a|0,d=t,v=r[t],l=i,m=o[i],p=u;;){var h=p,E=m,x=l,g=v,y=d;if(g<E){s[h]=g;var _=y+1|0,T=h+1|0;if(_<c){p=T,v=r[_],d=_;continue}return n.blitUnsafe(o,x,s,T,f-x|0),(T+f|0)-x|0}if(g!==E){s[h]=E;var A=x+1|0,b=h+1|0;if(!(A<f))return n.blitUnsafe(r,y,s,b,c-y|0),(b+c|0)-y|0;p=b,m=o[A],l=A}else{s[h]=g;var k=y+1|0,S=x+1|0,C=h+1|0;if(!(k<c&&S<f))return k===c?(n.blitUnsafe(o,S,s,C,f-S|0),(C+f|0)-S|0):(n.blitUnsafe(r,k,s,C,c-k|0),(C+c|0)-k|0);p=C,m=o[S],l=S,v=r[k],d=k}}},t.intersect=function(r,t,e,n,o,i,a,s){for(var u=t+e|0,c=o+i|0,f=t,d=r[t],v=o,l=n[o],m=s;;){var p=m,h=l,E=v,x=d,g=f;if(x<h){var y=g+1|0;if(y>=u)return p;d=r[y],f=y}else if(x!==h){var _=E+1|0;if(_>=c)return p;l=n[_],v=_}else{a[p]=x;var T=g+1|0,A=E+1|0,b=p+1|0;if(!(T<u&&A<c))return b;m=b,l=n[A],v=A,d=r[T],f=T}}},t.diff=function(r,t,e,o,i,a,s,u){for(var c=t+e|0,f=i+a|0,d=t,v=r[t],l=i,m=o[i],p=u;;){var h=p,E=m,x=l,g=v,y=d;if(g<E){s[h]=g;var _=h+1|0,T=y+1|0;if(T>=c)return _;p=_,v=r[T],d=T}else if(g!==E){var A=x+1|0;if(!(A<f))return n.blitUnsafe(r,y,s,h,c-y|0),(h+c|0)-y|0;m=o[A],l=A}else{var b=y+1|0,k=x+1|0;if(!(b<c&&k<f))return b===c?h:(n.blitUnsafe(r,b,s,h,c-b|0),(h+c|0)-b|0);m=o[k],l=k,v=r[b],d=b}}}},8466:(r,t,e)=>{var n=e(2971);function o(r,t,e,o,i,a,s,u){for(var c=t+e|0,f=i+a|0,d=t,v=r[t],l=i,m=o[i],p=u;;){var h=p,E=m,x=l,g=v,y=d;if(g<=E){s[h]=g;var _=y+1|0;if(_>=c)return n.blitUnsafe(o,x,s,h+1|0,f-x|0);p=h+1|0,v=r[_],d=_}else{s[h]=E;var T=x+1|0;if(T>=f)return n.blitUnsafe(r,y,s,h+1|0,c-y|0);p=h+1|0,m=o[T],l=T}}}function i(r,t,e,n,o){for(var i=0;i<o;++i){for(var a=r[t+i|0],s=(n+i|0)-1|0;s>=n&&e[s]>a;)e[s+1|0]=e[s],s=s-1|0;e[s+1|0]=a}}function a(r,t,e,n,s){if(s<=5)return i(r,t,e,n,s);var u=s/2|0,c=s-u|0;a(r,t+u|0,e,n+u|0,c),a(r,t,r,t+c|0,u),o(r,t+c|0,u,e,n+u|0,c,e,n)}function s(r){var t=r.length;if(t<=5)return i(r,0,r,0,t);var e=t/2|0,n=t-e|0,s=new Array(n);a(r,e,s,0,n),a(r,0,r,n,e),o(r,n,e,s,0,n,r,0)}t.strictlySortedLength=function(r){var t=r.length;if(0===t||1===t)return t;var e=r[0],n=r[1];if(!(e<n))return e>n?0|-function(r,t,e,n){for(;;){var o=e,i=t;if(o>=n)return o;var a=r[o];if(i<=a)return o;e=o+1|0,t=a}}(r,n,2,t):1;for(var o=n,i=2;;){var a=i,s=o;if(a>=t)return a;var u=r[a];if(s>=u)return a;i=a+1|0,o=u}},t.isSorted=function(r){var t=r.length;if(0===t)return!0;for(var e=0,n=t-1|0;;){var o=e;if(o===n)return!0;if(r[o]>r[o+1|0])return!1;e=o+1|0}},t.stableSortInPlace=s,t.stableSort=function(r){var t=r.slice(0);return s(t),t},t.binarySearch=function(r,t){var e=r.length;if(0===e)return-1;if(t<r[0])return-1;if(t>r[e-1|0])return 0|-(e+1|0);for(var n=0,o=e-1|0;;){var i=o,a=n,s=(a+i|0)/2|0,u=r[s];if(t===u)return s;if(t<u){if(i===s)return r[a]===t?a:0|-(i+1|0);o=s}else{if(a===s)return r[i]===t?i:0|-(i+1|0);n=s}}},t.union=function(r,t,e,o,i,a,s,u){for(var c=t+e|0,f=i+a|0,d=t,v=r[t],l=i,m=o[i],p=u;;){var h=p,E=m,x=l,g=v,y=d;if(g<E){s[h]=g;var _=y+1|0,T=h+1|0;if(_<c){p=T,v=r[_],d=_;continue}return n.blitUnsafe(o,x,s,T,f-x|0),(T+f|0)-x|0}if(g!==E){s[h]=E;var A=x+1|0,b=h+1|0;if(!(A<f))return n.blitUnsafe(r,y,s,b,c-y|0),(b+c|0)-y|0;p=b,m=o[A],l=A}else{s[h]=g;var k=y+1|0,S=x+1|0,C=h+1|0;if(!(k<c&&S<f))return k===c?(n.blitUnsafe(o,S,s,C,f-S|0),(C+f|0)-S|0):(n.blitUnsafe(r,k,s,C,c-k|0),(C+c|0)-k|0);p=C,m=o[S],l=S,v=r[k],d=k}}},t.intersect=function(r,t,e,n,o,i,a,s){for(var u=t+e|0,c=o+i|0,f=t,d=r[t],v=o,l=n[o],m=s;;){var p=m,h=l,E=v,x=d,g=f;if(x<h){var y=g+1|0;if(y>=u)return p;d=r[y],f=y}else if(x!==h){var _=E+1|0;if(_>=c)return p;l=n[_],v=_}else{a[p]=x;var T=g+1|0,A=E+1|0,b=p+1|0;if(!(T<u&&A<c))return b;m=b,l=n[A],v=A,d=r[T],f=T}}},t.diff=function(r,t,e,o,i,a,s,u){for(var c=t+e|0,f=i+a|0,d=t,v=r[t],l=i,m=o[i],p=u;;){var h=p,E=m,x=l,g=v,y=d;if(g<E){s[h]=g;var _=h+1|0,T=y+1|0;if(T>=c)return _;p=_,v=r[T],d=T}else if(g!==E){var A=x+1|0;if(!(A<f))return n.blitUnsafe(r,y,s,h,c-y|0),(h+c|0)-y|0;m=o[A],l=A}else{var b=y+1|0,k=x+1|0;if(!(b<c&&k<f))return b===c?h:(n.blitUnsafe(r,b,s,h,c-b|0),(h+c|0)-b|0);m=o[k],l=k,v=r[b],d=b}}}},4881:(r,t,e)=>{var n=e(1386),o=e(7175),i=e(2531);function a(r,t,e){var n=void 0!==r?r.h:0,o=void 0!==e?e.h:0;return{v:t,h:(n>=o?n:o)+1|0,l:r,r:e}}function s(r){return{v:r,h:1,l:void 0,r:void 0}}function u(r,t){return void 0===t||void 0!==r&&r.h>=t.h}function c(r,t,e){var n=void 0!==r?r.h:0,o=void 0!==e?e.h:0;if(n>(o+2|0)){var i=r.l,s=r.r;return u(i,s)?a(i,r.v,a(s,t,e)):a(a(i,r.v,s.l),s.v,a(s.r,t,e))}if(o<=(n+2|0))return{v:t,h:(n>=o?n:o)+1|0,l:r,r:e};var c=e.l,f=e.r;return u(f,c)?a(a(r,t,c),e.v,f):a(a(r,t,c.l),c.v,a(c.r,e.v,f))}function f(r){for(;;){var t=r,e=t.l;if(void 0===e)return t.v;r=e}}function d(r){for(;;){var t=r,e=t.r;if(void 0===e)return t.v;r=e}}function v(r,t){var e=r.l;return void 0!==e?c(v(e,t),r.v,r.r):(t.contents=r.v,r.r)}function l(r,t){for(;;){if(void 0===r)return t;t={hd:r,tl:t},r=r.l}}function m(r,t){for(;;){var e=r;if(void 0===e)return;m(e.l,t),t(e.v),r=e.r}}function p(r,t,e){for(;;){var n=t,o=r;if(void 0===o)return n;t=e(p(o.l,n,e),o.v),r=o.r}}function h(r,t){for(;;){var e=r;if(void 0===e)return!0;if(!t(e.v))return!1;if(!h(e.l,t))return!1;r=e.r}}function E(r,t){for(;;){var e=r;if(void 0===e)return!1;if(t(e.v))return!0;if(E(e.l,t))return!0;r=e.r}}function x(r,t){return void 0!==r?c(x(r.l,t),r.v,r.r):s(t)}function g(r,t){return void 0!==r?c(r.l,r.v,g(r.r,t)):s(t)}function y(r,t,e){if(void 0===r)return x(e,t);if(void 0===e)return g(r,t);var n=r.h,o=e.h;return n>(o+2|0)?c(r.l,r.v,y(r.r,t,e)):o>(n+2|0)?c(y(r,t,e.l),e.v,e.r):a(r,t,e)}function _(r,t){if(void 0===r)return t;if(void 0===t)return r;var e={contents:t.v},n=v(t,e);return y(r,e.contents,n)}function T(r,t){if(void 0===r)return[void 0,void 0];var e=r.v,n=T(r.l,t),o=n[1],i=n[0],a=t(e),s=T(r.r,t),u=s[1],c=s[0];return a?[y(i,e,c),_(o,u)]:[_(i,c),y(o,e,u)]}function A(r){var t=r.l,e=r.r;return(1+(void 0!==t?A(t):0)|0)+(void 0!==e?A(e):0)|0}function b(r){return void 0!==r?A(r):0}function k(r,t){for(;;){var e=t,n=r;if(void 0===n)return e;t={hd:n.v,tl:k(n.r,e)},r=n.l}}function S(r,t,e){for(;;){var n=t,o=r,i=o.v,a=o.l,s=o.r,u=void 0!==a?S(a,n,e):n;e[u]=i;var c=u+1|0;if(void 0===s)return c;t=c,r=s}}function C(r,t,e,n){for(;;){var o=r,i=o.v,a=o.l,s=o.r;if(void 0!==a&&C(a,t,e,n),n(i)){var u=t.forward;e[u]=i,t.forward=u+1|0}else{var c=t.backward;e[c]=i,t.backward=c-1|0}if(void 0===s)return;r=s}}function w(r,t,e,n){for(;;){var o=t,i=r,a=i.v,s=i.l,u=i.r,c=void 0!==s?w(s,o,e,n):o,f=n(a)?(e[c]=a,c+1|0):c;if(void 0===u)return f;t=f,r=u}}function I(r,t,e){switch(e){case 0:return;case 1:return s(r[t]);case 2:var n=r[t];return{v:r[t-1|0],h:2,l:s(n),r:void 0};case 3:var o=r[t],i=r[t-1|0],u=r[t-2|0];return{v:i,h:2,l:s(o),r:s(u)};default:var c=e/2|0;return a(I(r,t,c),r[t-c|0],I(r,(t-c|0)-1|0,(e-c|0)-1|0))}}function M(r,t,e){switch(e){case 0:return;case 1:return s(r[t]);case 2:var n=r[t];return{v:r[t+1|0],h:2,l:s(n),r:void 0};case 3:var o=r[t],i=r[t+1|0],u=r[t+2|0];return{v:i,h:2,l:s(o),r:s(u)};default:var c=e/2|0;return a(M(r,t,c),r[t+c|0],M(r,1+(t+c|0)|0,(e-c|0)-1|0))}}function G(r,t){if(void 0!==r){var e=r.v,n=r.l,o=r.r,i=G(n,t),a=t(e),s=G(o,t);return a?n===i&&o===s?r:y(i,e,s):_(i,s)}}function j(r,t){if(void 0!==r){var e=A(r),n=new Array(e);return M(n,0,w(r,0,n,t))}}function D(r,t){if(void 0===r)return[void 0,void 0];var e=A(r),n=new Array(e),o=e-1|0,i={forward:0,backward:o};C(r,i,n,t);var a=i.forward;return[M(n,0,a),I(n,o,e-a|0)]}function O(r,t,e){var n=b(r),o=b(t);if(n!==o)return n<o?-1:1;for(var i=l(r,0),a=l(t,0);;){var s=a,u=i;if(!u)return 0;if(!s)return 0;var c=s.hd,f=u.hd,d=e(f.v,c.v);if(0!==d)return d;a=l(c.r,s.tl),i=l(f.r,u.tl)}}function N(r){var t=r.l;r.l=t.r,t.r=r;var e=r.l,n=void 0!==e?e.h:0,o=r.r,i=void 0!==o?o.h:0;r.h=(n>i?n:i)+1|0;var a=t.l,s=void 0!==a?a.h:0,u=r.h;return t.h=(s>u?s:u)+1|0,t}function P(r){var t=r.r;r.r=t.l,t.l=r;var e=r.l,n=void 0!==e?e.h:0,o=r.r,i=void 0!==o?o.h:0;r.h=(n>i?n:i)+1|0;var a=t.r,s=void 0!==a?a.h:0,u=r.h;return t.h=(s>u?s:u)+1|0,t}function U(r){var t=r.l,e=void 0!==t?t.h:0,n=r.r,o=void 0!==n?n.h:0;return r.h=(e>o?e:o)+1|0,r}function F(r){var t,e,n=r.l,o=r.r,i=void 0!==n?n.h:0,a=void 0!==o?o.h:0;if(i>(2+a|0))return u(n.l,n.r)?U(N(r)):U((e=P((t=r).l),t.l=e,N(t)));if(a>(2+i|0)){var s=o.l;return u(o.r,s)?U(P(r)):U(function(r){var t=N(r.r);return r.r=t,P(r)}(r))}return r.h=(i>a?i:a)+1|0,r}function V(r,t,e){if(void 0===t)return s(e);var n=r(e,t.v);if(0===n)return t;var o=t.l,i=t.r;if(n<0){var a=V(r,o,e);t.l=a}else t.r=V(r,i,e);return F(t)}t.copy=function r(t){return void 0!==t?{v:t.v,h:t.h,l:r(t.l),r:r(t.r)}:t},t.create=a,t.bal=c,t.singleton=s,t.minimum=function(r){if(void 0!==r)return o.some(f(r))},t.minUndefined=function(r){if(void 0!==r)return f(r)},t.maximum=function(r){if(void 0!==r)return o.some(d(r))},t.maxUndefined=function(r){if(void 0!==r)return d(r)},t.removeMinAuxWithRef=v,t.isEmpty=function(r){return void 0===r},t.stackAllLeft=l,t.forEachU=m,t.forEach=function(r,t){m(r,n.__1(t))},t.reduceU=p,t.reduce=function(r,t,e){return p(r,t,n.__2(e))},t.everyU=h,t.every=function(r,t){return h(r,n.__1(t))},t.someU=E,t.some=function(r,t){return E(r,n.__1(t))},t.joinShared=y,t.concatShared=_,t.keepSharedU=G,t.keepShared=function(r,t){return G(r,n.__1(t))},t.keepCopyU=j,t.keepCopy=function(r,t){return j(r,n.__1(t))},t.partitionSharedU=T,t.partitionShared=function(r,t){return T(r,n.__1(t))},t.partitionCopyU=D,t.partitionCopy=function(r,t){return D(r,n.__1(t))},t.lengthNode=A,t.size=b,t.toList=function(r){return k(r,0)},t.checkInvariantInternal=function r(t){for(;;){var e=t;if(void 0===e)return;var n=e.l,o=e.r,i=(void 0!==n?n.h:0)-(void 0!==o?o.h:0)|0;if(!(i<=2&&i>=-2))throw{RE_EXN_ID:"Assert_failure",_1:["belt_internalAVLset.res",319,4],Error:new Error};r(n),t=o}},t.fillArray=S,t.toArray=function(r){if(void 0===r)return[];var t=A(r),e=new Array(t);return S(r,0,e),e},t.fromSortedArrayAux=M,t.fromSortedArrayRevAux=I,t.fromSortedArrayUnsafe=function(r){return M(r,0,r.length)},t.has=function(r,t,e){for(;;){var n=r;if(void 0===n)return!1;var o=e(t,n.v);if(0===o)return!0;r=o<0?n.l:n.r}},t.cmp=O,t.eq=function(r,t,e){return 0===O(r,t,e)},t.subset=function r(t,e,n){for(;;){var o=e,i=t;if(void 0===i)return!0;if(void 0===o)return!1;var s=i.v,u=i.l,c=i.r,f=o.v,d=o.l,v=o.r,l=n(s,f);if(0!==l)if(l<0){if(!r(a(u,s,void 0),d,n))return!1;t=c}else{if(!r(a(void 0,s,c),v,n))return!1;t=u}else{if(!r(u,d,n))return!1;e=v,t=c}}},t.get=function(r,t,e){for(;;){var n=r;if(void 0===n)return;var i=n.v,a=e(t,i);if(0===a)return o.some(i);r=a<0?n.l:n.r}},t.getUndefined=function(r,t,e){for(;;){var n=r;if(void 0===n)return;var o=n.v,i=e(t,o);if(0===i)return o;r=i<0?n.l:n.r}},t.getExn=function(r,t,e){for(;;){var n=r;if(void 0===n)throw{RE_EXN_ID:"Not_found",Error:new Error};var o=n.v,i=e(t,o);if(0===i)return o;r=i<0?n.l:n.r}},t.fromArray=function(r,t){var e=r.length;if(0!==e){var n,o=i.strictlySortedLengthU(r,(function(r,e){return t(r,e)<0}));n=o>=0?M(r,0,o):I(r,(o=0|-o)-1|0,o);for(var a=o;a<e;++a)n=V(t,n,r[a]);return n}},t.addMutate=V,t.balMutate=F,t.removeMinAuxWithRootMutate=function r(t,e){var n=e.l,o=e.r;return void 0!==n?(e.l=r(t,n),F(e)):(t.v=e.v,o)}},6144:(r,t,e)=>{var n=e(1386),o=e(7175),i=e(2531);function a(r){return void 0!==r?r.h:0}function s(r,t,e,n){var o=a(r),i=a(n);return{k:t,v:e,h:o>=i?o+1|0:i+1|0,l:r,r:n}}function u(r,t){return{k:r,v:t,h:1,l:void 0,r:void 0}}function c(r,t){return void 0===t||void 0!==r&&r.h>=t.h}function f(r,t,e,n){var o=void 0!==r?r.h:0,i=void 0!==n?n.h:0;if(o>(i+2|0)){var u=r.l,c=r.r;return a(u)>=a(c)?s(u,r.k,r.v,s(c,t,e,n)):s(s(u,r.k,r.v,c.l),c.k,c.v,s(c.r,t,e,n))}if(i<=(o+2|0))return{k:t,v:e,h:o>=i?o+1|0:i+1|0,l:r,r:n};var f=n.l,d=n.r;return a(d)>=a(f)?s(s(r,t,e,f),n.k,n.v,d):s(s(r,t,e,f.l),f.k,f.v,s(f.r,n.k,n.v,d))}function d(r){for(;;){var t=r,e=t.l;if(void 0===e)return t.k;r=e}}function v(r){for(;;){var t=r,e=t.r;if(void 0===e)return t.k;r=e}}function l(r){for(;;){var t=r,e=t.l;if(void 0===e)return[t.k,t.v];r=e}}function m(r){for(;;){var t=r,e=t.r;if(void 0===e)return[t.k,t.v];r=e}}function p(r,t,e){var n=r.l;return void 0!==n?f(p(n,t,e),r.k,r.v,r.r):(t.contents=r.k,e.contents=r.v,r.r)}function h(r,t){for(;;){if(void 0===r)return t;t={hd:r,tl:t},r=r.l}}function E(r,t){if(void 0!==r){var e=E(r.l,t);if(void 0!==e)return e;var n=r.k,o=r.v;if(t(n,o))return[n,o];var i=E(r.r,t);return void 0!==i?i:void 0}}function x(r,t){for(;;){var e=r;if(void 0===e)return;x(e.l,t),t(e.k,e.v),r=e.r}}function g(r,t){if(void 0!==r){var e=g(r.l,t),n=t(r.v),o=g(r.r,t);return{k:r.k,v:n,h:r.h,l:e,r:o}}}function y(r,t){if(void 0!==r){var e=r.k,n=y(r.l,t),o=t(e,r.v),i=y(r.r,t);return{k:e,v:o,h:r.h,l:n,r:i}}}function _(r,t,e){for(;;){var n=t,o=r;if(void 0===o)return n;var i=o.k,a=o.v,s=o.l,u=o.r;t=e(_(s,n,e),i,a),r=u}}function T(r,t){for(;;){var e=r;if(void 0===e)return!0;if(!t(e.k,e.v))return!1;if(!T(e.l,t))return!1;r=e.r}}function A(r,t){for(;;){var e=r;if(void 0===e)return!1;if(t(e.k,e.v))return!0;if(A(e.l,t))return!0;r=e.r}}function b(r,t,e){return void 0!==r?f(b(r.l,t,e),r.k,r.v,r.r):u(t,e)}function k(r,t,e){return void 0!==r?f(r.l,r.k,r.v,k(r.r,t,e)):u(t,e)}function S(r,t,e,n){if(void 0===r)return b(n,t,e);if(void 0===n)return k(r,t,e);var o=r.k,i=r.v,a=r.h,u=r.l,c=r.r,d=n.k,v=n.v,l=n.h,m=n.l,p=n.r;return a>(l+2|0)?f(u,o,i,S(c,t,e,n)):l>(a+2|0)?f(S(r,t,e,m),d,v,p):s(r,t,e,n)}function C(r,t){if(void 0===r)return t;if(void 0===t)return r;var e={contents:t.k},n={contents:t.v},o=p(t,e,n);return S(r,e.contents,n.contents,o)}function w(r,t){if(void 0!==r){var e=r.k,n=r.v,o=w(r.l,t),i=t(e,n),a=w(r.r,t);return i?S(o,e,n,a):C(o,a)}}function I(r,t){if(void 0!==r){var e=r.k,n=r.v,i=I(r.l,t),a=t(e,n),s=I(r.r,t);return void 0!==a?S(i,e,o.valFromOption(a),s):C(i,s)}}function M(r,t){if(void 0===r)return[void 0,void 0];var e=r.k,n=r.v,o=M(r.l,t),i=o[1],a=o[0],s=t(e,n),u=M(r.r,t),c=u[1],f=u[0];return s?[S(a,e,n,f),C(i,c)]:[C(a,f),S(i,e,n,c)]}function G(r){var t=r.l,e=r.r;return(1+(void 0!==t?G(t):0)|0)+(void 0!==e?G(e):0)|0}function j(r){return void 0!==r?G(r):0}function D(r,t){for(;;){var e=t,n=r;if(void 0===n)return e;var o=n.k,i=n.v,a=n.l;t={hd:[o,i],tl:D(n.r,e)},r=a}}function O(r,t,e){for(;;){var n=t,o=r,i=o.k,a=o.l,s=o.r,u=void 0!==a?O(a,n,e):n;e[u]=i;var c=u+1|0;if(void 0===s)return c;t=c,r=s}}function N(r,t,e){for(;;){var n=t,o=r,i=o.l,a=o.r,s=void 0!==i?N(i,n,e):n;e[s]=o.v;var u=s+1|0;if(void 0===a)return u;t=u,r=a}}function P(r,t,e){for(;;){var n=t,o=r,i=o.l,a=o.k,s=o.r,u=void 0!==i?P(i,n,e):n;e[u]=[a,o.v];var c=u+1|0;if(void 0===s)return c;t=c,r=s}}function U(r,t,e){switch(e){case 0:return;case 1:var n=r[t];return u(n[0],n[1]);case 2:var o=r[t],i=r[t-1|0],a=o;return{k:i[0],v:i[1],h:2,l:u(a[0],a[1]),r:void 0};case 3:var c=r[t],f=r[t-1|0],d=r[t-2|0],v=f,l=c;return{k:v[0],v:v[1],h:2,l:u(l[0],l[1]),r:u(d[0],d[1])};default:var m=e/2|0,p=U(r,t,m),h=r[t-m|0],E=U(r,(t-m|0)-1|0,(e-m|0)-1|0);return s(p,h[0],h[1],E)}}function F(r,t,e){switch(e){case 0:return;case 1:var n=r[t];return u(n[0],n[1]);case 2:var o=r[t],i=r[t+1|0],a=o;return{k:i[0],v:i[1],h:2,l:u(a[0],a[1]),r:void 0};case 3:var c=r[t],f=r[t+1|0],d=r[t+2|0],v=f,l=c;return{k:v[0],v:v[1],h:2,l:u(l[0],l[1]),r:u(d[0],d[1])};default:var m=e/2|0,p=F(r,t,m),h=r[t+m|0],E=F(r,1+(t+m|0)|0,(e-m|0)-1|0);return s(p,h[0],h[1],E)}}function V(r,t,e,n){var o=j(r),i=j(t);if(o!==i)return o<i?-1:1;for(var a=h(r,0),s=h(t,0);;){var u=s,c=a;if(!c)return 0;if(!u)return 0;var f=u.hd,d=c.hd,v=e(d.k,f.k);if(0!==v)return v;var l=n(d.v,f.v);if(0!==l)return l;s=h(f.r,u.tl),a=h(d.r,c.tl)}}function R(r,t,e,n){if(j(r)!==j(t))return!1;for(var o=h(r,0),i=h(t,0);;){var a=i,s=o;if(!s)return!0;if(!a)return!0;var u=a.hd,c=s.hd;if(0!==e(c.k,u.k)||!n(c.v,u.v))return!1;i=h(u.r,a.tl),o=h(c.r,s.tl)}}function B(r){var t=r.l;r.l=t.r,t.r=r;var e=a(r.l),n=a(r.r);r.h=(e>n?e:n)+1|0;var o=a(t.l),i=r.h;return t.h=(o>i?o:i)+1|0,t}function W(r){var t=r.r;r.r=t.l,t.l=r;var e=a(r.l),n=a(r.r);r.h=(e>n?e:n)+1|0;var o=a(t.r),i=r.h;return t.h=(o>i?o:i)+1|0,t}function L(r){var t=a(r.l),e=a(r.r);return r.h=(t>e?t:e)+1|0,r}function H(r){var t,e,n=r.l,o=r.r,i=a(n),s=a(o);if(i>(2+s|0))return c(n.l,n.r)?L(B(r)):L((e=W((t=r).l),t.l=e,B(t)));if(s>(2+i|0)){var u=o.l;return c(o.r,u)?L(W(r)):L(function(r){var t=B(r.r);return r.r=t,W(r)}(r))}return r.h=(i>s?i:s)+1|0,r}function q(r,t,e,n){if(void 0===r)return u(t,e);var o=n(t,r.k);if(0===o)return r.v=e,r;var i=r.l,a=r.r;if(o<0){var s=q(i,t,e,n);r.l=s}else r.r=q(a,t,e,n);return H(r)}t.copy=function r(t){return void 0!==t?{k:t.k,v:t.v,h:t.h,l:r(t.l),r:r(t.r)}:t},t.create=s,t.bal=f,t.singleton=u,t.updateValue=function(r,t){return r.v===t?r:{k:r.k,v:t,h:r.h,l:r.l,r:r.r}},t.minKey=function(r){if(void 0!==r)return o.some(d(r))},t.minKeyUndefined=function(r){if(void 0!==r)return d(r)},t.maxKey=function(r){if(void 0!==r)return o.some(v(r))},t.maxKeyUndefined=function(r){if(void 0!==r)return v(r)},t.minimum=function(r){if(void 0!==r)return l(r)},t.minUndefined=function(r){if(void 0!==r)return l(r)},t.maximum=function(r){if(void 0!==r)return m(r)},t.maxUndefined=function(r){if(void 0!==r)return m(r)},t.removeMinAuxWithRef=p,t.isEmpty=function(r){return void 0===r},t.stackAllLeft=h,t.findFirstByU=E,t.findFirstBy=function(r,t){return E(r,n.__2(t))},t.forEachU=x,t.forEach=function(r,t){x(r,n.__2(t))},t.mapU=g,t.map=function(r,t){return g(r,n.__1(t))},t.mapWithKeyU=y,t.mapWithKey=function(r,t){return y(r,n.__2(t))},t.reduceU=_,t.reduce=function(r,t,e){return _(r,t,n.__3(e))},t.everyU=T,t.every=function(r,t){return T(r,n.__2(t))},t.someU=A,t.some=function(r,t){return A(r,n.__2(t))},t.join=S,t.concat=C,t.concatOrJoin=function(r,t,e,n){return void 0!==e?S(r,t,o.valFromOption(e),n):C(r,n)},t.keepSharedU=w,t.keepShared=function(r,t){return w(r,n.__2(t))},t.keepMapU=I,t.keepMap=function(r,t){return I(r,n.__2(t))},t.partitionSharedU=M,t.partitionShared=function(r,t){return M(r,n.__2(t))},t.lengthNode=G,t.size=j,t.toList=function(r){return D(r,0)},t.checkInvariantInternal=function r(t){for(;;){var e=t;if(void 0===e)return;var n=e.l,o=e.r,i=a(n)-a(o)|0;if(!(i<=2&&i>=-2))throw{RE_EXN_ID:"Assert_failure",_1:["belt_internalAVLtree.res",457,4],Error:new Error};r(n),t=o}},t.fillArray=P,t.toArray=function(r){if(void 0===r)return[];var t=G(r),e=new Array(t);return P(r,0,e),e},t.keysToArray=function(r){if(void 0===r)return[];var t=G(r),e=new Array(t);return O(r,0,e),e},t.valuesToArray=function(r){if(void 0===r)return[];var t=G(r),e=new Array(t);return N(r,0,e),e},t.fromSortedArrayAux=F,t.fromSortedArrayRevAux=U,t.fromSortedArrayUnsafe=function(r){return F(r,0,r.length)},t.cmpU=V,t.cmp=function(r,t,e,o){return V(r,t,e,n.__2(o))},t.eqU=R,t.eq=function(r,t,e,o){return R(r,t,e,n.__2(o))},t.get=function(r,t,e){for(;;){var n=r;if(void 0===n)return;var i=e(t,n.k);if(0===i)return o.some(n.v);r=i<0?n.l:n.r}},t.getUndefined=function(r,t,e){for(;;){var n=r;if(void 0===n)return;var o=e(t,n.k);if(0===o)return n.v;r=o<0?n.l:n.r}},t.getWithDefault=function(r,t,e,n){for(;;){var o=r;if(void 0===o)return e;var i=n(t,o.k);if(0===i)return o.v;r=i<0?o.l:o.r}},t.getExn=function(r,t,e){for(;;){var n=r;if(void 0===n)throw{RE_EXN_ID:"Not_found",Error:new Error};var o=e(t,n.k);if(0===o)return n.v;r=o<0?n.l:n.r}},t.has=function(r,t,e){for(;;){var n=r;if(void 0===n)return!1;var o=e(t,n.k);if(0===o)return!0;r=o<0?n.l:n.r}},t.fromArray=function(r,t){var e=r.length;if(0!==e){var n,o=i.strictlySortedLengthU(r,(function(r,e){return t(r[0],e[0])<0}));n=o>=0?F(r,0,o):U(r,(o=0|-o)-1|0,o);for(var a=o;a<e;++a){var s=r[a];n=q(n,s[0],s[1],t)}return n}},t.updateMutate=q,t.balMutate=H,t.removeMinAuxWithRootMutate=function r(t,e){var n=e.r,o=e.l;return void 0!==o?(e.l=r(t,o),H(e)):(t.k=e.k,t.v=e.v,n)}},5252:(r,t,e)=>{var n=e(1386),o=e(2971),i=e(7175);function a(r){if(void 0===r)return r;var t={key:r.key,value:r.value,next:void 0};return function(r,t){for(;;){var e=t,n=r;if(void 0===n)return;var o={key:n.key,value:n.value,next:void 0};e.next=o,t=o,r=n.next}}(r.next,t),t}function s(r){for(var t=r.length,e=new Array(t),n=0;n<t;++n)e[n]=a(r[n]);return e}function u(r,t){for(;;){var e=r;if(void 0===t)return e;t=t.next,r=e+1|0}}function c(r,t){for(;;){var e=t;if(void 0===e)return;r(e.key,e.value),t=e.next}}function f(r,t){for(var e=r.buckets,n=0,o=e.length;n<o;++n)c(t,e[n])}function d(r,t,e){for(;;){var n=t;if(void 0===n)return e;e=r(e,n.key,n.value),t=n.next}}function v(r,t,e){for(var n=r.buckets,o=t,i=0,a=n.length;i<a;++i)o=d(e,n[i],o);return o}function l(r){var t=function(r){return o.reduceU(r.buckets,0,(function(r,t){var e=u(0,t);return r>e?r:e}))}(r),e=o.makeByU(t+1|0,(function(r){return 0}));return o.forEachU(r.buckets,(function(r){var t=u(0,r);e[t]=e[t]+1|0})),e}function m(r,t,e,n,o){for(;;){var a=o,s=n,u=a.next,c=r(a.key,a.value);if(void 0===c){if(t.size=t.size-1|0,void 0===u)return void(void 0!==s?s.next=u:t.buckets[e]=s);o=u}else{if(void 0!==s?a.next=a:t.buckets[e]=a,a.value=i.valFromOption(c),void 0===u)return void(a.next=u);o=u,n=a}}}function p(r,t){for(var e=r.buckets,n=0,o=e.length;n<o;++n){var i=e[n];void 0!==i&&m(t,r,n,void 0,i)}}function h(r,t,e,n){for(;;){var o=e,i=r;t[i]=n(o);var a=o.next;if(void 0===a)return i+1|0;e=a,r=i+1|0}}function E(r,t){for(var e=r.buckets,n=0,o=new Array(r.size),i=0,a=e.length;i<a;++i){var s=e[i];void 0!==s&&(n=h(n,o,s,t))}return o}t.C=void 0,t.copy=function(r){return{size:r.size,buckets:s(r.buckets),hash:r.hash,eq:r.eq}},t.forEachU=f,t.forEach=function(r,t){f(r,n.__2(t))},t.reduceU=v,t.reduce=function(r,t,e){return v(r,t,n.__3(e))},t.logStats=function(r){var t=l(r);console.log({bindings:r.size,buckets:r.buckets.length,histogram:t})},t.keepMapInPlaceU=p,t.keepMapInPlace=function(r,t){p(r,n.__2(t))},t.fillArray=function(r,t,e){for(;;){var n=e,o=r;t[o]=[n.key,n.value];var i=n.next;if(void 0===i)return o+1|0;e=i,r=o+1|0}},t.keysToArray=function(r){return E(r,(function(r){return r.key}))},t.valuesToArray=function(r){return E(r,(function(r){return r.value}))},t.toArray=function(r){return E(r,(function(r){return[r.key,r.value]}))},t.getBucketHistogram=l},354:(r,t)=>{t.emptyOpt=void 0,t.make=function(r,t,e){var n=function(r,t){for(;;){if(r>=t)return r;if(r<<1<r)return r;r<<=1}}(16,e);return{size:0,buckets:new Array(n),hash:r,eq:t}},t.clear=function(r){r.size=0;for(var t=r.buckets,e=t.length,n=0;n<e;++n)t[n]=void 0},t.isEmpty=function(r){return 0===r.size}},3163:(r,t,e)=>{var n=e(6253),o=e(1386),i=e(7175),a=e(2531),s=e(6144);function u(r,t){var e=t.k,n=t.v,o=t.l,a=t.r;if(r===e)return[o,i.some(n),a];if(r<e){if(void 0===o)return[void 0,void 0,t];var c=u(r,o);return[c[0],c[1],s.join(c[2],e,n,a)]}if(void 0===a)return[t,void 0,void 0];var f=u(r,a);return[s.join(o,e,n,f[0]),f[1],f[2]]}function c(r,t){return void 0!==t?u(r,t):[void 0,void 0,void 0]}function f(r,t,e){if(void 0!==r){if(r.h>=(void 0!==t?t.h:0)){var n=r.k,o=r.v,a=r.l,u=r.r,d=c(n,t);return s.concatOrJoin(f(a,d[0],e),n,e(n,i.some(o),d[1]),f(u,d[2],e))}}else if(void 0===t)return;var v=t.k,l=t.v,m=t.l,p=t.r,h=c(v,r);return s.concatOrJoin(f(h[0],m,e),v,e(v,h[1],i.some(l)),f(h[2],p,e))}function d(r,t,e){for(;;){var o=t,i=r;if(!i)return 0;if(!o)return 0;var a=o.hd,u=i.hd,c=n.int_compare(u.k,a.k);if(0!==c)return c;var f=e(u.v,a.v);if(0!==f)return f;t=s.stackAllLeft(a.r,o.tl),r=s.stackAllLeft(u.r,i.tl)}}function v(r,t,e){var n=s.size(r),o=s.size(t);return n===o?d(s.stackAllLeft(r,0),s.stackAllLeft(t,0),e):n<o?-1:1}function l(r,t,e){for(;;){var n=t,o=r;if(!o)return!0;if(!n)return!0;var i=n.hd,a=o.hd;if(a.k!==i.k||!e(a.v,i.v))return!1;t=s.stackAllLeft(i.r,n.tl),r=s.stackAllLeft(a.r,o.tl)}}function m(r,t,e){return s.size(r)===s.size(t)&&l(s.stackAllLeft(r,0),s.stackAllLeft(t,0),e)}function p(r,t,e){if(void 0===r)return s.singleton(t,e);var n=r.k;if(t===n)return r.k=t,r.v=e,r;var o=r.l,i=r.r;if(t<n){var a=p(o,t,e);r.l=a}else r.r=p(i,t,e);return s.balMutate(r)}t.N=void 0,t.A=void 0,t.S=void 0,t.add=function r(t,e,n){if(void 0===t)return s.singleton(e,n);var o=t.k;if(e===o)return s.updateValue(t,n);var i=t.v;return e<o?s.bal(r(t.l,e,n),o,i,t.r):s.bal(t.l,o,i,r(t.r,e,n))},t.get=function(r,t){for(;;){var e=r;if(void 0===e)return;var n=e.k;if(t===n)return i.some(e.v);r=t<n?e.l:e.r}},t.getUndefined=function(r,t){for(;;){var e=r;if(void 0===e)return;var n=e.k;if(t===n)return e.v;r=t<n?e.l:e.r}},t.getExn=function(r,t){for(;;){var e=r;if(void 0===e)throw{RE_EXN_ID:"Not_found",Error:new Error};var n=e.k;if(t===n)return e.v;r=t<n?e.l:e.r}},t.getWithDefault=function(r,t,e){for(;;){var n=r;if(void 0===n)return e;var o=n.k;if(t===o)return n.v;r=t<o?n.l:n.r}},t.has=function(r,t){for(;;){var e=r;if(void 0===e)return!1;var n=e.k;if(t===n)return!0;r=t<n?e.l:e.r}},t.remove=function r(t,e){if(void 0===t)return t;var n=t.k,o=t.l,i=t.r;if(e!==n)return e<n?s.bal(r(o,e),n,t.v,i):s.bal(o,n,t.v,r(i,e));if(void 0===o)return i;if(void 0===i)return o;var a={contents:i.k},u={contents:i.v},c=s.removeMinAuxWithRef(i,a,u);return s.bal(o,a.contents,u.contents,c)},t.splitAux=u,t.split=c,t.mergeU=f,t.merge=function(r,t,e){return f(r,t,o.__3(e))},t.compareAux=d,t.cmpU=v,t.cmp=function(r,t,e){return v(r,t,o.__2(e))},t.eqAux=l,t.eqU=m,t.eq=function(r,t,e){return m(r,t,o.__2(e))},t.addMutate=p,t.fromArray=function(r){var t=r.length;if(0!==t){var e,n=a.strictlySortedLengthU(r,(function(r,t){return r[0]<t[0]}));n>=0?e=s.fromSortedArrayAux(r,0,n):(n=0|-n,e=s.fromSortedArrayRevAux(r,n-1|0,n));for(var o=n;o<t;++o){var i=r[o];e=p(e,i[0],i[1])}return e}}},2459:(r,t,e)=>{var n=e(6253),o=e(1386),i=e(7175),a=e(2531),s=e(6144);function u(r,t){var e=t.k,n=t.v,o=t.l,a=t.r;if(r===e)return[o,i.some(n),a];if(r<e){if(void 0===o)return[void 0,void 0,t];var c=u(r,o);return[c[0],c[1],s.join(c[2],e,n,a)]}if(void 0===a)return[t,void 0,void 0];var f=u(r,a);return[s.join(o,e,n,f[0]),f[1],f[2]]}function c(r,t){return void 0!==t?u(r,t):[void 0,void 0,void 0]}function f(r,t,e){if(void 0!==r){if(r.h>=(void 0!==t?t.h:0)){var n=r.k,o=r.v,a=r.l,u=r.r,d=c(n,t);return s.concatOrJoin(f(a,d[0],e),n,e(n,i.some(o),d[1]),f(u,d[2],e))}}else if(void 0===t)return;var v=t.k,l=t.v,m=t.l,p=t.r,h=c(v,r);return s.concatOrJoin(f(h[0],m,e),v,e(v,h[1],i.some(l)),f(h[2],p,e))}function d(r,t,e){for(;;){var o=t,i=r;if(!i)return 0;if(!o)return 0;var a=o.hd,u=i.hd,c=n.string_compare(u.k,a.k);if(0!==c)return c;var f=e(u.v,a.v);if(0!==f)return f;t=s.stackAllLeft(a.r,o.tl),r=s.stackAllLeft(u.r,i.tl)}}function v(r,t,e){var n=s.size(r),o=s.size(t);return n===o?d(s.stackAllLeft(r,0),s.stackAllLeft(t,0),e):n<o?-1:1}function l(r,t,e){for(;;){var n=t,o=r;if(!o)return!0;if(!n)return!0;var i=n.hd,a=o.hd;if(a.k!==i.k||!e(a.v,i.v))return!1;t=s.stackAllLeft(i.r,n.tl),r=s.stackAllLeft(a.r,o.tl)}}function m(r,t,e){return s.size(r)===s.size(t)&&l(s.stackAllLeft(r,0),s.stackAllLeft(t,0),e)}function p(r,t,e){if(void 0===r)return s.singleton(t,e);var n=r.k;if(t===n)return r.k=t,r.v=e,r;var o=r.l,i=r.r;if(t<n){var a=p(o,t,e);r.l=a}else r.r=p(i,t,e);return s.balMutate(r)}t.N=void 0,t.A=void 0,t.S=void 0,t.add=function r(t,e,n){if(void 0===t)return s.singleton(e,n);var o=t.k;if(e===o)return s.updateValue(t,n);var i=t.v;return e<o?s.bal(r(t.l,e,n),o,i,t.r):s.bal(t.l,o,i,r(t.r,e,n))},t.get=function(r,t){for(;;){var e=r;if(void 0===e)return;var n=e.k;if(t===n)return i.some(e.v);r=t<n?e.l:e.r}},t.getUndefined=function(r,t){for(;;){var e=r;if(void 0===e)return;var n=e.k;if(t===n)return e.v;r=t<n?e.l:e.r}},t.getExn=function(r,t){for(;;){var e=r;if(void 0===e)throw{RE_EXN_ID:"Not_found",Error:new Error};var n=e.k;if(t===n)return e.v;r=t<n?e.l:e.r}},t.getWithDefault=function(r,t,e){for(;;){var n=r;if(void 0===n)return e;var o=n.k;if(t===o)return n.v;r=t<o?n.l:n.r}},t.has=function(r,t){for(;;){var e=r;if(void 0===e)return!1;var n=e.k;if(t===n)return!0;r=t<n?e.l:e.r}},t.remove=function r(t,e){if(void 0===t)return t;var n=t.k,o=t.l,i=t.r;if(e!==n)return e<n?s.bal(r(o,e),n,t.v,i):s.bal(o,n,t.v,r(i,e));if(void 0===o)return i;if(void 0===i)return o;var a={contents:i.k},u={contents:i.v},c=s.removeMinAuxWithRef(i,a,u);return s.bal(o,a.contents,u.contents,c)},t.splitAux=u,t.split=c,t.mergeU=f,t.merge=function(r,t,e){return f(r,t,o.__3(e))},t.compareAux=d,t.cmpU=v,t.cmp=function(r,t,e){return v(r,t,o.__2(e))},t.eqAux=l,t.eqU=m,t.eq=function(r,t,e){return m(r,t,o.__2(e))},t.addMutate=p,t.fromArray=function(r){var t=r.length;if(0!==t){var e,n=a.strictlySortedLengthU(r,(function(r,t){return r[0]<t[0]}));n>=0?e=s.fromSortedArrayAux(r,0,n):(n=0|-n,e=s.fromSortedArrayRevAux(r,n-1|0,n));for(var o=n;o<t;++o){var i=r[o];e=p(e,i[0],i[1])}return e}}},9167:(r,t,e)=>{var n=e(1386),o=e(2971);function i(r){if(void 0===r)return r;var t={key:r.key,next:void 0};return function(r,t){for(;;){var e=t,n=r;if(void 0===n)return;var o={key:n.key,next:void 0};e.next=o,t=o,r=n.next}}(r.next,t),t}function a(r){for(var t=r.length,e=new Array(t),n=0;n<t;++n)e[n]=i(r[n]);return e}function s(r,t){for(;;){var e=r;if(void 0===t)return e;t=t.next,r=e+1|0}}function u(r,t){for(;;){var e=t;if(void 0===e)return;r(e.key),t=e.next}}function c(r,t){for(var e=r.buckets,n=0,o=e.length;n<o;++n)u(t,e[n])}function f(r,t,e){for(;;){var n=e,o=r;t[o]=n.key;var i=n.next;if(void 0===i)return o+1|0;e=i,r=o+1|0}}function d(r,t,e){for(;;){var n=t;if(void 0===n)return e;e=r(e,n.key),t=n.next}}function v(r,t,e){for(var n=r.buckets,o=t,i=0,a=n.length;i<a;++i)o=d(e,n[i],o);return o}function l(r){var t=function(r){return o.reduceU(r.buckets,0,(function(r,t){var e=s(0,t);return r>e?r:e}))}(r),e=o.makeByU(t+1|0,(function(r){return 0}));return o.forEachU(r.buckets,(function(r){var t=s(0,r);e[t]=e[t]+1|0})),e}t.C=void 0,t.copy=function(r){return{size:r.size,buckets:a(r.buckets),hash:r.hash,eq:r.eq}},t.forEachU=c,t.forEach=function(r,t){c(r,n.__1(t))},t.fillArray=f,t.toArray=function(r){for(var t=r.buckets,e=0,n=new Array(r.size),o=0,i=t.length;o<i;++o){var a=t[o];void 0!==a&&(e=f(e,n,a))}return n},t.reduceU=v,t.reduce=function(r,t,e){return v(r,t,n.__2(e))},t.logStats=function(r){var t=l(r);console.log({bindings:r.size,buckets:r.buckets.length,histogram:t})},t.getBucketHistogram=l},9113:(r,t,e)=>{var n=e(3282),o=e(4881);function i(r,t){for(;;){var e=t,n=r;if(!n)return 0;if(!e)return 0;var i=e.hd,a=n.hd,s=a.v,u=i.v;if(s!==u)return s<u?-1:1;t=o.stackAllLeft(i.r,e.tl),r=o.stackAllLeft(a.r,n.tl)}}function a(r,t){var e=o.size(r),n=o.size(t);return e===n?i(o.stackAllLeft(r,0),o.stackAllLeft(t,0)):e<n?-1:1}function s(r,t){if(void 0===r)return o.singleton(t);var e=r.v;if(t===e)return r;var n=r.l,i=r.r;return t<e?r.l=s(n,t):r.r=s(i,t),o.balMutate(r)}t.S=void 0,t.N=void 0,t.A=void 0,t.has=function(r,t){for(;;){var e=r;if(void 0===e)return!1;var n=e.v;if(t===n)return!0;r=t<n?e.l:e.r}},t.compareAux=i,t.cmp=a,t.eq=function(r,t){return 0===a(r,t)},t.subset=function r(t,e){for(;;){var n=e,i=t;if(void 0===i)return!0;if(void 0===n)return!1;var a=i.v,s=i.l,u=i.r,c=n.v,f=n.l,d=n.r;if(a!==c)if(a<c){if(!r(o.create(s,a,void 0),f))return!1;t=u}else{if(!r(o.create(void 0,a,u),d))return!1;t=s}else{if(!r(s,f))return!1;e=d,t=u}}},t.get=function(r,t){for(;;){var e=r;if(void 0===e)return;var n=e.v;if(t===n)return n;r=t<n?e.l:e.r}},t.getUndefined=function(r,t){for(;;){var e=r;if(void 0===e)return;var n=e.v;if(t===n)return n;r=t<n?e.l:e.r}},t.getExn=function(r,t){for(;;){var e=r;if(void 0===e)throw{RE_EXN_ID:"Not_found",Error:new Error};var n=e.v;if(t===n)return n;r=t<n?e.l:e.r}},t.addMutate=s,t.fromArray=function(r){var t=r.length;if(0!==t){var e,i=n.strictlySortedLength(r);i>=0?e=o.fromSortedArrayAux(r,0,i):(i=0|-i,e=o.fromSortedArrayRevAux(r,i-1|0,i));for(var a=i;a<t;++a)e=s(e,r[a]);return e}}},1572:(r,t,e)=>{var n=e(4881),o=e(8466);function i(r,t){for(;;){var e=t,o=r;if(!o)return 0;if(!e)return 0;var i=e.hd,a=o.hd,s=a.v,u=i.v;if(s!==u)return s<u?-1:1;t=n.stackAllLeft(i.r,e.tl),r=n.stackAllLeft(a.r,o.tl)}}function a(r,t){var e=n.size(r),o=n.size(t);return e===o?i(n.stackAllLeft(r,0),n.stackAllLeft(t,0)):e<o?-1:1}function s(r,t){if(void 0===r)return n.singleton(t);var e=r.v;if(t===e)return r;var o=r.l,i=r.r;return t<e?r.l=s(o,t):r.r=s(i,t),n.balMutate(r)}t.S=void 0,t.N=void 0,t.A=void 0,t.has=function(r,t){for(;;){var e=r;if(void 0===e)return!1;var n=e.v;if(t===n)return!0;r=t<n?e.l:e.r}},t.compareAux=i,t.cmp=a,t.eq=function(r,t){return 0===a(r,t)},t.subset=function r(t,e){for(;;){var o=e,i=t;if(void 0===i)return!0;if(void 0===o)return!1;var a=i.v,s=i.l,u=i.r,c=o.v,f=o.l,d=o.r;if(a!==c)if(a<c){if(!r(n.create(s,a,void 0),f))return!1;t=u}else{if(!r(n.create(void 0,a,u),d))return!1;t=s}else{if(!r(s,f))return!1;e=d,t=u}}},t.get=function(r,t){for(;;){var e=r;if(void 0===e)return;var n=e.v;if(t===n)return n;r=t<n?e.l:e.r}},t.getUndefined=function(r,t){for(;;){var e=r;if(void 0===e)return;var n=e.v;if(t===n)return n;r=t<n?e.l:e.r}},t.getExn=function(r,t){for(;;){var e=r;if(void 0===e)throw{RE_EXN_ID:"Not_found",Error:new Error};var n=e.v;if(t===n)return n;r=t<n?e.l:e.r}},t.addMutate=s,t.fromArray=function(r){var t=r.length;if(0!==t){var e,i=o.strictlySortedLength(r);i>=0?e=n.fromSortedArrayAux(r,0,i):(i=0|-i,e=n.fromSortedArrayRevAux(r,i-1|0,i));for(var a=i;a<t;++a)e=s(e,r[a]);return e}}},6253:(r,t)=>{function e(r,t){return r[1]===t[1]&&r[0]===t[0]}function n(r,t){var e=t[0],n=r[0];return n>e||!(n<e)&&r[1]>=t[1]}function o(r,t){return r[0]>t[0]||!(r[0]<t[0])&&r[1]>t[1]}t.int_compare=function(r,t){return r<t?-1:r===t?0:1},t.bool_compare=function(r,t){return r?t?0:1:t?-1:0},t.float_compare=function(r,t){return r===t?0:r<t?-1:r>t||r==r?1:t==t?-1:0},t.bigint_compare=function(r,t){return r<t?-1:r===t?0:1},t.string_compare=function(r,t){return r===t?0:r<t?-1:1},t.bool_min=function(r,t){return r?t:r},t.int_min=function(r,t){return r<t?r:t},t.float_min=function(r,t){return r<t?r:t},t.string_min=function(r,t){return r<t?r:t},t.bool_max=function(r,t){return r||t},t.int_max=function(r,t){return r>t?r:t},t.float_max=function(r,t){return r>t?r:t},t.string_max=function(r,t){return r>t?r:t},t.i64_eq=e,t.i64_neq=function(r,t){return!e(r,t)},t.i64_lt=function(r,t){return!n(r,t)},t.i64_gt=o,t.i64_le=function(r,t){return!o(r,t)},t.i64_ge=n,t.i64_min=function(r,t){return n(r,t)?t:r},t.i64_max=function(r,t){return o(r,t)?r:t}},1748:(r,t)=>{t.dup=function(r){return r.slice(0)},t.sub=function(r,t,e){for(var n=new Array(e),o=0,i=t;o<e;)n[o]=r[i],o=o+1|0,i=i+1|0;return n},t.concat=function(r){var t=function(r,t){for(;;){var e=t,n=r;if(!e)return n;t=e.tl,r=e.hd.length+n|0}}(0,r),e=new Array(t);return function(r,t,e){for(;;){var n=e,o=t;if(!n)return;for(var i=n.hd,a=i.length,s=o,u=0;u<a;)r[s]=i[u],s=s+1|0,u=u+1|0;e=n.tl,t=s}}(e,0,r),e},t.make=function(r,t){for(var e=new Array(r),n=0;n<r;++n)e[n]=t;return e},t.make_float=function(r){for(var t=new Array(r),e=0;e<r;++e)t[e]=0;return t},t.blit=function(r,t,e,n,o){if(n<=t)for(var i=0;i<o;++i)e[i+n|0]=r[i+t|0];else for(var a=o-1|0;a>=0;--a)e[a+n|0]=r[a+t|0]},t.get=function(r,t){if(t<0||t>=r.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};return r[t]},t.set=function(r,t,e){if(t<0||t>=r.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};r[t]=e}},6181:(r,t)=>{var e=new Map;t.create=function(r){var t,n=e.get(r);if(void 0!==n){var o=n+1|0;e.set(r,o),t=o}else e.set(r,1),t=1;return r+"/"+t},t.is_extension=function(r){return null!=r&&"string"==typeof r.RE_EXN_ID},t.exn_slot_name=function(r){return r.RE_EXN_ID}},1863:(r,t)=>{function e(r,t){return r<<t|r>>>(32-t|0)|0}function n(r,t){var n=t;n=e(n=Math.imul(n,-862048943),15);var o=r^(n=Math.imul(n,461845907));return((o=e(o,13))+(o<<2)|0)-430675100|0}t.hash_mix_int=n,t.hash_mix_string=function(r,t){for(var e=t.length,o=(e/4|0)-1|0,i=r,a=0;a<=o;++a){var s=a<<2;i=n(i,t.charCodeAt(s)|t.charCodeAt(s+1|0)<<8|t.charCodeAt(s+2|0)<<16|t.charCodeAt(s+3|0)<<24)}var u=3&e;return 0!==u&&(i=n(i,3===u?t.charCodeAt(e-1|0)<<16|t.charCodeAt(e-2|0)<<8|t.charCodeAt(e-3|0):2===u?t.charCodeAt(e-1|0)<<8|t.charCodeAt(e-2|0):t.charCodeAt(e-1|0))),i^e},t.hash_final_mix=function(r){var t=r^r>>>16;return t=Math.imul(t,-2048144789),t^=t>>>13,(t=Math.imul(t,-1028477387))^t>>>16}},8723:(r,t)=>{t.div=function(r,t){if(0===t)throw{RE_EXN_ID:"Division_by_zero",Error:new Error};return r/t|0},t.mod_=function(r,t){if(0===t)throw{RE_EXN_ID:"Division_by_zero",Error:new Error};return r%t}},4518:(r,t,e)=>{var n=e(7175),o=e(6181),i="JsError";t.$$Error=i,t.internalToOCamlException=function(r){return o.is_extension(r)?r:{RE_EXN_ID:"JsError",_1:r}},t.as_js_exn=function(r){if(r.RE_EXN_ID===i)return n.some(r._1)}},4923:(r,t,e)=>{var n=e(6253),o=function(r,t){for(var e in r)t(e)};function i(r,t){if(r===t)return 0;var e=typeof r,o=typeof t;switch(e){case"bigint":if("bigint"===o)return n.float_compare(r,t);break;case"boolean":if("boolean"===o)return n.bool_compare(r,t);break;case"function":if("function"===o)throw{RE_EXN_ID:"Invalid_argument",_1:"compare: functional value",Error:new Error};break;case"number":if("number"===o)return n.float_compare(r,t);break;case"string":return"string"===o?n.string_compare(r,t):1;case"undefined":return-1}switch(o){case"string":return-1;case"undefined":return 1;default:if("boolean"===e)return 1;if("boolean"===o)return-1;if("function"===e)return 1;if("function"===o)return-1;if("number"===e)return null===t||void 0!==t.BS_PRIVATE_NESTED_SOME_NONE?1:-1;if("number"===o)return null===r||void 0!==r.BS_PRIVATE_NESTED_SOME_NONE?-1:1;if(null===r)return void 0!==t.BS_PRIVATE_NESTED_SOME_NONE?1:-1;if(null===t)return void 0!==r.BS_PRIVATE_NESTED_SOME_NONE?-1:1;if(void 0!==r.BS_PRIVATE_NESTED_SOME_NONE)return void 0!==t.BS_PRIVATE_NESTED_SOME_NONE?a(r,t):-1;var s=r.TAG,u=t.TAG;if(248===s)return n.int_compare(r[1],t[1]);if(251===s)throw{RE_EXN_ID:"Invalid_argument",_1:"equal: abstract value",Error:new Error};if(s!==u)return s<u?-1:1;var c=0|r.length,f=0|t.length;if(c===f){if(!Array.isArray(r))return r instanceof Date&&t instanceof Date?r-t:a(r,t);for(var d=0;;){var v=d;if(v===c)return 0;var l=i(r[v],t[v]);if(0!==l)return l;d=v+1|0}}else if(c<f)for(var m=0;;){var p=m;if(p===c)return-1;var h=i(r[p],t[p]);if(0!==h)return h;m=p+1|0}else for(var E=0;;){var x=E;if(x===f)return 1;var g=i(r[x],t[x]);if(0!==g)return g;E=x+1|0}}}function a(r,t){var e={contents:void 0},a={contents:void 0},s=function(r,t){var e=r[2],n=r[1];if(!Object.prototype.hasOwnProperty.call(n,t)||i(r[0][t],n[t])>0){var o=e.contents;return void 0!==o&&t>=o?void 0:void(e.contents=t)}},u=[r,t,a],c=[t,r,e];o(r,(function(r){return s(u,r)})),o(t,(function(r){return s(c,r)}));var f=e.contents,d=a.contents;return void 0!==f?void 0!==d?n.string_compare(f,d):-1:void 0!==d?1:0}function s(r,t){if(r===t)return!0;var e=typeof r;if("string"===e||"number"===e||"bigint"===e||"boolean"===e||"undefined"===e||null===r)return!1;var n=typeof t;if("function"===e||"function"===n)throw{RE_EXN_ID:"Invalid_argument",_1:"equal: functional value",Error:new Error};if("number"===n||"bigint"===n||"undefined"===n||null===t)return!1;var i=r.TAG,a=t.TAG;if(248===i)return r[1]===t[1];if(251===i)throw{RE_EXN_ID:"Invalid_argument",_1:"equal: abstract value",Error:new Error};if(i!==a)return!1;var u=0|r.length;if(u!==(0|t.length))return!1;if(!Array.isArray(r)){if(r instanceof Date&&t instanceof Date)return!(r>t||r<t);var c={contents:!0};return o(r,(function(r){Object.prototype.hasOwnProperty.call(t,r)||(c.contents=!1)})),c.contents&&o(t,(function(e){Object.prototype.hasOwnProperty.call(r,e)&&s(t[e],r[e])||(c.contents=!1)})),c.contents}for(var f=0;;){var d=f;if(d===u)return!0;if(!s(r[d],t[d]))return!1;f=d+1|0}}t.obj_dup=function(r){if(Array.isArray(r)){for(var t=r.length,e=new Array(t),n=0;n<t;++n)e[n]=r[n];return void 0!==r.TAG&&(e.TAG=r.TAG),e}return Object.assign({},r)},t.update_dummy=function(r,t){if(Array.isArray(t)){for(e=0;e<t.length;++e)r[e]=t[e];void 0!==t.TAG&&(r.TAG=t.TAG)}else for(var e in t)r[e]=t[e]},t.compare=i,t.equal=s,t.equal_null=function(r,t){return null!==t?s(r,t):r===t},t.equal_undefined=function(r,t){return void 0!==t?s(r,t):r===t},t.equal_nullable=function(r,t){return null==t?r===t:s(r,t)},t.notequal=function(r,t){return"number"!=typeof r&&"bigint"!=typeof r||"number"!=typeof t&&"bigint"!=typeof t?!s(r,t):r!==t},t.greaterequal=function(r,t){return"number"!=typeof r&&"bigint"!=typeof r||"number"!=typeof t&&"bigint"!=typeof t?i(r,t)>=0:r>=t},t.greaterthan=function(r,t){return"number"!=typeof r&&"bigint"!=typeof r||"number"!=typeof t&&"bigint"!=typeof t?i(r,t)>0:r>t},t.lessthan=function(r,t){return"number"!=typeof r&&"bigint"!=typeof r||"number"!=typeof t&&"bigint"!=typeof t?i(r,t)<0:r<t},t.lessequal=function(r,t){return"number"!=typeof r&&"bigint"!=typeof r||"number"!=typeof t&&"bigint"!=typeof t?i(r,t)<=0:r<=t},t.min=function(r,t){return i(r,t)<=0?r:t},t.max=function(r,t){return i(r,t)>=0?r:t}},7175:(r,t)=>{function e(r){return void 0===r?{BS_PRIVATE_NESTED_SOME_NONE:0}:null!==r&&void 0!==r.BS_PRIVATE_NESTED_SOME_NONE?{BS_PRIVATE_NESTED_SOME_NONE:r.BS_PRIVATE_NESTED_SOME_NONE+1|0}:r}function n(r){if(null===r||void 0===r.BS_PRIVATE_NESTED_SOME_NONE)return r;var t=r.BS_PRIVATE_NESTED_SOME_NONE;return 0===t?void 0:{BS_PRIVATE_NESTED_SOME_NONE:t-1|0}}t.nullable_to_opt=function(r){return null==r?void 0:e(r)},t.undefined_to_opt=function(r){return void 0===r?void 0:e(r)},t.null_to_opt=function(r){return null===r?void 0:e(r)},t.valFromOption=n,t.some=e,t.isNested=function(r){return void 0!==r.BS_PRIVATE_NESTED_SOME_NONE},t.option_get=function(r){return void 0===r?void 0:n(r)},t.option_unwrap=function(r){return void 0!==r?r.VAL:r}},3533:(r,t)=>{t.spliceApply=function(r,t){var e,n;n=t.length;var o=[];for(e=0;e<n-1;++e)o.push(t[e]);var i=t[n-1];for(e=0;e<i.length;++e)o.push(i[e]);return r.apply(null,o)},t.spliceNewApply=function(r,t){var e,n;n=t.length;var o=[null];for(e=0;e<n-1;++e)o.push(t[e]);var i=t[n-1];for(e=0;e<i.length;++e)o.push(i[e]);return new(Function.prototype.bind.apply(r,o))},t.spliceObjApply=function(r,t,e){var n,o;o=e.length;var i=[];for(n=0;n<o-1;++n)i.push(e[n]);var a=e[o-1];for(n=0;n<a.length;++n)i.push(a[n]);return r[t].apply(r,i)}},1386:(r,t,e)=>{var n=e(1748);function o(r,t){for(;;){var e=t,i=r,a=i.length,s=0===a?1:a,u=s-e.length|0;if(0===u)return i.apply(null,e);if(u>=0)return function(r,t){return function(e){return o(r,t.concat([e]))}}(i,e);t=n.sub(e,s,0|-u),r=i.apply(null,n.sub(e,0,s))}}function i(r,t){var e=r.length;if(1===e)return r(t);switch(e){case 1:return r(t);case 2:return function(e){return r(t,e)};case 3:return function(e,n){return r(t,e,n)};case 4:return function(e,n,o){return r(t,e,n,o)};case 5:return function(e,n,o,i){return r(t,e,n,o,i)};case 6:return function(e,n,o,i,a){return r(t,e,n,o,i,a)};case 7:return function(e,n,o,i,a,s){return r(t,e,n,o,i,a,s)};default:return o(r,[t])}}function a(r,t,e){var n=r.length;if(2===n)return r(t,e);switch(n){case 1:return o(r(t),[e]);case 2:return r(t,e);case 3:return function(n){return r(t,e,n)};case 4:return function(n,o){return r(t,e,n,o)};case 5:return function(n,o,i){return r(t,e,n,o,i)};case 6:return function(n,o,i,a){return r(t,e,n,o,i,a)};case 7:return function(n,o,i,a,s){return r(t,e,n,o,i,a,s)};default:return o(r,[t,e])}}function s(r,t,e,n){var i=r.length;if(3===i)return r(t,e,n);switch(i){case 1:return o(r(t),[e,n]);case 2:return o(r(t,e),[n]);case 3:return r(t,e,n);case 4:return function(o){return r(t,e,n,o)};case 5:return function(o,i){return r(t,e,n,o,i)};case 6:return function(o,i,a){return r(t,e,n,o,i,a)};case 7:return function(o,i,a,s){return r(t,e,n,o,i,a,s)};default:return o(r,[t,e,n])}}function u(r,t,e,n,i){var a=r.length;if(4===a)return r(t,e,n,i);switch(a){case 1:return o(r(t),[e,n,i]);case 2:return o(r(t,e),[n,i]);case 3:return o(r(t,e,n),[i]);case 4:return r(t,e,n,i);case 5:return function(o){return r(t,e,n,i,o)};case 6:return function(o,a){return r(t,e,n,i,o,a)};case 7:return function(o,a,s){return r(t,e,n,i,o,a,s)};default:return o(r,[t,e,n,i])}}function c(r,t,e,n,i,a){var s=r.length;if(5===s)return r(t,e,n,i,a);switch(s){case 1:return o(r(t),[e,n,i,a]);case 2:return o(r(t,e),[n,i,a]);case 3:return o(r(t,e,n),[i,a]);case 4:return o(r(t,e,n,i),[a]);case 5:return r(t,e,n,i,a);case 6:return function(o){return r(t,e,n,i,a,o)};case 7:return function(o,s){return r(t,e,n,i,a,o,s)};default:return o(r,[t,e,n,i,a])}}function f(r,t,e,n,i,a,s){var u=r.length;if(6===u)return r(t,e,n,i,a,s);switch(u){case 1:return o(r(t),[e,n,i,a,s]);case 2:return o(r(t,e),[n,i,a,s]);case 3:return o(r(t,e,n),[i,a,s]);case 4:return o(r(t,e,n,i),[a,s]);case 5:return o(r(t,e,n,i,a),[s]);case 6:return r(t,e,n,i,a,s);case 7:return function(o){return r(t,e,n,i,a,s,o)};default:return o(r,[t,e,n,i,a,s])}}function d(r,t,e,n,i,a,s,u){var c=r.length;if(7===c)return r(t,e,n,i,a,s,u);switch(c){case 1:return o(r(t),[e,n,i,a,s,u]);case 2:return o(r(t,e),[n,i,a,s,u]);case 3:return o(r(t,e,n),[i,a,s,u]);case 4:return o(r(t,e,n,i),[a,s,u]);case 5:return o(r(t,e,n,i,a),[s,u]);case 6:return o(r(t,e,n,i,a,s),[u]);case 7:return r(t,e,n,i,a,s,u);default:return o(r,[t,e,n,i,a,s,u])}}function v(r,t,e,n,i,a,s,u,c){var f=r.length;if(8===f)return r(t,e,n,i,a,s,u,c);switch(f){case 1:return o(r(t),[e,n,i,a,s,u,c]);case 2:return o(r(t,e),[n,i,a,s,u,c]);case 3:return o(r(t,e,n),[i,a,s,u,c]);case 4:return o(r(t,e,n,i),[a,s,u,c]);case 5:return o(r(t,e,n,i,a),[s,u,c]);case 6:return o(r(t,e,n,i,a,s),[u,c]);case 7:return o(r(t,e,n,i,a,s,u),[c]);default:return o(r,[t,e,n,i,a,s,u,c])}}t.app=o,t._1=i,t.__1=function(r){return 1===r.length?r:function(t){return i(r,t)}},t._2=a,t.__2=function(r){return 2===r.length?r:function(t,e){return a(r,t,e)}},t._3=s,t.__3=function(r){return 3===r.length?r:function(t,e,n){return s(r,t,e,n)}},t._4=u,t.__4=function(r){return 4===r.length?r:function(t,e,n,o){return u(r,t,e,n,o)}},t._5=c,t.__5=function(r){return 5===r.length?r:function(t,e,n,o,i){return c(r,t,e,n,o,i)}},t._6=f,t.__6=function(r){return 6===r.length?r:function(t,e,n,o,i,a){return f(r,t,e,n,o,i,a)}},t._7=d,t.__7=function(r){return 7===r.length?r:function(t,e,n,o,i,a,s){return d(r,t,e,n,o,i,a,s)}},t._8=v,t.__8=function(r){return 8===r.length?r:function(t,e,n,o,i,a,s,u){return v(r,t,e,n,o,i,a,s,u)}}},2900:(r,t)=>{t.$$Error="JsError",t.raiseError=function(r){throw new Error(r)},t.raiseEvalError=function(r){throw new EvalError(r)},t.raiseRangeError=function(r){throw new RangeError(r)},t.raiseReferenceError=function(r){throw new ReferenceError(r)},t.raiseSyntaxError=function(r){throw new SyntaxError(r)},t.raiseTypeError=function(r){throw new TypeError(r)},t.raiseUriError=function(r){throw new URIError(r)}},1589:(r,t)=>{t.equal=function(r,t){return r===t},t.max=2147483647,t.min=-2147483648},4763:(r,t,e)=>{var n=e(1589);function o(r){return r>n.max?n.max:r<n.min?n.min:Math.ceil(r)}function i(r){return r>n.max?n.max:r<n.min?n.min:Math.floor(r)}var a=o,s=i;t.unsafe_ceil=function(r){return Math.ceil(r)},t.ceil_int=o,t.ceil=a,t.unsafe_floor=function(r){return Math.floor(r)},t.floor_int=i,t.floor=s,t.random_int=function(r,t){return i(Math.random()*(t-r|0))+r|0}},3053:(r,t,e)=>{var n=e(6517),o=e(2423),i=e(1874);function a(r,t,e,i){for(var a,s=0,u={contents:0},c=r.hyps.length-1|0;s<=c&&n.isNone(a);){var f=r.hyps[s];"E"===f.typ&&(n.getWithDefault(n.map(e,function(r){return function(t){return t===r.label}}(f)),!1)||n.getWithDefault(n.map(i,(function(r){return r===u.contents})),!1)?a=o.pnGetExpr(t[s]):u.contents=u.contents+1|0),s=s+1|0}return a}function s(r,t,e,n,o){if(n===e.frm.numOfHypsE)return!0;if(-1===n){var u={contents:!1},c=e.frm;return i.iterateSubstitutions(c.frame.asrt,r,c.frmConstParts[c.numOfHypsE],c.constParts[c.numOfHypsE],c.varGroups[c.numOfHypsE],c.subs,o,(function(i){return s(r,t,e,n+1|0,o)?(u.contents=!0,"Stop"):"Continue"})),u.contents}var f=function(r,t,e){if("object"==typeof e&&"Assertion"===e.TAG){var n=e.frame,o=e.args,i=r.hypMatchers[t];return"Label"===i.TAG?a(n,o,i._0,void 0):a(n,o,void 0,i._0)}}(e,n,t);if(void 0===f)return!1;var d={contents:!1},v=e.frm;return i.iterateSubstitutions(v.hypsE[n].expr,f,v.frmConstParts[n],v.constParts[n],v.varGroups[n],v.subs,o,(function(i){return s(r,t,e,n+1|0,o)?(d.contents=!0,"Stop"):"Continue"})),d.contents}t.exprSrcMatches=function(r,t,e,n){return e.matchAsrt?s(r,t,e,-1,n):s(r,t,e,0,n)}},6705:(r,t,e)=>{var n=e(5291),o=e(6638),i=e(2971),a=e(6517),s=e(9775),u=e(1874),c=e(5047),f=e(7653);function d(r,t){return!(!a.isNone(r.err)||!a.isNone(t.err)||r.frame.label!==t.frame.label)&&u.subsEq(r.subs,t.subs)}function v(r){return c.hash2(c.hashStr(r.frame.label),u.subsHash(r.subs))}var l=o.MakeHashableU({hash:v,eq:d});function m(r,t,e,n,o,i,a,s,u){if(e===t.length)return i.contents=i.contents+1|0,i.contents>a?s():t.some((function(r){return-1===r}))?n?"Continue":u(t):o?"Continue":u(t);for(var c="Continue",f=0,d=r[e].length-1|0;"Continue"===c&&f<=d&&i.contents<=a;)t[e]=r[e][f],-1===t[e]&&n||(c=m(r,t,e+1|0,n,o,i,a,s,u)),f=f+1|0;return c}function p(r,t,e,n,o,a,s){for(var u=i.makeBy(t,(function(r){return[]})),c=t-1|0,f=r-1|0,d=0;d<=c;++d)for(var v=-1;v<=f;++v)e(v,d)&&u[d].push(v);var l=u.findIndex((function(r){return 0===r.length}));if(-1!==l)return o>=2?s({TAG:"NoUnifForArg",args:[],errArgIdx:l}):"Continue";var p=i.make(t,0),h={contents:!1},E=m(u,p,0,!0,!1,{contents:0},n,(function(){return h.contents=!0,s({TAG:"TooManyCombinations",frmLabels:void 0})}),a);return"Continue"===E?m(u,p,0,!1,!0,{contents:0},n,(function(){return h.contents?"Continue":s({TAG:"TooManyCombinations",frmLabels:void 0})}),a):E}function h(r,t,e,n,o){var i=r.newVars.length,a=t.subs.isDefined.slice(),s={contents:(r.maxVar+1|0)+r.newVars.length|0},c=[],f=[],d=[];u.applySubs(n<t.hypsE.length?t.hypsE[n].expr:t.frame.asrt,t.subs,(function(r){var e=c.indexOf(r);if(-1!==e)return f[e];var n=s.contents;return s.contents=s.contents+1|0,c.push(r),f.push(n),d.push(t.frame.varTypes[r]),n}));for(var v=c.length-1|0,l=0;l<=v;++l){var m=c[l],p=f[l],h=d[l];t.subs.exprs[m]=[p],t.subs.begins[m]=0,t.subs.ends[m]=0,t.subs.isDefined[m]=!0,r.newVars.push(p),r.newVarTypes.push(h)}var E=e||0===r.newVars.length?o():"Continue";return a.forEach((function(r,e){t.subs.isDefined[e]=r})),r.newVars.splice(i),r.newVarTypes.splice(i),E}function E(r,t){for(var e=r+1|0;e<t.length&&t[e]>=0;)e=e+1|0;if(e<t.length&&t[e]<0)return e}function x(r,t){if(r>=t.length)throw{RE_EXN_ID:n.MmException,_1:{msg:"getNextHypIdxToMatch: hypIdx >= comb->Array.length"},Error:new Error};if(r<0||t[r]>=0){var e=function(r,t){for(var e=r+1|0;e<t.length&&t[e]<0;)e=e+1|0;if(e<t.length&&t[e]>=0)return e}(r,t);if(void 0!==e)return e;var o=E(-1,t);return void 0!==o?o:t.length}var i=E(r,t);return void 0!==i?i:t.length}function g(r,t,e,n,o,i,a,s,c,f){var d=function(){return i.map((function(r){return r>=0?n[r]:[]}))};if(a===i.length){var v={contents:!1},l=h(r,t,o,a,(function(){return v.contents=!0,c()}));return s>=2&&!v.contents?f({TAG:"NewVarsAreDisabled",args:d(),errArgIdx:a}):l}if(i[a]>=0){var m={contents:!1},p=u.iterateSubstitutions(t.hypsE[a].expr,n[i[a]],t.frmConstParts[a],t.constParts[a],t.varGroups[a],t.subs,e,(function(u){return m.contents=!0,g(r,t,e,n,o,i,x(a,i),s,c,f)}));return s>=2&&!m.contents?f({TAG:"NoUnifForArg",args:d(),errArgIdx:a}):p}var E={contents:!1},y=h(r,t,o,a,(function(){return E.contents=!0,g(r,t,e,n,o,i,x(a,i),s,c,f)}));return s>=2&&!E.contents?f({TAG:"NewVarsAreDisabled",args:d(),errArgIdx:a}):y}t.applyAssertionResultEq=d,t.applyAssertionResultHash=v,t.ApplyAssertionResultHash=l,t.applyAssertions=function(r,t,e,n,o,i,c,d,v,m,h,E,y,_,T,A){var b=void 0!==c&&c,k=void 0===d||d,S=void 0===v||v,C=void 0!==E&&E,w=void 0!==y?y:1e4,I=void 0!==T?T:0,M=function(r){return void 0!==m?_({newVars:[],newVarTypes:[],frame:r.frame,subs:u.subsClone(r.subs),err:{TAG:"NoUnifForAsrt",asrtExpr:r.frame.asrt,expr:m}}):"Continue"},G=i.length,j=function(r,t,e){if(void 0!==t)return t.length;if(void 0===e)return u.frmsGetAll(r).length;var n=u.frmsGetByType(r,e[0]);return void 0!==n?n.length:0}(t,e,m),D=f.progressTrackerMake(.01,void 0,A,void 0),O={contents:0},N={contents:"Continue"},P=s.make(16,l),U=function(t){if("Continue"===N.contents)if(a.getWithDefault(a.map(m,(function(r){return r[0]!==t.frame.asrt[0]})),!1))I>=2&&(N.contents=M(t));else{var e={contents:!1};N.contents=function(r,t,e,n){return void 0!==t?u.iterateSubstitutions(r.frame.asrt,t,r.frmConstParts[r.numOfHypsE],r.constParts[r.numOfHypsE],r.varGroups[r.numOfHypsE],r.subs,e,n):n(r.subs)}(t,m,h,(function(n){e.contents=!0;var a=t.numOfHypsE,c=[],f=[],d={maxVar:r,newVars:c,newVarTypes:f};return p(G,a,(function(r,e){return-1===r?!b&&k:(!b||r===e)&&function(r,t,e,n,o){if(n[0]!==e[0])return!1;var i={contents:!1};return u.iterateSubstitutions(n,e,r.frmConstParts[t],r.constParts[t],r.varGroups[t],r.subs,o,(function(r){return i.contents=!0,"Stop"})),i.contents}(t,e,i[r],t.hypsE[e].expr,h)}),w,I,(function(e){return g(d,t,h,i,S,e,x(-1,e),I,(function(){var e=function(r,t,e,n,o,i){return u.verifyDisjoints(r,t,(function(r,t){return!(r<=e&&t<=e&&!n)||o(r,t)}),i)}(t.frame.disj,t.subs,r,C,o,I);if(void 0!==e){if(0===I)return"Continue";var n=c.slice(),i=f.slice(),a=t.frame,d=u.subsClone(t.subs);return _({newVars:n,newVarTypes:i,frame:a,subs:d,err:e})}var v={newVars:c.slice(),newVarTypes:f.slice(),frame:t.frame,subs:u.subsClone(t.subs),err:void 0};return s.has(P,v)?"Continue":(s.add(P,v),_(v))}),(function(r){return _({newVars:[],newVarTypes:[],frame:t.frame,subs:u.subsClone(t.subs),err:r})}))}),(function(r){return _({newVars:[],newVarTypes:[],frame:t.frame,subs:u.subsClone(t.subs),err:r})}))})),I>=2&&!e.contents&&(N.contents=M(t))}O.contents=O.contents+1,f.progressTrackerSetCurrPct(D,O.contents/j)};return void 0!==e?void e.forEach((function(r){a.forEach(u.frmsGetByLabel(t,r),(function(r){if(n(r.frame))return U(r)}))})):u.frmsForEach(t,a.map(m,(function(r){return r[0]})),(function(r){if(n(r.frame))return U(r)}))},t.iterateCombinations=p,t.getNextHypIdxToMatch=x},1307:(r,t,e)=>{var n=e(2900),o=e(6638),i=e(3333),a=e(6517),s=e(2815),u=e(2448),c=e(2423),f=e(3591),d=e(3533),v=e(5047);function l(r,t,e,o,i){var s=c.pnGetExpr(r),f=c.pnGetProof(r);if(void 0===f)return{TAG:"Error",_0:"Cannot build a syntax tree from a node without proof."};if("object"!=typeof f)return n.raiseError("buildSyntaxTreeInner.VarType");switch(f.TAG){case"Hypothesis":for(var d,v=f.label,m=s.length-1|0,p=new Array(m),h=i(),E=1;E<=m;++E){var x=t(s[E]);p[E-1|0]={TAG:"Symbol",id:i(),symInt:x,sym:e(x),color:void 0,isVar:x>=0}}if(1===p.length){var g=p[0];d="Subtree"!==g.TAG&&g.isVar?u.getOr(o(v,g.symInt),v):v}else d=v;return{TAG:"Ok",_0:{id:h,typ:s[0],label:d,children:p,height:-1}};case"Assertion":var y=f.frame,_=f.args,T=i(),A=y.asrt[0],b=y.label,k=new Array(y.asrt.length-1|0),S={id:T,typ:A,label:b,children:k,height:-1},C={contents:void 0};y.asrt.forEach((function(r,n){if(n>0&&a.isNone(C.contents))if(r<0){var s=t(r);k[n-1|0]={TAG:"Symbol",id:i(),symInt:s,sym:e(s),color:void 0,isVar:!1}}else{var u=l(_[y.varHyps[r]],t,e,o,i);"Ok"===u.TAG?k[n-1|0]={TAG:"Subtree",_0:u._0}:C.contents={TAG:"Error",_0:u._0}}}));var w=C.contents;return void 0!==w?w:{TAG:"Ok",_0:S};case"AssertionWithErr":return{TAG:"Error",_0:"Cannot build a syntax tree from a node with an AssertionWithErr proof."}}}function m(r,t){switch(r.TAG){case"Const":switch(t.TAG){case"Const":return r._0===t._0;case"CtxVar":case"AsrtVar":return!1}case"CtxVar":switch(t.TAG){case"CtxVar":return r._0===t._0;case"Const":case"AsrtVar":return!1}case"AsrtVar":switch(t.TAG){case"Const":case"CtxVar":return!1;case"AsrtVar":return r._0===t._0}}}function p(r,t){return r.length===t.length&&r.every((function(r,e){return m(r,t[e])}))}var h=o.MakeHashableU({hash:function(r){return r._0},eq:m});function E(r){s.clear(r.subs),v.clearArray(r.newDisj)}function x(r,t){s.forEach(t.subs,(function(t,e){for(var n=0;n<r.length;)m(r[n],t)?(d.spliceObjApply(r,"splice",[n,1,e]),n=n+e.length|0):n=n+1|0}))}function g(r,t,e){if(x(e,r),e.some((function(r){return m(r,t)})))return!1;var n=s.get(r.subs,t);return void 0!==n?p(e,n):(s.set(r.subs,t,e),s.forEach(r.subs,(function(t,e){x(e,r)})),!0)}function y(r,t){return v.arrFlatMap(r.children,(function(r){return"Subtree"===r.TAG?y(r._0,t):[t(r.symInt)]}))}function _(r,t,e,n,o){var a={contents:!0};return function(r,t,e,n){r?i.disjImmForEach(e,n):i.disjForEach(t,n)}(t,e,n,(function(e,n){if(a.contents){var i=s.get(r.subs,t?{TAG:"AsrtVar",_0:e}:{TAG:"CtxVar",_0:e});void 0===i||i.forEach((function(e){if(a.contents&&e._0>=0){var i=s.get(r.subs,t?{TAG:"AsrtVar",_0:n}:{TAG:"CtxVar",_0:n});void 0===i||i.forEach((function(t){if(a.contents&&t._0>=0)return a.contents=!m(e,t),a.contents&&!o(e,t)?void r.newDisj.push([e,t]):void 0}))}}))}})),a.contents}function T(r,t,e){var n=[t];x(n,r);var o=[e];return x(o,r),p(n,o)}function A(r,t,e,n,o,a,s,u,c,d){if(e.typ!==a.typ)d.contents=!1;else{var v=f.isVar(e,n);if(void 0!==v){var l=v[0],m=f.isVar(a,s);if(void 0!==m){var p=m[0];d.contents=T(c,o(l),u(p))||g(c,o(l),[u(p)])}else d.contents=g(c,o(l),y(a,u))}else{var h=f.isVar(a,s);if(void 0!==h)d.contents=g(c,u(h[0]),y(e,o));else if(e.children.length!==a.children.length)d.contents=!1;else for(var E=e.children.length-1|0,x=0;d.contents&&x<=E;){var b=e.children[x];if("Subtree"===b.TAG){var k=b._0,S=a.children[x];"Subtree"===S.TAG?A(r,t,k,n,o,S._0,s,u,c,d):d.contents=S.isVar&&s(S.sym)&&g(c,u(S.symInt),y(k,o))}else{var C=b.isVar,w=b.sym,I=b.symInt,M=a.children[x];if("Subtree"===M.TAG)d.contents=C&&n(w)&&g(c,o(I),y(M._0,u));else{var G=M.symInt;d.contents=T(c,o(I),u(G))||C&&n(w)&&g(c,o(I),[u(G)])||M.isVar&&s(M.sym)&&g(c,u(G),[o(I)])}}x=x+1|0}}}d.contents=d.contents&&function(r,t,e){var n=function(r,n){switch(r.TAG){case"Const":return!1;case"CtxVar":switch(n.TAG){case"CtxVar":return i.disjContains(t,r._0,n._0);case"Const":case"AsrtVar":return!1}case"AsrtVar":switch(n.TAG){case"Const":case"CtxVar":return!1;case"AsrtVar":return i.disjImmContains(e,r._0,n._0)}}};return!!_(r,!0,t,e,n)&&_(r,!1,t,e,n)}(c,t,r)}function b(r){return r<0?{TAG:"Const",_0:r}:{TAG:"AsrtVar",_0:r}}function k(r){return r<0?{TAG:"Const",_0:r}:{TAG:"CtxVar",_0:r}}t.buildSyntaxTree=function(r,t,e,n){var o={contents:-1};return l(r,t,e,n,(function(){return o.contents=o.contents+1|0,o.contents}))},t.symEq=m,t.arrSymEq=p,t.symToInt=function(r){return r._0},t.unifSubsMake=function(){return{subs:s.make(16,h),newDisj:[]}},t.unifSubsGet=function(r,t){return s.get(r.subs,t)},t.unifSubsSize=function(r){return s.size(r.subs)},t.unifSubsReset=E,t.unify=function(r,t,e,n,o,i){var a={contents:!0};return E(i),A(r,t,e,(function(r){return!0}),b,n,o,k,i,a),!!a.contents||(a.contents=!0,E(i),A(r,t,n,o,k,e,(function(r){return!0}),b,i,a),a.contents)}},3333:(r,t,e)=>{var n=e(6253),o=e(5291),i=e(6638),a=e(4923),s=e(55),u=e(2971),c=e(1094),f=e(6517),d=e(303),v=e(7175),l=e(2761),m=e(2448),p=e(5082),h=e(7356),E=e(7659),x=e(3533),g=e(2275),y=e(8615),_=e(5047),T=e(7653),A=e(9217);function b(r,t){var e=r.length;if(e!==t.length)return!1;for(var n=!0,o=0;n&&o<e;)n=r[o]===t[o],o=o+1|0;return n}function k(r,t){var e=r.length,o=t.length,i=n.int_compare(e,o);if(0!==i)return i;for(var a=0,s=0;s<e&&0===a;)a=n.int_compare(r[s],t[s]),s=s+1|0;return a}var S=_.toIntCmp(k),C=i.MakeComparableU({cmp:S}),w=i.MakeHashableU({hash:_.hashArrInt,eq:b});function I(r,t,e){if(t!==e){var n=t<=e?t:e,o=t<=e?e:t,i=h.get(r,n);return void 0!==i?E.add(v.valFromOption(i),o):h.set(r,n,E.fromArray([o]))}}function M(r,t){var e=r.parent;if(void 0===e)return t(r);var n=M(e,t);return void 0!==n?v.some(v.valFromOption(n)):t(r)}function G(r,t){for(;;){var e=r,n=t(e);if(void 0!==n)return v.some(v.valFromOption(n));var o=e.parent;if(void 0===o)return;r=o}}function j(r,t){return G(r.contents,(function(r){var e=g.get(r.frames,t);if(void 0!==e)return e.isAxiom?"A":"P";var n=g.get(r.labelToHyp,t);if(void 0!==n)return"F"===n.typ?"F":"E";var o=g.get(r.symToInt,t);return void 0!==o?o<0?"C":"V":void 0}))}function D(r,t){return f.getWithDefault(f.map(g.get(f.getExn(r.contents.root).symToInt,t),(function(r){return r<0})),!1)}function O(r,t){return f.getWithDefault(f.map(G(r.contents,(function(r){return g.get(r.symToInt,t)})),(function(r){return 0<=r})),!1)}function N(r,t){return f.isSome(G(r.contents,(function(r){return g.get(r.labelToHyp,t)})))}function P(r,t,e){var n=t<=e?t:e,o=t<=e?e:t,i=h.get(r,n);return void 0!==i&&E.has(v.valFromOption(i),o)}function U(r,t){h.forEach(r,(function(r,e){E.forEach(e,(function(e){t(r,e)}))}))}function F(r){var t=E.make(100);return h.forEach(r,(function(r,e){E.add(t,r),E.forEach(e,(function(r){E.add(t,r)}))})),t}function V(r,t,e,i,a){var s,u,c,d=void 0!==t&&t,l=[];s=r,u=function(r,t){l.push([r,t])},(c=h.keysToArray(s)).sort(n.int_compare),c.forEach((function(r){var t=E.toArray(m.getExn(h.get(s,r),void 0));t.sort(n.int_compare),t.forEach((function(t){u(r,t)}))}));for(var p,x=function(t,e){var n={contents:!0};return t.forEach((function(t){n.contents&&e.forEach((function(e){n.contents&&t!==e&&(n.contents=P(r,t,e))}))})),n.contents},g=function(r,t){l.splice(l.findIndex((function(r){return b(r,t)})),1),t.forEach((function(t){r.includes(t)||r.push(t)}))},y=function(){for(var r,t=0,e=l.length-2|0;t<=e;++t)if(f.isNone(r))for(var n=t+1|0,o=l.length;n<o;++n)if(f.isNone(r)){var i=l[t],a=l[n];x(i,a)&&(r=[i,a])}return r},T=!0;T;){var A=y();void 0!==A?g(A[0],A[1]):T=!1}if(d)if(void 0!==i)if(void 0!==a)if(void 0!==e){var S=F(r),C=h.make(E.size(S)),w=h.make(E.size(S));E.forEach(S,(function(r){var t=i(r);void 0!==t&&h.set(C,r,t);var n=e(r);if(void 0!==n)return h.set(w,r,n)}));var I=o.createVarTypeComparator(C,v.valFromOption(a)),M=o.createVarNameComparator(w);p=_.comparatorAndThen(I,M)}else p=n.int_compare;else p=n.int_compare;else p=n.int_compare;else p=n.int_compare;return l.forEach((function(r){_.sortInPlaceWith(r,p)})),_.sortInPlaceWith(l,k)}function R(r,t){var e=t.expr,n=e.length,o=n>0?e[0]:0,i=n>1?e[1]:0,a=h.get(r.exprToHyp,n);if(void 0===a)return h.set(r.exprToHyp,n,h.fromArray([[o,h.fromArray([[i,[t]]])]]));var s=v.valFromOption(a),u=h.get(s,o);if(void 0===u)return h.set(s,o,h.fromArray([[i,[t]]]));var c=v.valFromOption(u),f=h.get(c,i);return void 0===f?h.set(c,i,[t]):void 0!==f.find((function(r){return b(r.expr,t.expr)}))?void 0:void f.push(t)}function B(r,t){return G(r.contents,(function(r){return g.get(r.frames,t)}))}function W(r,t){return M(r.contents,(function(r){return _.arrForEach(r.hyps,t)}))}function L(r,t){return G(r.contents,(function(r){return g.get(r.symToInt,t)}))}function H(r,t){var e=L(r,t);if(void 0!==e)return e;throw{RE_EXN_ID:o.MmException,_1:{msg:"The symbol '"+t+"' is not declared."},Error:new Error}}function q(r,t){return t.map((function(t){return H(r,t)}))}function X(r,t){return t<0?u.get(f.getExn(r.contents.root).consts,0|-t):G(r.contents,(function(r){return t<r.varsBaseIdx?void 0:r.vars[t-r.varsBaseIdx|0]}))}function z(r,t){var e=X(r,t);if(void 0!==e)return e;throw{RE_EXN_ID:o.MmException,_1:{msg:"Cannot convert "+String(t)+" to a symbol."},Error:new Error}}function $(r,t){return t.map((function(t){return z(r,t)}))}function K(r,t){return t.map((function(t){return z(r,t)})).join(" ")}function J(r,t,e){return e<0?X(r,e):u.get(t.frameVarToSymb,e)}function Q(r,t,e){var n=J(r,t,e);if(void 0!==n)return n;throw{RE_EXN_ID:o.MmException,_1:{msg:"Could not convert from int "+String(e)+" to a symbol."},Error:new Error}}function Z(r,t,e){return e.map((function(e){return Q(r,t,e)}))}function Y(r,t){return G(r.contents,(function(r){return h.get(r.varTypes,t)}))}function rr(r,t){var e=Y(r,t);if(void 0!==e)return e;var n=X(r,t),i=void 0!==n?"'"+n+"'":String(t);throw{RE_EXN_ID:o.MmException,_1:{msg:"Cannot determine type of the variable "+i},Error:new Error}}function tr(r,t,e,n){var o=void 0!==e&&e,i=E.make(16);return o||(void 0!==n?n.forEach((function(r){r.forEach((function(r){if(r>=0)return E.add(i,r)}))})):W(r,(function(r){"E"===r.typ&&r.expr.forEach((function(r){if(r>=0)return E.add(i,r)}))}))),t.forEach((function(r){if(r>=0)return E.add(i,r)})),i}function er(r,t,e,n){var o=void 0!==e&&e,i=[];return W(r,(function(r){("E"===r.typ&&!o&&f.isNone(n)||"F"===r.typ&&E.has(t,r.expr[1]))&&i.push(r)})),void 0!==n&&n.forEach((function(r,t){i.push({typ:"E",label:String(t),expr:r})})),i}function nr(r){return f.getExn(r.contents.root).consts.slice(1)}function or(r){var t=[];return G(r.contents,(function(r){x.spliceObjApply(t,"push",[g.valuesToArray(r.frames)])})),t}function ir(r,t){return M(r.contents,(function(r){var e={contents:void 0};return g.forEach(r.frames,(function(r,n){f.isNone(e.contents)&&(e.contents=t(n))})),e.contents}))}function ar(r){var t=r.parent;return void 0!==t?1+ar(t)|0:0}function sr(r,t){var e=void 0!==t&&t,n=void 0!==r?(r.contents.lastComment=void 0,r.contents):void 0,o={contents:{root:void 0,parent:n,consts:void 0!==n?[]:[""],varsBaseIdx:void 0!==n?n.varsBaseIdx+n.vars.length|0:0,vars:[],symToInt:g.make(0),disj:h.make(16),hyps:[],labelToHyp:g.make(4),exprToHyp:h.make(4),varTypes:h.make(4),lastComment:void 0,frames:g.make(1),totalNumOfFrames:void 0!==n?n.totalNumOfFrames:0,deprOrTranDeprFrms:y.make(1),debug:f.getWithDefault(f.map(n,(function(r){return r.debug})),e)}};return o.contents.root=void 0!==n?n.root:o.contents,o}function ur(r){r.contents=sr(r,void 0).contents}function cr(r){var t,e=r.contents,n=e.parent;if(void 0===n)throw{RE_EXN_ID:o.MmException,_1:{msg:"Cannot close the root context."},Error:new Error};n.lastComment=void 0,n.totalNumOfFrames=n.totalNumOfFrames+g.size(e.frames)|0,g.forEach(e.frames,(function(r,t){g.set(n.frames,r,t)}));var i=n.deprOrTranDeprFrms;y.forEach(e.deprOrTranDeprFrms,(function(r){return y.add(i,r)})),t=n,r.contents=t}function fr(r,t,e){if(""===t.trim())throw{RE_EXN_ID:o.MmException,_1:{msg:"Cannot use an empty string as a name of "+e+"."},Error:new Error};var n=j(r,t);if(void 0!==n)switch(n){case"C":throw{RE_EXN_ID:o.MmException,_1:{msg:"An attempt to re-declare the constant '"+t+"' as "+e+"."},Error:new Error};case"V":throw{RE_EXN_ID:o.MmException,_1:{msg:"An attempt to re-declare the variable '"+t+"' as "+e+"."},Error:new Error};case"F":throw{RE_EXN_ID:o.MmException,_1:{msg:"An attempt to re-declare a floating label '"+t+"' as "+e+"."},Error:new Error};case"E":throw{RE_EXN_ID:o.MmException,_1:{msg:"An attempt to re-declare an essential label '"+t+"' as "+e+"."},Error:new Error};case"A":throw{RE_EXN_ID:o.MmException,_1:{msg:"An attempt to re-declare an axiom label '"+t+"' as "+e+"."},Error:new Error};case"P":throw{RE_EXN_ID:o.MmException,_1:{msg:"An attempt to re-declare a provable label '"+t+"' as "+e+"."},Error:new Error}}}function dr(r,t){if(t<0)return t;var e=h.get(r,t);if(void 0!==e)return e;throw{RE_EXN_ID:o.MmException,_1:{msg:"Cannot determine frame variable for the context variable "+String(t)+"."},Error:new Error}}function vr(r,t){return t.map((function(t){return dr(r,t)}))}function lr(r,t){var e=h.make(16);return U(t,(function(t,n){I(e,dr(r,t),dr(r,n))})),c.fromArray(h.toArray(e).map((function(r){return[r[0],d.fromArray(E.toArray(r[1]))]})))}function mr(r,t){return f.getWithDefault(f.map(t,(function(t){return t.test(r)})),!1)}function pr(r,t,e,n){return!!f.getWithDefault(f.map(r,(function(r){return mr(r,e)})),!1)||mr(t,n)}function hr(r,t){if(void 0===t)return!1;var e=t.labels;return f.getWithDefault(M(r.contents,(function(r){if(e.some((function(t){return y.has(r.deprOrTranDeprFrms,t)})))return!0})),!1)}function Er(r,t){var e=u.make(r,-1);if(t.forEach((function(t,n){if("F"===t.typ){var i=t.expr[1];if(i>=r)throw{RE_EXN_ID:o.MmException,_1:{msg:"Internal error: hyp.expr[1] >= numOfVars"},Error:new Error};e[i]=n}})),e.some((function(r){return r<0})))throw{RE_EXN_ID:o.MmException,_1:{msg:"Internal error: varHyps->Array.some(idx => idx < 0)"},Error:new Error};return e}var xr=new RegExp("\\s+","g");function gr(r){return r.trim().toLowerCase().replaceAll(xr," ")}function yr(r,t,e,n,i,a,s,u,c,d,v,l,p,x,g){var y=void 0!==u&&u,_=void 0!==c&&c,T=void 0!==d&&d;if(fr(r,n,void 0!==s?s:"a frame"),i.length<1)throw{RE_EXN_ID:o.MmException,_1:{msg:"Length of an assertion expression must be at least 1."},Error:new Error};if(!_&&!D(r,i[0]))throw{RE_EXN_ID:o.MmException,_1:{msg:"The first symbol in an assertion expression must be a constant."},Error:new Error};var A=i.find((function(t){return f.isNone(L(r,t))}));if(void 0!==A)throw{RE_EXN_ID:o.MmException,_1:{msg:"The symbol '"+A+"' must be either a constant or a variable."},Error:new Error};var b=i.map((function(t){return H(r,t)})),k=tr(r,b,y,v),S=E.toArray(k),C=T?h.make(16):function(r,t){var e=h.make(16);return G(r.contents,(function(r){h.forEach(r.disj,(function(r,n){if(E.has(t,r))return E.forEach(n,(function(n){if(E.has(t,n))return I(e,r,n)}))}))})),e}(r,k),w=er(r,k,y,v),M=h.fromArray(S.map((function(r,t){return[r,t]}))),j=r.contents.lastComment,O=m.map(j,gr),N=w.map((function(r){return{typ:r.typ,label:r.label,expr:vr(M,r.expr)}})),P=S.length;return{ord:t,isAxiom:e,disj:lr(M,C),hyps:N,asrt:vr(M,b),label:n,frameVarToSymb:S.map((function(t){return z(r,t)})),varTypes:S.map((function(t){return rr(r,t)})),varHyps:Er(P,N),numOfVars:P,numOfArgs:w.length,descr:j,descrNorm:O,proof:a,isDisc:pr(j,n,l,p),isDepr:pr(j,n,x,g),isTranDepr:hr(r,a),dbg:r.contents.debug?{disj:V(C,void 0,void 0,void 0,void 0).map((function(t){return K(r,t)})),hyps:w.map((function(t){return K(r,t.expr)})),asrt:K(r,b)}:void 0,usageCnt:-1}}function _r(r,t,e,n,o,i,a,s,u){var c=r.contents,d=yr(r,c.totalNumOfFrames,t,e,n,o,f.isNone(o)?"an axiom":"a theorem",void 0,void 0,void 0,void 0,i,a,s,u);if(g.set(c.frames,e,d),c.totalNumOfFrames=c.totalNumOfFrames+1|0,d.isDepr||d.isTranDepr)return y.add(c.deprOrTranDeprFrms,e)}function Tr(r,t,e,n,i,a){var s=!1;switch(t.TAG){case"Comment":!function(r,t){r.contents.lastComment=t}(r,t.text),s=!0;break;case"Const":t.symbols.forEach((function(t){if(f.isSome(r.contents.parent))throw{RE_EXN_ID:o.MmException,_1:{msg:"An attempt to declare a constant '"+t+"' in an inner block."},Error:new Error};fr(r,t,"a constant");var e=r.contents;g.set(e.symToInt,t,0|-e.consts.length),e.consts.push(t)}));break;case"Block":throw{RE_EXN_ID:o.MmException,_1:{msg:"Block statements are not accepted by applySingleStmt()."},Error:new Error};case"Var":t.symbols.forEach((function(t){fr(r,t,"a variable");var e=r.contents;g.set(e.symToInt,t,e.varsBaseIdx+e.vars.length|0),e.vars.push(t)}));break;case"Disj":!function(r,t){var e=t.find((function(t){return!O(r,t)}));if(void 0!==e)throw{RE_EXN_ID:o.MmException,_1:{msg:"The symbol '"+e+"' is not a variable but it is used in a disjoint statement."},Error:new Error};for(var n=t.map((function(t){return H(r,t)})),i=n.length-1|0,a=0;a<=i;++a)for(var s=a+1|0;s<=i;++s)I(r.contents.disj,n[a],n[s])}(r,t.vars);break;case"Floating":!function(r,t,e){if(2!==e.length)throw{RE_EXN_ID:o.MmException,_1:{msg:"Length of a floating expression must be 2."},Error:new Error};fr(r,t,"a floating label");var n=e[0],i=e[1];if(!D(r,n))throw{RE_EXN_ID:o.MmException,_1:{msg:"The first symbol in the floating '"+n+"' must be a constant."},Error:new Error};if(!O(r,i))throw{RE_EXN_ID:o.MmException,_1:{msg:"The second symbol in the floating '"+i+"' must be a variable."},Error:new Error};var a=H(r,i);if(f.isSome(Y(r,a)))throw{RE_EXN_ID:o.MmException,_1:{msg:"Cannot redefine typecode for the variable '"+i+"'"},Error:new Error};var s=H(r,n),u={typ:"F",label:t,expr:[s,a]},c=r.contents;c.hyps.push(u),g.set(c.labelToHyp,t,u),R(c,u),h.set(c.varTypes,a,s)}(r,t.label,t.expr);break;case"Essential":!function(r,t,e){if(e.length<1)throw{RE_EXN_ID:o.MmException,_1:{msg:"Length of an essential expression must be at least 1."},Error:new Error};if(!D(r,e[0]))throw{RE_EXN_ID:o.MmException,_1:{msg:"The first symbol in an essential expression must be a constant."},Error:new Error};var n={typ:"E",label:t,expr:q(r,e)},i=r.contents;i.hyps.push(n),g.set(i.labelToHyp,t,n),R(i,n)}(r,t.label,t.expr);break;case"Axiom":_r(r,!0,t.label,t.expr,void 0,e,n,i,a);break;case"Provable":_r(r,!1,t.label,t.expr,t.proof,e,n,i,a)}s||(r.contents.lastComment=void 0)}function Ar(r,t){return f.getWithDefault(h.get(r,t),t)}function br(r,t){for(var e=t.length-1|0,n=0;n<=e;++n){var o=t[n];o<0&&(t[n]=Ar(r,o))}}function kr(r,t,e,n){var o=g.get(n,r.label),i=void 0!==o?o.contents:r.usageCnt,s=a.obj_dup(r);return s.usageCnt=i,s.proof=e?void 0:r.proof,s.descrNorm=t?void 0:r.descrNorm,s.descr=t?void 0:r.descr,s}function Sr(r,t,e,n){var o=function(r){var o=r.parent;return{root:r.root,parent:r.parent,consts:r.consts,varsBaseIdx:r.varsBaseIdx,vars:r.vars,symToInt:r.symToInt,disj:r.disj,hyps:r.hyps,labelToHyp:r.labelToHyp,exprToHyp:r.exprToHyp,varTypes:r.varTypes,lastComment:t?void 0:r.lastComment,frames:g.fromArray(g.toArray(r.frames).map((function(r){return[r[0],kr(r[1],t,e,n)]}))),totalNumOfFrames:void 0!==o?o.totalNumOfFrames+g.size(r.frames)|0:g.size(r.frames),deprOrTranDeprFrms:y.make(0),debug:r.debug}},i=r.parent;if(void 0!==i){var a=Sr(i,t,e,n),s=a[0],u=o(r);return[s,{root:s,parent:a[1],consts:u.consts,varsBaseIdx:u.varsBaseIdx,vars:u.vars,symToInt:u.symToInt,disj:u.disj,hyps:u.hyps,labelToHyp:u.labelToHyp,exprToHyp:u.exprToHyp,varTypes:u.varTypes,lastComment:u.lastComment,frames:u.frames,totalNumOfFrames:u.totalNumOfFrames,deprOrTranDeprFrms:u.deprOrTranDeprFrms,debug:u.debug}]}var c=o(r);return c.root=c,[c,c]}function Cr(r,t){return q(r,$(r,t).sort())}function wr(r,t){var e=E.fromArray(q(r,nr(r))),n=E.size(e),i=E.make(n),a=E.make(n);ir(r,(function(r){var t=r.asrt[1];t<0&&E.add(i,t);var e=r.asrt[r.asrt.length-1|0];e<0&&E.add(a,e)}));var s=E.fromArray(E.toArray(i).filter((function(r){return E.has(a,r)})));E.forEach(s,(function(r){return E.remove(i,r)})),E.forEach(s,(function(r){return E.remove(a,r)}));var c=o.getSpaceSeparatedValuesAsArray(t).map((function(t){return L(r,t)})).filter((function(r){return f.mapWithDefault(r,!1,(function(r){return r<0}))})).map(f.getExn);c.forEach((function(r){E.remove(i,r),E.remove(s,r),E.remove(a,r)}));var d,v=E.fromArray(E.toArray(e).filter((function(r){return!(c.includes(r)||E.has(i,r)||E.has(s,r)||E.has(a,r))}))),l=u.concatMany([c,(d=E.toArray(i),Cr(r,d)),function(t){return Cr(r,t)}(E.toArray(s)),function(t){return Cr(r,t)}(E.toArray(a)),function(t){return Cr(r,t)}(E.toArray(v))]),m=0|-c.length,p=m-1|0,h=(1+(p-E.size(i)|0)|0)-1|0,x=1+(h-E.size(s)|0)|0,g=1+((x-1|0)-E.size(a)|0)|0;return{allConsts:$(r,l),parenMin:m,canBeFirstMin:x,canBeFirstMax:p,canBeLastMin:g,canBeLastMax:h}}t.createContext=sr,t.applySingleStmt=Tr,t.openChildContext=ur,t.closeChildContext=cr,t.resetToParentContext=function(r){var t,e=r.contents.parent;if(void 0===e)throw{RE_EXN_ID:o.MmException,_1:{msg:"Cannot reset the root context."},Error:new Error};e.lastComment=void 0,t=e,r.contents=t},t.loadContext=function(r,t,e,n,o,i,a,u,c,f,d,l){var m=void 0!==e?e:"",p=void 0!==n?n:"",h=void 0!==i?i:-1,E=void 0!==d?d:function(r){},x=void 0!==l&&l,g={contents:0},y=T.progressTrackerMake(.1,void 0,E,void 0);return s.traverseAst(void 0!==t?t:sr(void 0,x),r,(function(r,t){void 0!==o&&o(r,t.stmt);var e=t.stmt;switch(e.TAG){case"Block":return e.level>0&&ur(r),void(r.contents.lastComment=void 0);case"Axiom":case"Provable":break;default:return}if(h>0&&(g.contents=g.contents+1,T.progressTrackerSetCurrPct(y,g.contents/h)),m===e.label)return v.some(void 0)}),(function(r,t){var e=t.stmt;"Block"!==e.TAG&&Tr(r,e,a,u,c,f)}),(function(r,t){var e=t.stmt;switch(e.TAG){case"Block":return void(e.level>0&&cr(r));case"Axiom":case"Provable":break;default:return}if(p===e.label)return v.some(void 0)}))[0]},t.ctxOptimizeForProver=function(r,t,e,n,o){var i;if(o){var a=or(r),s=g.fromArray(a.map((function(r){return[r.label,{contents:0}]})));a.forEach((function(r){var t=r.proof;if(void 0!==t)return y.forEach(y.fromArray(t.labels),(function(r){var t=g.get(s,r);void 0===t||(t.contents=t.contents+1|0)}))})),i=s}else i=g.make(0);var u={contents:Sr(r.contents,e,n,i)[1]};return function(r,t){for(var e=f.getExn(r.contents.root),n=t.slice(),o=-1,i=0|-(e.consts.length-1|0);o>=i;--o)n.includes(o)||n.push(o);var a=e.consts.slice(),s=h.make(e.consts.length);n.forEach((function(r,t){var n=a[0|-r],o=0|-(t+1|0);h.set(s,r,o),e.consts[0|-o]=n,g.set(e.symToInt,n,o)})),W(r,(function(r){br(s,r.expr)})),ir(r,(function(r){r.hyps.forEach((function(r){br(s,r.expr)})),br(s,r.asrt),br(s,r.varTypes)})),M(r.contents,(function(r){for(var t=r.vars.length-1|0,e=0;e<=t;++e){var n=r.varsBaseIdx+e|0,o=h.get(r.varTypes,n);void 0!==o&&h.set(r.varTypes,n,Ar(s,o))}h.clear(r.exprToHyp),r.hyps.forEach((function(t){R(r,t)}))}))}(u,q(u,wr(u,t).allConsts)),u},t.ctxGetOptimizedConstsOrder=wr,t.isDebug=function(r){return r.contents.debug},t.isConst=D,t.isVar=O,t.isHyp=N,t.isAsrt=function(r,t){return f.isSome(G(r.contents,(function(r){return g.get(r.frames,t)})))},t.isDisj=function(r,t,e){return f.getWithDefault(G(r.contents,(function(r){if(P(r.disj,t,e))return!0})),!1)},t.getAllConsts=nr,t.getHypothesis=function(r,t){return G(r.contents,(function(r){return g.get(r.labelToHyp,t)}))},t.getHypByExpr=function(r,t){return G(r.contents,(function(r){var e=t.length,n=h.get(r.exprToHyp,e);if(void 0!==n){var o=e>0?t[0]:0,i=h.get(v.valFromOption(n),o);if(void 0!==i){var a=e>1?t[1]:0,s=h.get(v.valFromOption(i),a);return void 0!==s?s.find((function(r){return b(r.expr,t)})):void 0}}}))},t.getMandHyps=function(r,t,e,n){var o=void 0!==e&&e;return er(r,tr(r,t,o,n),o,n)},t.getAllHyps=function(r){var t=[];return W(r,(function(r){t.push(r)})),p.fromArray(t.map((function(r){return[r.label,r]})))},t.getAllFrames=function(r){var t=[];return G(r.contents,(function(r){g.forEach(r.frames,(function(r,e){t.push([r,e])}))})),p.fromArray(t)},t.getAllFramesArr=or,t.getAllDisj=function(r){var t=h.make(16);return G(r.contents,(function(r){h.forEach(r.disj,(function(r,e){E.forEach(e,(function(e){I(t,r,e)}))}))})),t},t.getLocalDisj=function(r){var t=h.make(16);return h.forEach(r.contents.disj,(function(r,e){E.forEach(e,(function(e){I(t,r,e)}))})),t},t.getFrame=B,t.getFrameExn=function(r,t){var e=B(r,t);if(void 0!==e)return e;throw{RE_EXN_ID:o.MmException,_1:{msg:"Could not find a frame by the label '"+t+"'"},Error:new Error}},t.frameIsAllowed=function(r,t){return!(r.isDisc&&!t.useDisc||r.isDepr&&!t.useDepr)&&(!r.isTranDepr||t.useTranDepr)},t.getLocalVars=function(r){return r.contents.vars.slice()},t.getLocalHyps=function(r){return r.contents.hyps.slice()},t.getNumOfVars=function(r){return r.contents.varsBaseIdx+r.contents.vars.length|0},t.forEachFrame=ir,t.forEachHypothesisInDeclarationOrder=W,t.getNestingLevel=function(r){return ar(r.contents)},t.findParentheses=function(r,t){for(var e,n=function(r,t,e){for(var n=!0,o=!1,i=!1,a=A.parenCntMake([t,e],!1),s="Balanced",u=r.length,c=0;c<u&&n;){for(var f=r[c],d=f.length,v=0;v<d&&n;){var l=f[v];o||l!==t||(o=!0),i||l!==e||(i=!0),n="Failed"!==(s=A.parenCntPut(a,l)),v=v+1|0}n="Balanced"===s,c=c+1|0}return!(!n||!o)&&i},i=function(r){var t=[];return ir(r,(function(r){r.hyps.forEach((function(r){"E"!==r.typ||t.push(r.expr)})),t.push(r.asrt)})),t}(r),a=(e=o.getSpaceSeparatedValuesAsArray('( ) [ ] { } [. ]. [_ ]_ <. >. <" "> << >> [s ]s (. ). (( ))').filter((function(t){return D(r,t)})),q(r,e)).concat(u.range(1,f.getExn(r.contents.root).consts.length-1|0).map((function(r){return 0|-r}))),s=a.length-2|0,c=T.progressTrackerMake(.01,void 0,t,void 0),d=[],v=0;v<=s;++v){var l=a[v],m=a[v+1|0];d.includes(l)||d.includes(m)||!n(i,l,m)||(d.push(l),d.push(m)),T.progressTrackerSetCurrPct(c,v/s)}return d},t.getTypeOfVar=Y,t.getTypeOfVarExn=rr,t.getTokenType=j,t.ctxSymToInt=L,t.ctxIntToSym=X,t.ctxSymToIntExn=H,t.ctxSymsToIntsExn=q,t.ctxStrToIntsExn=function(r,t){return q(r,o.getSpaceSeparatedValuesAsArray(t))},t.ctxIntToSymExn=z,t.ctxIntsToSymsExn=$,t.ctxIntsToStrExn=K,t.frmIntToSym=J,t.frmIntToSymExn=Q,t.frmIntsToStrExn=function(r,t,e){return Z(r,t,e).join(" ")},t.frmIntsToSymsExn=Z,t.frmGetPatternSearchData=function(r){var t=r.patSearch;if(void 0!==t)return t;var e=r.hyps.filter((function(r){return"E"===r.typ})).map((function(r){return r.expr})),n={allHypsAsrt:x.spliceObjApply([],"concat",[e]).concat(r.asrt),numOfHyps:e.length,stmtBnds:l.reduce(e,[0],(function(r,t){return r.push(m.getExn(l.last(r),void 0)+t.length|0),r}))};return r.patSearch=n,n},t.createFrame=yr,t.generateNewVarNames=function(r,t,e,n){for(var o=void 0!==e?v.valFromOption(e):void 0,i=g.make(p.size(o)),a=function(r){return f.getWithDefault(g.get(i,r),0)},s=function(r){g.set(i,r,a(r)+1|0)},u=t.length-1|0,c=[],d=0;d<=u;++d){var l=z(r,t[d]),m=p.getWithDefault(o,l,l);s(m);for(var h={contents:m+String(a(m))};f.isSome(j(r,h.contents))||f.getWithDefault(f.map(n,function(r){return function(t){return y.has(t,r.contents)}}(h)),!1);)s(m),h.contents=m+String(a(m));c.push(h.contents)}return c},t.generateNewLabels=function(r,t,e,n,o){for(var i=void 0!==o&&o,a=function(t){return!!(f.getWithDefault(f.map(n,(function(r){return y.has(r,t)})),!1)||!i&&f.isSome(j(r,t)))||!!i&&N(r,t)},s=e-1|0,u=0,c=[],d=0;d<=s;++d){u=u+1|0;for(var v=t+String(u);a(v);)u=u+1|0,v=t+String(u);c.push(v)}return c},t.disjMake=function(){return h.make(16)},t.disjAddPair=I,t.disjContains=P,t.disjImmContains=function(r,t,e){var n=t<=e?t:e,o=t<=e?e:t,i=c.get(r,n);return void 0!==i&&d.has(v.valFromOption(i),o)},t.disjToArr=V,t.disjForEachArr=function(r,t,e,n,o,i){V(r,void 0!==t&&t,e,n,o).forEach(i)},t.disjForEach=U,t.disjImmForEach=function(r,t){c.forEach(r,(function(r,e){d.forEach(e,(function(e){t(r,e)}))}))},t.disjIsEmpty=function(r){return 0===h.size(r)},t.disjMutToDisjImm=function(r){return c.fromArray(h.toArray(r).map((function(r){return[r[0],d.fromArray(E.toArray(r[1]))]})))},t.disjGetAllVars=F,t.disjToStrDbg=function(r,t){var e=[];return h.keysToArray(r).toSorted(n.int_compare).forEach((function(o){var i=m.getExn(h.get(r,o),void 0);e.push(z(t,o)+" -> "+K(t,E.toArray(i).toSorted(n.int_compare)))})),e.join("\n")},t.exprEq=b,t.ExprCmp=C,t.ExprHash=w,t.normalizeDescr=gr},4792:(r,t,e)=>{var n=e(5291);t.parenCntMake=function(r,t,e,o,i){if(r%2!=0)throw{RE_EXN_ID:n.MmException,_1:{msg:"mod(parenMin, 2)  != 0 in parenCntMake"},Error:new Error};return{stack:new Array(1e3),len:0,failed:!1,parenMin:r,canBeFirstMin:t,canBeFirstMax:e,canBeLastMin:o,canBeLastMax:i}},t.parenCntReset=function(r){r.len=0,r.failed=!1},t.parenCntPut=function(r,t){return r.failed?"Failed":r.parenMin<=t&&t<0?t%2==-1?(function(r,t){if(r.stack.length===r.len)for(var e=1;e<=1e3;++e)r.stack.push(0);r.stack[r.len]=t,r.len=r.len+1|0}(r,t),"Opened"):0===r.len||r.stack[r.len-1|0]!==(t+1|0)?(r.failed=!0,"Failed"):(r.len=r.len-1|0,0===r.len?"Balanced":"Opened"):0===r.len?"Balanced":"Opened"},t.parenCntCanBeFirst=function(r,t){return 0<=t||r.parenMin<t&&t%2==-1||r.canBeFirstMin<=t&&t<=r.canBeFirstMax},t.parenCntCanBeLast=function(r,t){return 0<=t||r.parenMin<=t&&t%2==0||r.canBeLastMin<=t&&t<=r.canBeLastMax}},9217:(r,t,e)=>{var n=e(5291),o=e(2761),i=e(5047);t.parenCntMake=function(r,t){var e=void 0===t||t,i=r.length;if(i%2!=0)throw{RE_EXN_ID:n.MmException,_1:{msg:"mod(parenLen, 2)  != 0 in parenCntMake"},Error:new Error};if(0===i)return{min:0,parens:[],parentStack:[],failed:!1};for(var a=[],s=(i/2|0)-1|0,u=0;u<=s;++u){var c=r[u<<1],f=r[1+(u<<1)|0];a.push({code:c,isOpen:!0,opposite:f}),a.push({code:f,isOpen:!1,opposite:c})}var d=o.reduce(r,r[0],(function(r,t){return r<=t?r:t}));return e&&Math.abs(d)!==i&&console.log("Warning: parentheses are not optimized (this may slow down the unification process)."),{min:d,parens:a,parentStack:[],failed:!1}},t.parenCntReset=function(r){i.clearArray(r.parentStack),r.failed=!1},t.parenCntPut=function(r,t){if(!r.failed&&r.min<=t&&t<0){var e=r.parens.find((function(r){return r.code===t}));if(void 0!==e)if(e.isOpen)r.parentStack.push(e);else{var n=r.parentStack.pop();void 0!==n&&n.opposite===e.code||(r.failed=!0)}}return r.failed?"Failed":0===r.parentStack.length?"Balanced":"Opened"}},55:(r,t,e)=>{var n=e(5291),o=e(6517),i=e(3533),a=e(368),s=e(7653);function u(r){return" "===r||"\t"===r||"\n"===r||"\r"===r}function c(r,t){var e=(t+20|0)<r.length?"...":"";return"'"+r.substr(t,20)+e+"'"}function f(r,t,e,n,o){return a.traverseTree(r,t,(function(r,t){var e=t.stmt;if("Block"===e.TAG)return e.statements}),e,n,o)}function d(r){return void 0!==r?"Uncompressed"===r.TAG?r.labels.join(" "):"( "+r.labels.join(" ")+" ) "+r.compressedProofBlock:"?"}function v(r){var t=r.stmt;switch(t.TAG){case"Comment":return"$( "+t.text+" $)";case"Const":return"$c "+t.symbols.join(" ")+" $.";case"Block":return"block(level="+String(t.level)+")";case"Var":return"$v "+t.symbols.join(" ")+" $.";case"Disj":return"$d "+t.vars.join(" ")+" $.";case"Floating":return t.label+" $f "+t.expr.join(" ")+" $.";case"Essential":return t.label+" $e "+t.expr.join(" ")+" $.";case"Axiom":return t.label+" $a "+t.expr.join(" ")+" $.";case"Provable":return t.label+" $p "+t.expr.join(" ")+" $= "+d(t.proof)+" $."}}t.parseMmFile=function(r,t,e,a){var f=void 0!==t&&t,d=void 0!==e&&e,v=void 0!==a?a:function(r){},l=r.length,m={contents:0},p={contents:!1},h={contents:""},E=s.progressTrackerMake(.1,void 0,v,!0),x=[],g=function(t){m.contents=t,m.contents>=l?(p.contents=!0,h.contents=""):(p.contents=!1,h.contents=r.charAt(m.contents))};g(0);var y=function(){if(!p.contents)return m.contents=m.contents+1|0,void(m.contents>=l?(p.contents=!0,h.contents=""):h.contents=r.charAt(m.contents))},_=function(t){for(var e,n=!1,o=m.contents;!n;){var i=r.indexOf(t,m.contents);if(i<0)n=!0;else{var a=i+t.length|0;g(a),p.contents||u(h.contents)?(e=r.substring(o,i),n=!0):g(i+1|0)}}return e},T=function(t){var e=_("$)");if(void 0!==e)return{begin:t,end:m.contents-1|0,stmt:{TAG:"Comment",text:e}};throw{RE_EXN_ID:n.MmException,_1:{msg:"A comment is not closed at "+c(r,t)},Error:new Error}},A=function(t){if(t){for(var e=A(!1);"$("===e;)T(m.contents),e=A(!1);return e}!function(){for(;!p.contents&&u(h.contents);)y()}();for(var n=m.contents;!p.contents&&!u(h.contents);)y();return r.substring(n,m.contents)},b=function(r){for(var t,e=!1,n=[];!e;){var o=A(!0);""===o?e=!0:o===r?(t=n,e=!0):n.push(o)}return t},k=function(t){var e=b("$.");if(void 0!==e)return{begin:t,end:m.contents-1|0,stmt:{TAG:"Const",symbols:e}};throw{RE_EXN_ID:n.MmException,_1:{msg:"A constant statement is not closed at "+c(r,t)},Error:new Error}},S=function(t){var e=b("$.");if(void 0!==e)return{begin:t,end:m.contents-1|0,stmt:{TAG:"Var",symbols:e}};throw{RE_EXN_ID:n.MmException,_1:{msg:"A variable statement is not closed at "+c(r,t)},Error:new Error}},C=function(t){var e=b("$.");if(void 0!==e)return{begin:t,end:m.contents-1|0,stmt:{TAG:"Disj",vars:e}};throw{RE_EXN_ID:n.MmException,_1:{msg:"A disjoint statement is not closed at "+c(r,t)},Error:new Error}},w=function(t,e){var o=b("$.");if(void 0!==o)return{begin:t,end:m.contents-1|0,stmt:{TAG:"Floating",label:e,expr:o}};throw{RE_EXN_ID:n.MmException,_1:{msg:"A floating statement is not closed at "+c(r,t)},Error:new Error}},I=function(t,e){var o=b("$.");if(void 0!==o)return{begin:t,end:m.contents-1|0,stmt:{TAG:"Essential",label:e,expr:o}};throw{RE_EXN_ID:n.MmException,_1:{msg:"An essential statement is not closed at "+c(r,t)},Error:new Error}},M=function(t,e){var o=b("$.");if(void 0!==o)return{begin:t,end:m.contents-1|0,stmt:{TAG:"Axiom",label:e,expr:o}};throw{RE_EXN_ID:n.MmException,_1:{msg:"An axiom statement is not closed at "+c(r,t)},Error:new Error}},G=function(t,e){var o=b("$=");if(void 0!==o){var a=A(!0);if("("===a){var s=b(")");if(void 0!==s){var u=b("$.");if(void 0!==u)return{begin:t,end:m.contents-1|0,stmt:{TAG:"Provable",label:e,expr:o,proof:d?void 0:{TAG:"Compressed",labels:s,compressedProofBlock:i.spliceObjApply("","concat",[u])}}};throw{RE_EXN_ID:n.MmException,_1:{msg:"A probale statement is not closed[3] at "+c(r,t)},Error:new Error}}throw{RE_EXN_ID:n.MmException,_1:{msg:"A provable statement is not closed[2] at "+c(r,t)},Error:new Error}}var f=b("$.");if(void 0!==f)return{begin:t,end:m.contents-1|0,stmt:{TAG:"Provable",label:e,expr:o,proof:d?void 0:{TAG:"Uncompressed",labels:[a].concat(f)}}};throw{RE_EXN_ID:n.MmException,_1:{msg:"A provable statement is not closed[4] at "+c(r,t)},Error:new Error}}throw{RE_EXN_ID:n.MmException,_1:{msg:"A provable statement is not closed[1] at "+c(r,t)},Error:new Error}},j=function(t,e){for(var i,a=[];o.isNone(i);){var u=A(!1),d=m.contents-u.length|0;if(""===u){if(0!==e)throw{RE_EXN_ID:n.MmException,_1:{msg:"Unexpected end of a block. The block begins at "+c(r,t)+" and is not closed."},Error:new Error};i={begin:t,end:m.contents-1|0,stmt:{TAG:"Block",level:e,statements:a}}}else if("$}"===u)i={begin:t,end:m.contents-1|0,stmt:{TAG:"Block",level:e,statements:a}};else if("${"===u){var v=j(d,e+1|0);a.push(v)}else if("$("===u){var p=T(d);f||a.push(p)}else if("$["===u)_("$]");else if("$c"===u){var h=k(d);a.push(h)}else if("$v"===u){var g=S(d);a.push(g)}else if("$d"===u){var y=C(d);a.push(y)}else{var b=A(!0),D=m.contents-b.length|0;if(""===b)throw{RE_EXN_ID:n.MmException,_1:{msg:"Unexpected end of file at "+c(r,d)},Error:new Error};if("$f"===b){var O=w(d,u);a.push(O)}else if("$e"===b){var N=I(d,u);a.push(N)}else if("$a"===b){x.push(u);var P=M(d,u);a.push(P)}else{if("$p"!==b)throw{RE_EXN_ID:n.MmException,_1:{msg:"Unexpected token '"+b+"' at "+c(r,D)},Error:new Error};x.push(u);var U=G(d,u);a.push(U)}}s.progressTrackerSetCurrPct(E,d/l)}return o.getExn(i)};return[j(m.contents,0),x]},t.textAt=c,t.traverseAst=f,t.stmtToStr=v,t.stmtToStrRec=function(r){return f([{contents:0},[]],r,(function(r,t){var e=r[0],n=t.stmt;if("Block"===n.TAG){var o=n.level;0!==o&&r[1].push("    ".repeat(e.contents)+"${"),e.contents=o}}),(function(r,t){var e;""!==(e="Block"===t.stmt.TAG?"":v(t))&&r[1].push("    ".repeat(r[0].contents)+e)}),(function(r,t){var e=r[0],n=t.stmt;if("Block"===n.TAG){var o=n.level;e.contents=o-1|0,0!==o&&r[1].push("    ".repeat(e.contents)+"$}")}}))[0][1]},t.astToStr=function(r){var t=[];return f(void 0,r,(function(r,e){var n=e.stmt;"Block"===n.TAG&&n.level>0&&t.push("${")}),(function(r,e){var n=e.stmt;switch(n.TAG){case"Comment":t.push("$( "+n.text+" $)");break;case"Const":var o="$c "+n.symbols.join(" ")+" $.";t.push(o);break;case"Block":break;case"Var":var i="$v "+n.symbols.join(" ")+" $.";t.push(i);break;case"Disj":var a="$d "+n.vars.join(" ")+" $.";t.push(a);break;case"Floating":var s=n.label+" $f "+n.expr.join(" ")+" $.";t.push(s);break;case"Essential":var u=n.label+" $e "+n.expr.join(" ")+" $.";t.push(u);break;case"Axiom":var c=n.label+" $a "+n.expr.join(" ")+" $.";t.push(c);break;case"Provable":var f=n.label+" $p "+n.expr.join(" ")+" $= "+d(n.proof)+" $.";t.push(f)}}),(function(r,e){var n=e.stmt;"Block"===n.TAG&&n.level>0&&t.push("$}")})),t.join("\n")},t.isWhitespace=u},6134:(r,t,e)=>{var n=e(5291),o=e(4923),i=e(5300),a=e(3333),s=e(6517),u=e(2761),c=e(7356),f=e(7659),d=e(368),v=e(9702),l=e(2275);function m(r,t,e){var n=r.length;return e<=n?r:r+t.repeat(e-n|0)}function p(r){return u.reduce(r.map((function(r){return r.length})),0,(function(r,t){return Math.max(r,t)}))}function h(r,t){var e=t.map((function(r){var t=r.proof;return"Hypothesis"===t.TAG?"":t.args.map((function(r){return r+1|0})).join(",")})),n=t.map((function(r){var t=r.proof;return t.TAG,t.label})),o=t.map((function(t){return a.ctxIntsToStrExn(r,t.expr)})),s=1+(i.Int.floor(Math.log10(t.length))+1|0)|0,u=p(e)+1|0,c=p(n)+1|0;return t.map((function(r,t){return i=String(t+1|0)," ",((a=s)<=(f=i.length)?i:" ".repeat(a-f|0)+i)+"| "+m(e[t]," ",u)+"| "+m(n[t]," ",c)+"| "+o[t];var i,a,f}))}function E(r,t,e){var n=h(r,t);return m("--- "+e+" ","-",p(n))+"\n"+n.join("\n")+"\n"+m("","-",p(n))}function x(r,t,e,n){var o=f.make(64);d.traverseTree(void 0,t,(function(t,e){var n=r[e].proof;return"Hypothesis"===n.TAG||f.has(o,e)?void 0:n.args}),void 0,void 0,(function(t,i){"Hypothesis"===r[i].proof.TAG?e(i):f.has(o,i)?n(i):(f.add(o,i),e(i))}))}t.createProof=function(r,t,e){if(t.length<=e)throw{RE_EXN_ID:n.MmException,_1:{msg:"tblLen <= rootIdx"},Error:new Error};var o=r.length,i=l.fromArray(r.map((function(r,t){return[r.label,t+1|0]}))),a=[],u=l.make(64),d=function(r,t){var e=f.make(64);return x(r,t,(function(r){}),(function(r){f.add(e,r)})),e}(t,e),m=c.make(64),p=[];x(t,e,(function(r){var e,n=t[r].proof;if(n.TAG,e=function(r){var t=l.get(i,r);if(void 0!==t)return t;var e=l.get(u,r);if(void 0!==e)return e;a.push(r);var n=o+a.length|0;return l.set(u,r,n),n}(n.label),p.push(e),f.has(d,r))return p.push(0),c.set(m,r,c.size(m)+1|0)}),(function(r){p.push(0|-s.getExn(c.get(m,r)))}));var h=o+a.length|0;return{TAG:"Compressed",labels:a,compressedProofBlock:p.map((function(r){return 0===r?"Z":r<0?v.intToCompressedProofStr(h-r|0):v.intToCompressedProofStr(r)})).join("")}},t.createProofTableFromProof=function(r,t){var e=void 0===t||t,i=c.make(v.proofNodeGetId(r)),u=[],f=function(r,t,e){u.push({expr:t,proof:e});var n=u.length-1|0;c.set(i,r,n)},l=function(r,t,d){if(s.isSome(c.get(i,r)))throw{RE_EXN_ID:n.MmException,_1:{msg:"getIdxByNodeId(nodeId)->Belt_Option.isSome in createProofTableFromProof()"},Error:new Error};if(!e)return f(r,t,d);var v=u.findIndex((function(r){return!!a.exprEq(r.expr,t)&&o.equal(r.proof,d)}));return-1!==v?c.set(i,r,v):f(r,t,d)};return d.traverseTree(void 0,r,(function(r,t){return"Hypothesis"===t.TAG?void 0:t.args}),void 0,void 0,(function(r,t){if("Hypothesis"===t.TAG){var e=t.id;s.isNone(c.get(i,e))&&l(e,t.expr,{TAG:"Hypothesis",label:t.hypLabel})}else{var o=t.id;s.isNone(c.get(i,o))&&l(o,t.expr,{TAG:"Assertion",args:t.args.map((function(r){var t=v.proofNodeGetId(r),e=c.get(i,t);if(void 0!==e)return e;throw{RE_EXN_ID:n.MmException,_1:{msg:"Could not determine idx by nodeId in createProofTableFromProof()."},Error:new Error}})),label:t.asrtLabel})}})),u},t.proofTableToArrStr=h,t.proofTableToStr=E,t.proofTablePrint=function(r,t,e){console.log(E(r,t,e))}},2423:(r,t,e)=>{var n=e(5291),o=e(3333),i=e(6517),a=e(2815),s=e(9775),u=e(5082),c=e(5650),f=e(2275),d=e(5047);function v(r){if("object"!=typeof r)return!0;switch(r.TAG){case"Hypothesis":return!0;case"Assertion":return r.args.every((function(r){return i.isSome(r.proof)}));case"AssertionWithErr":return!1}}function l(r){var t=r.pnDbg;return void 0!==t?t.exprStr:r.expr.map((function(r){return String(r)})).join(" ")}function m(r){var t=r.fParents,e=void 0!==t?t.find(v):void 0;return i.isSome(e)?e:r.eParents.find(v)}t.ptMake=function(r,t,e){var n=u.toArray(o.getAllHyps(r)),c=o.getNumOfVars(r)-1|0,d=function(r,t){if(o.isDebug(r)){var e=function(e){return e<=t?o.ctxIntToSymExn(r,e):"&"+String(e)};return function(r){return r.map(e).join(" ")}}}(r,c);return{proofCtx:r,frms:t,hypsByExpr:a.fromArray(n.map((function(r){var t=r[1];return[t.expr,t]})),o.ExprHash),hypsByLabel:f.fromArray(n),ctxMaxVar:c,ctxDisj:o.getAllDisj(r),maxVar:c,newVars:s.make(16,o.ExprHash),parenCnt:e,nextNodeId:0,nodes:a.make(128,o.ExprHash),rootStmts:[],syntaxProofs:a.make(128,o.ExprHash),ptDbg:i.map(d,(function(r){return{newVars:[],exprToStr:r}}))}},t.ptGetProofCtx=function(r){return r.proofCtx},t.ptGetFrms=function(r){return r.frms},t.ptGetHypByExpr=function(r,t){return a.get(r.hypsByExpr,t)},t.ptGetHypByLabel=function(r,t){return f.get(r.hypsByLabel,t)},t.ptGetMaxVar=function(r){return r.maxVar},t.ptGetCtxMaxVar=function(r){return r.ctxMaxVar},t.ptGetParenCnt=function(r){return r.parenCnt},t.ptIsDisjInCtx=function(r,t,e){return o.disjContains(r.ctxDisj,t,e)},t.ptIsNewVarDef=function(r,t){return s.has(r.newVars,t)},t.ptGetRootStmts=function(r){return r.rootStmts},t.ptGetNode=function(r,t){var e=a.get(r.nodes,t);if(void 0!==e)return e;var n={id:r.nextNodeId,expr:t,fParents:void 0,eParents:[],children:[],proof:void 0,isInvalidFloating:!1,dist:void 0,bottomUpProverParams:void 0,pnDbg:i.map(r.ptDbg,(function(r){return{exprStr:r.exprToStr(t)}}))};return a.set(r.nodes,t,n),r.nextNodeId=r.nextNodeId+1|0,n},t.ptAddNewVar=function(r,t){r.maxVar=r.maxVar+1|0;var e=r.maxVar;s.add(r.newVars,[t,e]);var n=r.ptDbg;return void 0!==n&&n.newVars.push(n.exprToStr([t,e])),e},t.ptAddRootStmt=function(r,t){return void 0!==r.rootStmts.find((function(r){return o.exprEq(r.expr,t.expr)}))?void 0:void r.rootStmts.push(t)},t.ptAddSyntaxProof=function(r,t,e){a.set(r.syntaxProofs,t,e)},t.ptGetSyntaxProof=function(r,t){return a.get(r.syntaxProofs,t)},t.ptGetAllSyntaxProofs=function(r){return a.toArray(r.syntaxProofs)},t.ptClearDists=function(r){a.forEach(r.nodes,(function(r,t){t.dist=void 0}))},t.ptGetDbg=function(r){return r.ptDbg},t.ptGetCopyOfNewVars=function(r){return s.toArray(r.newVars)},t.ptGetCtxDisj=function(r){return r.ctxDisj},t.pnGetId=function(r){return r.id},t.pnGetExpr=function(r){return r.expr},t.pnGetProof=function(r){return r.proof},t.pnGetFParents=function(r){return r.fParents},t.pnGetEParents=function(r){return r.eParents},t.pnAddParent=function(r,t,e,o){if(i.isNone(r.proof)||o){var a,s=!1;if(e)a=r.eParents;else{var u=r.fParents;if(void 0!==u)a=u;else{var f=[t];r.fParents=f,s=!0,a=f}}if(!s){var d=a.find((function(r){if("object"!=typeof r)return"object"!=typeof t;switch(r.TAG){case"Hypothesis":return"object"==typeof t&&"Hypothesis"===t.TAG&&r.label===t.label;case"Assertion":var e=r.args;if("object"!=typeof t)return!1;if("Assertion"!==t.TAG)return!1;var n=t.args;return r.frame.label===t.frame.label&&e.length===n.length&&e.every((function(r,t){return r.id===n[t].id}));case"AssertionWithErr":return!1}}));if(void 0!==d){if(v(d))throw{RE_EXN_ID:n.MmException,_1:{msg:"Unexpected: an unproved node '"+l(r)+"' has a proved parent."},Error:new Error}}else a.push(t),s=!0}if(s)return"object"==typeof t&&"Assertion"===t.TAG&&t.args.forEach((function(t){if(t.id!==r.id)return void 0!==t.children.find((function(t){return t.id===r.id}))?void 0:void t.children.push(r)})),v(t)?(function(r){if(i.isNone(r.proof)){var t=m(r);if(void 0!==t){r.proof=t;for(var e=c.fromArray(r.children);!c.isEmpty(e);){var n=i.getExn(c.pop(e));if(i.isNone(n.proof)){var o=m(n);void 0!==o&&(n.proof=o,n.children.forEach((function(r){c.add(e,r)})))}}}}}(r),o?void(r.proof=t):void 0):void 0}},t.pnIsInvalidFloating=function(r){return r.isInvalidFloating},t.pnSetInvalidFloating=function(r){r.isInvalidFloating=!0},t.pnGetDist=function(r){return r.dist},t.pnSetDist=function(r,t){r.dist=t},t.pnGetBottomUpProverParams=function(r){return r.bottomUpProverParams},t.pnSetBottomUpProverParams=function(r,t){r.bottomUpProverParams=t},t.pnGetDbg=function(r){return r.pnDbg},t.jstfEqSrc=function(r,t,e){if("object"!=typeof e)return!1;if("Assertion"!==e.TAG)return!1;var n=e.frame;if(t!==n.label)return!1;var i=e.args,a=r.length,s=n.hyps.length;if(a>s)return!1;for(var u=0,c=0,f=!0;f&&u<a&&c<s;)"F"===n.hyps[c].typ||(f=o.exprEq(r[u],i[c].expr),u=u+1|0),c=c+1|0;for(;f&&c<s;)"F"===n.hyps[c].typ?c=c+1|0:f=!1;return!(!f||u!==a)&&c===s},t.ptPrintStats=function(r){var t=a.toArray(r.nodes).map((function(r){return r[1]})),e=t.length;console.log("nodeCnt",e);var o=t.filter((function(r){return i.isSome(r.proof)})).length;console.log("provedNodeCnt",o,n.floatToPctStr(o/e));var s=t.filter((function(r){return r.isInvalidFloating})).length;console.log("invalidFloatingCnt",s,n.floatToPctStr(s/e));var u=r.ptDbg;if(void 0===u)return"Debug is off";var c=t.filter((function(r){return!!i.isNone(r.proof)&&!r.isInvalidFloating}));return d.sortInPlaceWith(c,(function(r,t){return r.expr.length-t.expr.length|0})),c.map((function(r){return r.expr})).map(u.exprToStr).join("\n")}},1717:(r,t,e)=>{var n=e(6253),o=e(5291),i=e(3333),a=e(6517),s=e(2815),u=e(9775),c=e(2423),f=e(368),d=e(6601);function v(r,t){var e=function(r){var e=s.get(t,c.pnGetExpr(r));if(void 0!==e)return e;throw{RE_EXN_ID:o.MmException,_1:{msg:"exprSrcToDto: cannot get idx by expr."},Error:new Error}};if("object"!=typeof r)return"VarType";switch(r.TAG){case"Hypothesis":return{TAG:"Hypothesis",label:r.label};case"Assertion":return{TAG:"Assertion",args:r.args.map(e),label:r.frame.label};case"AssertionWithErr":return{TAG:"AssertionWithErr",args:r.args.map(e),label:r.frame.label,err:r.err}}}function l(r,t){if("object"!=typeof r)return"object"!=typeof t?0:-1;if("Hypothesis"===r.TAG){if("object"!=typeof t)return 1;switch(t.TAG){case"Hypothesis":return n.string_compare(r.label,t.label);case"Assertion":case"AssertionWithErr":return-1}}if("object"!=typeof t)return 1;switch(t.TAG){case"Hypothesis":return 1;case"Assertion":case"AssertionWithErr":return n.string_compare(r.label,t.label)}}function m(r,t,e){return c.ptGetAllSyntaxProofs(r).map((function(r){var n,i=s.get(t,c.pnGetExpr(r[1]));if(void 0===i)throw{RE_EXN_ID:o.MmException,_1:{msg:"Could not convert proofNode to proofNodeDto for a syntax proof."},Error:new Error};return n=e[i],[r[0],n]}))}t.proofTreeToDto=function(r,t){var e=function(r,t){var e=d.make();c.ptGetAllSyntaxProofs(r).forEach((function(r){d.push(e,r[1])})),t.forEach((function(t){d.push(e,c.ptGetNode(r,t))}));for(var n=u.make(100,i.ExprHash),o=s.make(100,i.ExprHash),f=function(r){"object"==typeof r&&"Hypothesis"!==r.TAG&&r.args.forEach((function(r){d.push(e,r)}))};!d.isEmpty(e);){var v=a.getExn(d.pop(e)),l=c.pnGetExpr(v);u.has(n,l)||(u.add(n,l),s.set(o,l,s.size(o)),c.pnGetEParents(v).forEach(f),a.forEach(c.pnGetProof(v),f))}return o}(r,t),n=new Array(s.size(e));return s.forEach(e,(function(t,o){n[o]=function(r,t){return{expr:c.pnGetExpr(r),parents:c.pnGetEParents(r).map((function(r){return v(r,t)})).toSorted(l),proof:a.map(c.pnGetProof(r),(function(r){return v(r,t)})),dbg:a.map(c.pnGetDbg(r),(function(r){return{exprStr:r.exprStr}}))}}(c.ptGetNode(r,t),e)})),{newVars:c.ptGetCopyOfNewVars(r),nodes:n,syntaxProofs:m(r,e,n),dbg:a.map(c.ptGetDbg(r),(function(r){return{newVars:r.newVars}}))}},t.createProofTable=function(r,t,e,n){var u=void 0!==e&&e;if(u&&a.isNone(n))throw{RE_EXN_ID:o.MmException,_1:{msg:"Error in createProofTable: ctx must be set when essentialsOnly == true."},Error:new Error};var c=function(r,t){if(!(u&&r.length>0))return r;var e=[];return i.getFrameExn(a.getExn(n),t).hyps.forEach((function(t,n){"E"!==t.typ||e.push(r[n])})),e},d=s.make(64,i.ExprHash),v=[],l=function(r,t){if(a.isSome(s.get(d,r)))throw{RE_EXN_ID:o.MmException,_1:{msg:"getIdxByExpr(expr)->Belt_Option.isSome in createProofTable()."},Error:new Error};v.push({expr:r,proof:t});var e=v.length-1|0;s.set(d,r,e)};return f.traverseTree(void 0,t,(function(t,e){var n=e.proof;if(void 0===n)throw{RE_EXN_ID:o.MmException,_1:{msg:"Cannot create proofTable from an unproved proofNodeDto [1]."},Error:new Error};if("object"!=typeof n)throw{RE_EXN_ID:o.MmException,_1:{msg:"VarType is not supported in createProofTable [1]."},Error:new Error};switch(n.TAG){case"Hypothesis":return;case"Assertion":return c(n.args,n.label).map((function(t){return r.nodes[t]}));case"AssertionWithErr":throw{RE_EXN_ID:o.MmException,_1:{msg:"AssertionWithErr is not supported in createProofTable [1]."},Error:new Error}}}),void 0,void 0,(function(t,e){var n=e.proof;if(void 0===n)throw{RE_EXN_ID:o.MmException,_1:{msg:"Cannot create proofTable from an unproved proofNodeDto [2]."},Error:new Error};if("object"!=typeof n)throw{RE_EXN_ID:o.MmException,_1:{msg:"VarType is not supported in createProofTable [2]."},Error:new Error};switch(n.TAG){case"Hypothesis":a.isNone(s.get(d,e.expr))&&l(e.expr,{TAG:"Hypothesis",label:n.label});break;case"Assertion":var i=n.label;a.isNone(s.get(d,e.expr))&&l(e.expr,{TAG:"Assertion",args:c(n.args,i).map((function(t){var e=r.nodes[t].expr,n=s.get(d,e);if(void 0!==n)return n;throw{RE_EXN_ID:o.MmException,_1:{msg:"Could not determine idx by expr in createProofTable()."},Error:new Error}})),label:i});break;case"AssertionWithErr":throw{RE_EXN_ID:o.MmException,_1:{msg:"AssertionWithErr is not supported in createProofTable [2]."},Error:new Error}}})),v}},9702:(r,t,e)=>{var n=e(5291),o=e(4923),i=e(2971),a=e(3333),s=e(1094),u=e(6517),c=e(303),f=e(5047),d=e(1725);function v(r){return r.TAG,r.expr}function l(r,t){return v(r.nodes[t])}function m(r,t,e,n,i){var a=t,s=n,u=r.length,c=e.length;if(u<(t+i|0)||c<(n+i|0))return!1;for(var f=(t+i|0)-1|0;a<=f&&o.equal(r[a],e[s]);)s=s+1|0,a=a+1|0;return a>f}var p=u.getExn("Z".codePointAt(0)),h=u.getExn("A".codePointAt(0)),E=h-1|0,x=u.getExn("T".codePointAt(0)),g=u.getExn("U".codePointAt(0)),y=g-1|0;function _(r){for(var t=r.length,e=[],n=0,o=0;o<t;){var i=u.getExn(r.codePointAt(o));i===p?(e.push("Z"),n=o=o+1|0):h<=i&&i<=x?(e.push(r.substring(n,o+1|0)),n=o=o+1|0):o=o+1|0}return e}function T(r){return r<=x?r-E|0:r-y|0}function A(r){for(var t=0,e=1,n=r.length,o=n-2|0;o>=0;--o)t=t+Math.imul(e,T(u.getExn(r.codePointAt(o))))|0,e=Math.imul(e,5);return Math.imul(t,20)+T(u.getExn(r.codePointAt(n-1|0)))|0}function b(r,t,e){var n={contents:void 0};return s.forEach(t,(function(t,o){if(u.isNone(n.contents))return c.forEach(o,(function(o){if(u.isNone(n.contents))for(var i=r[t],a=i.length-1|0,s=r[o],c=s.length-1|0,f=1;f<=a;++f)if(u.isNone(n.contents)){var d=i[f];if(d>=0)for(var v=1;v<=c;++v)if(u.isNone(n.contents)){var l=s[v];l>=0&&(d===l?n.contents={TAG:"DisjCommonVar",frmVar1:t,expr1:i.slice(1,a+1|0),frmVar2:o,expr2:s.slice(1,c+1|0),commonVar:d}:e(d,l)||(n.contents={TAG:"Disj",frmVar1:t,expr1:i.slice(1,a+1|0),var1:d,frmVar2:o,expr2:s.slice(1,c+1|0),var2:l}))}}}))})),n.contents}function k(r,t,e,o){var s=r.nodes.length;if(s<t.numOfArgs)throw{RE_EXN_ID:n.MmException,_1:{msg:"stackLength < numOfArgs"},Error:new Error};var u=function(r,t){var e=new Array(t.numOfVars),o=i.make(t.numOfVars,!1),a=r.nodes.length-t.numOfArgs|0;if(t.hyps.forEach((function(t,i){if("F"===t.typ){var s=t.expr[0],u=t.expr[1];if(o[u])throw{RE_EXN_ID:n.MmException,_1:{msg:"subsLock[v]"},Error:new Error};var c=l(r,a+i|0);if(c.length<2)throw{RE_EXN_ID:n.MmException,_1:{msg:"subsExpr->Array.length < 2"},Error:new Error};if(c[0]!==s)throw{RE_EXN_ID:n.MmException,_1:{msg:"subsExpr[0] != t"},Error:new Error};o[u]=!0,e[u]=c}})),o.some((function(r){return!r})))throw{RE_EXN_ID:n.MmException,_1:{msg:"subsLock->Array.some(lock => !lock)"},Error:new Error};return e}(r,t),c=b(u,t.disj,o);if(void 0!==c){var v=d.unifErrToStr(c,(function(r){return a.ctxIntsToStrExn(e,r)}),(function(r){return a.frmIntsToStrExn(e,t,r)}));throw{RE_EXN_ID:n.MmException,_1:{msg:"Disjoint verification failed: "+v},Error:new Error}}!function(r,t,e){var o=r.nodes.length-t.numOfArgs|0;t.hyps.forEach((function(t,i){if("E"===t.typ&&!function(r,t,e){for(var n=0,o=0,i=!0,a=r.length,s=e.length;i&&n<a&&o<s;){var u=r[n];if(u<0)i=u===e[o],o=o+1|0;else{var c=t[u],f=c.length-1|0;i=m(c,1,e,o,f),o=o+f|0}n=n+1|0}return!(!i||n!==a)&&o===s}(t.expr,e,l(r,o+i|0)))throw{RE_EXN_ID:n.MmException,_1:{msg:"!compareExprAfterSubstitution(ess, subs, stack->stGetExpr(baseIdx+i))"},Error:new Error}}))}(r,t,u);var p=function(r,t){var e={contents:0};r.forEach((function(r){e.contents=r<0?e.contents+1|0:(e.contents+t[r].length|0)-1|0}));for(var n=new Array(e.contents),o=0,i=0;i<e.contents;){var a=r[o];if(a<0)n[i]=a,i=i+1|0;else{var s=t[a],u=s.length-1|0;f.copySubArray(s,1,n,i,u),i=i+u|0}o=o+1|0}return n}(t.asrt,u),h={TAG:"Calculated",id:r.nextId,args:r.nodes.slice(s-t.numOfArgs|0),asrtLabel:t.label,expr:p,dbg:a.isDebug(e)?{exprStr:a.ctxIntsToStrExn(e,p)}:void 0};r.nextId=r.nextId+1|0;for(var E=1,x=t.numOfArgs;E<=x;++E)r.nodes.pop();r.nodes.push(h)}t.proofNodeGetId=function(r){return r.id},t.proofNodeGetExpr=v,t.verifyProof=function(r,t,e,o){var s,u={nextId:0,nodes:[]};if("Uncompressed"===e.TAG?function(r,t,e,o){e.forEach((function(e){var i=a.getHypothesis(r,e);if(void 0!==i)return t.nodes.push({TAG:"Hypothesis",id:t.nextId,hypLabel:i.label,expr:i.expr,dbg:a.isDebug(r)?{exprStr:a.ctxIntsToStrExn(r,i.expr)}:void 0}),void(t.nextId=t.nextId+1|0);var s=a.getFrame(r,e);if(void 0!==s)return k(t,s,r,o);throw{RE_EXN_ID:n.MmException,_1:{msg:"The proof step '"+e+"' doesn't refer to a hypothesis or assertion (in uncompressed proof)."},Error:new Error}}))}(r,u,e.labels,o):function(r,t,e,o,s,u){var c=function(r){o.nodes.push({TAG:"Hypothesis",id:o.nextId,hypLabel:r.label,expr:r.expr,dbg:a.isDebug(e)?{exprStr:a.ctxIntsToStrExn(e,r.expr)}:void 0}),o.nextId=o.nextId+1|0},f=_(t),d=a.getMandHyps(e,r,void 0,void 0),v=d.length,l=v+u.length|0,m=[];i.forEach(f,(function(r){if("Z"!==r){var t=A(r);if(t<1)throw{RE_EXN_ID:n.MmException,_1:{msg:"Unexpected condition when applying compressed proof: i < 1."},Error:new Error};if(t<=v)return c(d[t-1|0]);if(t<=l){var f=u[(t-v|0)-1|0],p=a.getHypothesis(e,f);if(void 0!==p)return c(p);var h=a.getFrame(e,f);if(void 0!==h)return k(o,h,e,s);throw{RE_EXN_ID:n.MmException,_1:{msg:"The proof step '"+f+"' doesn't refer to a hypothesis or assertion (in compressed proof)."},Error:new Error}}var E=i.get(m,(t-l|0)-1|0);if(void 0===E)throw{RE_EXN_ID:n.MmException,_1:{msg:"Compressed proof refers to a saved step by the index which is out of bounds."},Error:new Error};o.nodes.push(E)}else{var x=o.nodes.length;if(0===x)throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot execute 'Z' command because the stack is empty."},Error:new Error};m.push(o.nodes[x-1|0])}}))}(t,e.compressedProofBlock,r,u,o,e.labels),1!==u.nodes.length)throw{RE_EXN_ID:n.MmException,_1:{msg:"stack->Array.length is "+String(u.nodes.length)+" but must be 1."},Error:new Error};if(!a.exprEq(l(u,0),t))throw{RE_EXN_ID:n.MmException,_1:{msg:"stack[0] != expr\nstack[0] is '"+(s=l(u,0),a.ctxIntsToStrExn(r,s)+"'\nexpr is     '"+function(t){return a.ctxIntsToStrExn(r,t)}(t)+"'")},Error:new Error};return u.nodes[0]},t.compressedProofBlockToArray=_,t.compressedProofStrToInt=A,t.intToCompressedProofStr=function(r){if(r<1)throw{RE_EXN_ID:n.MmException,_1:{msg:"intToCompressedProofStr: i < 1"},Error:new Error};for(var t=[String.fromCharCode(h+(r-1|0)%20|0)],e=(r-1|0)/20|0;e>0;)t.push(String.fromCharCode(g+(e-1|0)%5|0)),e=(e-1|0)/5|0;return t.reverse(),t.join("")},t.verifyDisjoints=b},9592:(r,t,e)=>{var n=e(5291),o=e(4923),i=e(2971),a=e(3333),s=e(6517),u=e(7175),c=e(6705),f=e(2423),d=e(5082),v=e(7659),l=e(4792),m=e(1874),p=e(5650),h=e(5981),E=e(5047),x=e(7653),g=e(3053);function y(r,t){if(f.ptIsNewVarDef(r,t))return"VarType";var e=f.ptGetHypByExpr(r,t);return void 0!==e?{TAG:"Hypothesis",label:e.label}:void 0}function _(r,t,e,o,i){var u=t.length;m.frmsForEach(f.ptGetFrms(r),t[0],(function(c){if(a.frameIsAllowed(c.frame,o)){var d=c.frame.asrt;m.iterateSubstitutions(d,t,c.frmConstParts[c.numOfHypsE],c.constParts[c.numOfHypsE],c.varGroups[c.numOfHypsE],c.subs,f.ptGetParenCnt(r),(function(t){if(t.isDefined.every((function(r){return r}))&&s.isNone(m.verifyDisjoints(c.frame.disj,t,(function(t,e){return f.ptIsDisjInCtx(r,t,e)}),0))){for(var o=c.frame.hyps,a=o.length,d=new Array(a),v=!0,l=0,p=a-1|0;l<=p&&v;){var h,E=m.applySubs(o[l].expr,t,(function(r){throw{RE_EXN_ID:n.MmException,_1:{msg:"Work variables are not supported in findAsrtParentsWithoutNewVars()."},Error:new Error}}));switch(e){case"No":h=!0;break;case"LessEq":h=E.length<=u;break;case"Less":h=E.length<u}if(v=h){var x=f.ptGetNode(r,E);d[l]=x,v=!f.pnIsInvalidFloating(x)}l=l+1|0}v&&i({TAG:"Assertion",args:d,frame:c.frame})}return"Continue"}))}}))}function T(r,t,e,o){if(s.isNone(f.pnGetProof(t))&&!f.pnIsInvalidFloating(t)){n.arrayQueueReset(o);var i=v.make(128),a=function(r){if(void 0===f.pnGetProof(r)){var t=f.pnGetId(r);return v.has(i,t)?void 0:(v.add(i,t),n.arrayQueueAdd(o,r))}},u=function(r){"object"==typeof r&&"Assertion"===r.TAG&&r.args.forEach(a)},c=function(){for(var r=n.arrayQueuePop(o);s.mapWithDefault(r,!1,(function(r){return!!s.isSome(f.pnGetProof(r))||f.pnIsInvalidFloating(r)}));)r=n.arrayQueuePop(o);return r};a(t);for(var d={contents:!1},l=c();s.isNone(f.pnGetProof(t))&&s.isSome(l);){var m=s.getExn(l),p=f.pnGetFParents(m);if(void 0!==p)p.forEach(u);else{var h=f.pnGetExpr(m),E=y(r,h);void 0!==E?f.pnAddParent(m,E,!1,!1):(d.contents=!1,_(r,h,"LessEq",e,function(r){return function(t){f.pnAddParent(r,t,!1,!1),u(t),d.contents=!0}}(m)),d.contents||f.pnSetInvalidFloating(m))}l=c()}return s.isNone(f.pnGetProof(t))?f.pnSetInvalidFloating(t):void 0}}function A(r,t,e,o,i,u,d,v,l,p,E,x,g){var y=void 0!==E?E:0,_=n.arrayQueueMake(1e3),A=[],b=s.isSome(x),k=s.getWithDefault(x,0),S=f.ptGetMaxVar(r);c.applyAssertions(S,f.ptGetFrms(r),v,(function(r){return a.frameIsAllowed(r,l.inEssen)}),(function(t,e){return f.ptIsDisjInCtx(r,t,e)}),e,o,i,u,t,f.ptGetParenCnt(r),d,p,(function(r){A.push(r);var t=A.length;return void 0!==g&&t%100==0&&g(t),b&&t>=k?"Stop":"Continue"}),y,void 0);var C=[];return A.forEach((function(t){var e=t.frame,o=t.err,i=0;if(void 0!==o&&"object"==typeof o)switch(o.TAG){case"NoUnifForAsrt":case"NoUnifForArg":case"NewVarsAreDisabled":i=1;break;case"TooManyCombinations":return void C.push({TAG:"AssertionWithErr",args:[],frame:e,err:s.getExn(t.err)});default:i=2}else i=2;switch(i){case 1:return 0!==y?void C.push({TAG:"AssertionWithErr",args:[],frame:e,err:s.getExn(t.err)}):void 0;case 2:var a=h.make();t.newVars.forEach((function(e,n){var o=t.newVarTypes[n],i=f.ptAddNewVar(r,o);h.set(a,e,i)}));for(var u,c=e.hyps.length,d=new Array(c),v=0,p=c-1|0;v<=p&&(s.isNone(u)||0!==y);){for(var E=m.applySubs(e.hyps[v].expr,t.subs,(function(r){throw{RE_EXN_ID:n.MmException,_1:{msg:"New work variables are not expected here [findAsrtParentsWithNewVars]."},Error:new Error}})),x=E.length-1|0,g=0;g<=x;++g){var A=E[g];if(A>S){var b,k=h.get(a,A);if(void 0===k)throw{RE_EXN_ID:n.MmException,_1:{msg:"Could not replace an applVar with a treeVar."},Error:new Error};b=k,E[g]=b}}var w=f.ptGetNode(r,E);d[v]=w,"F"===e.hyps[v].typ&&s.isNone(t.err)&&s.isNone(u)&&(T(r,w,l.inSyntax,_),s.isNone(f.pnGetProof(w))&&(u=f.pnGetExpr(w))),v=v+1|0}var I=void 0!==t.err?t.err:s.map(u,(function(r){return{TAG:"UnprovedFloating",expr:r}}));return void 0!==I?0!==y?void C.push({TAG:"AssertionWithErr",args:d,frame:e,err:I}):void 0:void C.push({TAG:"Assertion",args:d,frame:e})}})),C}function b(r,t){return"object"==typeof t&&"Assertion"===t.TAG&&t.args.some((function(t){return a.exprEq(r,f.pnGetExpr(t))}))}function k(r,t,e,n){var o=f.pnGetBottomUpProverParams(r);if(void 0!==o){var i=o.updateParams;return void 0!==i?f.pnSetBottomUpProverParams(r,i(o,f.pnGetExpr(r),t,e,n)):void 0}}function S(r,t,e){return void 0!==r?r<=t&&(void 0===e||t<=e):void 0===e||t<=e}function C(r,t,e){return void 0===t||t.some((function(t){if(!t.matchAsrt)return!0;var n=t.frm;if(r[0]!==n.frame.asrt[0])return!1;var o={contents:!1};return m.iterateSubstitutions(n.frame.asrt,r,n.frmConstParts[n.numOfHypsE],n.constParts[n.numOfHypsE],n.varGroups[n.numOfHypsE],n.subs,e,(function(r){return o.contents=!0,"Stop"})),o.contents}))}function w(r,t,e,o,c,d,v,l){void 0!==o?function(r,t,e,o,u,c,d){(function(r,t,e,o,i,u){var c=function(r){return a.ctxIntToSym(f.ptGetProofCtx(t),r)},d=function(r){return a.ctxSymToInt(f.ptGetProofCtx(t),r)},v=p.make(),l=String(i),m=x.progressTrackerMake(.01,void 0,(function(r){}),void 0);f.ptClearDists(t);var h=f.ptGetNode(t,e);f.pnSetDist(h,0),f.pnSetBottomUpProverParams(h,r),p.add(v,h);for(var E=0,g=1,_=0,T=s.map(u,(function(r){return function(t){r("Proving bottom-up: 0/"+l+" "+String(t))}}));s.isNone(f.pnGetProof(h))&&!p.isEmpty(v);){var A=s.getExn(p.pop(v));if(s.isNone(f.pnGetProof(A))){var S,C=f.pnGetDist(A);if(void 0===C)throw{RE_EXN_ID:n.MmException,_1:{msg:"Encountered a node without dist."},Error:new Error};if(S=C,void 0!==u){if(E!==S){T=void 0,E=S;var w=String(S);m=x.progressTrackerMake(.01,void 0,function(r){return function(t){var e=String(0|Math.round(100*t));u("Proving bottom-up: "+r+"/"+l+" "+e+"%")}}(w),void 0),g=p.size(v)+1|0,_=0}x.progressTrackerSetCurrPct(m,_/g),_=_+1|0}var I=f.pnGetExpr(A),M=y(t,I);if(void 0!==M)f.pnAddParent(A,M,!0,!1);else{var G=S+1|0;if(G<=i){k(A,S,c,d);var j=f.pnGetBottomUpProverParams(A);void 0!==j&&o(j,I,S,T).forEach(function(r,t,e){return function(n){b(t,n)||(f.pnAddParent(r,n,!0,!1),"object"==typeof n&&"Assertion"===n.TAG&&n.args.forEach((function(t){if(s.isNone(f.pnGetDist(t)))return f.pnSetDist(t,e),f.pnSetBottomUpProverParams(t,f.pnGetBottomUpProverParams(r)),s.isNone(f.pnGetProof(t))?p.add(v,t):void 0})))}}(A,I,G))}}}}})(e,r,t,(function(t,e,n,a){for(var s=[],d=0,v=t.assertionParams.length;d<v;++d){var l=t.assertionParams[d];if(S(l.minDist,n,l.maxDist)&&C(e,l.matches,f.ptGetParenCnt(r))){var m,p=A(r,e,l.deriveFrom,!1,l.allowNewStatements,l.allowNewVariables,l.allowNewDisjointsForExistingVariables,l.assertionsToUse,o,u,c,l.maxNumberOfBranches,a),h=0;switch(l.statementLengthRestriction){case"No":m=p;break;case"LessEq":case"Less":h=1}if(1===h){var E=e.length;m=p.filter(function(r,t){return function(e){if("object"!=typeof e)return!0;if("Assertion"!==e.TAG)return!0;for(var n=e.frame,o=e.args,i=!0,a=n.hyps.length-1|0,s=0;s<=a&&i;){var u=o[s];if("E"===n.hyps[s].typ){var c;switch(r.statementLengthRestriction){case"No":c=!0;break;case"LessEq":c=f.pnGetExpr(u).length<=t;break;case"Less":c=f.pnGetExpr(u).length<t}i=c}s=s+1|0}return i}}(l,E))}var x=l.matches,y=void 0!==x?m.filter(function(t){return function(n){return t.some((function(t){return g.exprSrcMatches(e,n,t,f.ptGetParenCnt(r))}))}}(x)):m;s.push(y)}}return i.concatMany(s)}),e.maxSearchDepth,d),f.ptGetNode(r,t)}(r,t,o,c,d,v,l):void 0!==e?function(r,t,e,n,o){var i=function(i,a){return A(r,t,i,!0,!1,!1,!1,[e.label],n,o,a,void 0,void 0)},a=f.ptGetNode(r,t),c=function(r,t){var e=t.args.map((function(t){var e=f.ptGetRootStmts(r).find((function(r){return r.label===t}));if(void 0!==e)return e.expr;var n=f.ptGetHypByLabel(r,t);return void 0!==n?n.expr:void 0})).filter(s.isSome).map(s.getExn);if(e.length===t.args.length)return e}(r,e);void 0!==c&&s.getWithDefault(s.map(f.pnGetProof(a),(function(r){return!f.jstfEqSrc(c,e.label,r)})),!0)&&(E.arrForEach(i(c,0),(function(r){var t=f.jstfEqSrc(c,e.label,r);if(f.pnAddParent(a,r,!0,t),t)return u.some(void 0)})),s.isNone(f.pnGetProof(a))&&E.arrForEach(i(c,2),(function(r){var t=f.jstfEqSrc(c,e.label,r);if(f.pnAddParent(a,r,!0,t),t)return u.some(void 0)})))}(r,t,e,c,d):function(r,t,e,n){var o=f.ptGetNode(r,t);if(s.isNone(f.pnGetProof(o))){var i=A(r,t,f.ptGetRootStmts(r).map((function(r){return r.expr})),!1,!1,!1,!1,void 0,e,n,void 0,void 0,void 0);E.arrForEach(i,(function(r){return f.pnAddParent(o,r,!0,!1),f.pnGetProof(o)}))}}(r,t,c,d)}function I(r,t,e){var n=f.ptMake(r,t,e);return d.forEach(a.getAllHyps(r),(function(r,t){if("E"===t.typ){var e=f.ptGetNode(n,t.expr);f.pnAddParent(e,{TAG:"Hypothesis",label:r},!0,!1),f.ptAddRootStmt(n,{isHyp:!0,label:r,expr:t.expr,jstf:void 0})}})),n}function M(r,t,e,o,i,a,c,d){if(s.isNone(r)&&(s.isNone(t)||s.isNone(e)||s.isNone(i)))throw{RE_EXN_ID:n.MmException,_1:{msg:"Either proofTree or (wrkCtx and frms and parenCnt) should be passed."},Error:new Error};var v=x.progressTrackerMake(.01,void 0,d,void 0),l=void 0!==r?u.valFromOption(r):I(s.getExn(t),s.getExn(e),s.getExn(i));if(0===c.length)return l;for(var m=n.arrayQueueMake(1e3),p=c[0],h=0,E=a.length;h<E;++h){var g=a[h],y=f.ptGetNode(l,[p].concat(g));T(l,y,o,m);for(var _=0;s.isNone(f.pnGetProof(y))&&_<c.length;){var A=c[_];_=_+1|0,A!==p&&T(l,y=f.ptGetNode(l,[A].concat(g)),o,m)}void 0!==f.pnGetProof(y)&&(f.ptAddSyntaxProof(l,g,y),p=f.pnGetExpr(y)[0]),x.progressTrackerSetCurrPct(v,(h+1|0)/a.length)}return l}function G(r,t){var e=a.createContext(u.some(r),void 0);return t.forEach((function(t){if(t.isHyp)return a.applySingleStmt(e,{TAG:"Essential",label:t.label,expr:a.ctxIntsToSymsExn(r,t.expr)},void 0,void 0,void 0,void 0)})),e}function j(r,t,e){return r.slice(t,e).sort()}function D(r,t,e,n){return o.equal(j(r,e,n),j(t,e,n))}t.createProofCtx=G,t.proveFloatings=function(r,t,e,o,i){var a=I(r,t,i),s=n.arrayQueueMake(1e3);return o.forEach((function(r){T(a,f.ptGetNode(a,r),e,s)})),a},t.proveSyntaxTypes=M,t.unifyAll=function(r,t,e,o,i,a,c,d,v,l,m){var p=void 0!==l?l:0,h=x.progressTrackerMake(.01,void 0,s.map(m,(function(r){return function(t){r("Unifying all: "+n.floatToPctStr(t))}})),void 0),E=I(G(r,e),t,o);void 0!==d&&d.length>0&&void 0!==v&&M(u.some(E),void 0,void 0,a.inSyntax,void 0,v,d,s.map(m,(function(r){return function(t){r("Checking syntax: "+n.floatToPctStr(t))}})));var g=e.filter((function(r){return!r.isHyp})),y=g.length,_=y-1|0;return g.forEach((function(r,t){w(E,r.expr,r.jstf,t===_?i:void 0,a,c,p,t!==_||s.isNone(i)?void 0:m),f.ptAddRootStmt(E,r),x.progressTrackerSetCurrPct(h,(t+1|0)/y)})),E},t.makeParenCnt=function(r,t){var e=a.ctxGetOptimizedConstsOrder(r,t),i=e.canBeLastMax,s=e.canBeLastMin,u=e.canBeFirstMax,c=e.canBeFirstMin,f=e.parenMin,d=e.allConsts,v=a.getAllConsts(r);if(d.length!==v.length)throw{RE_EXN_ID:n.MmException,_1:{msg:"allConsts.length != allConstsActual.length"},Error:new Error};if(f<0&&o.notequal(d.slice(0,0|-f),v.slice(0,0|-f)))throw{RE_EXN_ID:n.MmException,_1:{msg:"allConsts.parens != allConstsActual.parens"},Error:new Error};if(c<=u&&!D(d,v,(0|-u)-1|0,0|-c))throw{RE_EXN_ID:n.MmException,_1:{msg:"allConsts.canBeFirst != allConstsActual.canBeFirst"},Error:new Error};if(s<=i&&!D(d,v,(0|-i)-1|0,0|-s))throw{RE_EXN_ID:n.MmException,_1:{msg:"allConsts.canBeLast != allConstsActual.canBeLast"},Error:new Error};if(!D(d,v,0,d.length))throw{RE_EXN_ID:n.MmException,_1:{msg:"allConsts.remaining != allConstsActual.remaining"},Error:new Error};return l.parenCntMake(f,c,u,s,i)}},5090:(r,t,e)=>{var n=e(4923);t.jstfEq=function(r,t){return r.label===t.label&&n.equal(r.args,t.args)},t.jstfToStr=function(r){return(r.args.join(" ")+" : "+r.label).trim()}},1874:(r,t,e)=>{var n=e(2971),o=e(3333),i=e(1094),a=e(6517),s=e(303),u=e(7356),c=e(4792),f=e(2275),d=e(8615),v=e(5047);function l(r,t,e){return r<0?t[0][0]:r<(t.length-1|0)?(t[r+1|0][0]-t[r][1]|0)-1|0:(e-t[r][1]|0)-1|0}function m(r,t,e){return r<0?t.begins[0]:r<(t.length-1|0)?(t.begins[r+1|0]-t.ends[r]|0)-1|0:(e-t.ends[r]|0)-1|0}function p(r){for(var t=[],e=0,n=r.length;e<n;++e){var o=t.length;r[e]<0?(0===o||t[o-1|0][1]>=0)&&t.push([e,-1]):o>0&&t[o-1|0][1]<0&&(t[o-1|0][1]=e-1|0)}var i=t.length,a=r.length;i>0&&t[i-1|0][1]<0&&(t[i-1|0][1]=a-1|0);for(var s=new Array(i),u=new Array(i),c=new Array(i),f={length:i,begins:s,ends:u,remainingMinLength:c},d=0,v=i-1|0;v>=0;--v)s[v]=t[v][0],u[v]=t[v][1],d=(d+(1+(u[v]-s[v]|0)|0)|0)+l(v,t,a)|0,c[v]=d;return f}function h(r){return{length:r.length,begins:new Array(r.length),ends:new Array(r.length),remainingMinLength:[]}}function E(r,t,e,n,o,i,s){var u=function(){return E(r,t,e,n,o+1|0,i,s)},f=t.length,d=r.length;if(f<d)return"Continue";if(o===e.length){if(e.length<=0)return c.parenCntCanBeFirst(i,t[0])&&c.parenCntCanBeLast(i,t[f-1|0])?s(n):"Continue";if(n.ends[o-1|0]===(f-1|0))return s(n);if(e.ends[o-1|0]===(d-1|0))return"Continue";var v=m(o-1|0,e,d);if(m(o-1|0,n,f)<v)return"Continue";if(!c.parenCntCanBeFirst(i,t[n.ends[o-1|0]+1|0])||!c.parenCntCanBeLast(i,t[f-1|0]))return"Continue";c.parenCntReset(i);for(var l="Balanced",p=n.ends[o-1|0]+1|0;p<f&&"Failed"!==l;)l=c.parenCntPut(i,t[p]),p=p+1|0;return"Balanced"===l?s(n):"Continue"}if(0===o&&0===e.begins[0]){if((f-1|0)<e.ends[0])return"Continue";for(var h,x=e.ends[0],g=0;a.isNone(h)&&g<=x;)r[g]!==t[g]&&(h="Continue"),g=g+1|0;return void 0!==h?h:x===(f-1|0)||c.parenCntCanBeFirst(i,t[x+1|0])?(n.begins[0]=0,n.ends[0]=x,u()):"Continue"}var y=0===o?0:n.ends[o-1|0]+1|0,_=f-e.remainingMinLength[o]|0;c.parenCntReset(i);for(var T="Balanced",A=m(o-1|0,e,d),b=1;b<=A;++b)T=c.parenCntPut(i,t[y]),y=y+1|0;for(var k=1+(e.ends[o]-e.begins[o]|0)|0,S="Continue";y<=_&&"Failed"!==T&&"Continue"===S;){if("Balanced"===T){for(var C=0,w=!0;C<k&&w;)w=r[e.begins[o]+C|0]===t[y+C|0],C=C+1|0;var I=(y+k|0)-1|0;C===k&&w&&c.parenCntCanBeLast(i,t[y-1|0])&&(I===(f-1|0)||c.parenCntCanBeFirst(i,t[I+1|0]))&&(n.begins[o]=y,n.ends[o]=I,S=u(),c.parenCntReset(i))}T=c.parenCntPut(i,t[y]),y=y+1|0}return S}function x(r,t){var e=r.length;if(0===t.length)return[{leftConstPartIdx:-1,frmExpr:r,varsBeginIdx:0,numOfVars:e,exprBeginIdx:0,exprEndIdx:0}];var n=[];0!==t.begins[0]&&n.push({leftConstPartIdx:-1,frmExpr:r,varsBeginIdx:0,numOfVars:t.begins[0],exprBeginIdx:0,exprEndIdx:0});for(var o=0,i=t.length-2|0;o<=i;++o)n.push({leftConstPartIdx:o,frmExpr:r,varsBeginIdx:t.ends[o]+1|0,numOfVars:m(o,t,e),exprBeginIdx:0,exprEndIdx:0});var a=t.length-1|0;return t.ends[a]!==(e-1|0)&&n.push({leftConstPartIdx:a,frmExpr:r,varsBeginIdx:t.ends[a]+1|0,numOfVars:m(a,t,e),exprBeginIdx:0,exprEndIdx:0}),n}function g(r,t,e,n,o,i,a,s){var u=e[n],f=u.frmExpr[u.varsBeginIdx+o|0],d=(1+(u.exprEndIdx-i|0)|0)-((u.numOfVars-o|0)-1|0)|0,v=function(c){return o<(u.numOfVars-1|0)?g(r,t,e,n,o+1|0,i+c|0,a,s):n<(e.length-1|0)?g(r,t,e,n+1|0,0,e[n+1|0].exprBeginIdx,a,s):s(t)},l="Continue";if(t.isDefined[f]){var m=t.exprs[f],p=t.begins[f],h=1+(t.ends[f]-p|0)|0;if(h<=d&&(o<(u.numOfVars-1|0)||h===d)){for(var E=0;E<h&&m[p+E|0]===r[i+E|0];)E=E+1|0;E===h&&(l=v(h))}}else{if(t.isDefined[f]=!0,t.exprs[f]=r,t.begins[f]=i,o===(u.numOfVars-1|0))t.ends[f]=u.exprEndIdx,l=v(d);else if(c.parenCntCanBeFirst(a,r[i])){var x=1,y=i;c.parenCntReset(a);for(var _="Balanced";x<=d&&"Continue"===l&&"Failed"!==_;)t.ends[f]=y,"Balanced"===(_=c.parenCntPut(a,r[y]))&&c.parenCntCanBeLast(a,r[y])&&(l=v(x),c.parenCntReset(a)),x=x+1|0,y=y+1|0}t.isDefined[f]=!1}return l}function y(r,t,e,n,i,a,s,u){if(0===a.size)return o.exprEq(r,t)?u(a):"Continue";var c=t.length,f=r.length;if(c<f||0===c||0===f)return"Continue";var d=r[f-1|0];if(d<0&&d!==t[c-1|0])return"Continue";var l=r[0];return l<0&&l!==t[0]?"Continue":E(r,t,e,n,0,s,(function(r){return i.length>0?(function(r,t,e){var n=e.length;0===t.length?(r[0].exprBeginIdx=0,r[0].exprEndIdx=n-1|0):(r.forEach((function(r){-1===r.leftConstPartIdx?(r.exprBeginIdx=0,r.exprEndIdx=t.begins[0]-1|0):r.leftConstPartIdx===(t.length-1|0)?(r.exprBeginIdx=t.ends[r.leftConstPartIdx]+1|0,r.exprEndIdx=n-1|0):(r.exprBeginIdx=t.ends[r.leftConstPartIdx]+1|0,r.exprEndIdx=t.begins[r.leftConstPartIdx+1|0]-1|0)})),v.sortInPlaceWith(r,(function(r,t){return r.numOfVars-t.numOfVars|0})))}(i,r,t),g(t,a,i,0,0,i[0].exprBeginIdx,s,u)):u(a)}))}function _(r){return{size:r,begins:n.make(r,0),ends:n.make(r,0),exprs:n.make(r,[]),isDefined:n.make(r,!1)}}function T(r){var t=r.hyps.filter((function(r){return"E"===r.typ})),e=[],n=[],o=[];t.forEach((function(r){var t=p(r.expr),i=h(t),a=x(r.expr,t);e.push(t),n.push(i),o.push(a)}));var i=p(r.asrt),a=h(i),s=x(r.asrt,i);e.push(i),n.push(a),o.push(s);var u=_(r.numOfVars);return{frame:r,hypsE:t,numOfHypsE:t.length,frmConstParts:e,constParts:n,varGroups:o,subs:u}}t.subsClone=function(r){return{size:r.size,begins:r.begins.slice(),ends:r.ends.slice(),exprs:r.exprs.slice(),isDefined:r.isDefined.slice()}},t.subsEq=function(r,t){if(r.size!==t.size||!r.isDefined.every((function(r){return r}))||!t.isDefined.every((function(r){return r})))return!1;for(var e=!0,n=0;e&&n<r.size;){var o=r.exprs[n],i=r.begins[n],a=r.ends[n],s=1+(a-i|0)|0,u=t.exprs[n],c=t.begins[n];if(s===(1+(t.ends[n]-c|0)|0))for(var f=i,d=c;e&&f<=a;)e=o[f]===u[d],f=f+1|0,d=d+1|0;else e=!1;n=n+1|0}return e},t.subsHash=function(r){if(!r.isDefined.every((function(r){return r})))return 0;for(var t=0,e=0;e<r.size;)t=v.hash2(t,v.hashArrIntFromTo(r.exprs[e],r.begins[e],r.ends[e])),e=e+1|0;return t},t.createConstParts=p,t.createMatchingConstParts=h,t.createSubs=_,t.prepareFrmSubsDataForFrame=T,t.prepareFrmSubsData=function(r){var t=v.comparatorAndThen(v.comparatorByInt((function(r){return r.hypsE.length})),v.comparatorByInt((function(r){return r.frame.ord}))),e=v.sortInPlaceWith(o.getAllFramesArr(r).map(T),t),n=f.make(1e3),i=u.make(16);return e.forEach((function(r){f.set(n,r.frame.label,r);var t=r.frame.asrt[0],e=u.get(i,t);return void 0!==e?void e.push(r):u.set(i,t,[r])})),{all:e,byType:i,byLabel:n}},t.sortFrames=function(r,t){var e=d.fromArray(t);return r.all.filter((function(r){return d.has(e,r.frame.label)})).map((function(r){return r.frame.label}))},t.iterateSubstitutions=y,t.applySubs=function(r,t,e){var n={contents:0};r.forEach((function(r){r<0||!t.isDefined[r]?n.contents=n.contents+1|0:n.contents=n.contents+(1+(t.ends[r]-t.begins[r]|0)|0)|0}));for(var o=new Array(n.contents),i=0,a=0;a<n.contents;){var s=r[i];if(s<0)o[a]=s,a=a+1|0;else if(t.isDefined[s]){var u=t.exprs[s],c=1+(t.ends[s]-t.begins[s]|0)|0;v.copySubArray(u,t.begins[s],o,a,c),a=a+c|0}else o[a]=e(s),a=a+1|0;i=i+1|0}return o},t.verifyDisjoints=function(r,t,e,n){var o={contents:void 0};return i.forEach(r,(function(r,i){if(a.isNone(o.contents))return s.forEach(i,(function(i){if(a.isNone(o.contents))for(var s=t.exprs[r],u=t.begins[r],c=t.ends[r],f=t.exprs[i],d=t.begins[i],v=t.ends[i],l=u;l<=c;++l)if(a.isNone(o.contents)){var m=s[l];if(m>=0)for(var p=d;p<=v;++p)if(a.isNone(o.contents)){var h=f[p];h>=0&&(m===h?o.contents=0===n?"UnifErr":{TAG:"DisjCommonVar",frmVar1:r,expr1:s.slice(u,c+1|0),frmVar2:i,expr2:f.slice(d,v+1|0),commonVar:m}:e(m,h)||(o.contents=0===n?"UnifErr":{TAG:"Disj",frmVar1:r,expr1:s.slice(u,c+1|0),var1:m,frmVar2:i,expr2:f.slice(d,v+1|0),var2:h}))}}}))})),o.contents},t.frmsEmpty=function(){return{all:[],byType:u.make(0),byLabel:f.make(0)}},t.frmsSize=function(r){return r.all.length},t.frmsForEach=function(r,t,e){return void 0!==t?a.forEach(u.get(r.byType,t),(function(r){r.forEach(e)})):void r.all.forEach(e)},t.frmsGetAll=function(r){return r.all},t.frmsGetByLabel=function(r,t){return f.get(r.byLabel,t)},t.frmsGetByType=function(r,t){return u.get(r.byType,t)},t.frmsSelect=function(r,t,e){if(void 0!==t){if(void 0!==e){var n=a.keep(f.get(r.byLabel,e),(function(r){return r.frame.asrt[0]===t}));return void 0!==n?[n]:[]}var o=u.get(r.byType,t);return void 0!==o?o.slice():[]}if(void 0===e)return r.all.slice();var i=f.get(r.byLabel,e);return void 0!==i?[i]:[]},t.frmsGetAllTypes=function(r){return u.keysToArray(r.byType)},t.frmsGetAllGroupedByLabel=function(r){return r.byLabel},t.test_iterateConstParts=function(r,t,e){var n=function(r){return r.begins.map((function(t,e){return[t,r.ends[e]]}))},o=p(r),i=h(o),a=[];return E(r,t,o,i,0,e,(function(r){return a.push(n(r)),"Continue"})),[n(o),a]},t.test_iterateSubstitutions=function(r,t,e){var n=p(r),o=h(n),i=x(r,n),a=s.size(s.fromArray(r.filter((function(r){return r>=0})))),u=_(a),c=[];return y(r,t,n,o,i,u,e,(function(r){for(var t=[],e=0;e<a;++e)t.push(r.exprs[e].slice(r.begins[e],r.ends[e]+1|0));return c.push(t),"Continue"})),c}},3591:(r,t,e)=>{var n=e(4923),o=e(2971),i=e(3333),a=e(6517),s=e(303),u=e(2761),c=e(3533),f=e(368),d=e(1717),v=e(2275),l=e(5047);function m(r){return u.reduce(r,0,(function(r,t){return Math.max(r,function(r){return"Subtree"===r.TAG?r._0.height:0}(t))}))}function p(r,t,e,n){var s=n.proof;if("Hypothesis"===s.TAG){for(var u=s.label,c=n.expr.length-1|0,f=r(),d=n.expr[0],v=new Array(c),l=1;l<=c;++l)v[l-1|0]={TAG:"Symbol",id:r(),symInt:n.expr[l],sym:i.ctxIntToSymExn(t,n.expr[l]),color:void 0,isVar:n.expr[l]>=0};return{TAG:"Ok",_0:{id:f,typ:d,label:u,children:v,height:m(v)+1|0}}}var h=s.label,E=i.getFrame(t,h);if(void 0===E)return{TAG:"Error",_0:"Cannot find a frame by label '"+h+"' in buildSyntaxTreeInner."};var x=function(r,t){var e=new Array(t.numOfVars),n=o.make(t.numOfVars,!1);if(r.length!==t.numOfArgs)return{TAG:"Error",_0:"extractVarToRecIdxMapping: args.Array.length != frame.numOfArgs"};var i={contents:void 0};t.hyps.forEach((function(t,o){if(a.isNone(i.contents)&&"F"===t.typ){var s=t.expr[1];n[s]?i.contents={TAG:"Error",_0:"extractVarToRecIdxMapping: locks[v]"}:(n[s]=!0,e[s]=r[o])}}));var s=i.contents;return void 0!==s?s:n.some((function(r){return!r}))?{TAG:"Error",_0:"extractVarToRecIdxMapping: locks->Array.some(lock => !lock)"}:{TAG:"Ok",_0:e}}(s.args,E);if("Ok"!==x.TAG)return{TAG:"Error",_0:x._0};var g=x._0,y=r(),_=E.asrt[0],T=new Array(E.asrt.length-1|0),A={contents:void 0};E.asrt.forEach((function(n,o){if(o>0&&a.isNone(A.contents))if(n<0)T[o-1|0]={TAG:"Symbol",id:r(),symInt:n,sym:i.ctxIntToSymExn(t,n),color:void 0,isVar:!1};else{var s=p(r,t,e,e[g[n]]);"Ok"===s.TAG?T[o-1|0]={TAG:"Subtree",_0:s._0}:A.contents={TAG:"Error",_0:s._0}}}));var b=A.contents;return void 0!==b?b:{TAG:"Ok",_0:{id:y,typ:_,label:h,children:T,height:m(T)+1|0}}}function h(r,t,e){var n={contents:0};return p((function(){return n.contents=n.contents+1|0,n.contents-1|0}),r,t,t[e])}function E(r,t,e){var n=t.nodes.find((function(r){return i.exprEq(r.expr,e)}));return void 0!==n?{TAG:"Ok",_0:d.createProofTable(t,n,void 0,void 0)}:{TAG:"Error",_0:"buildSyntaxProofTableFromProofTreeDto: could not find a proof for: "+i.ctxIntsToStrExn(r,e)}}function x(r,t){if(1===r.children.length){var e=r.children[0];if("Subtree"!==e.TAG){var n=e.sym;return e.isVar&&t(n)?[e.symInt,n]:void 0}}}function g(r,t){v.forEach(t,(function(t,e){for(var n=0;n<r.length;)r[n]===t?(c.spliceObjApply(r,"splice",[n,1,e]),n=n+e.length|0):n=n+1|0}))}function y(r,t,e){if(g(e,r),e.includes(t))return!1;var o=v.get(r,t);return void 0!==o?n.equal(e,o):(v.set(r,t,e),v.forEach(r,(function(t,e){g(e,r)})),!0)}function _(r){return l.arrFlatMap(r.children,(function(r){return"Subtree"===r.TAG?_(r._0):[r.sym]}))}function T(r,t,e){var o=[t];g(o,r);var i=[e];return g(i,r),n.equal(o,i)}function A(r,t){return f.traverseTree(void 0,r,(function(r,t){if("Subtree"===t.TAG)return t._0.children}),void 0,(function(r,e){return t(e)}),void 0)[1]}t.buildSyntaxTree=h,t.buildSyntaxProofTableFromProofTreeDto=E,t.buildSyntaxTreeFromProofTreeDto=function(r,t,e){var n=E(r,t,e);if("Ok"!==n.TAG)return{TAG:"Error",_0:n._0};var o=n._0;return h(r,o,o.length-1|0)},t.syntaxTreeToSymbols=function r(t){return o.concatMany(t.children.map((function(t){return"Subtree"===t.TAG?r(t._0):[t.sym]})))},t.syntaxTreeIsEmpty=function(r){return 0===r.children.length},t.getNodeById=function(r,t){return f.traverseTree(void 0,{TAG:"Subtree",_0:r},(function(r,t){if("Subtree"===t.TAG)return t._0.children}),void 0,(function(r,e){if(("Subtree"===e.TAG?e._0.id:e.id)===t)return e}),void 0)[1]},t.syntaxTreeForEachNode=A,t.syntaxTreeGetIdsOfAllChildSymbols=function(r){var t=[];return A(r,(function(r){"Subtree"!==r.TAG&&t.push(r.id)})),s.fromArray(t)},t.syntaxTreeToText=function(r){var t=[];return A(r,(function(r){"Subtree"!==r.TAG&&t.push(r.sym)})),t.join(" ")},t.syntaxTreeGetNumberOfSymbols=function(r){var t={contents:0};return A(r,(function(r){"Subtree"!==r.TAG&&(t.contents=t.contents+1|0)})),t.contents},t.syntaxTreeGetParent=function r(t,e){return u.reduce(t.children,void 0,(function(n,o){if(void 0!==n)return n;if("Subtree"!==o.TAG)return o.id===e?t:void 0;var i=o._0;return i.id===e?t:r(i,e)}))},t.isVar=x,t.unify=function r(t,e,n,o,i){var a=x(t,n);if(void 0===a){var s=x(e,n);if(void 0===s)if(t.children.length===e.children.length)for(var u=t.children.length-1|0,c=0;i.contents&&c<=u;){var f=t.children[c];if("Subtree"===f.TAG){var d=f._0,v=e.children[c];if("Subtree"===v.TAG)r(d,v._0,n,o,i);else{var l=v.sym;i.contents=v.isVar&&n(l)&&y(o,l,_(d))}}else{var m=f.isVar,p=f.sym,h=e.children[c];if("Subtree"===h.TAG)i.contents=m&&n(p)&&y(o,p,_(h._0));else{var E=h.sym;i.contents=T(o,p,E)||m&&n(p)&&y(o,p,[E])||h.isVar&&n(E)&&y(o,E,[p])}}c=c+1|0}else i.contents=!1;else i.contents=y(o,s[1],_(t))}else{var g=a[1],A=x(e,n);if(void 0===A)return void(i.contents=y(o,g,_(e)));var b=A[1];i.contents=T(o,g,b)||y(o,g,[b])}}},1725:(r,t)=>{function e(r,t){return r.map((function(r,e){return String(e+1|0)+": "+(0===r.length?"?":t(r))})).join("\n")}t.unifErrToStr=function(r,t,n){if("object"!=typeof r)return"Details of the error were not stored.";switch(r.TAG){case"DisjCommonVar":var o=String.fromCharCode(8594);return"Unsatisfied disjoint, common variable "+t([r.commonVar])+":\n"+n([r.frmVar1])+" "+o+" "+t(r.expr1)+"\n"+n([r.frmVar2])+" "+o+" "+t(r.expr2);case"Disj":var i=String.fromCharCode(8594);return"Missing disjoint "+t([r.var1])+","+t([r.var2])+":\n"+n([r.frmVar1])+" "+i+" "+t(r.expr1)+"\n"+n([r.frmVar2])+" "+i+" "+t(r.expr2);case"UnprovedFloating":return"Could not prove this floating statement:\n"+t(r.expr);case"NoUnifForAsrt":var a=String.fromCharCode(8594);return"Could not find a match for assertion:\n"+n(r.asrtExpr)+"\n"+a+"\n"+t(r.expr);case"NoUnifForArg":var s=r.args,u=0===s.length?"":":";return"Could not match essential hypothesis #"+String(r.errArgIdx+1|0)+u+"\n"+e(s,t);case"NewVarsAreDisabled":var c=r.errArgIdx,f=r.args;return"New variables are not allowed, but one had to be created when unifying "+(f.length===c?"assertion":"essential hypothesis #"+String(c+1|0))+(0===f.length?"":":")+"\n"+e(f,t);case"TooManyCombinations":var d=r.frmLabels;return void 0!==d?"Some assertions produce too big search space. Only part of that search space was examined. Those assertions are: "+d.join(", ")+" .":"This assertion produces too big search space. Only part of that search space was examined."}}},5291:(r,t,e)=>{var n=e(6253),o=e(2971),i=e(6517),a=e(7175),s=e(2448),u=e(7356),c=e(6181),f=e(4518),d=String.fromCharCode(160),v=String.fromCharCode(9679),l=c.create("Common.MmException");function m(r){var t=f.as_js_exn(r);return{exn:r,msg:s.getOr(s.flatMap(t,(function(r){return r.message})),"Unknown error."),stack:s.getOr(s.flatMap(t,(function(r){return r.stack})),"")}}function p(r,t){var e=r.depVer;if(void 0!==e&&r.depVerEq(a.valFromOption(e),t))return r.data}function h(r,t){return r.split(t).map((function(r){return i.getWithDefault(r,"").trim()})).filter((function(r){return r.length>0}))}var E=/[\n\r]/,x=/[\s\n\r\f]/;function g(r){return h(r,x)}var y=/\+/g,_=/-/g,T=/\//g,A=/_/g;t.nbsp=d,t.circleChar=v,t.MmException=l,t.panic=function(r){throw{RE_EXN_ID:l,_1:{msg:r},Error:new Error}},t.jsErrorToExnData=m,t.catchExn=function(r){try{return{TAG:"Ok",_0:r()}}catch(r){var t=f.internalToOCamlException(r);return t.RE_EXN_ID===l?{TAG:"Error",_0:{exn:void 0,msg:t._1.msg,stack:""}}:{TAG:"Error",_0:m(t)}}},t.currTimeStr=function(){return new Date(Date.now()).toISOString()},t.compareDates=function(r,t){var e=r.getTime(),n=t.getTime();return e<n?-1:n<e?1:0},t.floatToPctStr=function(r){return String(0|Math.round(100*r))+"%"},t.cacheMake=function(r,t){return{recalc:r,depVerEq:t,depVer:void 0,data:void 0}},t.cacheGetByDepVer=p,t.cacheGet=function(r,t,e){var n=p(r,t);if(void 0!==n)return a.valFromOption(n);r.depVer=a.some(t);var o=r.recalc(e);return r.data=a.some(o),o},t.multilineTextToNonEmptyLines=function(r){return h(r,E)},t.getSpaceSeparatedValuesAsArray=g,t.strToBase64=function(r){return btoa(r)},t.base64ToStr=function(r){return atob(r)},t.strToSafeBase64=function(r){return btoa(r).replace(y,"-").replace(T,"_")},t.safeBase64ToStr=function(r){return atob(r.replace(A,"/").replace(_,"+"))},t.strToRegex=function(r){try{return{TAG:"Ok",_0:new RegExp(r)}}catch(e){var t=f.internalToOCamlException(e);return{TAG:"Error",_0:i.getWithDefault(i.flatMap(f.as_js_exn(t),(function(r){return r.message})),"could not create a regular expression from string '"+r+"'")}}},t.versionMake=function(r){return{ver:0,val:r}},t.versionSet=function(r,t){return{ver:r.ver+1|0,val:t}},t.arrayQueueMake=function(r){var t=new Array(r);return{begin:0,end:-1,maxEnd:t.length-1|0,data:t}},t.arrayQueueAdd=function(r,t){r.end===r.maxEnd&&(console.log("q.end == q.maxEnd"),r.data=o.concat(r.data,new Array(r.data.length)),r.maxEnd=r.data.length-1|0),r.end=r.end+1|0,r.data[r.end]=t},t.arrayQueuePop=function(r){if(!(r.begin>r.end)){var t=r.data[r.begin];return r.begin=r.begin+1|0,a.some(t)}},t.arrayQueueReset=function(r){r.begin=0,r.end=-1},t.createVarTypeComparator=function(r,t){var e=u.make(u.size(r));return u.forEach(r,(function(r,n){var o=u.get(t,n);if(void 0!==o)return u.set(e,r,o)})),function(r,t){var o=u.get(e,r);if(void 0!==o){var i=u.get(e,t);return void 0!==i?n.int_compare(o,i):-1}return void 0!==u.get(e,t)?1:0}},t.createVarNameComparator=function(r){return function(t,e){var n=u.get(r,t);if(void 0!==n){var o=u.get(r,e);return void 0!==o?n.localeCompare(o):-1}return void 0!==u.get(r,e)?1:0}},t.createTypeOrderFromStr=function(r,t){var e=u.make(4);return g(r).forEach((function(r){var n=t(r);if(void 0!==n)return u.set(e,n,u.size(e))})),e}},7653:(r,t,e)=>{var n=e(8723);function o(r,t){return n.div(1e5*r|0,t)}function i(r,t,e,n){var i=void 0!==n&&n,a=1e5*r|0,s=o(void 0!==t?t:0,a);return{step:a,numOfSteps:s,lastSentNumOfSteps:s,onProgress:e,dontDecrease:i}}function a(r,t){var e=r.onProgress;if(void 0!==e){var n,i,a=o(t,r.step);return r.dontDecrease&&a>r.lastSentNumOfSteps||!r.dontDecrease&&a!==r.lastSentNumOfSteps?(e((n=a,i=r.step,Math.imul(n,i)/1e5)),void(r.lastSentNumOfSteps=a)):void 0}}t.progressTrackerMake=i,t.progressTrackerSetCurrPct=a,t.progressTrackerIntMake=function(r,t,e,n,o){var a=void 0!==t?t:0;return{progressState:i(r,a/e,n,void 0!==o&&o),cnt:a,maxCnt:e,stepInt:Math.max(e*r/2|0,1)}},t.progressTrackerIntIncCnt=function(r){if(r.cnt=r.cnt+1|0,0===n.mod_(r.cnt,r.stepInt))return a(r.progressState,r.cnt/r.maxCnt)}},8944:(r,t,e)=>{var n=e(5291),o=e(2900),i=e(7175),a=r=>"string"==typeof r,s=r=>"boolean"==typeof r,u=r=>Array.isArray(r),c=r=>null!=r&&!Array.isArray(r)&&"object"==typeof r,f=r=>"function"==typeof r;function d(r,t){return null==r?o.raiseError("A required attribute is missing: "+t):r}t.isString=a,t.isBool=s,t.isArray=u,t.isObject=c,t.isFunction=f,t.reqStrExn=function(r,t){var e=d(r,t);return a(e)?e:o.raiseError("Not a string: "+t)},t.optStrExn=function(r,t){if(null!=r)return a(r)?r:o.raiseError("Not a string: "+t)},t.reqBoolExn=function(r,t){var e=d(r,t);return s(e)?e:o.raiseError("Not a boolean: "+t)},t.optBoolExn=function(r,t){if(null!=r)return s(r)?r:o.raiseError("Not a boolean: "+t)},t.reqArrExn=function(r,t){var e=d(r,t);return u(e)?e:o.raiseError("Not an array: "+t)},t.reqObjExn=function(r,t){var e=d(r,t);return c(e)?e:o.raiseError("Not an object: "+t)},t.optObjExn=function(r,t){if(null!=r)return c(r)?i.some(r):o.raiseError("Not an object: "+t)},t.reqFuncExn=function(r,t){var e=d(r,t);return f(e)?e:o.raiseError("Not a function: "+t)},t.invokeExnFunc=function(r,t){var e=n.catchExn(t);if("Ok"===e.TAG)return{TAG:"Ok",_0:e._0};var o=e._0,i=o.stack;return{TAG:"Error",_0:r+": "+o.msg+"."+(""!==i?"\n"+i:"")}},t.executeFunctionBody=r=>new Function("",r)(),t.executeAsyncFunctionBody=r=>new(0,Object.getPrototypeOf((async function(){})).constructor)(r)(),t.makeFunction=(r,t)=>new Function(r,t)},5376:(r,t,e)=>{var n=e(3333),o=e(2605),i="MM_wrk_FindParens";t.procName=i,t.beginFindParens=function(r,t,e){o.beginWorkerInteraction(i,{TAG:"FindParens",ctx:r},(function(r,n,o){if("FindParensProgress"===r.TAG)return t(r.pct);o(),e(r.parens)}),void 0,void 0,void 0)},t.processOnWorkerSide=function(r,t){var e,o=r.ctx;t({TAG:"FindParensDone",parens:(e=n.findParentheses(o,(function(r){t({TAG:"FindParensProgress",pct:r})})),n.ctxIntsToStrExn(o,e))})},t.reqToStr=function(r){return"FindParens"},t.respToStr=function(r){return"FindParensProgress"===r.TAG?"FindParensProgress(pct="+String(r.pct)+")":'FindParensDone(parens="'+r.parens+'")'}},5171:(r,t,e)=>{var n=e(5291),o=e(2900),i=e(3333),a=e(6517),s=e(7175),u=e(2761),c=e(2605),f=e(7709),d=e(4518),v="MM_wrk_LoadCtx";function l(r){var t=r.trim();if(0!==t.length){var e=n.strToRegex(t);if("Ok"===e.TAG)return s.some(e._0);throw{RE_EXN_ID:n.MmException,_1:{msg:"Could not parse a regex: "+e._0},Error:new Error}}}t.procName=v,t.beginLoadingMmContext=function(r,t,e,n,o,i,a){c.beginWorkerInteraction(v,{TAG:"LoadMmContext",scopes:r,descrRegexToDisc:t,labelRegexToDisc:e,descrRegexToDepr:n,labelRegexToDepr:o},(function(r,t,e){if("MmContextLoadProgress"===r.TAG)return i(r.pct);e(),a(r.ctx)}),void 0,void 0,void 0)},t.processOnWorkerSide=function(r,t){var e=r.labelRegexToDepr,c=r.descrRegexToDepr,f=r.labelRegexToDisc,v=r.descrRegexToDisc,m=r.scopes,p=u.reduce(m,0,(function(r,t){return r+t.expectedNumOfAssertions|0})),h=m.map((function(r){return r.expectedNumOfAssertions/p}));try{for(var E=i.createContext(void 0,void 0),x=0,g=m.length;x<g;++x){var y=m[x],_=u.reduceWithIndex(h,0,function(r){return function(t,e,n){return n<r?t+e:t}}(x)),T=h[x];if(i.loadContext(m[x].ast,s.some(E),y.stopBefore,y.stopAfter,void 0,y.expectedNumOfAssertions,l(v),l(f),l(c),l(e),function(r,e){return function(n){t({TAG:"MmContextLoadProgress",pct:r+n*e})}}(_,T),void 0),y.resetNestingLevel)for(;0!==i.getNestingLevel(E);)i.closeChildContext(E)}return t({TAG:"MmContextLoadProgress",pct:1}),t({TAG:"MmContextLoaded",ctx:{TAG:"Ok",_0:E}})}catch(r){var A=d.internalToOCamlException(r);if(A.RE_EXN_ID===n.MmException)return t({TAG:"MmContextLoaded",ctx:{TAG:"Error",_0:A._1.msg}});if(A.RE_EXN_ID===o.$$Error)return t({TAG:"MmContextLoaded",ctx:{TAG:"Error",_0:a.getWithDefault(A._1.message,"Internal error.")}});throw A}},t.reqToStr=function(r){return"LoadMmContext"},t.respToStr=function(r){return"MmContextLoadProgress"===r.TAG?"MmContextLoadProgress(pct="+String(r.pct)+")":"MmContextLoaded"},t.createMmScopesForFrame=function(r,t){var e=[];return u.reduce(r,!1,(function(r,o){if(r)return r;var i=function(r){switch(f.readInstrFromStr(r.readInstr)){case"ReadAll":return[void 0,void 0,r.allLabels];case"StopBefore":var t=r.allLabels.findIndex((function(t){return t===r.label}));return-1!==t?[r.label,void 0,r.allLabels.slice(0,t)]:[void 0,void 0,r.allLabels];case"StopAfter":var e=r.allLabels.findIndex((function(t){return t===r.label}));return-1!==e?[void 0,r.label,r.allLabels.slice(0,e+1|0)]:[void 0,void 0,r.allLabels]}}(o),a=i[2],s=a.includes(t)?[t,void 0,a.indexOf(t),!1]:[i[0],i[1],a.length,!0],u=s[2],c=o.ast;if(void 0===c)throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot create MM context for a frame without ast."},Error:new Error};var d={ast:c,expectedNumOfAssertions:u,stopBefore:s[0],stopAfter:s[1],resetNestingLevel:s[3]};return e.push(d),a.length!==u})),e}},8152:(r,t,e)=>{var n=e(5291),o=e(55),i=e(2605),a=e(4518),s="MM_wrk_ParseMmFile";t.procName=s,t.beginParsingMmFile=function(r,t,e){i.beginWorkerInteraction(s,{TAG:"ParseMmFile",mmFileText:r},(function(r,n,o){if("MmFileParseProgress"===r.TAG)return t(r.pct);o(),e(r.parseResult)}),void 0,void 0,void 0)},t.processOnWorkerSide=function(r,t){try{var e=o.parseMmFile(r.mmFileText,void 0,void 0,(function(r){t({TAG:"MmFileParseProgress",pct:r})}));return t({TAG:"MmFileParseProgress",pct:1}),t({TAG:"MmFileParsed",parseResult:{TAG:"Ok",_0:e}})}catch(r){var i=a.internalToOCamlException(r);if(i.RE_EXN_ID===n.MmException)return t({TAG:"MmFileParsed",parseResult:{TAG:"Error",_0:i._1.msg}});throw i}},t.reqToStr=function(r){return"ParseMmFile"},t.respToStr=function(r){return"MmFileParseProgress"===r.TAG?"MmFileParseProgress(pct="+String(r.pct)+")":"MmFileParsed"}},6862:(r,t,e)=>{var n=e(5291),o=e(6517);t.serialize=function(r){return r},t.deserialize=function(r){return r},t.logClientIsSendingRequest=function(r,t,e,i){var a=o.getWithDefault(o.map(i,(function(r){return r(e)})),"");console.log(n.currTimeStr()+" ["+String(r)+","+t+"] C~> "+a)},t.logClientReceivedResponse=function(r,t,e,i){var a=o.getWithDefault(o.map(i,(function(r){return r(e)})),"");console.log(n.currTimeStr()+" ["+String(r)+","+t+"] ->C "+a)},t.logWorkerIsSendingResponse=function(r,t,e,o){console.log(n.currTimeStr()+" ["+String(r)+","+t+"] W~> "+o(e))},t.logWorkerReceivedRequest=function(r,t,e,o){console.log(n.currTimeStr()+" ["+String(r)+","+t+"] ->W "+o(e))}},2605:(r,t,e)=>{var n=e(6862),o=e(6517),i=e(7175),a=e(6181),s=e(5047),u=a.create("MM_wrk_client.WorkerException"),c={contents:void 0},f=[],d={contents:0};t.beginWorkerInteraction=function(r,t,e,a,v,l){var m=void 0!==a&&a,p={contents:-1},h={contents:function(r){}};p.contents=function(r,t){var e=(d.contents=d.contents+1|0,d.contents-1|0);return f.push({id:e,callback:r,traceEnabled:t}),e}((function(t){var o=n.deserialize(t);m&&n.logClientReceivedResponse(p.contents,r,o,l),e(o,h.contents,(function(){for(var r=p.contents,t=0;t<f.length;)f[t].id===r?f.splice(t,1):t=t+1|0}))}),m),h.contents=function(t){m&&n.logClientIsSendingRequest(p.contents,r,t,v);var e={clientId:p.contents,procName:r,body:n.serialize(t),traceEnabled:m};if(o.isNone(c.contents)){var a=new Worker("./webworker-main.js");a.onmessage=function(r){var t=r.data;s.arrForEach(f,(function(r){if(r.id===t.clientId)return r.callback(t.body),i.some(void 0)}))},c.contents=i.some(a)}var d=c.contents;if(void 0!==d)return i.valFromOption(d).postMessage(e);throw{RE_EXN_ID:u,_1:"Could not instantiate a webworker.",Error:new Error}},h.contents(t)},t.terminateWorker=function(){var r=c.contents;if(void 0!==r)return i.valFromOption(r).terminate(),c.contents=void 0,void f.splice(0,f.length)}},9010:(r,t,e)=>{var n=e(5291),o=e(3333),i=e(7175),a=e(2761),s=e(4518);function u(r){var t=n.multilineTextToNonEmptyLines(r);return 0===t.length?{TAG:"Ok",_0:[]}:a.reduce(t,{TAG:"Ok",_0:[]},(function(r,t){if("Ok"!==r.TAG)return r;var e=r._0,o=function(r){var t=n.getSpaceSeparatedValuesAsArray(r);return 3!==t.length?{TAG:"Error",_0:"A line representing a variable definition should consist of exactly three parts separated with a whitespace."}:{TAG:"Ok",_0:t}}(t);return"Ok"!==o.TAG?{TAG:"Error",_0:o._0}:(e.push(o._0),{TAG:"Ok",_0:e})}))}t.prepareParenInts=function(r,t){for(var e=n.getSpaceSeparatedValuesAsArray(t),i=[],a=(e.length/2|0)-1|0,s=0;s<=a;++s){var u=e[s<<1],c=e[1+(s<<1)|0],f=o.ctxSymToInt(r,u);if(void 0!==f&&o.isConst(r,u)){var d=o.ctxSymToInt(r,c);void 0!==d&&o.isConst(r,c)&&(i.push(f),i.push(d))}}return i},t.textToVarDefs=u,t.createWrkCtx=function(r,t,e){var c=o.createContext(i.some(r),void 0),f=a.reduce([function(){var r=u(t);if("Ok"!==r.TAG){return{varsErr:r._0,disjErr:void 0}}try{return void r._0.forEach((function(r){o.applySingleStmt(c,{TAG:"Var",symbols:[r[2]]},void 0,void 0,void 0,void 0),o.applySingleStmt(c,{TAG:"Floating",label:r[0],expr:[r[1],r[2]]},void 0,void 0,void 0,void 0)}))}catch(r){var e=s.internalToOCamlException(r);if(e.RE_EXN_ID===n.MmException){return{varsErr:e._1.msg,disjErr:void 0}}throw e}},function(){try{return void n.multilineTextToNonEmptyLines(e).forEach((function(r){o.applySingleStmt(c,{TAG:"Disj",vars:r.split(" ").map((function(r){return r.trim()})).filter((function(r){return""!==r}))},void 0,void 0,void 0,void 0)}))}catch(t){var r=s.internalToOCamlException(t);if(r.RE_EXN_ID===n.MmException)return{varsErr:void 0,disjErr:r._1.msg};throw r}}],void 0,(function(r,t){return void 0!==r?r:t()}));return void 0!==f?{TAG:"Error",_0:f}:{TAG:"Ok",_0:c}}},9662:(r,t,e)=>{var n=e(5291),o=e(9592),i=e(7175),a=e(2605),s=e(1874),u=e(9010),c=e(5047),f=e(6848),d="MM_wrk_ctx",v={contents:void 0},l=n.cacheMake((function(r){return r}),(function(r,t){return r===t})),m=n.cacheMake((function(r){return r}),(function(r,t){return r===t})),p=n.cacheMake((function(r){return s.prepareFrmSubsData(r)}),(function(r,t){return r===t})),h=n.cacheMake((function(r){return o.makeParenCnt(r[1],r[0].parens)}),(function(r,t){return r[0]===t[0]&&r[1]===t[1]})),E=n.cacheMake((function(r){return c.sortInPlaceWith(s.frmsSelect(r,void 0,void 0),(function(r,t){return r.frame.ord-t.frame.ord|0})).map((function(r){return r.frame}))}),(function(r,t){return r===t})),x=n.cacheMake((function(r){return f.findTypes(r)[1]}),(function(r,t){return r===t}));t.procName=d,t.beginWorkerInteractionUsingCtx=function(r,t,e,n,o,i,s,u,c,f){var v=void 0!==f&&f,l={TAG:"PrepareWrkPrecalcData",settingsVer:r,preCtxVer:e,varsText:o,disjText:i};a.beginWorkerInteraction(d,l,(function(o,i,f){if("object"==typeof o)return"GetSettings"===o.TAG?o.settingsVer===r?(i({TAG:"SetSettings",settingsVer:r,settings:t}),i(l)):void 0:o.preCtxVer===e?(i({TAG:"SetPreCtx",preCtxVer:e,preCtx:n}),i(l)):void 0;f(),a.beginWorkerInteraction(s,u,c,v,void 0,void 0)}),v,void 0,void 0)},t.getSettingsExn=function(){var r=v.contents;if(void 0!==r)return r.settings;throw{RE_EXN_ID:n.MmException,_1:{msg:"settings are not created in the worker thread."},Error:new Error}},t.getWrkCtxExn=function(){var r=v.contents;if(void 0!==r)return r.wrkCtx;throw{RE_EXN_ID:n.MmException,_1:{msg:"wrkCtx is not created in the worker thread."},Error:new Error}},t.getWrkParenCntExn=function(){var r=v.contents;if(void 0!==r)return r.wrkParenCnt;throw{RE_EXN_ID:n.MmException,_1:{msg:"wrkParenCnt is not created in the worker thread."},Error:new Error}},t.getWrkFrmsExn=function(){var r=v.contents;if(void 0!==r)return r.wrkFrms;throw{RE_EXN_ID:n.MmException,_1:{msg:"wrkFrms is not created in the worker thread."},Error:new Error}},t.getAllFramesInDeclarationOrderExn=function(){var r=v.contents;if(void 0!==r)return r.allFramesInDeclarationOrder;throw{RE_EXN_ID:n.MmException,_1:{msg:"wrkFrms is not created in the worker thread."},Error:new Error}},t.getSyntaxTypesExn=function(){var r=v.contents;if(void 0!==r)return r.syntaxTypes;throw{RE_EXN_ID:n.MmException,_1:{msg:"syntaxTypes are not created in the worker thread."},Error:new Error}},t.processOnWorkerSide=function(r,t){switch(r.TAG){case"PrepareWrkPrecalcData":v.contents=void 0;var e=function(r,t,e,o){var a=n.cacheGetByDepVer(l,r);if(void 0===a)return{TAG:"Error",_0:{TAG:"GetSettings",settingsVer:r}};var s=n.cacheGetByDepVer(m,t);if(void 0===s)return{TAG:"Error",_0:{TAG:"GetPreCtx",preCtxVer:t}};var c=i.valFromOption(s),f=u.createWrkCtx(c,e,o);if("Ok"===f.TAG){var d=n.cacheGet(p,t,c);return{TAG:"Ok",_0:{settings:a,wrkFrms:d,wrkParenCnt:n.cacheGet(h,[r,t],[a,c]),wrkCtx:f._0,allFramesInDeclarationOrder:n.cacheGet(E,t,d),syntaxTypes:n.cacheGet(x,t,c)}}}throw{RE_EXN_ID:n.MmException,_1:{msg:"There was an error creating wrkCtx in the worker thread."},Error:new Error}}(r.settingsVer,r.preCtxVer,r.varsText,r.disjText);return"Ok"!==e.TAG?t(e._0):(v.contents=e._0,t("Ok"));case"SetSettings":return void n.cacheGet(l,r.settingsVer,r.settings);case"SetPreCtx":return void n.cacheGet(m,r.preCtxVer,r.preCtx)}},t.reqToStr=function(r){switch(r.TAG){case"PrepareWrkPrecalcData":return"PrepareWrkPrecalcData";case"SetSettings":return"SetSettings(settingsVer="+String(r.settingsVer)+")";case"SetPreCtx":return"SetPreCtx(preCtxVer="+String(r.preCtxVer)+")"}},t.respToStr=function(r){return"object"!=typeof r?"Ok":"GetSettings"===r.TAG?"GetSettings(settingsVer="+String(r.settingsVer)+")":"GetPreCtx(preCtxVer="+String(r.preCtxVer)+")"}},7709:(r,t,e)=>{var n=e(5291),o=e(4923),i=e(55),a=e(2971),s=e(5300),u=e(3333),c=e(9592),f=e(6517),d=e(6369),v=e(7175),l=e(2761),m=e(2815),p=e(9775),h=e(2448),E=e(2423),x=e(5082),g=e(1367),y=e(6134),_=e(3591),T=e(7659),A=e(4792),b=e(1874),k=e(9010),S=e(5650),C=e(1717),w=e(9702),I=e(5090),M=e(2275),G=e(8615),j=e(5981),D=e(4518),O=e(5047),N=e(1725),P=e(2867);function U(r){return"Text"===r.TAG?n.getSpaceSeparatedValuesAsArray(r.text):n.getSpaceSeparatedValuesAsArray(r._0.text)}function F(r){return"Text"===r.TAG?r.text:r._0.text}function V(r,t,e){var o=n.getSpaceSeparatedValuesAsArray(r);return{TAG:"Text",text:o.join(" "),syms:o.map((function(r){var n,o=f.flatMap(t,(function(t){return M.get(t,r)}));if(void 0!==o)n=o;else{var i=f.flatMap(e,(function(t){return M.get(t,r)}));n=void 0!==i?i:void 0}return{sym:r,color:n}}))}}function R(r){switch(r){case"H":return["E",!1];case"P":return["P",!1];case"G":return["P",!0]}}function B(r,t,e,n){return{id:r,label:e,labelEditMode:!1,typ:t,typEditMode:!1,isGoal:n,isBkm:!1,cont:{TAG:"Text",text:"",syms:[]},contEditMode:!0,isDuplicated:!1,jstfText:"",jstfEditMode:!1,stmtErr:void 0,expr:void 0,jstf:void 0,proofTreeDto:void 0,src:void 0,proof:void 0,proofStatus:void 0,unifErr:void 0,syntaxErr:void 0}}function W(r){var t,e=r.expr;if(void 0===e)throw{RE_EXN_ID:n.MmException,_1:{msg:"Expr must be set for a userStmt before converting to rootStmt."},Error:new Error};return t=e,{isHyp:"E"===r.typ,label:r.label,expr:t,jstf:r.jstf}}function L(r){var t=r.cont;if("Text"===t.TAG)return r;var e=t._0;if(void 0===e.clickedNodeId)return r;var n=o.obj_dup(r);return n.cont={TAG:"Tree",_0:{text:e.text,exprTyp:e.exprTyp,root:e.root,clickedNodeId:void 0,expLvl:e.expLvl}},n}function H(r,t){return r.stmts.find((function(r){return r.id===t}))}function q(r,t){return r.stmts.find((function(r){return r.label===t}))}function X(r,t){var e=H(r,t);if(void 0!==e)return e;throw{RE_EXN_ID:n.MmException,_1:{msg:"editorGetStmtByIdExn: Cannot find a step by id."},Error:new Error}}function z(r,t,e){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts.map((function(r){return r.id===t?e(r):r})),checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}}function $(r,t){return r.checkedStmtIds.some((function(r){return r[0]===t}))}function K(r,t){return $(r,t)?{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds.filter((function(r){return r[0]!==t})),nextAction:r.nextAction}:{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds.concat([[t,new Date]]),nextAction:r.nextAction}}function J(r){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts.map(L),checkedStmtIds:[],nextAction:r.nextAction}}function Q(r,t){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts.filter((function(r){return r.id!==t})),checkedStmtIds:r.checkedStmtIds.filter((function(r){return r[0]!==t})),nextAction:r.nextAction}}function Z(r,t){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts.filter((function(r){return!t.includes(r.id)})),checkedStmtIds:r.checkedStmtIds.filter((function(r){return!t.includes(r[0])})),nextAction:r.nextAction}}function Y(r,t){var e=r.stmts.length;return 0!==e&&0!==r.checkedStmtIds.length&&(!(!t||$(r,r.stmts[0].id))||!t&&!$(r,r.stmts[e-1|0].id))}function rr(r,t){if(!Y(r,t))return r;var e=r.stmts.length,n=r.stmts.slice();if(t){for(var o=e-2|0,i=0;i<=o;++i)if(!$(r,n[i].id)&&$(r,n[i+1|0].id)){var a=n[i];n[i]=n[i+1|0],n[i+1|0]=a}}else for(var s=e-1|0;s>=1;--s)if($(r,n[s-1|0].id)&&!$(r,n[s].id)){var u=n[s];n[s]=n[s-1|0],n[s-1|0]=u}return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:n,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}}function tr(r,t,e){var n=void 0!==e&&e,o=G.fromArray(r.stmts.map((function(r){return r.label}))),i=k.textToVarDefs(r.varsText);"Ok"===i.TAG&&i._0.forEach((function(r){G.add(o,r[0])}));var a,s=r.preCtxData.ctxV.val.min;if(void 0!==t)a=t;else if(n){var c=r.stmts.find((function(r){return r.isGoal}));a=void 0!==c?c.label+".":""}else a="";for(var d,v=1,l=a+String(v);d=l,G.has(o,d)||u.isHyp(s,d)||n&&f.isSome(u.getTokenType(s,d));)v=v+1|0,l=a+String(v);return l}function er(r){return 0===r.checkedStmtIds.length?void 0:r.stmts.find((function(t){return $(r,t.id)}))}function nr(r,t,e){var n,i=void 0!==t&&t,s=String(r.nextStmtId),u=l.reduce(r.stmts,0,(function(r,t){return"P"===t.typ?r+1|0:r})),c=r.preCtxData.settingsV.val.defaultStmtLabel.trim(),d=0===u&&c.length>0?r.stmts.some((function(r){return r.label===c}))?tr(r,c,i):c:tr(r,"",i),v=0===u&&r.preCtxData.settingsV.val.initStmtIsGoal,m=f.map(er(r),(function(r){return r.id}));if(void 0!==m)n=a.concatMany(r.stmts.map((function(r){if(r.id!==m)return[r];var t=o.obj_dup(B(s,"P",d,v));return[(t.isBkm=f.getWithDefault(e,r.isBkm),t),r]})));else{var p=o.obj_dup(B(s,"P",d,v));n=r.stmts.concat([(p.isBkm=f.getWithDefault(e,!1),p)])}return[{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId+1|0,stmts:n,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction},s]}function or(r,t,e){var n=void 0!==e&&e,o=r.checkedStmtIds,i=J(r),a=nr(0<=t&&t<i.stmts.length?K(i,i.stmts[t].id):i,n,void 0),s=a[0];return[{preCtxData:s.preCtxData,tabTitle:s.tabTitle,descr:s.descr,descrEditMode:s.descrEditMode,varsText:s.varsText,varsEditMode:s.varsEditMode,varsErr:s.varsErr,wrkCtxColors:s.wrkCtxColors,disjText:s.disjText,disjEditMode:s.disjEditMode,disjErr:s.disjErr,wrkCtx:s.wrkCtx,nextStmtId:s.nextStmtId,stmts:s.stmts,checkedStmtIds:o,nextAction:s.nextAction},a[1]]}function ir(r){return 1===r.checkedStmtIds.length}function ar(r,t){return!r.stmts.some((function(r){return r.id===t&&(!!(r.labelEditMode||r.typEditMode||r.contEditMode)||r.jstfEditMode)}))}function sr(r){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:!0,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}}function ur(r,t){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:t,disjEditMode:!1,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}}function cr(r,t,e){return z(r,t,(function(r){if(""===e.trim())return r;var t=o.obj_dup(r);return t.labelEditMode=!1,t.label=e,t}))}function fr(r,t,e){return z(r,t,(function(t){if(""===e.trim())return t;var n=o.obj_dup(t);return n.isDuplicated=!1,n.contEditMode=!1,n.cont=V(e,v.some(r.preCtxData.symColors),v.some(r.wrkCtxColors)),n}))}function dr(r){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:(t=r.varsText,e=r.preCtxData.typeColors,n=M.make(16),o=k.textToVarDefs(t),"Ok"===o.TAG&&o._0.forEach((function(r){var t=r[2],o=r[1],i=M.get(e,o);if(void 0!==i)return M.set(n,t,i)})),n),disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction};var t,e,n,o}function vr(r){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts.map((function(t){var e=o.obj_dup(t);return e.cont=V(F(t.cont),v.some(r.preCtxData.symColors),v.some(r.wrkCtxColors)),e})),checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}}function lr(r){return vr(dr(r))}function mr(r,t){return lr({preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:t,varsEditMode:!1,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction})}function pr(r){var t=function(t){return"E"===t.typ?1:r.preCtxData.settingsV.val.stickGoalToBottom&&t.isGoal?3:2},e=r.stmts.length;if(e<2)return r;for(var n,o,i=r.stmts.slice(),a=!0,s=e-2|0;s>=0&&a;){a=!1;for(var u=0;u<=s;++u)if(n=i[u],o=i[u+1|0],(t(n)-t(o)|0)>0){var c=i[u];i[u]=i[u+1|0],i[u+1|0]=c,a=!0}s=s-1|0}return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:i,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}}function hr(r){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:void 0,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:void 0,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts.map((function(r){var t=o.obj_dup(r);return t.syntaxErr=void 0,t.unifErr=void 0,t.proofStatus=void 0,t.proof=void 0,t.src=void 0,t.proofTreeDto=void 0,t.jstf=void 0,t.expr=void 0,t.stmtErr=void 0,t})),checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}}function Er(r){return f.isSome(r.stmtErr)}function xr(r){return!(!f.isSome(r.stmtErr)&&!f.isSome(r.syntaxErr))||f.isSome(r.unifErr)}function gr(r){return!(!f.isSome(r.varsErr)&&!f.isSome(r.disjErr))||r.stmts.some(Er)}function yr(r){var t=[];return h.forEach(r.varsErr,(function(r){t.push("Variable definition error: "+r)})),h.forEach(r.disjErr,(function(r){t.push("Disjoints error: "+r)})),r.stmts.some(Er)&&(t.push("Errors for steps:"),r.stmts.forEach((function(r){h.forEach(r.stmtErr,(function(e){t.push(F(r.cont)+":"),t.push(e.msg)}))}))),t.join(" \n")}function _r(r){var t=k.createWrkCtx(r.preCtxData.ctxV.val.min,r.varsText,r.disjText);if("Ok"===t.TAG)return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:v.some(t._0),nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction};var e=t._0,n=e.varsErr,o=void 0!==n?{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:n,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}:r,i=e.disjErr;return void 0!==i?{preCtxData:o.preCtxData,tabTitle:o.tabTitle,descr:o.descr,descrEditMode:o.descrEditMode,varsText:o.varsText,varsEditMode:o.varsEditMode,varsErr:o.varsErr,wrkCtxColors:o.wrkCtxColors,disjText:o.disjText,disjEditMode:o.disjEditMode,disjErr:i,wrkCtx:o.wrkCtx,nextStmtId:o.nextStmtId,stmts:o.stmts,checkedStmtIds:o.checkedStmtIds,nextAction:o.nextAction}:o}function Tr(r){var t=r.trim();if(0===t.length)return{TAG:"Ok",_0:void 0};var e=t.split(":");return 2!==e.length?{TAG:"Error",_0:"Cannot parse justification: '"+t+"'. A justification must contain exactly one colon symbol."}:""===e[1].trim()?{TAG:"Error",_0:"Cannot parse justification: '"+t+"'. Reference must not be empty."}:{TAG:"Ok",_0:{args:n.getSpaceSeparatedValuesAsArray(e[0]),label:e[1].trim()}}}function Ar(r){if(f.isSome(r.stmtErr)||"E"===r.typ)return r;var t=Tr(r.jstfText);if("Ok"===t.TAG){var e=o.obj_dup(r);return e.jstf=t._0,e}var n=o.obj_dup(r);return n.stmtErr={code:-1,msg:t._0},n}function br(r,t,e){return!!G.has(e,r)||u.isHyp(t,r)}function kr(r){var t=r.wrkCtx;if(void 0!==t){var e=v.valFromOption(t),i=r.stmts.length,a=G.make(i),s=m.make(i,u.ExprHash),c={contents:void 0},d=[function(r){if(f.isSome(r.stmtErr))return r;if(!("E"===r.typ||"P"===r.typ&&r.isGoal)){if(!br(r.label,e,a))return r;var t=o.obj_dup(r);return t.stmtErr={code:-1,msg:"[4] Cannot reuse label '"+r.label+"'."},t}var n=u.getTokenType(e,r.label);if(void 0===n){if(!br(r.label,e,a))return r;var i=o.obj_dup(r);return i.stmtErr={code:-1,msg:"[3] Cannot reuse label '"+r.label+"'."},i}if("E"===r.typ){var s=o.obj_dup(r);return s.stmtErr={code:-1,msg:"[1] Cannot reuse label '"+r.label+"'."},s}switch(n){case"A":case"P":return r;default:var c=o.obj_dup(r);return c.stmtErr={code:-1,msg:"[2] Cannot reuse label '"+r.label+"'."},c}},function(r){if(f.isSome(r.stmtErr))return r;try{var t=o.obj_dup(r);return t.expr=u.ctxSymsToIntsExn(e,U(r.cont)),t}catch(t){var i=D.internalToOCamlException(t);if(i.RE_EXN_ID===n.MmException){var a=o.obj_dup(r);return a.stmtErr={code:-1,msg:i._1.msg},a}throw i}},function(r){if(f.isSome(r.stmtErr))return r;var t=c.contents;if(void 0===t)return r;if(!r.isGoal)return r;var e=o.obj_dup(r);return e.stmtErr={code:-1,msg:"Cannot re-define the goal. Previously defined goal is the step labeled '"+t+"'"},e},Ar,function(t){var i=r.preCtxData.frms;if(f.isSome(t.stmtErr))return t;var s=t.jstf;if(void 0===s)return t;var c=s.label,d=s.args,v=d.find((function(r){return!br(r,e,a)}));if(void 0!==v){var l=o.obj_dup(t);return l.stmtErr={code:-1,msg:"The label '"+v+"' is not defined."},l}if(u.isAsrt(e,c)){var m=b.frmsGetByLabel(i,c);if(void 0!==m){var p=m.numOfHypsE,h=d.length;if(h===p)return t;var E=1===p?"essential hypothesis":"essential hypotheses",x=1===h?"is":"are",g=o.obj_dup(t);return g.stmtErr={code:-1,msg:"'"+c+"' assertion expects "+String(p)+" "+E+" but "+String(h)+" "+x+" provided."},g}throw{RE_EXN_ID:n.MmException,_1:{msg:"Could not get frame by label '"+c+"'"},Error:new Error}}var y=o.obj_dup(t);return y.stmtErr={code:-1,msg:"The label '"+c+"' doesn't refer to any assertion."},y},function(r){if(f.isSome(r.stmtErr))return r;var t=r.expr;if(void 0!==t){var i=u.getHypByExpr(e,t);if(void 0!==i){var a=o.obj_dup(r);return a.stmtErr={code:1,msg:"This statement is the same as the previously defined hypothesis - '"+i.label+"'"},a}var c=m.get(s,t);if(void 0!==c){var d=o.obj_dup(r);return d.stmtErr={code:1,msg:"This statement is the same as the previous one - '"+c+"'"},d}if(r.contEditMode||!(0===t.length||t[0]>=0))return r;var v=o.obj_dup(r);return v.stmtErr={code:-1,msg:"Any statement must begin with a constant."},v}throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot validateStmtExpr without expr."},Error:new Error}}];return l.reduce(r.stmts,r,(function(r,t){if(gr(r))return r;var e=l.reduce(d,t,(function(r,t){return f.isSome(r.stmtErr)?r:t(r)}));if(G.add(a,e.label),!f.isSome(e.stmtErr)){var o=e.expr;if(void 0===o)throw{RE_EXN_ID:n.MmException,_1:{msg:"Expr must be set in prepareUserStmtsForUnification."},Error:new Error};m.set(s,o,e.label),e.isGoal&&(c.contents=e.label)}return z(r,e.id,(function(r){return e}))}))}throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot prepareUserStmtsForUnification without wrkCtx."},Error:new Error}}function Sr(r){var t=hr(r);return l.reduce([pr,_r,kr],t,(function(r,t){return gr(r)?r:t(r)}))}function Cr(r,t,e,o){var i=void 0!==o&&o,a=r.wrkCtx;if(void 0!==a){var s,c=v.valFromOption(a),f=t.length;if(0===f)return[r,[]];if(void 0!==e){if(t.length!==e.length)throw{RE_EXN_ID:n.MmException,_1:{msg:"varTypes->Array.length != varNames->Array.length"},Error:new Error};s=e}else{var d=x.fromArray(r.preCtxData.settingsV.val.typeSettings.map((function(r){return[r.typ,r.prefix]})));s=u.generateNewVarNames(c,t,v.some(d),void 0)}var l=u.generateNewLabels(c,"var",f,void 0,void 0),m=u.ctxIntsToSymsExn(c,t);i||(u.applySingleStmt(c,{TAG:"Var",symbols:s},void 0,void 0,void 0,void 0),l.forEach((function(r,t){u.applySingleStmt(c,{TAG:"Floating",label:r,expr:[m[t],s[t]]},void 0,void 0,void 0,void 0)})));var p=u.ctxSymsToIntsExn(c,s),h=l.map((function(r,t){return r+" "+m[t]+" "+s[t]})).join("\n");return[dr({preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:[r.varsText,h].join("\n").trim(),varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}),p]}throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot create new variables without wrkCtx."},Error:new Error}}function wr(r,t){var e=r.wrkCtx;if(void 0!==e){var o=v.valFromOption(e),i=[];if(u.disjForEachArr(t,void 0,void 0,void 0,void 0,(function(r){var t=u.ctxIntsToSymsExn(o,r);u.applySingleStmt(o,{TAG:"Disj",vars:t},void 0,void 0,void 0,void 0),i.push(t.join(" "))})),0===i.length)return r;var a=i.join("\n");return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:[r.disjText,a].join("\n").trim(),disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}}throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot create new disjoints without wrkCtx."},Error:new Error}}function Ir(r,t){var e=r.expr;if(void 0!==e)return u.exprEq(e,t.expr);throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot compare steps without expr."},Error:new Error}}function Mr(r){var t=r.wrkCtx;if(void 0!==t){var e=v.valFromOption(t),o=G.fromArray(O.arrFlatMap(r.stmts,(function(r){return U(r.cont)})));u.getLocalHyps(e).forEach((function(r){if("F"===r.typ&&r.label.startsWith("."))return G.add(o,u.ctxIntToSymExn(e,r.expr[1]))}));var i,a=u.getLocalVars(e).filter((function(r){return!G.has(o,r)}));if(0===a.length)i=r;else{var s=T.fromArray(u.ctxSymsToIntsExn(e,a));i=mr(r,u.getLocalHyps(e).filter((function(r){return"F"===r.typ&&!T.has(s,r.expr[1])})).map((function(r){return r.label+" "+u.ctxIntToSymExn(e,r.expr[0])+" "+u.ctxIntToSymExn(e,r.expr[1])})).join("\n"))}var c=u.disjMake();u.disjForEach(u.getLocalDisj(e),(function(r,t){if(G.has(o,u.ctxIntToSymExn(e,r))&&G.has(o,u.ctxIntToSymExn(e,t)))return u.disjAddPair(c,r,t)}));var f=u.disjToArr(c,!0,(function(r){return u.ctxIntToSym(e,r)}),(function(r){return u.getTypeOfVar(e,r)}),v.some(i.preCtxData.typeOrderInDisj)).map((function(r){return u.ctxIntsToSymsExn(e,r).join(" ")})).join("\n");if(i.disjText===f)return i;var d=i.disjEditMode,l=ur(i,f);return d?sr(l):l}throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot remove unused variables without wrkCtx."},Error:new Error}}function Gr(r,t,e,o){if("object"==typeof e&&"Assertion"===e.TAG){var i=e.label,s=e.args,c=u.getFrame(r,i);if(void 0!==c){var f=[],d={contents:!0};return c.hyps.forEach((function(r,e){if("E"===r.typ&&d.contents){var u=a.get(s,e);if(void 0===u)throw{RE_EXN_ID:n.MmException,_1:{msg:"Too few arguments for '"+i+"' in srcToJstf."},Error:new Error};var c=m.get(o,t.nodes[u].expr);void 0!==c?f.push(c.label):d.contents=!1}})),d.contents?{args:f,label:i}:void 0}throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot find an assertion '"+i+"' in srcToJstf."},Error:new Error}}}function jr(r,t,e){if(void 0===t)return f.flatMap(e,(function(t){return M.get(t,r)}));var n=M.get(v.valFromOption(t),r);return void 0!==n?n:f.flatMap(e,(function(t){return M.get(t,r)}))}function Dr(r,t,e){return{id:r.id,typ:r.typ,label:r.label,children:r.children.map((function(r){return"Subtree"===r.TAG?{TAG:"Subtree",_0:Dr(r._0,t,e)}:{TAG:"Symbol",id:r.id,symInt:r.symInt,sym:r.sym,color:jr(r.sym,t,e),isVar:r.isVar}})),height:r.height}}function Or(r){var t,e=(0!==(t=r).length&&i.isWhitespace(t.charAt(0))?"":" ")+r,n=function(r){var t=r.length;return 0!==t&&i.isWhitespace(r.charAt(t-1|0))}(e)?"":" ";return"$("+e+n+"$)"}function Nr(r,t,e,n,o,i,c){if("Uncompressed"===c.TAG)return"Error: only compressed proofs are supported.";var f=function(r,t){var e=r.length;if(e<=50)return[r];for(var n=[],o=s.Int.ceil(e/50),i=1;i<=o;++i){var a=Math.imul(i-1|0,50);n.push(r.substr(a,50))}return n}(c.compressedProofBlock).join(" "),d=0===o.length,l=e.length>0||!u.disjIsEmpty(n)||!d,m=[],p=e.filter((function(r){return"F"===r.typ})).map((function(t){return u.ctxIntToSymExn(r,t.expr[1])}));return p.length>0&&m.push("$v "+p.join(" ")+" $."),e.forEach((function(t){"F"!==t.typ||m.push(t.label+" $f "+u.ctxIntsToStrExn(r,t.expr)+" $.")})),u.disjForEachArr(n,!0,(function(t){return u.ctxIntToSym(r,t)}),(function(t){return u.getTypeOfVar(r,t)}),v.some(t),(function(t){m.push("$d "+u.ctxIntsToStrExn(r,t)+" $.")})),e.forEach((function(t){"E"!==t.typ||m.push(t.label+" $e "+u.ctxIntsToStrExn(r,t.expr)+" $.")})),d||m.push(Or(o)),m.push(i.label),m.push("    $p "+F(i.cont)),m.push("    $= ( "+c.labels.join(" ")+" ) "+f+" $."),(l?a.concatMany([["${"],m.map((function(r){return"    "+r})),["$}"]]):m).join("\n")}function Pr(r,t,e){return l.reduce(r.stmts,{TAG:"Ok",_0:r},(function(r,n){if("Ok"!==r.TAG)return r;var i=r._0;if("E"===n.typ)return{TAG:"Ok",_0:i};var a=Tr(n.jstfText);if("Ok"!==a.TAG)return{TAG:"Error",_0:"Cannot parse justification '"+n.jstfText+"' for the step '"+n.label+"'"};var s=a._0;if(void 0===s)return{TAG:"Ok",_0:i};if(!s.args.includes(t))return{TAG:"Ok",_0:i};var u={args:s.args.map((function(r){return r===t?e:r})),label:s.label};return{TAG:"Ok",_0:z(i,n.id,(function(r){var t=o.obj_dup(r);return t.jstfText=I.jstfToStr(u),t}))}}))}var Ur=/[\s:]+/g;function Fr(r,t,e){var n=e.replace(Ur,"");if(""===n)return{TAG:"Error",_0:"label must not be empty."};var i=r.stmts.find((function(r){return r.id!==t&&r.label===n}));if(void 0!==i)return{TAG:"Error",_0:"label '"+n+"' is used by another step."};var a=H(r,t);if(void 0===a)return{TAG:"Ok",_0:r};if(a.label===n)return{TAG:"Ok",_0:r};var s=Pr(r,a.label,n);return"Ok"===s.TAG?{TAG:"Ok",_0:z(s._0,t,(function(r){var t=o.obj_dup(r);return t.label=n,t}))}:{TAG:"Error",_0:s._0}}function Vr(r,t,e){var n=H(r,t);if(void 0===n)return{TAG:"Error",_0:"Cannot find a step with id = '"+t+"'"};var i=H(r,e);if(void 0===i)return{TAG:"Error",_0:"Cannot find a step with id = '"+e+"'"};if(F(n.cont)!==F(i.cont))return{TAG:"Error",_0:"Steps to merge must have identical expressions."};var a=Pr(r,i.label,n.label);if("Ok"!==a.TAG)return{TAG:"Error",_0:a._0};var s=Q(a._0,e);return"P"===i.typ&&i.isGoal&&"E"!==n.typ?Fr(z(s,t,(function(r){var t=o.obj_dup(r);return t.isGoal=!0,t.typ="P",t})),t,i.label):{TAG:"Ok",_0:s}}var Rr=/^\d+$/;function Br(r){return f.isSome(v.null_to_opt(r.match(Rr)))}function Wr(r,t,e){if(t.id!==e.id)throw{RE_EXN_ID:n.MmException,_1:{msg:"renameHypToMatchGoal: oldStmt.id != newStmt.id"},Error:new Error};var o=t.id;if("P"!==t.typ||"E"!==e.typ||!Br(e.label))return r;var i=f.isSome(r.stmts.find((function(r){return r.isGoal})))||f.isSome(u.getTokenType(r.preCtxData.ctxV.val.min,e.label))?tr(r,void 0,!0):e.label;if(i===e.label)return r;var a=Fr(r,o,i);return"Ok"===a.TAG?a._0:r}function Lr(r,t,e,n){var i=X(r,t),a=z(r,t,(function(r){var t,i=o.obj_dup(r);return t="E"!==e&&n,i.isGoal=t,i.typEditMode=!1,i.typ=e,i}));return Wr(a,i,X(a,t))}var Hr="HYP";function qr(r,t,e){var n=X(r,t),i=z(r,t,(function(t){var n=e.trim().toLocaleUpperCase(),i=n===Hr?"E":"P",a=n===Hr?"":e.trim(),s=r.preCtxData.settingsV.val,u="E"!==i&&t.isGoal,c=u&&!t.isGoal&&s.defaultStmtLabel.length>0?s.defaultStmtLabel:t.label,f=o.obj_dup(t);return f.jstfEditMode=!1,f.jstfText=a,f.isGoal=u,f.typ=i,f.label=c,f}));return Wr(i,n,X(i,t))}function Xr(r){if(void 0===r)return!1;switch(r){case"H":return!0;case"P":case"G":return!1}}function zr(r,t,e){var n=[function(r,t,e){var n=e.cont;return void 0!==n&&""!==n.trim()?{TAG:"Ok",_0:fr(r,t,n)}:{TAG:"Error",_0:"Steps must not have empty statements."}},function(r,t,e){var n=e.label;return void 0!==n?""===n.trim()?{TAG:"Error",_0:"Steps must not have empty labels."}:{TAG:"Ok",_0:cr(r,t,n)}:{TAG:"Ok",_0:r}},function(r,t,e){var n=e.typ;if(void 0===n)return{TAG:"Ok",_0:r};var o=R(n);return{TAG:"Ok",_0:Lr(r,t,o[0],o[1])}},function(r,t,e){var n=e.jstf;return void 0!==n?{TAG:"Ok",_0:qr(r,t,n)}:{TAG:"Ok",_0:r}},function(r,t,e){var n=e.isBkm;return void 0!==n?{TAG:"Ok",_0:z(r,t,(function(r){var t=o.obj_dup(r);return t.isBkm=n,t}))}:{TAG:"Ok",_0:r}}],i=[],a=l.reduceWithIndex(e,{TAG:"Ok",_0:r},(function(r,e,o){if("Ok"!==r.TAG)return r;var a=r._0,s=void 0!==t?or(a,t+o|0,Xr(e.typ)):nr(a,Xr(e.typ),void 0),u=s[1];return i.push(u),l.reduce(n,{TAG:"Ok",_0:s[0]},(function(r,t){return d.flatMap(r,(function(r){return t(r,u,e)}))}))}));return"Ok"===a.TAG?{TAG:"Ok",_0:[a._0,i]}:{TAG:"Error",_0:a._0}}function $r(r){var t=r.typ;if(void 0===t)return r;switch(t){case"H":return{id:r.id,label:r.label,typ:r.typ,cont:r.cont,jstf:void 0,isBkm:r.isBkm};case"P":case"G":return r}}function Kr(r){return r.stmts.find((function(r){return!r.isDuplicated&&f.getWithDefault(f.map(r.stmtErr,(function(r){return 1===r.code})),!1)}))}function Jr(r,t){var e=F(t.cont);return r.stmts.find((function(r){return!r.isDuplicated&&r.id!==t.id&&F(r.cont)===e}))}function Qr(r){for(var t=[],e=r,n=!0;n;){var o=Kr(e);if(void 0!==o){var i=Jr(e,o);if(void 0!==i){var a=e.stmts.findIndex(function(r){return function(t){return t.id===r.id}}(o)),s=e.stmts.findIndex(function(r){return function(t){return t.id===r.id}}(i)),u=a<s?[o,i]:[i,o],c=u[1],f=u[0],d=f.jstfText.trim(),v=c.jstfText.trim();if(""!==d&&""===v){var l=Vr(e,f.id,c.id);"Ok"===l.TAG?(t.push([c.label,f.label]),e=Sr(l._0)):n=!1}else if(""===v||""!==d&&d!==v)n=!1;else{var m=Vr(e,c.id,f.id);"Ok"===m.TAG?(t.push([f.label,c.label]),e=Sr(m._0)):n=!1}}else n=!1}else n=!1}return[e,t]}function Zr(r){var t=r.clickedNodeId;if(void 0!==t){var e=_.getNodeById(r.root,t[0]);if(void 0!==e&&"Subtree"!==e.TAG){var n=e.id;if(0===r.expLvl)return{TAG:"Symbol",id:n,symInt:e.symInt,sym:e.sym,color:e.color,isVar:e.isVar};for(var o=_.syntaxTreeGetParent(r.root,n),i=r.expLvl;i>1&&f.isSome(o);)i=i-1|0,o=_.syntaxTreeGetParent(r.root,f.getExn(o).id);return void 0!==o?{TAG:"Subtree",_0:o}:{TAG:"Subtree",_0:r.root}}}}function Yr(r){return f.getWithDefault(f.map(Zr(r),_.syntaxTreeGetNumberOfSymbols),0)}function rt(r){return{text:r.text,exprTyp:r.exprTyp,root:r.root,clickedNodeId:r.clickedNodeId,expLvl:Math.min(r.expLvl+1|0,r.root.height)}}function tt(r){return{text:r.text,exprTyp:r.exprTyp,root:r.root,clickedNodeId:r.clickedNodeId,expLvl:Math.max(r.expLvl-1|0,0)}}function et(r,t){for(var e=t?rt:tt,n=r,o=Yr(n),i=e(n),a=Yr(i);o===a&&(t&&i.expLvl<i.root.height||!t&&i.expLvl>0);)o=Yr(n=i),a=Yr(i=e(n));return i}function nt(r,t,e,n){var o=Sr(r);if(gr(o))return{TAG:"Error",_0:"Cannot perform renumbering because there is an error in the editor content. Please resolve the error before renumbering."};var i=o.stmts.filter(t).map((function(r){return r.id})),a=G.fromArray(i),s=l.reduce(o.stmts,{TAG:"Ok",_0:o},(function(r,t){if("Ok"!==r.TAG)return r;var e=r._0;return G.has(a,t.id)?Fr(e,t.id,"###tmp###"+t.label):{TAG:"Ok",_0:e}})),u=l.reduce(i,s,(function(r,t){if("Ok"!==r.TAG)return r;var o=r._0;return Fr(o,t,tr(o,e,n))}));if("Ok"!==u.TAG)return u;var c=Sr(u._0);return gr(c)?{TAG:"Error",_0:"Cannot renumber steps due to an internal error. An error was detected in the editor content after a renumbering attempt. All errors detected are: "+yr(c)}:{TAG:"Ok",_0:c}}function ot(r,t,e,n,o,i,s,d){if(0===e.length)return{TAG:"Error",_0:"Could not determine syntax types."};var l=function(t){return t.find((function(t){return f.isNone(u.ctxSymToInt(r,t))}))}(a.concatMany(t));if(void 0!==l)return{TAG:"Error",_0:"Unrecognized symbol: '"+l+"'"};var m=f.getWithDefault(f.flatMap(s,(function(t){return u.ctxSymToInt(r,t)})),0),p=O.sortInPlaceWith(e.slice(),(function(r,t){return r===m?-1:t===m?1:r-t|0})),h=t.map((function(t){return u.ctxSymsToIntsExn(r,t)})),x=c.proveSyntaxTypes(void 0,v.some(r),v.some(n),o,v.some(i),h,p,void 0),g=h.map((function(r){var t=E.ptGetSyntaxProof(x,r);if(void 0!==t)return E.pnGetExpr(v.valFromOption(t))})),y=C.proofTreeToDto(x,g.filter(f.isSome).map(f.getExn)),T=g.find(f.isSome);if(void 0!==T){var A=v.valFromOption(T);void 0!==A&&(void 0!==s?f.forEach(u.ctxIntToSym(r,A[0]),(function(r){if(s!==r)return d(r)})):f.forEach(u.ctxIntToSym(r,A[0]),d))}return{TAG:"Ok",_0:g.map((function(t){return void 0!==t?_.buildSyntaxProofTableFromProofTreeDto(r,y,t):{TAG:"Error",_0:"Could not prove this statement is of any of the types: "+u.ctxIntsToSymsExn(r,p).join(", ")}}))}}function it(r){var t=Tr(r);if("Ok"===t.TAG)return h.map(t._0,(function(r){return g.fromArray(r.args)}))}function at(r,t){return g.every(t,(function(t){return G.has(r,t)}))}t.defaultJstfForHyp=Hr,t.contIsEmpty=function(r){return"Text"===r.TAG?0===r.text.length:0===r._0.text.length},t.contToArrStr=U,t.contToStr=F,t.strToCont=V,t.userStmtTypeFromStr=function(r){switch(r){case"e":return"E";case"p":return"P";default:throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot convert '"+r+"' to userStmtType"},Error:new Error}}},t.userStmtTypeToStr=function(r){return"E"===r?"e":"p"},t.userStmtTypeExtendedFromStrExn=function(r){switch(r){case"g":return"G";case"h":return"H";case"p":return"P";default:throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot convert '"+r+"' to userStmtTypeExtended. Possible values are h, p, g."},Error:new Error}}},t.readInstrToStr=function(r){switch(r){case"ReadAll":return"ReadAll";case"StopBefore":return"StopBefore";case"StopAfter":return"StopAfter"}},t.readInstrFromStr=function(r){switch(r){case"ReadAll":return"ReadAll";case"StopAfter":return"StopAfter";case"StopBefore":return"StopBefore";default:throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot convert string '"+r+"' to a readInstr."},Error:new Error}}},t.mmFileSourceTypeToStr=function(r){return"Local"===r?"Local":"Web"},t.mmFileSourceTypeFromStr=function(r){switch(r){case"Local":return"Local";case"Web":return"Web";default:throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot convert string '"+r+"' to an mmFileSourceType."},Error:new Error}}},t.mmFileSourceTypeFromStrOpt=function(r){switch(r){case"Local":return"Local";case"Web":return"Web";default:return}},t.someStmtErrCode=-1,t.duplicatedStmtErrCode=1,t.createEmptyUserStmt=B,t.userStmtToRootStmt=W,t.updateStmt=z,t.isStmtChecked=$,t.toggleStmtChecked=K,t.toggleStmtCheckedWithShift=function(r,t,e){if($(r,t))return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds.filter((function(r){return r[0]!==t})),nextAction:r.nextAction};var n,o,i,a=r.stmts.filter((function(r){return!e||r.isBkm})).map((function(r){return r.id})),s=r.checkedStmtIds.toSorted((function(r,t){var e=r[1].getTime(),n=t[1].getTime();return e<n?1:e>n?-1:0})).at(0),u=void 0!==s?(n=a,o=s[0],i=t,l.reduce(n,[!1,[]],(function(r,t){var e=r[1],n=r[0];return t===o||t===i?(e.push(t),[!n,e]):(n&&e.push(t),[n,e])}))[1]):[t],c=r.preCtxData,f=r.tabTitle,d=r.descr,v=r.descrEditMode,m=r.varsText,p=r.varsEditMode,h=r.varsErr,E=r.wrkCtxColors,x=r.disjText,g=r.disjEditMode,y=r.disjErr,_=r.wrkCtx,T=r.nextStmtId,A=r.stmts,b=r.checkedStmtIds.filter((function(r){return!u.includes(r[0])})),k=r.nextAction;return{preCtxData:c,tabTitle:f,descr:d,descrEditMode:v,varsText:m,varsEditMode:p,varsErr:h,wrkCtxColors:E,disjText:x,disjEditMode:g,disjErr:y,wrkCtx:_,nextStmtId:T,stmts:A,checkedStmtIds:b.concat(u.map((function(r){return[r,new Date]}))),nextAction:k}},t.checkAllStmts=function(r){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.stmts.map((function(r){return[r.id,new Date]})),nextAction:r.nextAction}},t.uncheckAllStmts=J,t.deleteCheckedStmts=function(r){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts.filter((function(t){return!$(r,t.id)})),checkedStmtIds:[],nextAction:r.nextAction}},t.deleteStmt=Q,t.deleteStmts=Z,t.canMoveCheckedStmts=Y,t.moveCheckedStmts=rr,t.moveCheckedBookmarkedStmts=function(r,t){var e=g.fromArray(r.stmts.filter((function(r){return!(!r.isBkm&&"E"!==r.typ)||r.isGoal})).map((function(r){return r.id}))),n=r.preCtxData,o=r.tabTitle,i=r.descr,s=r.descrEditMode,u=r.varsText,c=r.varsEditMode,f=r.varsErr,d=r.wrkCtxColors,l=r.disjText,m=r.disjEditMode,p=r.disjErr,E=r.wrkCtx,x=r.nextStmtId,y=r.stmts,_=r.checkedStmtIds.filter((function(r){return g.has(e,r[0])})),T=r.nextAction,A=y.filter((function(r){return"E"===r.typ})),b=y.filter((function(r){return"E"!==r.typ&&!g.has(e,r.id)})),k=y.filter((function(r){return"E"!==r.typ&&g.has(e,r.id)})),S=rr({preCtxData:n,tabTitle:o,descr:i,descrEditMode:s,varsText:u,varsEditMode:c,varsErr:f,wrkCtxColors:d,disjText:l,disjEditMode:m,disjErr:p,wrkCtx:E,nextStmtId:x,stmts:a.concatMany([A,k,b]),checkedStmtIds:_,nextAction:T},t),C=S.stmts.slice(),w=C.length,I=M.make(w);C.forEach((function(r){h.forEach(it(r.jstfText),(function(t){M.set(I,r.label,t)}))}));for(var j=G.make(C.length),D=0,O={contents:0};O.contents<w&&D<=w;){var N=C[O.contents],P=M.get(I,N.label);if(void 0!==P){var U=v.valFromOption(P);if(at(j,U))O.contents=O.contents+1|0,G.add(j,N.label);else{var F=C.findIndex(function(r){return function(t,e){return O.contents<e&&g.has(r,t.label)}}(U));-1!==F&&F>O.contents?(C.splice(O.contents,0,C[F]),C.splice(F+1|0,1),D=D+1|0):(O.contents=O.contents+1|0,G.add(j,N.label))}}else O.contents=O.contents+1|0,G.add(j,N.label)}return{preCtxData:S.preCtxData,tabTitle:S.tabTitle,descr:S.descr,descrEditMode:S.descrEditMode,varsText:S.varsText,varsEditMode:S.varsEditMode,varsErr:S.varsErr,wrkCtxColors:S.wrkCtxColors,disjText:S.disjText,disjEditMode:S.disjEditMode,disjErr:S.disjErr,wrkCtx:S.wrkCtx,nextStmtId:S.nextStmtId,stmts:C,checkedStmtIds:S.checkedStmtIds,nextAction:S.nextAction}},t.moveCheckedStmtsToTop=function(r){var t=r.stmts.filter((function(t){return $(r,t.id)})),e=r.stmts.filter((function(t){return!$(r,t.id)}));return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:a.concatMany([t,e]),checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}},t.moveCheckedStmtsToBottom=function(r){var t=r.stmts.filter((function(t){return $(r,t.id)})),e=r.stmts.filter((function(t){return!$(r,t.id)}));return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:a.concatMany([e,t]),checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}},t.getRootStmtsForUnification=function(r){var t,e=G.fromArray(r.checkedStmtIds.map((function(r){return r[0]})));if(0===G.size(e))return r.stmts;for(var n=r.stmts.length-1|0;n>=0&&f.isNone(t);){var o=r.stmts[n];G.has(e,o.id)&&(t=n),n=n-1|0}var i=t;return void 0!==i?r.stmts.slice(0,i+1|0):r.stmts},t.addNewStmt=nr,t.addNewStatements=function(r,t,e){var i=void 0!==e&&e,a=t.stmts.every((function(r){return r.isProved})),s=Cr(r,t.newVarTypes,void 0,void 0),c=s[1],d=j.make();t.newVars.forEach((function(r,t){j.set(d,r,c[t])}));var m=function(r,t){return{newVars:r.newVars,newVarTypes:r.newVarTypes,newDisj:r.newDisj,newDisjStr:r.newDisjStr,stmts:r.stmts.map((function(r){return{label:r.label,expr:r.expr.map((function(r){return j.getWithDefault(t,r,r)})),exprStr:r.exprStr,jstf:r.jstf,isProved:r.isProved}}))}}(t,d),p=u.disjMake();u.disjForEach(m.newDisj,(function(r,t){u.disjAddPair(p,j.getWithDefault(d,r,r),j.getWithDefault(d,t,t))}));var h=wr(s[0],p),E=function(r){return 0===r.checkedStmtIds.length?void 0:r.stmts.toReversed().find((function(t){return $(r,t.id)}))}(h),x=P.make(),g=function(r){return{args:r.args.map((function(r){return P.getWithDefault(x,r,r)})),label:r.label}},y=m.stmts.some((function(r){return h.stmts.some((function(t){return Ir(t,r)}))})),_=f.isSome(E)&&!y,T={contents:h};return m.stmts.forEach((function(r){if(f.isSome(E)&&Ir(f.getExn(E),r)){var t=f.getExn(E);return T.contents=z(T.contents,t.id,(function(t){var e=o.obj_dup(t),n=r.jstf;e.src=void 0!==n?void 0:t.src;var i=r.jstf;e.jstf=void 0!==i?void 0:t.jstf;var a=r.jstf;return e.jstfText=void 0!==a?I.jstfToStr(g(a)):t.jstfText,e})),P.set(x,r.label,t.label)}var e=function(r,t,e,i,a,s){var c=r.wrkCtx;if(void 0!==c){var d,m,p=v.valFromOption(c),h=u.getHypByExpr(p,t);if(void 0!==h)return[r,h.label];if(void 0!==i){var E=r.stmts.findIndex((function(r){return r.id===i}));d=-1!==E?E:r.stmts.length}else d=r.stmts.length;if(void 0!==e){var x=G.fromArray(e.args),g=l.reduceWithIndex(r.stmts,0,(function(r,t,e){return G.isEmpty(x)?r:(G.remove(x,t.label),e+1|0)}));m=d<g?d:g}else m=0;var y=function(r,n){var i;if(void 0!==n){var c=function(r,t){return r.stmts.findIndex((function(r){return r.id===t}))}(r,n.id)+1|0;i=m<=c&&c<=d?c:m}else i=a?d:m;var l=or(r,i,void 0),h=l[1],E=l[0],x=z(E,h,(function(r){var n=o.obj_dup(r);return n.expr=t,n.jstfText=f.mapWithDefault(e,"",I.jstfToStr),n.contEditMode=!1,n.cont=V(u.ctxIntsToStrExn(p,t),v.some(E.preCtxData.symColors),v.some(E.wrkCtxColors)),n.isBkm=s,n.typ="P",n}));return[x,X(x,h).label]},_=function(r,t){return r.stmts.find((function(r){var e=r.expr;if(void 0!==e)return u.exprEq(e,t);throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot getUserStmtByExpr without stmt.expr."},Error:new Error}}))}(r,t);if(void 0===_)return y(r,void 0);if("E"===_.typ||f.isNone(e))return[r,_.label];var T=Tr(_.jstfText);if("Ok"!==T.TAG)return y(r,_);var A=T._0;return void 0!==A?function(r){return void 0!==e&&I.jstfEq(r,e)}(A)?[r,_.label]:y(r,_):[void 0!==e?z(r,_.id,(function(r){var t=o.obj_dup(r);return t.jstfText=I.jstfToStr(e),t})):r,_.label]}throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot insertStmt without wrkCtx."},Error:new Error}}(T.contents,r.expr,f.map(r.jstf,g),f.map(E,(function(r){return r.id})),_,i&&!a);T.contents=e[0],P.set(x,r.label,e[1])})),T.contents},t.isSingleStmtChecked=ir,t.duplicateCheckedStmt=function(r,t,e){if(!ir(r))return r;var n=String(r.nextStmtId),i=r.checkedStmtIds[0][0],s={preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId+1|0,stmts:a.concatMany(r.stmts.map((function(t){if(t.id!==i)return[t];var a=o.obj_dup(t);return[t,(a.jstfText="",a.isDuplicated=!0,a.isBkm=h.getOr(e,t.isBkm),a.isGoal=!1,a.label=tr(r,void 0,"E"===t.typ),a.id=n,a)]}))),checkedStmtIds:[[n,new Date]],nextAction:r.nextAction};return t?rr(s,!0):s},t.bookmarkCheckedStmts=function(r,t){var e=r.checkedStmtIds.map((function(r){return r[0]}));return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts.map((function(r){if(!e.includes(r.id))return r;var n=o.obj_dup(r);return n.isBkm=t,n})),checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}},t.canGoEditModeForStmt=ar,t.setDescrEditMode=function(r){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:!0,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}},t.completeDescrEditMode=function(r,t){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:t,descrEditMode:!1,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}},t.setVarsEditMode=function(r){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:!0,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}},t.completeVarsEditMode=mr,t.setDisjEditMode=sr,t.completeDisjEditMode=ur,t.setLabelEditMode=function(r,t){return ar(r,t)?z(r,t,(function(r){var t=o.obj_dup(r);return t.labelEditMode=!0,t})):r},t.completeLabelEditMode=cr,t.setContEditMode=function(r,t){return ar(r,t)?z(r,t,(function(r){var t=o.obj_dup(r);return t.contEditMode=!0,t})):r},t.completeContEditMode=fr,t.setStmtCont=function(r,t,e){var n=F(e),i=r.preCtxData.settingsV.val.autoMergeStmts&&r.stmts.some((function(r){return F(r.cont)===n}));return z(r,t,(function(r){var t=o.obj_dup(r);return t.isDuplicated=i,t.cont=e,t}))},t.setTypEditMode=function(r,t){return ar(r,t)?z(r,t,(function(r){var t=o.obj_dup(r);return t.typEditMode=!0,t})):r},t.completeTypEditMode=Lr,t.setJstfEditMode=function(r,t){return ar(r,t)?z(r,t,(function(r){var t=o.obj_dup(r);return t.jstfEditMode=!0,t})):r},t.completeJstfEditMode=qr,t.setNextAction=function(r,t){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:t}},t.setPreCtxData=function(r,t){return lr({preCtxData:t,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:r.stmts,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction})},t.editorStateHasCriticalErrors=gr,t.editorStateHasAnyErrors=function(r){return!!gr(r)||r.stmts.some(xr)},t.editorStateHasDuplicatedStmts=function(r){return r.stmts.some((function(r){return f.getWithDefault(f.map(r.stmtErr,(function(r){return 1===r.code})),!1)}))},t.createNewDisj=wr,t.removeUnusedVars=Mr,t.applyUnifyAllResults=function(r,t){var e=r.wrkCtx;if(void 0!==e){var i=v.valFromOption(e),a=m.fromArray(t.nodes.map((function(r){return[r.expr,r]})),u.ExprHash),s=m.fromArray(r.stmts.map((function(r){var t=r.expr;if(void 0!==t)return[t,r];throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot applyUnifyAllResults without stmt.expr [1]."},Error:new Error}})),u.ExprHash),c=m.fromArray(t.syntaxProofs,u.ExprHash);return l.reduce(r.stmts,r,(function(r,e){var d=o.obj_dup(e);return d.proofStatus=void 0,d.proof=void 0,z(r,d.id,(function(e){var d=e.expr;if(void 0!==d){var l=function(r,t,e,n,i,a){var s=t.cont;if("Text"!==s.TAG)return t;var u=m.get(i,e.slice(1)),c=void 0!==u?_.buildSyntaxTreeFromProofTreeDto(n,a,u.expr):void 0;if(void 0!==c){if("Ok"===c.TAG){var f=o.obj_dup(t);return f.cont={TAG:"Tree",_0:{text:s.text,exprTyp:s.syms[0].sym,root:Dr(c._0,v.some(r.preCtxData.symColors),v.some(r.wrkCtxColors)),clickedNodeId:void 0,expLvl:0}},f}var d=o.obj_dup(t);return d.syntaxErr=c._0,d}if(!r.preCtxData.settingsV.val.checkSyntax)return t;var l=o.obj_dup(t);return l.syntaxErr=function(r,t){var e="Balanced";A.parenCntReset(t);for(var n=0;n<r.length&&"Failed"!==e;)e=A.parenCntPut(t,r[n]),n=n+1|0;return"Balanced"===e}(e,r.preCtxData.parenCnt)?"":"parentheses mismatch",l}(r,e,d,i,c,t);if("P"!==l.typ)return l;var p=m.get(a,d);if(void 0!==p){var h=function(r,t,e,n,i){var a,s=n.proof;if(void 0!==s){var u=Gr(t,e,s,i);if(void 0!==u){var c=r.jstf;if(void 0!==c)if(I.jstfEq(u,c)){var f=o.obj_dup(r);f.proof=n,f.proofTreeDto=e,a=f}else a=r;else{var d=o.obj_dup(r);d.proof=n,d.proofTreeDto=e,d.jstfText=I.jstfToStr(u),a=d}}else a=r}else a=r;var v=o.obj_dup(a);return v.proofTreeDto=e,v}(l,i,t,p,s),E=h.proof;if(void 0!==E){var x=o.obj_dup(h);return x.proofStatus="Ready",x.src=E.proof,x}var g=h.jstf;if(void 0!==g){var y=p.parents.find((function(r){var e=Gr(i,t,r,s);return void 0!==e&&I.jstfEq(g,e)}));if(void 0!==y){var T=o.obj_dup(h);return T.proofStatus="Waiting",T.src=y,T}var b=p.parents.map((function(r){return"object"!=typeof r||"AssertionWithErr"!==r.TAG?void 0:[r.label,r.err]})).filter(f.isSome).map(f.getExn),k=b.length>0?b.map((function(r){var t=r[0];return N.unifErrToStr(r[1],(function(r){return u.ctxIntsToStrExn(i,r)}),(function(r){return u.frmIntsToStrExn(i,u.getFrameExn(i,t),r)}))})).join("\n\n"):void 0,S=o.obj_dup(h);return S.unifErr=f.orElse(h.unifErr,k),S.proofStatus="JstfIsIncorrect",S}var C=p.parents.map((function(r){if("object"==typeof r&&"AssertionWithErr"===r.TAG){var t=r.err;return"object"!=typeof t||"TooManyCombinations"!==t.TAG?void 0:r.label}})).filter(f.isSome).map(f.getExn),w=C.length>0?N.unifErrToStr({TAG:"TooManyCombinations",frmLabels:C},(function(r){return u.ctxIntsToStrExn(i,r)}),(function(r){return"<frmExprToStr is not defined>"})):void 0,M=o.obj_dup(h);return M.unifErr=f.orElse(h.unifErr,w),M.proofStatus="NoJstf",M}throw{RE_EXN_ID:n.MmException,_1:{msg:"exprToNode->Belt_HashMap.get(expr) is None"},Error:new Error}}throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot applyUnifyAllResults without stmt.expr [2]."},Error:new Error}}))}))}throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot applyUnifyAllResults without wrkCtx."},Error:new Error}},t.verifyEditorState=function(r){var t=Sr(r);if(!f.isSome(t.wrkCtx))return t;var e=Mr(t);return Sr(e.preCtxData.settingsV.val.autoMergeStmts?Qr(e)[0]:e)},t.generateCompressedProof=function(r,t,e){var o=void 0!==e&&e,i=r.wrkCtx;if(void 0!==i){var a=v.valFromOption(i),s=H(r,t);if(void 0!==s){var d=s.proofTreeDto;if(void 0!==d){var l=s.proof;if(void 0!==l){var m=r.preCtxData.ctxV.val.min,h=W(s).expr,E=C.createProofTable(d,l,void 0,void 0),x=C.createProofTable(d,l,!0,v.some(a)),g=p.fromArray(E.map((function(r){return r.expr})),u.ExprHash),_=r.stmts.map(W);o&&_.forEach((function(r){if(r.isHyp)return p.add(g,r.expr)}));var A=c.createProofCtx(a,_.filter((function(r){return!!r.isHyp&&p.has(g,r.expr)}))),b=u.getMandHyps(A,h,void 0,void 0),k=y.createProof(b,E,E.length-1|0),S=[];b.forEach((function(r){f.isNone(u.getHypByExpr(m,r.expr))&&S.push(r)}));var I=T.make(16);p.forEach(g,(function(r){r.forEach((function(r){if(r>=0)return T.add(I,r)}))}));var M=T.fromArray(b.map((function(r){return r.expr[1]})));u.getLocalHyps(a).forEach((function(r){if("F"===r.typ){var t=r.expr[1];!T.has(I,t)||T.has(M,t)||S.push(r)}}));var G=u.disjMake();return w.verifyProof(A,h,k,(function(r,t){if(!u.isDisj(a,r,t))throw{RE_EXN_ID:n.MmException,_1:{msg:"!(wrkCtx->isDisj(n,m))"},Error:new Error};return u.isDisj(m,r,t)||u.disjAddPair(G,r,t),!0})),[Nr(a,r.preCtxData.typeOrderInDisj,S,G,r.descr,s,k),y.proofTableToStr(a,E,s.label),y.proofTableToStr(a,x,s.label)]}}}}},t.updateColorsInAllStmts=vr,t.getTheOnlyCheckedStmt=function(r){return 1!==r.checkedStmtIds.length?void 0:er(r)},t.editorGetStmtById=H,t.editorGetStmtByIdExn=X,t.editorGetStmtByLabel=q,t.getAllExprsToSyntaxCheck=function(r,t){var e=[];return r.stmts.forEach((function(r,n){"Text"===r.cont.TAG&&e.push(t[n].expr.slice(1))})),e},t.mergeStmts=Vr,t.renameStmt=Fr,t.findStmtsToMerge=function(r){var t;if(0===r.checkedStmtIds.length)t=r.stmts.find((function(r){return f.getWithDefault(f.map(r.stmtErr,(function(r){return 1===r.code})),!1)}));else{var e=r.checkedStmtIds[0];t=H(r,e[0])}if(void 0===t)return{TAG:"Error",_0:"[1] Cannot determine a duplicated step."};var n=F(t.cont),o=r.stmts.find((function(r){return r.id!==t.id&&F(r.cont)===n}));return void 0===o?{TAG:"Error",_0:"[2] Cannot find another step to merge with."}:r.stmts.findIndex((function(r){return r.id===t.id}))<r.stmts.findIndex((function(r){return r.id===o.id}))?{TAG:"Ok",_0:[t,o]}:{TAG:"Ok",_0:[o,t]}},t.parseJstf=Tr,t.removeAllTempData=hr,t.isEditMode=function(r){return!!(r.descrEditMode||r.varsEditMode||r.disjEditMode)||r.stmts.some((function(r){return!!(r.labelEditMode||r.typEditMode||r.contEditMode)||r.jstfEditMode}))},t.resetEditorContent=function(r){return{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:"",descrEditMode:!1,varsText:"",varsEditMode:!1,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:"",disjEditMode:!1,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:[],checkedStmtIds:[],nextAction:r.nextAction}},t.deleteUnrelatedSteps=function(r,t,e){var n=Sr(r);if(gr(n))return{TAG:"Error",_0:"Cannot perform deletion because there is an error in the editor content. Please resolve the error before deleting steps."};var o=S.fromArray(t);n.stmts.forEach((function(r){if(!e&&"E"===r.typ||r.isGoal||r.isBkm)return S.add(o,r.id)}));for(var i=G.make(Math.imul(t.length,5));!S.isEmpty(o);){var a=f.getExn(S.pop(o));if(!G.has(i,a)){G.add(i,a);var s=H(n,a);if(void 0!==s){var u=s.jstf;void 0!==u&&u.args.forEach((function(r){var t=q(n,r);if(void 0!==t)return S.add(o,t.id)}))}}}var c=n.stmts.map((function(r){return r.id})).filter((function(r){return!G.has(i,r)}));return{TAG:"Ok",_0:Z(n,c)}},t.autoMergeDuplicatedStatements=Qr,t.userStmtHasCriticalErrors=Er,t.userStmtHasAnyErrors=xr,t.createNewVars=Cr,t.addSteps=function(r,t,e,n,o){var i=void 0!==n?n:[],a=e.map($r);if(0===i.length)return zr(r,t,a);var s=r.wrkCtx;if(void 0===s)return{TAG:"Error",_0:"Cannot add new variables because of errors in the editor."};var c=v.valFromOption(s),d=i.map((function(r){return r[0]})),l=d.map((function(r){return u.ctxSymToInt(c,r)})),m=l.findIndex(f.isNone);if(m>=0)return{TAG:"Error",_0:"Unknown type - "+d[m]};var p=l.map(f.getExn);return function(r){return!!r.every((function(r){return f.isNone(r[1])}))||r.every((function(r){return f.isSome(r[1])}))}(i)?zr(i.some((function(r){return f.isNone(r[1])}))?Cr(r,p,void 0,o)[0]:Cr(r,p,i.map((function(r){return f.getExn(r[1])})),o)[0],t,a):{TAG:"Error",_0:"All variable names must be either defined or undefined."}},t.updateSteps=function(r,t){var e=t.map($r),n=[function(t,e){var n=e.cont;if(void 0===n)return{TAG:"Ok",_0:t};if(""===n.trim())return{TAG:"Error",_0:"Steps must not have empty statements."};var i=o.obj_dup(t);return{TAG:"Ok",_0:(i.isDuplicated=!1,i.contEditMode=!1,i.cont=V(n,v.some(r.preCtxData.symColors),v.some(r.wrkCtxColors)),i)}},function(r,t){var e=t.typ;if(void 0===e)return{TAG:"Ok",_0:r};var n=R(e),i=o.obj_dup(r);return{TAG:"Ok",_0:(i.isGoal=n[1],i.typEditMode=!1,i.typ=n[0],i)}},function(r,t){var e=t.jstf;if(void 0===e)return{TAG:"Ok",_0:r};var n=o.obj_dup(r);return{TAG:"Ok",_0:(n.jstfEditMode=!1,n.jstfText=e,n)}},function(r,t){var e=t.isBkm;if(void 0===e)return{TAG:"Ok",_0:r};var n=o.obj_dup(r);return{TAG:"Ok",_0:(n.isBkm=e,n)}}],i=M.fromArray(e.filter((function(r){return f.isSome(r.id)})).map((function(r){return[f.getExn(r.id),r]}))),a=l.reduce(r.stmts,{TAG:"Ok",_0:[]},(function(r,t){if("Ok"!==r.TAG)return r;var e=r._0,o=M.get(i,t.id),a=void 0!==o?l.reduce(n,{TAG:"Ok",_0:t},(function(r,t){return d.flatMap(r,(function(r){return t(r,o)}))})):{TAG:"Ok",_0:t};return"Ok"!==a.TAG?{TAG:"Error",_0:a._0}:(e.push(a._0),{TAG:"Ok",_0:e})}));return"Ok"===a.TAG?{TAG:"Ok",_0:{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:a._0,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}}:{TAG:"Error",_0:a._0}},t.getSelectedSubtree=Zr,t.getSelectedSubtreeFromStmtCont=function(r){return f.flatMap(function(r){return"Text"===r.TAG?void 0:r._0}(r),Zr)},t.getIdsOfSelectedNodes=function(r){if("Text"===r.TAG)return[-1,void 0];var t=r._0,e=t.clickedNodeId;if(void 0===e)return[-1,void 0];var n=Zr(t);return void 0!==n?[e[0],_.syntaxTreeGetIdsOfAllChildSymbols(n)]:[-1,void 0]},t.hasSelectedText=function(r){return"Text"!==r.TAG&&void 0!==r._0.clickedNodeId},t.getSelectedText=function(r){return"Text"===r.TAG?void 0:f.map(Zr(r._0),_.syntaxTreeToText)},t.getNodeIdBySymIdx=function(r,t){var e={contents:0};return _.syntaxTreeForEachNode({TAG:"Subtree",_0:t},(function(t){if("Subtree"!==t.TAG)return e.contents=e.contents+1|0,e.contents===r?t.id:void 0}))},t.incExpLvl=rt,t.decExpLvl=tt,t.incExpLvlIfConstClicked=function(r){if(0!==r.expLvl)return r;var t=r.clickedNodeId;if(void 0===t)return r;var e=_.getNodeById(r.root,t[0]);if(void 0===e)return r;if("Subtree"===e.TAG)return r;var n=_.syntaxTreeGetParent(r.root,e.id);return void 0!==n&&1!==_.syntaxTreeGetNumberOfSymbols({TAG:"Subtree",_0:n})?et(r,!0):r},t.getNumberOfSelectedSymbols=Yr,t.updateExpLevel=et,t.addColorsToSyntaxTree=Dr,t.getColorForSymbol=jr,t.renumberProvableSteps=function(r){return nt(r,(function(r){return"P"===r.typ&&!r.isGoal&&Br(r.label)}),"",!1)},t.renumberHypothesisSteps=function(r,t){return nt(r,(function(r){return"E"===r.typ}),t+".",!0)},t.textToSyntaxProofTable=ot,t.textToSyntaxTree=function(r,t,e,n,o,i,a,s){var u=ot(r,t,e,n,o,i,a,s);return"Ok"===u.TAG?{TAG:"Ok",_0:u._0.map((function(t){if("Ok"!==t.TAG)return{TAG:"Error",_0:t._0};var e=t._0;return _.buildSyntaxTree(r,e,e.length-1|0)}))}:{TAG:"Error",_0:u._0}},t.recalcWrkColors=lr,t.reorderSteps=function(r){var t=r.stmts.filter((function(r){return"E"===r.typ})),e=r.stmts.filter((function(r){return"E"!==r.typ})),n=M.make(r.stmts.length);r.stmts.forEach((function(r){h.forEach(it(r.jstfText),(function(t){M.set(n,r.label,t)}))}));for(var o={contents:!0};o.contents;){o.contents=!1;var i=G.fromArray(t.map((function(r){return r.label})));e=e.filter(function(r){return function(t){return!G.has(r,t.label)}}(i)),e.forEach(function(r){return function(e){var i=M.get(n,e.label);if(void 0!==i&&at(r,v.valFromOption(i)))return t.push(e),void(o.contents=!0)}}(i)),o.contents||e.forEach((function(r){return void 0!==M.get(n,r.label)?void 0:(t.push(r),void(o.contents=!0))}))}return e.forEach((function(r){t.push(r)})),{preCtxData:r.preCtxData,tabTitle:r.tabTitle,descr:r.descr,descrEditMode:r.descrEditMode,varsText:r.varsText,varsEditMode:r.varsEditMode,varsErr:r.varsErr,wrkCtxColors:r.wrkCtxColors,disjText:r.disjText,disjEditMode:r.disjEditMode,disjErr:r.disjErr,wrkCtx:r.wrkCtx,nextStmtId:r.nextStmtId,stmts:t,checkedStmtIds:r.checkedStmtIds,nextAction:r.nextAction}},t.makeCommentFromDescription=Or},6322:(r,t,e)=>{var n=e(7175),o=e(6778),i=e(7356),a=e(19),s=e(263);t.parsePattern=function(r,t,e){return 1===t?o.map(a.makeSearchPattern(r,e),(function(r){return{TAG:"V1",pattern:r,mapping:i.make(10)}})):2===t?o.map(s.parsePattern(r,void 0,n.some(e)),(function(r){return{TAG:"V2",_0:r}})):{TAG:"Error",_0:"Unexpected pattern version "+t.toString()}},t.frameMatchesPattern=function(r,t){if("V1"===t.TAG)return a.frameMatchesPattern(r,t.pattern,t.mapping)?{TAG:"Matched",_0:void 0}:"NotMatched";var e=s.frameMatchesPatterns(r,t._0);return"object"!=typeof e?"NotMatched":{TAG:"Matched",_0:e._0}},t.patternIsEmpty=function(r){return"V1"===r.TAG?0===r.pattern.length:0===r._0.length}},19:(r,t,e)=>{var n=e(3333),o=e(2761),i=e(2448),a=e(7356);function s(r){switch(r){case"!":return{TAG:"Ok",_0:"Exact"};case"+":return{TAG:"Ok",_0:"Adj"};case"a":return{TAG:"Ok",_0:"Asrt"};case"h":return{TAG:"Ok",_0:"Hyp"};default:return{TAG:"Error",_0:"Cannot convert '"+r+"' to patternModifier"}}}function u(r){for(var t=[],e=!1,n=[],o=[],a=[],u={contents:0},c=r.length-1|0,f={contents:void 0},d=function(r){f.contents=function(r){return r+" at position "+String(u.contents+1|0)+"."}(r)},v=function(r){r.splice(0,r.length)},l=function(){if(a.length>0)return o.push(a.join("")),v(a)},m=function(){return l(),n.length>0&&0===o.length?d("At least one symbol is expected"):o.length>0?(t.push([n.slice(),o.slice()]),v(n),v(o)):void 0};u.contents<=c&&i.isNone(f.contents);){var p=r.charAt(u.contents);if(""===p.trim())e?e=!1:l();else if(e){var h=s(p);"Ok"===h.TAG?(n.push(h._0),n.includes("Hyp")&&n.includes("Asrt")?d("A sub-pattern cannot be both a hypothesis and an assertion"):n.includes("Adj")&&n.includes("Exact")&&d("A sub-pattern cannot be both Adjacent and Exact")):d(h._0)}else"$"===p?(m(),e=!0):a.push(p);u.contents=u.contents+1|0}var E=f.contents;if(void 0!==E)return{TAG:"Error",_0:E};m();var x=f.contents;return void 0!==x?{TAG:"Error",_0:x}:t.length>1&&t.some((function(r){var t=r[0];return!(t.includes("Hyp")||t.includes("Asrt"))}))?{TAG:"Error",_0:"Each sub-pattern must be either a hypothesis or an assertion."}:{TAG:"Ok",_0:t}}function c(r,t,e,n){for(var o=0,i=t.length-1|0,a=n,s=r.length-1|0,u=!0;u&&o<=i&&a<=s;){var c=r[a],f=t[o];u=c<0&&c===f||c>=0&&e[c]===f,o=o+1|0,a=a+1|0}return!!u&&o>i}function f(r,t,e,n,o,i){for(var s=0,u=t.length-1|0,c=i,f=r.length-1|0,d=!0;d&&s<=u&&c<=f;){var v=r[c],l=t[s];if(v<0)d=v===l;else if((d=n[v]===e[s])&&l>=0){var m=a.get(o,l);void 0!==m?d=m===v:a.set(o,l,v)}s=s+1|0,c=c+1|0}return a.clear(o),!!d&&s>u}function d(r,t,e,n,o,i,s){if(i===t.length)return!0;for(var u={contents:s},c=function(){return d(r,t,e,n,o,i+1|0,u.contents+1|0)},f=!1,v=r.length-(t.length-i|0)|0;!f&&u.contents<=v;){var l=r[u.contents],m=t[i];if(l<0&&l===m)f=c();else if(l>=0&&n[l]===e[i])if(m<0)f=c();else{var p=a.get(o,m);void 0!==p?p===l&&(f=c()):(a.set(o,m,l),f=c(),a.remove(o,m))}u.contents=u.contents+1|0}return f}function v(r,t,e,n,o,i){if(function(r,t,e,n){var o=t.length,i=r.length;if(n.includes("Exact"))return o===i&&c(r,t,e,0);if(n.includes("Adj")){for(var a=!1,s=0,u=i-o|0;!a&&s<=u;)a=c(r,t,e,s),s=s+1|0;return a}for(var f=0,d=0;f<o&&d<i;){var v=r[d],l=t[f];(v<0&&v===l||v>=0&&e[v]===l)&&(f=f+1|0),d=d+1|0}return f===o}(r,e,n,o)){var a=e.length,s=r.length;if(o.includes("Exact"))return a===s&&f(r,t,e,n,i,0);if(!o.includes("Adj"))return d(r,t,e,n,i,0,0);for(var u=!1,v=0,l=s-a|0;!u&&v<=l;)u=f(r,t,e,n,i,v),v=v+1|0;return u}return!1}t.makeSearchPattern=function(r,t){var e=u(r);return"Ok"===e.TAG?o.reduce(e._0,{TAG:"Ok",_0:[]},(function(r,e){var o=e[1];if("Ok"!==r.TAG)return r;var a=r._0,s=o.find((function(r){return i.isNone(n.ctxSymToInt(t,r))}));if(void 0!==s)return{TAG:"Error",_0:"'"+s+"' - is not a constant or a variable."};var u=n.ctxSymsToIntsExn(t,o),c=u.map((function(r){return r<0?r:n.getTypeOfVarExn(t,r)}));return a.push({flags:e[0],varPat:u,constPat:c}),{TAG:"Ok",_0:a}})):{TAG:"Error",_0:e._0}},t.frameMatchesPattern=function(r,t,e){if(1!==t.length||t[0].flags.includes("Hyp")||t[0].flags.includes("Asrt")){var n=function(r,t,e){return t===r.length||r[t].some((function(o){if(e.includes(o))return!1;e.push(o);var i=n(r,t+1|0,e);return e.pop(),i}))},i=r.varTypes,a=t.filter((function(r){return r.flags.includes("Asrt")})),s=a.find((function(t){return!v(r.asrt,t.varPat,t.constPat,i,t.flags,e)}));if(void 0!==s)return!1;var u=t.filter((function(r){return r.flags.includes("Hyp")}));if(0===u.length)return!0;var c=r.hyps.filter((function(r){return"E"===r.typ}));if(c.length<u.length)return!1;var f=o.reduce(u,[],(function(r,t){if(void 0!==r){var n=c.map((function(r,t){return[r,t]})).filter((function(r){return v(r[0].expr,t.varPat,t.constPat,i,t.flags,e)})).map((function(r){return r[1]}));return 0===n.length?void 0:(r.push(n),r)}}));return void 0!==f&&n(f,0,[])}var d=t[0],l=d.varPat,m=d.constPat,p=d.flags,h=r.varTypes;return!!v(r.asrt,l,m,h,p,e)||o.reduce(r.hyps,!1,(function(r,t){return!!r||"E"===t.typ&&v(t.expr,l,m,h,p,e)}))},t.parseSearchStr=u},263:(r,t,e)=>{var n=e(6253),o=e(5291),i=e(2900),a=e(3333),s=e(7175),u=e(2761),c=e(2448),f=e(6778),d=e(3533),v=e(2275),l=e(2559);function m(r,t){return c.getExn(r[t],"No type is defiend for var "+t.toString())}function p(r,t,e){return r===t||r>=0&&m(e,r)===t}function h(r){return u.reduce(r,0,(function(r,t){return r+t.minLen|0}))}function E(r,t,e,n){switch(e){case"Frm":return n.stmtBnds[r];case"Hyps":return r===n.numOfHyps?t:n.stmtBnds[r];case"Asrt":return r===n.numOfHyps?n.stmtBnds[r]:t}}function x(r,t,e,n){switch(e){case"Frm":return c.mapOr(n.stmtBnds[r+1|0],t-1|0,(function(r){return r-1|0}));case"Hyps":return r===n.numOfHyps?-1:n.stmtBnds[r+1|0]-1|0;case"Asrt":return r===n.numOfHyps?t-1|0:-1}}function g(r,t,e){switch(t){case"Frm":return 0;case"Hyps":return e.numOfHyps>0?0:r;case"Asrt":return e.stmtBnds[e.numOfHyps]}}function y(r,t,e){switch(t){case"Hyps":return e.numOfHyps>0?e.stmtBnds[e.numOfHyps]-1|0:-1;case"Frm":case"Asrt":return r-1|0}}function _(r,t,e,n,o,i,a){var s=r.length,u=n.target;if(a<=i.numOfHyps)return T(r,t,e,n,o,i,a);if(n.singleStmt){for(var c=0,f=-1;c<=i.numOfHyps&&f<0;){var d=Math.max(t,E(c,s,u,i)),v=Math.min(e,x(c,s,u,i));d<=v&&(f=T(r,d,v,n,o,i,c)),c=c+1|0}return f}var l=Math.max(t,g(s,u,i)),m=Math.min(e,y(s,u,i));return l<=m?T(r,l,m,n,o,i,function(r,t){switch(r){case"Frm":return t.numOfHyps+2|0;case"Hyps":return t.numOfHyps+1|0;case"Asrt":return t.numOfHyps}}(u,i)):-1}function T(r,t,e,n,o,i,a){if(e<t||n.minConstMismatchIdx[a]<=t)return-1;var s,u=n.elems;switch(u.TAG){case"Adjacent":s=function(r,t,e,n,o){for(var i=t,a=(e+1|0)-n.length|0,s=!1,u=n.length-1|0;i<=a&&!s;){s=!0;for(var c=i,f=0;f<=u&&s;){var d=n[f],v=r[c],l=d.constOrVar;s="Const"===l.TAG?p(v,l._0,o):v>=0&&m(o,v)===l._0.typ,c=c+1|0,f=f+1|0}s||(i=i+1|0)}return s?i+u|0:-1}(r,t,e,u._0,o);break;case"Ordered":s=function(r,t,e,n,o,i,a){for(var s=t-1|0,u=!0,c=0,f=n.length-1|0;c<=f&&u;)u=0<=(s=_(r,s+1|0,e,n[c],o,i,a))&&s<=e,c=c+1|0;return u?s:-1}(r,t,e,u._0,o,i,a);break;case"Unordered":s=A(r,t,e,u._0,o,[],i,a);break;case"OneOf":s=function(r,t,e,n,o,i,a){for(var s=-1,u=0,c=n.length-1|0;s<0&&u<=c;){var f=n[u];if(t<f.minConstMismatchIdx[a]){var d=_(r,t,e,f,o,i,a);0<=d&&d<=e&&(s=d)}u=u+1|0}return s}(r,t,e,u._0,o,i,a)}return s<0&&(n.minConstMismatchIdx[a]=t),s}function A(r,t,e,n,o,i,a,s){if(i.length===n.length)return t-1|0;for(var u=-1,c=0,f=n.length-1|0;u<0&&c<=f;){if(!i.includes(c)){var d=n[c];if(t<d.minConstMismatchIdx[s]){var v=_(r,t,e,d,o,a,s);0<=v&&v<=e&&(i.push(c),u=A(r,v+1|0,e,n,o,i,a,s),i.pop())}}c=c+1|0}return u}function b(r,t,e,n,o,i,a,s,u){var c=r.length,f=n.target;if(u<=i.numOfHyps)return k(r,t,e,n,o,a,s,i,u);if(!n.singleStmt){var d=Math.max(t,g(c,f,i)),v=Math.min(e,y(c,f,i));return d<=v?k(r,d,v,n,o,a,s,i,u):void 0}for(var l=0;l<=i.numOfHyps&&!s.contents;){var m=Math.max(t,E(l,c,f,i)),p=Math.min(e,x(l,c,f,i));m<=p&&k(r,m,p,n,o,a,s,i,l),l=l+1|0}}function k(r,t,e,n,o,i,a,s,u){if(t<=e&&t<n.minConstMismatchIdx[u]){var f=n.elems;switch(f.TAG){case"Adjacent":for(var d=f._0,v=t,l=(e+1|0)-d.length|0,h=!1,E=d.length-1|0;v<=l&&!h;){h=!0;for(var x=v,g=0;g<=E&&h;){var y=d[g],_=r[x],T=y.constOrVar;if("Const"===T.TAG)h=p(_,T._0,o);else{var A=T._0;A.capVar>=0?h=A.capVar===_:_>=0&&!c.getExn(A.capVars.contents[_],"capVars.length is too small.")&&m(o,_)===A.typ?(A.capVar=_,A.capVars.contents[A.capVar]=!0,A.capVarIdx=x):h=!1}h&&(y.matchedIdx=x),x=x+1|0,g=g+1|0}for(h&&i({matchBegin:v,matchEnd:v+E|0}),g=Math.min(g,E);g>=0;){var k=d[g];k.matchedIdx=-1;var w=k.constOrVar;if("Const"!==w.TAG){var I=w._0;(v+g|0)===I.capVarIdx&&(I.capVars.contents[I.capVar]=!1,I.capVar=-1)}g=g-1|0}v=v+1|0}return;case"Ordered":return S(r,t,e,f._0,o,i,void 0,0,a,s,u);case"Unordered":return C(r,t,e,f._0,o,[],i,void 0,a,s,u);case"OneOf":for(var M=f._0,G=0,j=M.length-1|0;!a.contents&&G<=j;){for(var D=M[G],O={contents:t},N=(e+1|0)-D.minLen|0;!a.contents&&O.contents<=N&&O.contents<D.minConstMismatchIdx[u];){var P=O.contents;O.contents=N+1|0,b(r,P,e,D,o,s,function(r){return function(t){if(t.matchEnd<=e)return i(t),void(r.contents=t.matchBegin+1|0)}}(O),a,u)}G=G+1|0}return}}}function S(r,t,e,n,o,a,s,u,c,f,d){if(n.length<=u)return void 0!==s?a({matchBegin:s.matchBegin,matchEnd:t-1|0}):i.raiseError("exprIncludesVarOrderedSeq: res is None");if(!(t>e))for(var v=n[u],l={contents:t},m=(e+1|0)-v.minLen|0;!c.contents&&l.contents<=m&&l.contents<v.minConstMismatchIdx[d];){var p=l.contents;l.contents=m+1|0,b(r,p,e,v,o,f,function(t){return function(i){if(i.matchEnd<=e)return S(r,i.matchEnd+1|0,e,n,o,a,void 0!==s?s:{matchBegin:t,matchEnd:-1},u+1|0,c,f,d),void(l.contents=i.matchBegin+1|0)}}(p),c,d)}}function C(r,t,e,n,o,a,s,u,c,f,d){if(a.length===n.length)return void 0!==u?s({matchBegin:u.matchBegin,matchEnd:t-1|0}):i.raiseError("exprIncludesVarUnorderedSeq: res is None");if(!(t>e))for(var v={contents:0},l=n.length-1|0;!c.contents&&v.contents<=l;){if(!a.includes(v.contents))for(var m=n[v.contents],p={contents:t},h=(e+1|0)-m.minLen|0;!c.contents&&p.contents<=h&&p.contents<m.minConstMismatchIdx[d];){var E=p.contents;p.contents=h+1|0,b(r,E,e,m,o,f,function(t,i){return function(l){if(l.matchEnd<=e)return a.push(v.contents),C(r,l.matchEnd+1|0,e,n,o,a,s,void 0!==u?u:{matchBegin:i,matchEnd:-1},c,f,d),a.pop(),void(t.contents=l.matchBegin+1|0)}}(p,E),c,d)}v.contents=v.contents+1|0}}function w(r,t,e,o){var a={contents:void 0},s=r.length-1|0,u=o.numOfHyps+2|0;if(0<=_(r,0,s,t,e,o,u)){var c={contents:!1};b(r,0,s,t,e,o,(function(r){return c.contents=!0,void 0!==a.contents?i.raiseError("next() is called twice in exprIncludesSeq."):void(a.contents=function(r){var t=[],e=function(r){var n=r.elems;"Adjacent"!==n.TAG?n._0.forEach(e):n._0.forEach((function(r){r.matchedIdx>=0&&t.push(r.matchedIdx)}))};return e(r),t.sort(n.int_compare),t}(t))}),c,u)}return a.contents}function I(r,t){return{constOrVar:c.getExn(v.get(t,r),"makeSym: unknown symbol "+r),matchedIdx:-1}}function M(r,t,e){var n,o=l.passFlagsFromParentToChild(t,r.flags),i=o.target;if(void 0!==i)switch(i){case"Frm":n="Frm";break;case"Hyps":n="Hyps";break;case"Asrt":n="Asrt"}else n="Frm";var a,s=c.getOr(o.singleStmt,!1),f=function(r,t,e,n,o){switch(r.TAG){case"Symbols":var i=r._0;return function(r){return c.getOr(r.adj,!1)}(t)||1===i.length?{TAG:"Adjacent",_0:i.map((function(r){return I(r,o)}))}:{TAG:"Ordered",_0:i.map((function(r){return{elems:{TAG:"Adjacent",_0:[I(r,o)]},target:e,singleStmt:n,minLen:1,minConstMismatchIdx:[]}}))};case"Ordered":return{TAG:"Ordered",_0:r._0.map((function(r){return M(r,t,o)}))};case"Unordered":return{TAG:"Unordered",_0:r._0.map((function(r){return M(r,t,o)}))};case"OneOf":return{TAG:"OneOf",_0:r._0.map((function(r){return M(r,t,o)}))}}}(r.elems,o,n,s,e);switch(f.TAG){case"Adjacent":a=f._0.length;break;case"Ordered":case"Unordered":a=h(f._0);break;case"OneOf":var d=f._0;a=u.reduce(d,c.getOr(c.map(d[0],(function(r){return r.minLen})),0),(function(r,t){return Math.min(r,t.minLen)}))}return{elems:f,target:n,singleStmt:s,minLen:a,minConstMismatchIdx:[]}}function G(r,t,e,n){var o=void 0!==t?t:function(r){},i=void 0!==e?e:function(r){},a=void 0!==n?n:function(r){};o(r),i(r.elems);var s=r.elems;"Symbols"!==s.TAG?s._0.forEach((function(r){G(r,o,i,a)})):s._0.forEach(a)}function j(r,t,e,n){var o=void 0!==t?t:function(r){},i=void 0!==e?e:function(r){},a=void 0!==n?n:function(r){};o(r),i(r.elems);var s=r.elems;"Adjacent"!==s.TAG?s._0.forEach((function(r){j(r,o,i,a)})):s._0.forEach(a)}function D(r,t){j(r,(function(r){t.push(r)}),void 0,void 0)}function O(r,t,e){var n=v.make(20),o=[];return G(r.symSeq,void 0,void 0,(function(r){var i=a.getTokenType(t,r);if(void 0!==i)switch(i){case"C":return v.has(n,r)?void 0:v.set(n,r,{TAG:"Const",_0:a.ctxSymToIntExn(t,r)});case"V":return v.has(n,r)?void 0:v.set(n,r,{TAG:"Var",_0:{typ:a.getTypeOfVarExn(t,a.ctxSymToIntExn(t,r)),capVars:e,capVar:-1,capVarIdx:-1}})}o.push("'"+r+"' is not a math symbol")})),0===o.length?{TAG:"Ok",_0:n}:{TAG:"Error",_0:o.join("; ")}}function N(r,t){var e=o.getSpaceSeparatedValuesAsArray(r.trim()),n=[];return e.forEach((function(r){if(r.includes("$")){if(r.startsWith("$")){if(r===l.operatorOrdered||r===l.operatorUnordered||r===l.operatorOneOf||r===l.openParenthesis||r===l.closeParenthesis)return;var e=r.substring(r.startsWith(l.openParenthesis)?2:1);if(e.length<=0)return;for(var o=!1,i=!1,s=!1,u=!1,c=!1,f=!1,d=0,v=e.length;d<v;++d){var m=e.charAt(d);m===l.flagHyps?o=!0:m===l.flagHyp?i=!0:m===l.flagAsrt?s=!0:m===l.flagAdj?u=!0:m===l.flagNonAdj?c=!0:m===l.flagSingleStmt||(m===l.flagNegation?f=!0:n.push("'"+r+"' - invalid flag '"+m+"'"))}return(o||i)&&s&&n.push("'"+r+"' - flags '"+l.flagHyps+"', '"+l.flagHyp+"', and '"+l.flagAsrt+"' cannot be used together"),u&&c&&n.push("'"+r+"' - flags '"+l.flagAdj+"' and '"+l.flagNonAdj+"' cannot be used together"),(r.startsWith(l.openParenthesis)||r.startsWith(l.closeParenthesis))&&f?void n.push("'"+r+"' - flag '"+l.flagNegation+"' cannot be used with parentheses"):void 0}n.push("'"+r+"' - all control tokens must start with '$'")}else{var p=a.getTokenType(t,r);if(void 0!==p)switch(p){case"C":case"V":return}n.push("'"+r+"' - is not a constant or variable")}})),function(r){for(var t=0,e=0,n=r.length-1|0,o=!1;e<=n&&!o;){var i=r[e];i.startsWith(l.openParenthesis)?t=t+1|0:i===l.closeParenthesis&&(t=t-1|0)<0&&(o=!0),e=e+1|0}return!o&&0===t}(e)||n.push("parentheses mismatch"),e.length>0&&(void 0!==l.isPatternBegin(e[0])||c.forEach(u.reduceWithIndex(e,void 0,(function(r,t,e){return void 0!==r||0===e?r:l.isPatternBegin(t)})),(function(r){n.push("when multiple patterns are specified, each pattern must begin with $")}))),0===n.length?void 0:n.join("\n")}function P(r,t){for(var e=r.hyps.filter((function(r){return"E"===r.typ})),n=e.length,o=u.fromInitializer(n+1|0,(function(r){return[]})),i=0,a=t.length-1|0,s=0,f=n-1|0,d=0;s<=f;){for(var v=e[s].expr.length,l=(d+v|0)-1|0,m=o[s],p=t[i];c.mapOr(p,!1,function(r){return function(t){return t<=r}}(l))&&i<=a;)m.push(c.getExn(p,void 0)-d|0),p=t[i=i+1|0];d=d+v|0,s=s+1|0}for(var h=o[s];i<=a;)h.push(t[i]-d|0),i=i+1|0;return o}function U(r){var t=c.getExn(r[0],"mergeMatchedIndices: error 1").length,e=u.fromInitializer(t,(function(r){return[]}));return r.forEach((function(r){r.forEach((function(r,t){d.spliceObjApply(c.getExn(e[t],"mergeMatchedIndices: error 2"),"push",[r])}))})),e.forEach((function(r){r.sort(n.int_compare)})),e}t.parsePattern=function(r,t,e){var n=r.trim();if(0===n.length)return{TAG:"Ok",_0:[]};var o=c.flatMap(e,(function(r){return N(n,r)}));if(void 0!==o)return{TAG:"Error",_0:o};var i=l.parsePattern(n);if(void 0===i)return{TAG:"Error",_0:"Cannot parse the pattern '"+n+"'"};var a=i.map((function(r){var n=void 0!==t?{TAG:"Ok",_0:s.valFromOption(t)}:O(r,c.getExn(e,"parsePattern: either symMap or ctx must be provided."),{contents:[]});return f.map(n,(function(t){var e=c.mapOr(v.valuesToArray(t).find((function(r){return"Const"!==r.TAG})),{contents:[]},(function(r){return"Const"===r.TAG?{contents:[]}:r._0.capVars})),n=r.neg,o=M(r.symSeq,r.flags,t),i=[],a={neg:n,symSeq:o,allSeq:i,capVars:e};return D(o,i),a}))}));return u.reduce(a,{TAG:"Ok",_0:[]},(function(r,t){if("Ok"===r.TAG){var e=r._0;return"Ok"!==t.TAG?{TAG:"Error",_0:t._0}:(e.push(t._0),{TAG:"Ok",_0:e})}var n=r._0;return"Ok"===t.TAG?{TAG:"Error",_0:n}:{TAG:"Error",_0:n+"; "+t._0}}))},t.frameMatchesPatterns=function(r,t){if(0===t.length)return{TAG:"Matched",_0:void 0};var e=c.map(u.reduce(t,[],(function(t,e){if(void 0!==t){var n=function(r,t){var e=a.frmGetPatternSearchData(r),n=e.allHypsAsrt,o=n.length;t.allSeq.forEach((function(r){for(var t=e.numOfHyps+2|0;r.minConstMismatchIdx.length<=t;)r.minConstMismatchIdx.push(o);for(var n=0;n<=t;++n)r.minConstMismatchIdx[n]=o})),t.capVars.contents.length<r.varTypes.length&&(t.capVars.contents=u.make(r.varTypes.length,!1));var i=c.map(w(n,t.symSeq,r.varTypes,e),(function(t){return P(r,t)}));return void 0!==i?t.neg?void 0:i:t.neg?P(r,[]):void 0}(r,e);return void 0!==n?(t.push(n),t):void 0}})),U);return void 0!==e?{TAG:"Matched",_0:e}:"NotMatched"},t.validatePattern=N,t.countMinLen=h,t.exprIncludesSeq=w,t.convertMatchedIndices=P,t.mergeMatchedIndices=U},2559:(r,t,e)=>{var n=e(5291),o=e(8969),i=e(7175),a=e(2448),s=e(3533),u="$*",c="$/",f="$|",d="$[",v="$]",l="+",m="-",p="H",h="h",E="a",x="s",g="!";function y(r,t){return{flags:void 0!==t?t:{adj:void 0,target:void 0,singleStmt:void 0},elems:r}}var _=p+x;function T(r){var t=r.replaceAll(h,_);return{adj:!!t.includes(l)||!t.includes(m)&&void 0,target:t.includes(E)?"Asrt":t.includes(p)?"Hyps":void 0,singleStmt:!!t.includes(x)||void 0}}function A(r){if(r.startsWith("$")&&!(r.startsWith(u)||r.startsWith(c)||r.startsWith(f)||r.startsWith(d)||r.startsWith(v)))return{flags:T(r),neg:r.includes(g),symSeq:{flags:{adj:void 0,target:void 0,singleStmt:void 0},elems:{TAG:"Symbols",_0:[]}}}}function b(r,t){var e,n=r.target;if(void 0!==n)switch(n){case"Frm":e=t.target;break;case"Hyps":case"Asrt":e=r.target}else e=t.target;var o=r.singleStmt;return{adj:a.orElse(t.adj,r.adj),target:e,singleStmt:!(void 0===o||!o)||t.singleStmt}}function k(r,t){return void 0!==r?{flags:r.flags,neg:r.neg,symSeq:t}:{flags:{adj:void 0,target:void 0,singleStmt:void 0},neg:!1,symSeq:t}}var S=o.match((function(r){if(r.startsWith(d))return T(r)})),C=o.map(o.val(v),(function(r){})),w=o.match((function(r){return r.includes("$")?void 0:r})),I=o.map(o.nonEmpty(o.rep(w,void 0,void 0)),(function(r){return y({TAG:"Symbols",_0:r},void 0)})),M=o.oneOf([u,c,f]),G=o.match((function(r){if("Seq"===r.TAG)return r._0}));function j(r,t,e){return o.map(o.map(o.seq2(o.nonEmpty(o.rep(o.map(o.seq2(t,o.match((function(t){return"Seq"===t.TAG||t._0!==r?void 0:i.some(void 0)}))),(function(r){return r[0]})),void 0,void 0)),t),(function(r){return r[0].concat([r[1]])})),(function(r){return y(e(r),void 0)}))}var D=j(u,G,(function(r){return{TAG:"Ordered",_0:r}})),O=j(c,o.any([D,G]),(function(r){return{TAG:"Unordered",_0:r}})),N=j(f,o.any([O,D,G]),(function(r){return{TAG:"OneOf",_0:r}})),P=o.any([N,O,D]);function U(){return o.anyL([R,F,function(){return I}])}function F(){return o.map(o.seq3(S,U(),C),(function(r){var t=r[1];return{flags:b(r[0],t.flags),elems:t.elems}}))}function V(){return o.any([F(),I])}function R(){return o.flatMap(o.map(o.seq2(o.map(o.nonEmpty(o.rep(o.map(o.seq2(V(),M),(function(r){return[{TAG:"Seq",_0:r[0]},{TAG:"Operator",_0:r[1]}]})),void 0,void 0)),(function(r){return s.spliceObjApply([],"concat",[r])})),V()),(function(r){return r[0].concat([{TAG:"Seq",_0:r[1]}])})),(function(r){return P}))}var B=o.map(o.seq2(o.opt(o.match(A)),U()),(function(r){return k(r[0],r[1])})),W=o.map(o.seq2(o.match(A),U()),(function(r){return k(r[0],r[1])})),L=o.end(o.any([o.nonEmpty(o.rep(W,void 0,void 0)),o.map(B,(function(r){return[r]}))]));t.parseFlags=T,t.passFlagsFromParentToChild=b,t.parsePattern=function(r){return o.parse(n.getSpaceSeparatedValuesAsArray(r.trim()),L)},t.operatorOrdered=u,t.operatorUnordered=c,t.operatorOneOf=f,t.openParenthesis=d,t.closeParenthesis=v,t.flagAdj=l,t.flagNonAdj=m,t.flagHyps=p,t.flagHyp=h,t.flagAsrt=E,t.flagSingleStmt=x,t.flagNegation=g,t.isPatternBegin=A},6848:(r,t,e)=>{var n=e(5291),o=e(3333),i=e(9592),a=e(2448),s=e(7356),u=e(7659),c=e(4792),f=e(1874),d=e(9010),v=e(7470),l=e(2275);function m(r){var t=u.make(16),e=u.make(16);return o.forEachHypothesisInDeclarationOrder(r,(function(r){var n=r.expr[0];u.add(e,n),"F"===r.typ&&u.add(t,n)})),o.forEachFrame(r,(function(r){u.add(e,r.asrt[0]),r.hyps.forEach((function(r){var n=r.expr[0];if(u.add(e,n),"F"===r.typ)return u.add(t,n)}))})),[u.toArray(e),u.toArray(t)]}function p(r,t){var e=l.make(100);return o.forEachHypothesisInDeclarationOrder(r,(function(n){if("F"===n.typ){var i=o.ctxIntToSym(r,n.expr[0]);if(void 0!==i){var a=l.get(t,i);void 0!==a&&l.set(e,o.ctxIntToSymExn(r,n.expr[1]),a)}}})),e}t.preCtxDataMake=function(r){return{settingsV:n.versionMake(r),srcs:[],ctxV:n.versionMake({full:o.createContext(void 0,void 0),min:o.createContext(void 0,void 0)}),frms:f.frmsEmpty(),parenCnt:c.parenCntMake(0,0,0,0,0),allTypes:[],syntaxTypes:[],parensMap:l.make(0),typeOrderInDisj:s.make(0),typeColors:l.make(0),symColors:l.make(0),asrtSyntaxTrees:void 0}},t.preCtxDataUpdate=function(r,t,e){for(var s=a.mapOr(t,r.settingsV,(function(t){return n.versionSet(r.settingsV,t)})),u=a.mapOr(e,[r.srcs,r.ctxV],(function(t){var e=t[1];return[t[0],n.versionSet(r.ctxV,{full:e,min:e})]})),c=u[1],h=o.ctxOptimizeForProver(c.val.full,s.val.parens,!1,!1,!0),E=o.ctxOptimizeForProver(h,s.val.parens,!0,!0,!1),x=n.versionSet(c,{full:h,min:E}),g=x.val.min,y=f.prepareFrmSubsData(g),_=i.makeParenCnt(g,s.val.parens),T=m(g),A=d.prepareParenInts(g,s.val.parens),b=A.length/2|0,k=l.make(b),S=0;S<b;++S)l.set(k,o.ctxIntToSymExn(g,A[S<<1]),o.ctxIntToSymExn(g,A[1+(S<<1)|0]));var C=n.createTypeOrderFromStr(s.val.sortDisjByType,(function(r){return o.ctxSymToInt(g,r)})),w=v.settingsGetTypeColors(s.val),I=p(g,w);return{settingsV:s,srcs:u[0],ctxV:x,frms:y,parenCnt:_,allTypes:T[0],syntaxTypes:T[1],parensMap:k,typeOrderInDisj:C,typeColors:w,symColors:I,asrtSyntaxTrees:void 0}},t.findTypes=m,t.createSymbolColors=p},7115:(r,t,e)=>{var n=e(2900),o=e(2971),i=e(3333),a=e(1094),s=e(303),u=e(2448),c=e(9662),f=e(8492),d=e(7653),v=e(6322),l="MM_wrk_search_asrt";function m(r,t){return void 0===r||r===t}function p(r,t,e,o,i,a,s,c,f,l,p){var h,E=d.progressTrackerMake(.01,void 0,p,void 0),x={contents:0},g=r.length,y=v.parsePattern(i,a,s);h="Ok"===y.TAG?y._0:n.raiseError("Cannot parse the search pattern in doSearchAssertions: "+y._0);var _=o.trim().toLowerCase();return r.map((function(r){void 0!==p&&(x.contents=x.contents+1,d.progressTrackerSetCurrPct(E,x.contents/g));var n=u.mapOr(t,!0,(function(t){return t===r.isAxiom}))&&u.mapOr(e,!0,(function(t){return t===r.asrt[0]}))&&r.label.toLowerCase().includes(_)&&m(c,r.isDisc)&&m(f,r.isDepr)&&m(l,r.isTranDepr);if(n){var o=v.frameMatchesPattern(r,h);return"object"!=typeof o?void 0:[r,o._0]}})).filter((function(r){return u.isSome(r)})).map((function(r){return u.getExn(r,void 0)}))}t.procName=l,t.threeStateBoolMatchesTwoStateBool=m,t.doSearchAssertions=p,t.searchAssertions=function(r,t,e,n,o,i,a,s,u,d,v,m,p){return f.promise((function(f){c.beginWorkerInteractionUsingCtx(r,t,e,n,"","",l,{TAG:"FindAssertions",isAxiom:o,typ:i,label:a,pattern:s,patternVersion:u,ctx:n,isDisc:d,isDepr:v,isTranDepr:m},(function(r,t,e){if("OnProgress"===r.TAG)return p(r._0);e(),f(r._0)}),!1)}))},t.frameToStmtsDto=function(r,t){var e=i.disjMake();a.forEach(t.disj,(function(r,t){s.forEach(t,(function(t){i.disjAddPair(e,r,t)}))}));var n=[];i.disjForEachArr(e,void 0,void 0,void 0,void 0,(function(e){n.push(i.frmIntsToStrExn(r,t,e))}));var u=[],c=[];return t.hyps.forEach((function(e){if("E"===e.typ){var n=e.label;c.push(n),u.push({label:n,expr:e.expr,exprStr:i.frmIntsToStrExn(r,t,e.expr),jstf:void 0,isProved:!1})}})),u.push({label:t.label,expr:t.asrt,exprStr:i.frmIntsToStrExn(r,t,t.asrt),jstf:{args:c,label:t.label},isProved:!1}),{newVars:o.range(0,t.numOfVars-1|0),newVarTypes:t.varTypes,newDisj:e,newDisjStr:n,stmts:u}},t.processOnWorkerSide=function(r,t){var e=p(c.getAllFramesInDeclarationOrderExn(),r.isAxiom,r.typ,r.label,r.pattern,r.patternVersion,r.ctx,r.isDisc,r.isDepr,r.isTranDepr,(function(r){t({TAG:"OnProgress",_0:r})}));t({TAG:"SearchResult",_0:e.map((function(r){return[r[0].label,r[1]]}))})},t.reqToStr=function(r){return'FindAssertions(label="'+r.label+'", pattern='+r.pattern+")"},t.respToStr=function(r){return"OnProgress"===r.TAG?"OnProgress(pct="+String(r._0)+")":"SearchResult"}},7470:(r,t,e)=>{var n=e(4923),o=e(6517),i=e(2275);t.markUrlAsTrusted=function(r,t){if(o.isSome(r.webSrcSettings.find((function(r){return r.url===t})))){var e=n.obj_dup(r);return e.webSrcSettings=r.webSrcSettings.map((function(r){return r.url===t?{alias:r.alias,url:r.url,trusted:!0}:r})),e}var i=n.obj_dup(r);return i.webSrcSettings=r.webSrcSettings.concat([{alias:"",url:t,trusted:!0}]),i},t.settingsGetTypeColors=function(r){return i.fromArray(r.typeSettings.map((function(r){return[r.typ,r.color]})))}},9815:(r,t,e)=>{var n=e(2900),o=e(3333),i=e(9592),a=e(7175),s=e(2448),u=e(2423),c=e(7356),f=e(9662),d=e(2275),v=e(5047),l=e(1307),m="MM_wrk_syntax_tree";function p(r,t,e,f,m,p){var h=o.createContext(a.some(r),void 0),E=c.make(4),x=d.make(4),g=d.make(1e3);o.forEachFrame(h,(function(r){d.set(g,r.label,r.asrt.map((function(t){if(t<0)return t;var e=r.varTypes[t],n=c.get(E,e);if(void 0!==n)return n;var i=function(r){var t=o.generateNewLabels(h,"locVar",1,void 0,void 0);if(1!==t.length)throw{RE_EXN_ID:"Match_failure",_1:["MM_wrk_syntax_tree.res",80,12],Error:new Error};var e=t[0],n=o.generateNewVarNames(h,[r],void 0,void 0);if(1!==n.length)throw{RE_EXN_ID:"Match_failure",_1:["MM_wrk_syntax_tree.res",82,12],Error:new Error};var i=n[0];return o.applySingleStmt(h,{TAG:"Var",symbols:[i]},void 0,void 0,void 0,void 0),o.applySingleStmt(h,{TAG:"Floating",label:e,expr:[o.ctxIntToSymExn(h,r),i]},void 0,void 0,void 0,void 0),d.set(x,e,s.getExn(o.getHypothesis(h,e),"tmpCtxHyps")),o.ctxSymToIntExn(h,i)}(e);return c.set(E,e,i),i})))}));var y=v.sortInPlaceWith(d.valuesToArray(g),v.cmpRev(v.comparatorByInt((function(r){return r.length})))).map((function(r){return r.slice(1)})),_=i.proveSyntaxTypes(void 0,a.some(h),a.some(t),f,a.some(e),y,m,p),T=[];return o.forEachFrame(h,(function(r){var t,e,i,c=d.get(g,r.label);if(void 0!==c){var f=u.ptGetSyntaxProof(_,c.slice(1));if(void 0!==f){var m=l.buildSyntaxTree(a.valFromOption(f),(t=r.asrt,e={contents:-1},i=t.length-1|0,function(r){if(r<0)return r;for(e.contents=e.contents+1|0;e.contents<=i&&t[e.contents]<0;)e.contents=e.contents+1|0;if(i>=e.contents)return t[e.contents];var o="makeCtxIntToAsrtInt: asrtExpr="+v.stringify(t)+", ctxInt="+r.toString();return console.error(o),n.raiseError(o)}),(function(t){return o.frmIntToSymExn(h,r,t)}),(function(t,e){return s.flatMap(d.get(x,t),(function(t){var n=t.typ,o=r.hyps[r.varHyps[e]];if(o.typ===n)return o.label}))}));"Ok"===m.TAG?T.push([r.label,m._0]):console.error("Could not build an asrt syntax tree: "+m._0)}}})),T}t.procName=m,t.reqToStr=function(r){return"BuildSyntaxTreesForAllAsrts"},t.respToStr=function(r){return"OnProgress"===r.TAG?"OnProgress(pct="+String(r._0)+")":"Result"},t.buildSyntaxTreesForAllAssertions=function(r,t,e,n){return new Promise((function(o,i){f.beginWorkerInteractionUsingCtx(r.ver,r.val,t,e,"","",m,"BuildSyntaxTreesForAllAsrts",(function(r,t,e){if("OnProgress"===r.TAG)return n(r._0);e(),o(r._0)}),!1)}))},t.doBuildSyntaxTreesForAllAssertions=p,t.processOnWorkerSide=function(r,t){t({TAG:"Result",_0:p(f.getWrkCtxExn(),f.getWrkFrmsExn(),f.getWrkParenCntExn(),f.getSettingsExn().allowedFrms.inSyntax,f.getSyntaxTypesExn(),(function(r){t({TAG:"OnProgress",_0:r})}))})}},4186:(r,t,e)=>{var n=e(5291),o=e(3333),i=e(9592),a=e(6517),s=e(7175),u=e(2815),c=e(9775),f=e(8944),d=e(7356),v=e(9662),l=e(368),m=e(1717),p=e(9702),h=e(8615),E=e(8492),x="MM_wrk_unify";function g(r,t,e){var n=function(r,t){var e=t.exec(r);if(null==e)return{TAG:"Error",_0:1};var n=e.slice(1)[0];return void 0!==n?{TAG:"Ok",_0:n}:{TAG:"Error",_0:2}}(r,t);return"Ok"===n.TAG?{TAG:"Ok",_0:n._0}:{TAG:"Error",_0:e+" ["+n._0.toString()+"]: "+r}}var y=new RegExp("^[^\\(\\)]*\\(([^\\)]*)\\)","s"),_=new RegExp("[^\\{]*\\{(.*)\\}\\s*$","s");function T(r,t,e){var n=new Array(r.numOfVars);return r.hyps.forEach((function(r,o){"F"!==r.typ||(n[r.expr[1]]=e.nodes[t[o]].expr)})),n}t.procName=x,t.unify=function(r,t,e,n,o,i,a,s,u,c,f,d,l){return E.promise((function(m){v.beginWorkerInteractionUsingCtx(r,t,e,n,o,i,x,{TAG:"Unify",rootStmts:a,bottomUpProverParams:s,allowedFrms:u,combCntMax:t.combCntMax,syntaxTypes:c,exprsToSyntaxCheck:f,debugLevel:d},(function(r,t,e){switch(r.TAG){case"OnProgress":return l(r._0);case"Err":return m({TAG:"Error",_0:r._0});case"Result":return e(),m({TAG:"Ok",_0:r._0})}}),!1)}))},t.processOnWorkerSide=function(r,t){var e,o=r.bottomUpProverParams,a=r.rootStmts;if(void 0!==o){var s=o.updateParamsStr;if(void 0!==s){var u=function(r){var t=function(r){return g(r,y,"Cannot extract the list of paramaters")}(r);if("Ok"!==t.TAG)return{TAG:"Error",_0:t._0};var e=t._0,o=function(r){return g(r,_,"Cannot extract the function body")}(r);if("Ok"!==o.TAG)return{TAG:"Error",_0:o._0};var i=o._0,a=n.catchExn((function(){return f.makeFunction(e,i)}));return"Ok"===a.TAG?{TAG:"Ok",_0:a._0}:{TAG:"Error",_0:['Cannot parse a function: "'+a._0.msg+'".','Parsed params: "'+e+'".','Parsed body: "'+i+'".',"Provided function text: "+r+"."].join("\n")}}(s);e="Ok"===u.TAG?{TAG:"Ok",_0:{customParams:o.customParams,maxSearchDepth:o.maxSearchDepth,assertionParams:o.assertionParams,updateParamsStr:void 0,updateParams:u._0}}:{TAG:"Error",_0:u._0}}else e={TAG:"Ok",_0:o}}else e={TAG:"Ok",_0:void 0};if("Ok"!==e.TAG)return t({TAG:"Err",_0:e._0});var c=i.unifyAll(v.getWrkCtxExn(),v.getWrkFrmsExn(),a,v.getWrkParenCntExn(),e._0,r.allowedFrms,r.combCntMax,r.syntaxTypes,r.exprsToSyntaxCheck,r.debugLevel,(function(r){t({TAG:"OnProgress",_0:r})}));t({TAG:"Result",_0:m.proofTreeToDto(c,a.map((function(r){return r.expr})))})},t.proofTreeDtoToNewStmtsDto=function(r,t,e,i,f,v){var m=d.fromArray(r.newVars.map((function(r){if(2!==r.length)throw{RE_EXN_ID:"Match_failure",_1:["MM_wrk_unify.res",476,64],Error:new Error};var t=r[0];return[r[1],t]}))),E=r.nodes.find((function(r){return o.exprEq(r.expr,t)}));if(void 0===E)throw{RE_EXN_ID:n.MmException,_1:{msg:"the proof tree DTO doesn't contain the node to prove."},Error:new Error};return E.parents.map((function(E){if("object"==typeof E&&"Assertion"===E.TAG){var x=E.args,g={contents:!1},y={contents:!1},_=[],A=[],b=o.disjMake(),k=[],S=[],C={newVars:_,newVarTypes:A,newDisj:b,newDisjStr:k,stmts:S},w=u.toArray(f),I=u.fromArray(w,o.ExprHash),M=h.fromArray(v),G=function(r,t,i){var a=u.get(I,r);if(void 0!==a)return a;var c=o.getHypByExpr(e,r);if(void 0!==c)return c.label;if(i){var f=o.generateNewLabels(e,t,1,s.some(M),!0)[0];return u.set(I,r,f),h.add(M,f),f}throw{RE_EXN_ID:n.MmException,_1:{msg:"Could not find a label for an expr."},Error:new Error}},j=function(r,t){return G(r,t,!0)},D=function(r){return G(r,"",!1)},O=d.make(8),N=h.make(8),P=o.getNumOfVars(e)-1|0,U=function(r){if(r<=P){var t=o.ctxIntToSym(e,r);if(void 0!==t)return t;throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot determine sym for an existing int in srcToNewStmts."},Error:new Error}}var i=d.get(O,r);if(void 0!==i)return i;throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot determine name of a new var in srcToNewStmts."},Error:new Error}},F=function(r){var t=o.getFrame(e,r);if(void 0!==t)return t;throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot get a frame by label '"+r+" in srcToNewStmts.'"},Error:new Error}},V=function(t,a,u,c){a.forEach((function(r){if(r>P&&!_.includes(r)){var t=d.get(m,r);if(void 0!==t){_.push(r),A.push(t);var a=o.generateNewVarNames(e,[t],s.some(i),s.some(N))[0];return d.set(O,r,a),h.add(N,a),void j([t,r],"v")}throw{RE_EXN_ID:n.MmException,_1:{msg:"Cannot determine type of a new var in srcToNewStmts."},Error:new Error}}}));var f,v=a.map(U).join(" ");if(void 0!==u&&"object"==typeof u)switch(u.TAG){case"Hypothesis":f=void 0;break;case"Assertion":var l=u.label,p=u.args,E=[];F(l).hyps.forEach((function(t,e){"E"!==t.typ||E.push(D(r.nodes[p[e]].expr))})),f={args:E,label:l};break;case"AssertionWithErr":g.contents=!0,f=void 0}else f=void 0;S.push({label:t,expr:a,exprStr:v,jstf:f,isProved:c})},R=F(E.label),B=[];R.hyps.forEach((function(t,e){"E"!==t.typ||B.push(r.nodes[x[e]])}));var W=c.make(16,o.ExprHash),L=c.make(16,o.ExprHash);return B.forEach((function(n){l.traverseTree(c.fromArray([t],o.ExprHash),n,(function(t,e){if(!c.has(W,e.expr)){c.add(W,e.expr);var n=e.proof;if(void 0!==n&&"object"==typeof n)switch(n.TAG){case"Hypothesis":return;case"Assertion":var o=n.args,i=[];return F(n.label).hyps.forEach((function(t,e){"E"!==t.typ||i.push(r.nodes[o[e]])})),i;case"AssertionWithErr":return void(g.contents=!0)}}}),(function(r,t){return g.contents||y.contents?s.some(void 0):c.has(r,t.expr)?(y.contents=!0,s.some(void 0)):void c.add(r,t.expr)}),void 0,(function(t,n){if(c.remove(t,n.expr),g.contents||y.contents)return s.some(void 0);if(!c.has(L,n.expr)){c.add(L,n.expr);var i=n.proof;if(void 0!==i){if("object"==typeof i)switch(i.TAG){case"Hypothesis":return;case"Assertion":var a=F(i.label);return p.verifyDisjoints(T(a,i.args,r),a.disj,(function(r,t){return o.isDisj(e,r,t)||o.disjAddPair(b,r,t),!0})),void V(j(n.expr,""),n.expr,n.proof,!0);case"AssertionWithErr":return g.contents=!0,s.some(void 0)}}else V(j(n.expr,""),n.expr,void 0,!1)}}))})),g.contents||y.contents?void 0:(V(D(t),t,E,x.every((function(t){return a.isSome(r.nodes[t].proof)}))),p.verifyDisjoints(T(R,x,r),R.disj,(function(r,t){return o.isDisj(e,r,t)||o.disjAddPair(b,r,t),!0})),o.disjForEachArr(b,void 0,void 0,void 0,void 0,(function(r){k.push("$d "+r.map(U).join(" ")+" $.")})),C)}})).filter(a.isSome).map(a.getExn)},t.reqToStr=function(r){return"Unify(debugLevel="+String(r.debugLevel)+", bottomUpProverParams="+(void 0!==(t=r.bottomUpProverParams)?t.assertionParams.map((function(r){return"{allowNewDisjForExistingVars="+(r.allowNewDisjointsForExistingVariables?"true":"false")+"}"})).join("; "):"None")+")";var t},t.respToStr=function(r){switch(r.TAG){case"OnProgress":return'OnProgress("'+r._0+'")';case"Err":return'Err("'+r._0+'")';case"Result":return"Result"}}},2855:(r,t,e)=>{var n=e(6862),o=e(6517),i=e(4186),a=e(5082),s=e(5171),u=e(9662),c=e(5376),f=e(8152),d=e(7115),v=e(9815);function l(r,t,e){return function(o,i){var a=n.deserialize(o.body);o.traceEnabled&&n.logWorkerReceivedRequest(o.clientId,o.procName,a,t),r(a,(function(r){o.traceEnabled&&n.logWorkerIsSendingResponse(o.clientId,o.procName,r,e),i({clientId:o.clientId,body:n.serialize(r)})}))}}var m=a.fromArray([[f.procName,l(f.processOnWorkerSide,f.reqToStr,f.respToStr)],[s.procName,l(s.processOnWorkerSide,s.reqToStr,s.respToStr)],[c.procName,l(c.processOnWorkerSide,c.reqToStr,c.respToStr)],[u.procName,l(u.processOnWorkerSide,u.reqToStr,u.respToStr)],[d.procName,l(d.processOnWorkerSide,d.reqToStr,d.respToStr)],[i.procName,l(i.processOnWorkerSide,i.reqToStr,i.respToStr)],[v.procName,l(v.processOnWorkerSide,v.reqToStr,v.respToStr)]]);t.U=function(r){o.forEach(a.get(m,r.procName),(function(t){t(r,(function(r){postMessage(r)}))}))}},5047:(r,t,e)=>{var n=e(6253),o=e(2900),i=e(2971),a=e(5300),s=e(6517),u=e(303),c=e(1367),f=e(119),d=e(6181),v=o.raiseError,l=d.create("Expln_utils_common.ExplnUtilsException");t.exn=v,t.clearArray=r=>r.length=0,t.arrFlatMap=function(r,t){return i.concatMany(i.map(r,t))},t.arrStrDistinct=function(r){return c.toArray(c.fromArray(r))},t.arrIntDistinct=function(r){return u.toArray(u.fromArray(r))},t.arrForEach=function(r,t){for(var e,n=r.length,o=0;o<n&&s.isNone(e);)e=t(r[o]),o=o+1|0;return e},t.arrJoin=function(r,t){var e=r.length;if(e<2)return r;for(var n=new Array((e<<1)-1|0),o=e-1|0,i=0;i<=o;++i)n[i<<1]=r[i],i!==o&&(n[1+(i<<1)|0]=t);return n},t.copySubArray=function(r,t,e,n,o){for(var i=t,a=n,s=r.length,u=e.length,c=Math.min(s-1|0,(t+o|0)-1|0);i<=c&&a<u;)e[a]=r[i],a=a+1|0,i=i+1|0},t.toIntCmp=function(r){return function(t,e){return a.Int.floor(Math.sign(r(t,e)))}},t.strCmpI=function(r,t){return n.string_compare(r.toLocaleUpperCase(),t.toLocaleUpperCase())},t.cmpRev=function(r){return function(t,e){return f.invert(r(t,e))}},t.comparatorBy=function(r,t){return function(e,n){return t(r(e),r(n))}},t.comparatorByInt=function(r){return function(t,e){return n.int_compare(r(t),r(e))}},t.comparatorByStr=function(r){return function(t,e){return n.string_compare(r(t),r(e))}},t.comparatorAndThen=function(r,t){return function(e,n){var o=r(e,n);return f.isEqual(o)?t(e,n):o}},t.stringify=function(r){var t=JSON.stringify(r);return void 0!==t?t:"undefined"},t.ExplnUtilsException=l,t.hashStr=r=>{let t=0;for(let e=0;e<r.length;e++)t=(t<<5)-t+r.charCodeAt(e),t|=0;return t},t.hashArrInt=r=>{let t=0;for(let e=0;e<r.length;e++)t=(t<<5)-t+r[e],t|=0;return t},t.hashArrIntFromTo=(r,t,e)=>{let n=0;for(let o=t;o<=e;o++)n=(n<<5)-n+r[o],n|=0;return n},t.hash2=(r,t)=>(r<<5)-r+t|0,t.sortInPlaceWith=function(r,t){return r.sort(t),r}},368:(r,t,e)=>{var n=e(6517),o=e(6601),i=e(5047);t.log=function(r){console.log(r)},t.log2=function(r,t){console.log(r,t)},t.traverseTree=function(r,t,e,a,s,u){var c,f=n.isSome(a),d=n.isSome(s),v=n.isSome(u),l=o.make();for(o.push(l,{node:t,nodesToPostProcess:v?[t]:void 0});!o.isEmpty(l)&&n.isNone(c);){var m=o.pop(l);if(void 0!==m&&(f&&(c=n.flatMap(a,function(t){return function(e){return e(r,t.node)}}(m))),d&&n.isNone(c)&&(c=n.flatMap(s,function(t){return function(e){return e(r,t.node)}}(m))),n.isNone(c))){var p=e(r,m.node),h=0;if(void 0!==p&&0!==p.length)for(var E=p.length-1|0,x=E;x>=0;--x){var g;if(v)if(x===E){var y=m.nodesToPostProcess;if(void 0===y)throw{RE_EXN_ID:i.ExplnUtilsException,_1:{msg:"this case is not possible, because each node has itself in its nodesToPostProcess (2)"},Error:new Error};y.push(p[x]),g=y}else g=[p[x]];else g=void 0;o.push(l,{node:p[x],nodesToPostProcess:g})}else h=1;if(1===h&&v){var _=m.nodesToPostProcess;if(void 0===_)throw{RE_EXN_ID:i.ExplnUtilsException,_1:{msg:"this case is not possible, because each node has itself in its nodesToPostProcess (1)"},Error:new Error};for(var T={contents:_.length-1|0};T.contents>=0&&n.isNone(c);)c=n.flatMap(u,function(t,e){return function(n){return n(r,e[t.contents])}}(T,_)),T.contents=T.contents-1|0}}}return[r,c]}},8492:(r,t,e)=>{var n=e(4518);function o(r){return new Promise((function(t,e){try{return r((function(r){t(r)}))}catch(r){return e(n.internalToOCamlException(r))}}))}t.promise=o,t.promiseFlatMap=function(r,t){return r.then(t)},t.promiseMap=function(r,t){return r.then((function(r){return Promise.resolve(t(r))}))},t.promiseResolved=function(r){return o((function(t){t(r)}))}},8969:(r,t,e)=>{var n=e(4923),o=e(7175),i=e(2761),a=e(2448);function s(r,t){return a.map(t()({tokens:r,begin:0}),(function(r){return r.data}))}function u(r){return{tokens:r.tokens,begin:r.end+1|0}}function c(r){return r.tokens.length<=r.begin}function f(r,t){return function(e){return a.map(r(e),(function(r){return{tokens:r.tokens,begin:r.begin,end:r.end,data:t(r.data)}}))}}function d(r,t){return function(e){var n=r(e);if(void 0!==n)return a.map(t(n.data),(function(r){return{tokens:n.tokens,begin:n.begin,end:n.end,data:r}}))}}function v(r){return function(t){if(!c(t)){var e=t.tokens[t.begin];return a.map(r(e),(function(r){return{tokens:t.tokens,begin:t.begin,end:t.begin,data:r}}))}}}function l(r,t,e){var n=void 0!==t?t:0;return function(t){for(var o=r(),i=t.tokens,s=t.begin,c=t,f=[],d=-1,v=!1;!v&&a.mapOr(e,!0,(function(r){return f.length<r}));){var l=o(c);void 0!==l?(f.push(l.data),d=l.end,c=u(l)):v=!0}if(!(f.length<n))return{tokens:i,begin:s,end:0===f.length?s-1|0:d,data:f}}}function m(r){return f(l(r,void 0,1),(function(r){if(1===r.length)return o.some(r[0])}))}function p(r){return function(t){return a.map(i.reduce(r,[[],-1,-1,t],(function(r,t){if(void 0===r)return r;var e=r[0],n=t()(r[3]);return void 0!==n?(e.push(n.data),[e,1===e.length?n.begin:r[1],n.end,u(n)]):void 0})),(function(r){return{tokens:r[3].tokens,begin:r[1],end:r[2],data:r[0]}}))}}function h(r,t){return function(e){return a.flatMap(r()(e),(function(r){return a.map(t()(u(r)),(function(t){return{tokens:t.tokens,begin:r.begin,end:t.end,data:[r.data,t.data]}}))}))}}function E(r,t,e){return f(h((function(){return h(r,t)}),e),(function(r){var t=r[0];return[t[0],t[1],r[1]]}))}function x(r){return function(t){return i.reduce(r,void 0,(function(r,e){return void 0!==r?r:e()(t)}))}}function g(r){return x(r.map((function(r){return function(){return r}})))}function y(r){return g(r.map((function(r){return v((function(t){if(n.equal(t,r))return o.some(t)}))})))}t.parseL=s,t.parse=function(r,t){return s(r,(function(){return t}))},t.makeParserInput=function(r){return{tokens:r,begin:0}},t.toInput=u,t.isEmpty=c,t.mapParsed=function(r,t){return function(e){return a.map(r(e),(function(r){return{tokens:r.tokens,begin:r.begin,end:r.end,data:t(r)}}))}},t.map=f,t.mapOpt=d,t.flatMap=function(r,t){return d(r,(function(r){var e=t(r);return s(r,(function(){return e}))}))},t.match=v,t.oneOf=y,t.val=function(r){return y([r])},t.rep=function(r,t,e){return l((function(){return r}),void 0!==t?t:0,e)},t.repL=l,t.opt=function(r){return m((function(){return r}))},t.optL=m,t.seq=function(r){return p(r.map((function(r){return function(){return r}})))},t.seq2=function(r,t){return h((function(){return r}),(function(){return t}))},t.seq3=function(r,t,e){return E((function(){return r}),(function(){return t}),(function(){return e}))},t.seqL=p,t.seq2L=h,t.seq3L=E,t.any=g,t.anyL=x,t.nonEmpty=function(r){return d(r,(function(r){return 0===r.length?void 0:r}))},t.end=function(r){return function(t){var e=r(t);if(void 0!==e&&c(u(e)))return e}},t.withCallbacks=function(r,t,e,n){return function(o){a.forEach(t,(function(r){r(o)}));var i=r(o);return void 0!==i?(a.forEach(e,(function(r){r(i)})),i):void a.forEach(n,(function(r){r(o)}))}}}},e={};r=function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}(2855),onmessage=t=>{(0,r.U)(t.data)}})();